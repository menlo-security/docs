$(document).ready(function () {indexDict['en'] = [{ "title" : "Getting Started ", 
"url" : "41859-getting-started.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Getting Started ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Isolation Platform Architecture Guide ", 
"url" : "41859-getting-started/41860-isolation-platform-architecture-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Getting Started \/ Isolation Platform Architecture Guide ", 
"snippet" : "Menlo Security Isolation Platform (MSIP) Overview Menlo Security's isolation-centric approach splits web browsing and document retrieval between the user's device and an isolated, Disposable Virtual Container (DVC) away from the endpoint. All risky code is executed in the isolated DVC and never reac...", 
"body" : "Menlo Security Isolation Platform (MSIP) Overview Menlo Security's isolation-centric approach splits web browsing and document retrieval between the user's device and an isolated, Disposable Virtual Container (DVC) away from the endpoint. All risky code is executed in the isolated DVC and never reaches the endpoint. Only safe display data is sent to the user's browser. The diagram below describes how the MSIP works. User traffic is automatically sent to this infrastructure without any impact on the users themselves. The general flow is as follows: A new disposable virtual container (DVC) is instantiated in the MSIP. The DVC browses the target website on behalf of the end user. All active content is executed in the DVC. Only 100% safe rendering instructions are sent to the user's device via \"Adaptive Clientless Rendering\" (ACR). The DVC is discarded when the web session is complete. Menlo Security Paradigm Legacy web security solutions apply decisions based on the type of content and assume they can distinguish \"good\" traffic from \"bad\" traffic. Unfortunately, this methodology inevitably leads to mistakes, because malware is constantly changing. Furthermore, websites in previously harmless content categories ( News , Technology , Education , Government , etc.) are being compromised and used to deliver malware. The commonality among the compromised websites is that they are usually running old, vulnerable server software. Menlo Security researchers found that a third of the Alexa top one million sites are running vulnerable services. Another common web threat is from Uncategorized Sites . This catch-all category can include both a recently created web site that is part of a phishing or spam campaign and a local school website. Both of these types of site may not receive much traffic and may not have been classified by traditional approaches. Clearly, the threat from the former is very high and the latter is very low. Legacy web security solutions force administrators to compromise between security and productivity (blocking too much vs. allowing too much). Menlo Security provides the policy levers for security administrators to automatically Isolate risky websites like Uncategorized Sites , Vulnerable Services , etc. (see ). Security administrators can promote productivity while taking zero risk on behalf of the enterprise. Adaptive Clientless Rendering (ACR) The MSIP utilizes Menlo Securityâ€™s patented Adaptive Clientless Renderingâ„¢ (ACR) technology which provides the connection from the userâ€™s session running in the MSIP to the userâ€™s native browser. ACR technology requires no endpoint software or plug-ins and delivers a completely native user experience essentially indistinguishable from direct interaction with a web site. ACR leverages the fact that all modern browsers use a common framework for describing the elements on a web page (text, graphics, video, etc.). When web content executes normally in a userâ€™s browser it generates document object model (DOM) elements and an associated rendering tree that tells the browser how to create the userâ€™s display. When a web session is executed in the MSIP it also generates DOM and rendering tree information which is then optimized and delivered via the ACR protocol to the userâ€™s browser. The userâ€™s browser takes the information delivered via the protocol and generates the userâ€™s view as if the content were executing in the local browser. A trusted JavaScript delivered to the userâ€™s browser from the MSIP at the beginning of each session establishes and maintains the ACR channel using SSL. For each type of web content the ACR engine selects the optimal encoding and transport mechanism for delivery to the userâ€™s browser. For example, dangerous content such as Flash is executed in the MSIP and then delivered as a hi-fidelity, interactive experience in the userâ€™s browser. In all cases, the userâ€™s browser receives non-executable, malware-free content that renders naturally and preserves the userâ€™s native experience. The ACR protocol carries user activity (keystrokes and mouse clicks) to the MSIP and prevents malicious activity from flowing in the upstream direction. Regions & Failover The MSIP is deployed in data centers throughout the world. The following diagram shows only the major data center deployments; there are additional routing nodes in countries not pictured. These routing nodes allow us to initiate connections from different locations so that web servers can behave accordingly (for example, route traffic through the UK so that UK websites present geo-specific information). Additionally, the global architecture allows us to route traffic for users to their nearest data center (for example, traveling workers or global office locations). MSIP steers the traffic to the closest data center by using latency-based routing technology. In the event of a failure at any of the data center locations, the above latency-based routing technology can re-route the traffic to a different location. Additionally, there are redundant components at each of the data centers. " }, 
{ "title" : "Web Policy (Legacy Admin Portal) ", 
"url" : "41862-web-policy--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Web Administration Essentials Guide ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide ", 
"snippet" : "This guide is divided into the following sections:...", 
"body" : "This guide is divided into the following sections: " }, 
{ "title" : "Introduction to Web Policy Administration (Legacy Admin Portal) ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41893-introduction-to-web-policy-administration--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Introduction to Web Policy Administration (Legacy Admin Portal) ", 
"snippet" : "The Menlo Security Isolation Platform (MSIP) provides a tool for protecting your users from malware. The Isolation Platform can currently be leveraged to protect web traffic, manage access to documents, and prevent phishing attacks via email. In addition, it allows you to view and manage web traffic...", 
"body" : "The Menlo Security Isolation Platform (MSIP) provides a tool for protecting your users from malware. The Isolation Platform can currently be leveraged to protect web traffic, manage access to documents, and prevent phishing attacks via email. In addition, it allows you to view and manage web traffic. The platform provides analysis of all web traffic and potential threats. Administrators can then use the data to set up custom actions to be taken in response to threats and unwanted traffic. This guide outlines the interface and administrator features provided for the MSIP. Most screens and concepts are similar for both Cloud (SaaS) and On-Prem (\"Private Cloud\") versions. Refer to the On-Prem documents for information about specific settings and features provided for the On-Prem MSIP: and . Screens that are currently only available for the Cloud MSIP are noted in this document as such; these include the screens and the screens. This guide assumes you are using the legacy admin portal to manage and configure web policy. If you have enabled the updated admin portal on your tenant, please refer to the for information about managing and configuring web policy. Menlo Security Email Isolation setup and administration is not discussed in this document. Refer to the following Email docs for information about these topics: and . A feature is available to allow users to use their browser password manager in conjunction with web isolation. Please contact Menlo Security Support for details. " }, 
{ "title" : "Administration Console Application ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41894-administration-console-application.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Administration Console Application ", 
"snippet" : "Logging Into the Console To perform analysis and policy setup, open the MSIP Administrator panel. The panel may vary based on your licensed features. To access the panel, simply go to the following page and log in: admin.menlosecurity.com The default timeout (Public Cloud isolation) for the login pa...", 
"body" : "Logging Into the Console To perform analysis and policy setup, open the MSIP Administrator panel. The panel may vary based on your licensed features. To access the panel, simply go to the following page and log in: admin.menlosecurity.com The default timeout (Public Cloud isolation) for the login page is 60 minutes. Menlo Security recommends that administrators use SAML authentication for access to the console. If SAML is not an option, the built-in authentication is used. Built-in authentication enforces the following policy for login: 0-5 attempts: login fails without time penalty 5-10 attempts: the account is locked out for an increasing amount of time (10 seconds) for each attempt 10+ attempts: the account is locked out for 60 seconds between attempts Additional details about SAML Group Support is available at the Menlo Security Knowledge Base . Console Tabs The panel is divided into the following tabs, which can be selected from the left side. These tabs and their associated panes are described in more detail below. : These panes display threat and traffic analysis information. A summary of the most commonly used threat and traffic analysis widgets is provided in the Overview pane. : This pane provides activity logs with various filtering options. : These panes allow the user to run pre-defined or customize queries of user and administrative activity. : These panes are used to define proxy security policies. : These panes are used to manage system and activity reports. Note that this is currently only available for the Cloud MSIP. : These panes configure network and service settings, logging, and the time zone format and settings. Note that this is currently only available for the Cloud MSIP. : These panes configure the warning messages and block pages used with suspicious web pages. Customization for suspicious email links is covered in . Help : This provides access to the user documentation from within the Administrator Panel. The Email Policy pane is only used with Menlo Security Email Isolation; refer to for details. The Status , Management , Authentication and System Update panes are only available for Private Cloud (on-prem virtual appliance) installations; refer to for details. Logging Out of the Console To log out of the Administrator panel and change users, click the user name in the top right corner of the panel and select Logout . A confirmation screen appears when you have logged out. " }, 
{ "title" : "Web Isolation Policy Dashboard (Legacy Admin Portal) ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41895-web-isolation-policy-dashboard--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Web Isolation Policy Dashboard (Legacy Admin Portal) ", 
"snippet" : "Introduction The Dashboard tab provides various widgets that display information about web traffic and threats identified by the MSIP. The following panes are provided: The Overview pane has the key widgets from the other tabs, as well as Virus Scan information (if this feature is enabled). The Dash...", 
"body" : "Introduction The Dashboard tab provides various widgets that display information about web traffic and threats identified by the MSIP. The following panes are provided: The Overview pane has the key widgets from the other tabs, as well as Virus Scan information (if this feature is enabled). The Dashboard first opens to this pane. The Threat Analysis pane provides information about the domains and events that were flagged as threats by the MSIP. The Traffic Analysis pane provides information about web traffic and any actions taken by the proxy service. The Email Analysis pane provides information about email links, user clicks and any actions taken by the Menlo Security Email Isolation Platform. The Email Analysis pane is only used with Menlo Security Email Isolation; refer to for details about these widgets. Use the filter buttons ( Groups and Time ) to update the widgets on the Overview pane for the selected filter. The Time filter updates the widgets for the selected time period (e.g., last 12 hours). The Groups filter (e.g., Administrator) updates the widgets for the selected group. Filtering the Overview pane allows you to quickly view relevant data for the user group type or a specific time period without having to go through and filter each widget individually. Click the Expand icon in the top right corner of each widget to expand the widget and view additional information. To return to the pane, click the Close icon in the top right corner of the expanded widget. You can also drill in and view more specific data by selecting a threat\/domain from the expanded widget. Expand a widget (e.g., \"Top Sites\"). Select a threat\/domain by clicking on the graph (e.g., \"www.google.com\"). Click on the graph to view the pre-filtered Web Logs pane for the selection. All of the widgets available from the three panes are described below. The ordering of the widgets is configurable and may vary on your installation. Select and drag any widget on the pane to re-order the widgets displayed. Threat Types This widget displays types of threats identified by Menlo Security. Expand the widget to view a bar graph of the threat types and the last encountered time for each threat type. Threats are identified from a number of sources, including third party threat\/reputation feeds, AV Scan engines, URL classification databases, and Menlo Security's real-time server vulnerability inspection. Threats Averted This widget displays the number of times Menlo Security took action to mitigate threats. The threats are sorted by the policy applied to each instance: Isolate : Number of sites isolated by the MSIP. Block : Number of sites blocked by the MSIP. To view threat details click the corresponding part of the chart (e.g., Isolate ). Expand the widget to view the following information about averted threats: Date and time for each threat Number of sites isolated or blocked per date Threat Origins This widget displays the top sites which host the most flagged threats. The display also lists the number of visits to each site. Expand the widget to view a larger list of sites that are the source of threats. Information about each site includes the number of visits and the last time visited. Select the appropriate bar in the graph to view the related logs. To view threat events by domain (threat types, browser, and time), click the corresponding part of the graph. A Threats Events on domain pane displays. Virus Scans This widget is connected to the Virus Scan feature. This is an optional feature that helps protect users from documents or files (executables or archives) transferred out of the isolated environment and moved directly to a user's system. The document or file in the original format is scanned across 50+ antivirus engines and determined to be Infected , Clean , or Unknown . In the Unknown case, Menlo Security cannot say for sure if the file is safe or not - Menlo Security only scans the HASH of the file and not the entire file, so in some cases this can result in Unknown . You can configure the action to take on any Unknown responses ( Allow or Block ). Threats by Users This widget displays the number of threats encountered by each user. Expand the widget to view a bar graph of the threats per user and the last access time for each user. Vulnerable Services This widget displays the number of vulnerable services encountered. Menlo Security fingerprints each server prior to loading a page. The server software version is compared against the Common Vulnerabilities and Exposures (CVE) database, and the server is identified as vulnerable if any CVEs match. Expand the widget to view a bar graph of the threat count per service and the last encountered time. Documents This widget displays the number of documents which have been viewed in the Menlo Security isolated document viewer. The document viewer converts documents to a safe HTML5 format, eliminating any active components to provide a safe document view. Expand the widget to view a bar graph of the document count and the last access time for each document. Top Sites This widget displays the top sites viewed. Expand the widget to view a bar graph showing a longer list of sites, the number of visits to each site, and the last access time. If desired, select a site from the bar graph to view the top users for the selected site. Top Categories This widget displays the most accessed categories. Categories are based on the type of hosted content. Expand the widget to view a bar graph with a longer list of categories, the number of sites per category, and the last access time. Selecting a category from the graph displays the list of URLs in that category; click it again to view the URLs in the Log View pane with more information. If desired, select a category from the bar graph to view the most visited domains for the selected category. Top Users This widget displays the users and their usage count. Expand the widget to view a bar graph with the top domains visited by the user, the visit count, and the last access time. If desired, select a domain from the bar graph to view the event log for that user in the past 12 hours. Actions Summary This widget displays the actions taken by the proxy (allow, block, bypass or isolate). Expand the widget to view a bar graph showing the actions taken by time in the past 24 hours. Web Protocols This widget displays the HTTP and HTTPS traffic processed by the MSIP. HTTPS processing requires setting up trusted connections. (Certificate configuration is covered in .) Browsers This widget displays the usage and last access time for each browser processed by the MSIP. The following widgets are only available on the Cloud (SaaS) MSIP. Top Non-Browser User-Agents This widget displays the count and last access time for the top non-browser user agents (iPhone, Android, etc.) processed by the MSIP. Administrators can use this to look for suspicious user-agents and create a web policy for the most commonly used user-agents. Non-Browser User-Agent Traffic Actions This widget displays the count and last access time for user agent traffic actions (allow or block). The data from allowed user-agents can be used for reporting; data from blocked user-agents can be used to create a web policy (or used for further investigation). Traffic Distribution This widget displays an overview of all traffic processed by the MSIP (non-browser, supported browser and unsupported browser). " }, 
{ "title" : "Web Policy Logs (Legacy Admin Portal) ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41896-web-policy-logs--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Web Policy Logs (Legacy Admin Portal) ", 
"snippet" : "Introduction The Logs tab provides access to panes with detailed information about all traffic and any actions taken by the proxy service. Note that only administrators have access to these panes. Use the filter buttons at the top of each pane to configure the list displayed below. Web Logs This pan...", 
"body" : "Introduction The Logs tab provides access to panes with detailed information about all traffic and any actions taken by the proxy service. Note that only administrators have access to these panes. Use the filter buttons at the top of each pane to configure the list displayed below. Web Logs This pane provides detailed information about all web traffic and any actions taken by the proxy service. Click the Show logs for buttons at the top of the pane to view either All Logs , Web Logs only, or Application Logs only. The logs can be additionally filtered by any of the following categories: User group : The ability to group users will be available in a future release. Time period : Click to select the time period to view in the log below. User ID : Click to filter by a specific user. Domain : Click to filter by a domain URL. Category : Click to enter a domain category type to filter by. The top five most-used categories can also be selected from the menu. Threat type : Click to sort by threat type encountered: Flash , Vulnerable Service , Uncategorized Site , Spam , Phishing , Malware , Malvertising , Compromised Host , Command and Control , or Botnet . Risk Level : Click to sort by risk level: All , Low , Medium , or High . Request type : Click to sort by request type: All , Page Request , File Upload , File Request , Flash , Isolated Document , Safe Download , Original Download , or Mail Attachment . Appliance (on-prem only): Click to filter the logs by appliance hostname. Note that this filter is only available on on-prem appliances. Protocols : Click to sort by protocol: All , HTTP , or HTTPS . User Agent : Click to sort by user agent: Chrome , Safari , Firefox , Edge , or Internet Explorer . Actions taken : Click to sort by action taken: All , Allow , Isolate , Block , Bypass , or SSL Exception . Note that if Menlo Security Email Isolation is in use, additional email-specific actions can be selected from the menu. Since the SSL connection is not inspected, there is limited visibility into this action. If more than one filter is selected, the list is filtered by all filters in place (i.e., AND conditions are supported, but OR conditions are not supported). After changing any filters, click the Filter button to view the updated list. Click the Clear button to remove all filters from the list. Note that you can right-click an item to modify the policy, copy the entire URL, or copy the User ID. If you select a log entry, a Log Entry Details sidebar opens on the right. The pane provides tabs with detailed information about the event. Click the Edit Policy button to go to the Web Policy pane and change your policy, if desired. Logging Limitations Currently, SSL is supported only to a small number of ports (443, 8000-8010, 8443). This is enforced by squid, so requests outside these ports do not reach MSIP. A site that returns a 403 exception will not be reported in the logs. File Upload and Download logs If a file is infected the log shows additional information about the file including its size and type, and the sha256 hash of the file so that any hash based exceptions can be created easily. You can create hash based exceptions directly from the log line to mark files (identified by their file hash) as Clean or Infected (cloud only). If a file is infected, the Threat column will show \"Infected\" alongside an information icon. Clicking this icon will present a popup dialog with details of the file that was scanned, and shows detailed information about why the file was determined to be infected. The results of the multi-engine hash check as a “Score” with 0% meaning all engines reported a clean result and 100% meaning all engines reported infections. This also indicates if the file is ‘Unknown’ to the multi-engine hash check. (If enabled) The “File Scan Result” indicates the embedded full file scan result of Clean or Infected followed by the list of viruses reported. The version of file scan is also available which should be provided to Menlo Security Support when reporting any issues. (If enabled) The “File Sandbox Result” if the file was sent to the sandbox and the sandbox score with 0% meaning infected or malicious and 100% meaning not known to be malicious. This will also show a list of potentially malicious activity found by the sandbox - note that this activity may well be expected depending on the file and does not necessarily mean the file is malicious (for example, a Windows Installer program may well be expected to be updating the Windows registry) and so it is possible to obtain a list of potentially malicious activity with a result of Clean. The AV\/Sandbox is a licensed feature. For information about enabling this feature, refer to Anti-Virus (AV) Sandbox Feature . Geo-Location Logging MSIP now collects the geographical location of a user and\/or an Internet service. The following three new fields have been added to the log details for a log entry: Destination country Source country Egress country (MSIP nodes or bounce nodes) The following geo-location information is collected in the log store and available for export via the Log Export API and for analysis in Menlo Insights: Location Field Source Location Latitude Longitude Country Code State Code City Code Destination Location Latitude Longitude Country Code State Code City Code Egress Location Latitude Longitude Country Code State Code City Code Isolation Region (already logged) Email Logs This pane provides information about email traffic and actions taken by Menlo Security Email Isolation. Refer to for details about the email isolation product. DLP Logs This pane provides detailed information about file upload and user input that triggers Data Loss Prevention policy rules. The logs can be filtered by any of the following categories: Time period : Click to select the time period to view in the log below. User ID : Click to filter by a specific user. Filename : Click to filter by a specific filename. URL : Click to filter by a domain URL. Action : Click to filter by Log or Block action. If a log entry is selected, a Log Entry Details sidebar opens on the right. This provides detailed information about the event. Click the DLP Rule Name Hit link to go to the DLP Policy pane and view\/change your policy, if desired. Audit Logs This pane provides detailed information about all actions taken and events that occurred in web proxy service. The following information is collected for each event: Date : Date and time of the event Admin ID : ID for administrator logged in when the action was taken Event Type : Event type that was logged. Events are divided into the following types: Policy : Changes to the web policy Authentication : Authentication events (login and logout events) Settings : Changes to the proxy service settings Sub Type : Provides more information about the event (i.e., which parts of the web policy changed - exception added, categories modified, etc.) Action : The action that took place during the event (e.g., policy change published, excpetion deleted, login\/logout success) Info : Click the i icon to view detailed information about the selected event in a popup window. An example is shown below. " }, 
{ "title" : "Web Policy ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41897-web-policy.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Web Policy ", 
"snippet" : "Introduction The Web Policy panes configure the policies used to manage traffic processing. In some cases you know exactly what types of content you want to prevent your users from accessing (e.g., gambling sites). For this type of content it's best simply to block it instead of processing it in iso...", 
"body" : "Introduction The Web Policy panes configure the policies used to manage traffic processing. In some cases you know exactly what types of content you want to prevent your users from accessing (e.g., gambling sites). For this type of content it's best simply to block it instead of processing it in isolation. For other sites, you may want to enforce processing with a series of filters. The panes provided under the Web Policy tab allow you to configure these filters ( SSL Inspection , Web Apps , Exceptions , Threats , Categories , Docs and Files , and Content Inspection ). Menlo Security maintains a list of proxy exception sites. See for details. Filtering Order and Typical Global Rules and Exceptions Setup The following figure and steps describe the Key Policy Types and rule precedence used by the MSIP. Web Policy Rules The following list provides information about each web policy rule type in order of precedence (highest to lowest). Proxy Auto Config (PAC) : The PAC File is is used to determine which sites will be passed through to the MSIP (and ultimately, to a user). You can specify the sites that will skip the MSIP and be presented to the user without isolation. This is set up on the Proxy Automatic Configuration pane ( Settings -> Proxy Auto Config ) shown below. The default PAC includes the corporate domain as an exception, as well as all private IP ranges (RFC 1918 10, 172, 192, etc.). In many cases, no additions are needed. SSL Inspection : SSL Inspection rules determine the actions taken when an HTTPS session takes place. Malware increasingly uses encrypted sessions to hide activity and bypass existing security solutions. Menlo Security has the ability to isolate and protect HTTPS traffic. In addition to the security, you can view how much HTTPS traffic is in use, where this traffic is going, and who is using it. It also allows you to render documents retrieved from sites using HTTPS. In order to isolate a site using HTTPS (e.g., https:\/\/www.chase.com ), Menlo Security must terminate the SSL connection and open a new one to the destination server. The connection is encrypted with a different certificate. In some cases, there may be regulatory or privacy issues with the opening and re-encryption of a session, even though Menlo Security doesn't save or use the tunneled traffic. An admin can use this editor to determine which sites are NOT isolated by Menlo Security (e.g., healthcare or finance\/banking sites will not be isolated by Menlo Security). SSL Inspection policies apply to proxy requests from the client browser. They are not applied to requests originating from the isolated browser. To block these requests from loading in isolation, a Category or Domain Exception can be used. Exceptions : Exception rules for domains take precedence over your Global rules below (i.e., SSL Inspection , Threat , Category , and Documents and Files rules). The Exceptions editor is designed for entering specific domain exceptions. For example, an Exception rule to allow https:\/\/www.sports.com occurs even if there is a Category rule set to block sports sites; in this case, only that one sports site will be presented to the user. Threat and Category Rules : Threat and Category rules have equal rule precedence. The strictest rule policy is enforced if a site has matching in both the Threat rules list and Category rules list. For example, if a category rule is set to Isolate and the threat rule is set to Block , the site will be blocked. Threat rules control website access of items that pose the greatest risk to users. Category rules control other websites not covered by the Threat rules. Websites that are classified by categories (e.g., sports) can be configured with Allow , Isolate or Block when they are accessed by a user. A detailed description of all currently available Threat and Category Mapping is available here: . Documents and Files Policy Rules Docs and Files rules control transfers in and out of the Isolation Platform once you are on a site. The Web Policy rules in effect will not change the Documents and Files Policy rules in place. For example, a domain may be Allowed , but if the Document policy states that all .docx documents are Isolated , the document on this domain is still isolated. Documents are things that can be converted to HTML5 by the Isolation Platform, but Files cannot be converted to HTML5. Use this editor to determine which documents get converted to HTML5 and to set download Allow or Block policies. You can also configure anti-virus inspections of documents and files to prevent download of infected content. Note that Exceptions take precedence over the Documents and Files rules for viewing and downloading of documents and files. The MSIP now supports a rule type specifically for all other documents or files that are not specifically supported by the platform (see the full list of and ). This is controlled by the Other Documents setting on the Documents and Files pane. Recommended Global Rules and Exceptions Setup Typically, you should set up your Global Rules and Exceptions as follows: Design your Global Rules (i.e., SSL Inspection , Threat , Category , and Documents and Files rules) to err on the side of security by using the Isolate and Block actions. Usually, you should set Unknown Categories and Vulnerable Services to Isolate and the rest to Block . You should set your Category rules to block known bad things (e.g., gambling sites). This removes risk from blocking a legitimate site that hasn't been patched recently but may not be compromised. In either of those configurations, malware won't move from the MSIP to end users, so they are protected. Then set up your Exception rules for a small number of specific sites (e.g., business partners or exceptions for a particular user to go to a site). If you set up an exception to Isolate an HTTPS site that is already listed in the SSL Inspection rules, the exception is ignored (i.e., the SSL Inspection rule takes precedence over the Exception rule). However, if the HTTPS site is set to Block , the site is blocked. If the Threat Rule named Vulnerable Services is set to Block , it will not be enforced when the Category is set to Isolate (the page will be isolated); it will be enforced when the Category (e.g., sports) is set to Allow . Domain Exceptions will still take precedence over the Vulnerable Services threat type. This might be the case if a site has vulnerable versions of IIS and PHP, for example. Over time you may want to Block only a few categories and Isolate everything else. Many of the current choices are left in, so you can transition smoothly to MSIP from other products where you already have defined policies for behavior and want to mirror those as closely as possible with MSIP. Our goal is to always provide the same experience in isolation that you have in native browsers. However, some functions may not yet be supported. If you have problems in an isolated browsing session, please contact the Menlo Security Support team. Saving Policy Changes Making policy changes requires a two-step saving process. These steps can be performed one right after the other, or you can perform the first step ( Save Changes ) and then perform the second step ( Publish ) several hours later. The process is designed to allow an operations team to control exactly when desired changes are activated. Make the desired changes on the appropriate pane. The Save Changes and Reset buttons become active. Click the Save Changes button to save the modified settings. A message appears to confirm the save. If you don't wish to save changes, select Reset to return to the last saved settings. Click the Publish button to deploy the changes to your account. A confirmation message appears after the new policies are applied. Policy changes are active on all enforcement points within 90 seconds of publishing. Risk Score Menlo Security performs a top-to-bottom first rule match to determine the web risk score for pages. Web Risk Score Color Code Risk Level Precedence Comments R Red High 1 Has one or more of the following threats: Vulnerable Service, Phishing, Malware, Malvertising, Compromised Host, Botnet, Parked Domains, Command and Control Y Yellow Medium 2 Has one or more of the following threats: Uncategorized Site, Spam G Green Low 3 Has no known threats The following sections describe all the panes available for configuring the Web Policy. Exceptions Use the Exceptions pane to configure the policy for particular servers or domains. Exceptions take precedence over all policy classifications and can be used to apply specific exceptions to threat and category policies. The available types are listed in the table below. Name Description Domain Enter a domain and the desired policy action for all or a set of users\/groups. In addition to domains, this exception can also include URLs, IP addresses, network ranges, and subnets. See for details. Category Select one ore more category types and the desired policy action for all or a set of users\/groups. Threat Select a threat rule (e.g., vulnernable services like WordPress) and the desired policy action for all or a set of users\/groups. Document Download Create an exception for a document type for all or a set of users\/groups. If desired, a file size exception for downloads is available. Since most malware files are smaller than average, using this setting allows you to create an exception for large files that are more likely to be legitimate. If Size is set to 0 MB, all documents (regardless of file size) are included in the exception. You can also configure whether virus scans are skipped and if downloads of the original and\/or safe documents are allowed. In addition, if your policy allows printing of safe documents, you can control if printing is blocked by default for specific sites\/users. File Download Create an exception for a file download for all or a set of users\/groups. File Upload Create an exception for file uploads for all or a set of users\/groups. Different rules can be applied to isolated and non-isolated sessions. In isolated sessions all file upload actions can be identified and the specified policy applied. In non-isolated sessions Menlo uses a heuristic to attempt to identify the POSTs and PUTs as file uploads; if necessary, this can be fine-tuned for certain websites by inspecting\/blocking POSTs and PUTs over a certain size using an advanced option (a 0 in this field blocks all POSTs and PUTs to the given domains over the minimum size considered for inspection (5kb)). Content Inspection This exception type allows you to override the content inspection module's ability to inspect documents, files, or specific file hashes for all or a set of users. You can create an exception for content inspection to enable ALL content inspection plugin types for uploads, downloads, or both; note that these exceptions will override the base policy for uploads vs. downloads. Exit Prepend Isolation This exception allows a user to exit prepend mode if the user navigates to specific domains. For example, if accounts.google.com is listed, the browser will not be isolated when a user is logged into a google account and then goes to a google application (e.g., gmail or youtube). Dynamic Domain List This exception pulls an external domain list from a remote server at a specified interval. More information about using this exception type is provided below. Geo-Location Create an exception based on the country\/countries of the destination domain (e.g., France). The host country is used to determine if there is a policy match for Geo-location exceptions. Refer to the examples in the note below. These exceptions can be limited to specific users\/groups or published to all users. Resource This exception will allow admins to apply allow\/block policy for resource requests (e.g., javascript, images, css, etc.). See for more information. Geolocation Exception Examples Example 1 : A Geo-location policy isolates\/blocks traffic from the US. The domain being accesed is hosted in China, but a resource on the domain is hosted in the US. The resource is not blocked. Example 2 : A Geo-location policy isolates\/blocks traffic from China or Russia. The domain being accessed ends with .ru , but it is hosted in the US. The domain is not blocked. File Upload Exceptions For the best File Upload control, site access via isolation is recommended. In isolation, upload policy is enforced at the point a site generates a request for the user to select a file. This allows perfect identification of file upload events without the possibility of bypass. Uploads in non-isolated sessions are detected by inspecting the POST content or PUT network data submissions to identify files. Uploads following known patterns or containing enough data to indicate a file transfer will be identified in most cases. Some sites can break files into small chunks or encode the data in ways that cannot be identified on the network. Tuning of advanced parameters may be required to apply more restrictive upload controls. Where possible, identify the specific URL where an upload is processed by a web application and apply a block policy to that URL if there are issues blocking non-upload POSTs. Click Add Exception and select the desired exception Type . Then click Next to continue. Select the users\/groups affected and the desired action, and then click Next to continue. For Domains exceptions, an All Users\/Groups checkbox is provided that can be deselected if you want to associate a specific user or group to that exception type. You can also create User Exceptions and Group Exceptions as part of a Category Exception. Enter the desired category for the exception and the user(s) or group(s). Enter the user's name in the email address format. Your authentication service user name (e.g., Active Directory User Principal Name) will match the user name seen in the Menlo Security logs. The group name must be entered manually and is automatically in lower case. The Policy Action menu sets the exception action. Check the Anti-Virus Scan box if the virus scan will be skipped. Check the Original Download box to block a download of the original document. Check the Safe Download box to block a download of the safe document. For the Cloud MSIP only, you can also configure different policy actions for Isolated and Non Isolated sites (Block, Allow, or Isolate). If desired, enter a reason or tags for the exception rule. Use the Position menu to select where the exception is added in the list (\"Top of List\" or \"Bottom of List\"). Click the Add button to add the exception. Modify the desired action for existing exceptions by selecting the exception Edit button. You can also change the order of the rules in the pane by drag and drop. Exceptions at the top of the list will take precedence over exceptions lower in the list. Domain Exceptions The Domain exception will accept several input forms, described below. You may paste multiple values in comma or space separated formats. Domain Names : For example, google.com . These exceptions apply to the domain and subdomains like mail.google.com . Top Level Domains : For example, info or ru . These broad exceptions will match on any subdomain within the TLD. ru will match with www.news.ru . Note that when you enter a TLD the preceding \".\" is not entered. When creating a TLD exception, a warning briefly appears at the bottom of the window to warn you that the domain is not a \"standard\" (i.e., fully qualified) domain. This will match on any domain ending in the TLD (e.g., 'login.test' and 'some.other.test'). Destination IP Addresses : For example, 8.8.8.8 . IP address exceptions can be entered as individual addresses, ranges like 8.8.8.0-8.8.8.100 , or in CIDR subnet notation like 8.8.8.8\/24 . URL : For example, www.example.com\/news\/ . URL exceptions include the URL path in the policy match. The URL policy is performed as a \"begins with\" match, and it matches any URL under the configured path . The URL policy matches both http: and https: URLs. If you include the protocol when inputting a URL exception, the protocol is removed when saved. URL path policy applies to all browser requests for both isolated and non-isolated requests. Within isolated sessions, URL path policies also apply to HTML5 navigation. HTML5 navigation is a technique in modern browsers that uses javascript to change the address bar URL within a single page www application. Sites that use this technique include youtube.com and github.com . Since the navigation is generated in javascript and not as a network request, HTML5 navigation policy only applies to isolated sessions. We recommend that sites requiring full URL policy control are accessed via isolate policies rather than allow. Isolation Bypass The following feature must be enabled for your tenant. Please contact Menlo Security Customer Success for more information. The Isolation Bypass feature can be used with the following exception types: Domains (Note that a domain with a path is unsupported (e.g., cnn.com\/travel)) Categories Threat Types Geo-Location The isolation bypass only works on the top isolated frame, so if you create a bypass exception for foo.com and it is framed by bar.com, the bypass banner for foo.com will not appear. To set up an isolation bypass exception: Create a new Exception that is one of the supported types. In the Users Affected pane, select All Users\/Groups . Also set your policy to Isolate . Isolation bypass is not supported for Isolate + Read only rules. The Allow Bypass Isolation checkbox appears. Check this box to enable bypass isolation for all users when the exception policy is triggered. Set the rule position and then select Save to save the rule. Adding a Dynamic Domain List (DDL) Exception If a Dynamic Domain List exception type is desired, set up the exception as follows: Select Dynamic Domain List from the Type menu. This exception allows for an external domain list to be pulled at a specific interval from a remote server. The external domain list must be in plain text format with one domain per line. The external domain list may include a maximum of 100,000 domains. Top Level Domains (TLDs) are also supported in the DDL. Enter a List Name in the List Name field. This is the name that will be displayed in the exception editor. Enter the Source URL . The URL must use HTTPS to ensure integrity of domain list downloads. Authenticated requests can be made using the https:\/\/username:password@example.com\/list.txt syntax. You can validate this using the Test Source URL field below. Select an Update Frequency . This is how often the external domain list is pulled (5 min, 30 min, 1 hr, 1 day). Under Test Source URL , select the Validate button to check if the external list is acceptable. This checks the list for valid domains and that it is in the correct ASCII plain text format. A message appears next to the button after validation is complete. If an error is found during validation, a red message appears. In the following figure, a URL could not be found. Click Next > to go to the next screen and select which users and groups this policy will apply to. The Policy Action will be applied to all domains in the list. Click Save when finished. The policy uses string matching to match group names against the SAML group names. Regex and wildcards are not supported, but spaces are supported. To view the SAML auth response, enable verbose debugging and view the request\/response in the browser using developer tools. See for details. The exception is now added to the Exceptions List. If the external list cannot be pulled from the external server, it will be highlighted in the editor as shown below. This can be caused by an incorrect URL, a down server, or malformed data. To correct this, open the exception and use the Test Source URL Validate button to check the URL and list format are correct. Isolation Bypass (Cloud Only) For the Cloud MSIP only, you can also check the Isolation Bypass checkbox to allow users to bypass the isolation policy for a domain. SSL Inspection The SSL Inspection pane allows you to configure the categories or specific sources or destinations (IPs or FQDN) which will be excluded from SSL Inspection. When you set up Menlo Security to Isolate SSL sites, all sites are included by default. You use this policy editor to specify which sites should not be included in the isolation process. For example, some administrators may decide that they should not isolate sites which are hosting health or finance information. The following ciphers are supported for SSL decryption (TLS 1.2): ECDHE-RSA-AES128-GCM-SHA256 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-RSA-AES128-SHA256 ECDHE-RSA-AES128-SHA ECDHE-RSA-AES256-SHA384 ECDHE-RSA-AES256-SHA AES128-GCM-SHA256 AES256-GCM-SHA384 AES128-SHA256 AES128-SHA AES256-SHA256 AES256-SHA To add an exception: Select the exception type, and click the Add button. The following types are available: Category : Website category Source Match : Source IP value Destination Match : Destination hostname or domain Enter the criteria in the window that appears, and then click the Add Filter button. The MSIP appliance now supports copy and paste of a comma and\/or space-delimited list of domains. Previously, a list was filtered out when pasted into this field. The new exception rule is added to the list. Threat Rules Menlo Security analyzes traffic as it is retrieved to determine whether it matches an exception domain rule or a major URL category. But it also determines whether the traffic looks like a threat. Threat analysis can be controlled by the rules editor in the Threat Rules pane. For all threat types the following actions are available: Allow : Allow direct access to the site. Access is logged and monitored, but no security is applied. Isolate : Allow access to the site via the Menlo Security isolated browser. Isolate + Read-Only : A notification icon shows the user that the page is loaded in read-only mode. Block : Do not allow access to the site. Users receive a \"blocked site\" message. As noted previously, you are most likely to use only Isolate or Block . For example, a user accesses a small regional site (e.g., a high school sports team site) which hasn't been seen on the internet before. There isn't a specific domain exception for this site, and it doesn't exist in the major category rules yet. You may not want to block this type of site entirely (by setting Uncategorized Site to Block ), but you may not want to allow this type of site with no protection either. In this situation you can use the Isolate option. With this option Menlo Security fetches and executes this type of site inline for the user, and sends back only the clean and harmless rendering information. A similar example involves the Vulnerable Service threat type. There are many services (e.g., PHP) used by web sites which are un-patched or otherwise known to be easily compromised by hackers. Menlo Security examines such services on a website when a user visits it and can isolate the session to keep the user's browser clean and unexposed to any threats which may exist. This can happen not just for new or unknown sites, but also for common sites which do match a specific category. An example of the Isolate + Read-Only action is if a Facebook page loads with a Vulnerable Service threat. The user will be able to view the isolated page, but they cannot add a post to that page. Finally, the Parked Domains threat type action will be used by default as the policy for any Malware threats, too (i.e., if Parked Domains is set to Block , Malware is also set to Block ). However, you can change any of the policies independently of each other and not affect the parked domains (e.g., set Malware threats to Block and Parked Domains to Isolate ). In all of the above cases the goal is to filter known explicitly bad traffic and to isolate the rest. The configuration options presented here allow you to move to the Isolate mode gradually. This strategy also allows you to easily change the policy for troubleshooting. You can implement an Isolate all policy (including Category Rules , which by default only permit Allow or Block ). Menlo Security can also configure your tenant so the Isolate option is present under Category Rules ; this option is available upon request. Vulnerable Services For the Vulnerable Service type, the Detailed action is also available. Select this option to open a pane and choose the Edit button to set a specific action ( Allow , Isolate , Isolate + Read-Only or Block ) for each vulnerable service. If you don't select the Detailed option, then the action setting applies to all subcategories. The following figure shows the Detailed Threats for Vulnerable Service window that can be used to configure actions for each service. A detailed description of all currently available Threat and Category Mapping is available here: . Category Rules Use the Category Rules pane to define the actions to be taken for all domains that are classified as part of a particular category. For all category types the following actions are available: Allow , Block , Isolate , or Isolate + Read-Only . Allow allows you user to access these pages without isolation. Block is good for controlling productivity (e.g., keep users from surfing gambling websites). Isolate helps make sure sites that you do allow to your users are served in a secure fashion (e.g., sports sites are allowed, but only if they are isolated). Isolate + Read-Only will load isolated pages for that category, but the user will not be able to use the keyboard to enter text in comment boxes or upload files. Clicks (and anything the application does in response to clicks) are still allowed. In the Category Rules pane Menlo Security provides several dozen categories of URLs (e.g., Education and Arts ). These Category Rules match and enforce policy for many sites. However, some sites might not fall into one of the existing Category Rules , such as a little known regional site, or a website which just recently went live and is serving malware. For these sites we can leverage Threat Rules described in previous section or create Exceptions . A detailed description of all currently available Threat and Category Mapping is available here: . Docs and Files Use the Docs and Files pane to configure policies for handling all documents or files that are viewed and\/or downloaded from the web. Documents are things we can convert into HTML5 and perform Isolation on; files are things which can't be isolated. The Docs and Files pane is divided the following sections described below: . Rules can be configured specifically for the following: Downloads Menlo Security will analyze not just the extension to determine the type, but also perform Content Introspection in which attributes of the transferred content are analyzed to determine the document or file status. For example, an executable named something.pdf will still be found to be an executable and the appropriate rule below will be performed. Both Domain Exception and Category Exception rules override document and file download rules. Thus, if a site is blocked for a user, that user will also be unable to download anything from that site. Both Default and Custom rules are available for all supported document and file types. To modify the default rules, select the Set Default Rules button and update the rules according for all documents or files; to set a custom rule, select the Edit button for the specific document\/file type. Document Rules Documents (see the full list of ) can be altered to inject malware or otherwise harm end-user systems. These alterations are often written to exploit end-user software vulnerabilities which are difficult to patch and maintain. Unsuspecting users who open documents found on websites (legitimate or not), or even in web searches, can have their systems compromised. In many cases users don't even need to download the documents locally; they simply need to print and\/or view the documents. In these cases Menlo Security can retrieve the document, open it in the Isolation Platform, strip it of active content, and present a clean HTML5 view of the Document to the end user. There are three stages of viewing and interacting with a document: User views only the HTML5 version of the document; even Safe Downloads (a newly rendered PDF of the original file) are blocked. User views the HTML5 version and is allowed a Safe Download . User is allowed the first two items, and if a Virus Scan is clean they can download the original document in its native format. While the document is scanned, the file scan progress is displayed at the top of the viewer. If multiple scans are enabled, select the Information (i) icon to view detailed scan progress by scan type. Dark Mode is now supported for the Document Viewer on both mobile and web. Once the scans are complete, the document is loaded. A preview pane with page thumbnails for the entire document is provided on the left (select < to collapse the pane). Page navigation and zoom controls are also provided at the bottom of the viewer. In addition, the viewer supports the following commands: More (3 dot) Menu : Basic Commands File Info (i) : Opens a file information pane on the right with page count, date modified, author, and company information. Search : Opens a search box that the user can use to enter and skip to all matching cases in the document using the up and down icons. Share : Opens a window with an original file share link that can be copied to another application. Print : A print preview of the document loads in your browser's native pdf viewer. You can then use the pdf viewer print function (e.g., Printer icon) to print the document. Download Menu : Download Commands Download Original Document : Select to download the original document. Download Safe PDF : Select to download the Safe PDF version of the document. This is the completely clean PDF version of the content. Administrators can control download capabilities including blocking anything infected. Document Rules Editor The Documents Rules editor can be used to configure the policy for loading documents in the browser. These rules are enforced independently of the website being isolated or not. Select the Set Default Rules button to configure the default rule for all document types: Allow , Isolate , or Block . If desired, you can customize the rules by document type by selecting the Edit button next to the document type. The following example shows the window for creating a detailed policy for any spreadsheet document based on the file type (e.g., configure different settings for OpenOffice Spreadsheet and Excel files). The available actions are: Allow : Do not convert document to HTML5, and use the Safe Viewer. Block : Block the document. Isolate : Convert the document to HTML5. If the action is set to Isolate , you can also configure downloads using the following: Original Download : Select one of the radio buttons to configure the actions allowed for the original document ( Always block download or Block download if virus detected ). Safe Download : Select one of the radio buttons to configure the actions allowed for the Safe Download ( Block , Allow , or use an Automatic download of safe document policy that automatically converts the document to a safe PDF when the viewer is launched). Original URL : Select the checkbox to allow sharing of the original URL. For documents, the following rules are also available: Document Print : Select the checkbox to hide the print button so the isolated document cannot be printed. Use the Document Download to configure this by specific site\/user. Document Viewer : Select the checkbox to have documents appear in a maximized dialog on the current page that you can close using the close icon at the top right corner. Encrypted Documents : Use this menu to control the action taken for encrypted documents ( Password prompt , Skip Inspection , Do not Prompt ). Supported Documents Document mapping to the extension is done if Content Inspection doesn't identify the document. Supported document types are being added on an on-going basis. Please see for details. Some of these document formats (such as csv) can be viewed directly within the isolated browsing session. The document policy defined for these types will only apply if the file is being downloaded rather than viewed inline within the isolated browser itself. If functions or fonts from documents are not displayed correctly in the isolated browser, please download and use the original file or contact Menlo Security support for assistance. Hangul Document Considerations The Safe PDF conversion typically chooses Japanese fonts for document downloads. If you will be viewing\/downloading Hangul documents, configure your browser default browser language to first use Korean to ensure proper font selection for the download. For Chrome: Open your browser settings window and search for \"language\". If needed, press Add to add Korean . Then press the More Options icon on the right and select Move to the top so Korean is the first preference. For Firefox: Open your browser Options window and search for \"language\". Click the Choose... button to select the preferred language for pages. In the window that appears, add and move Korean to the top of the window. Click OK to save the changes and close the window. File Rules Files (see the full list of ) are divided into several classifications ( Scripts and Executables , Archives and Compressed Packages , Calendar , and Multimedia ), and there is a similar concept of Default and Custom rules. However, file downloads cannot be converted into safe HTML and presented in a special browser view. Therefore, unlike documents there is no Isolate action. Files are transferred to Menlo Security where they are checked before being allowed to be transferred to the end user. If enabled, an Anti-Virus scan is performed first. Then the file is checked against the rules you’ve defined in this editor for the various types of files ( Allow or Block ). If file downloads are set to Allow and Anti-Virus checks are Off , MSIP transfers the file directly to the end user from the origin server without checking for viruses. The File Rules editor can be used to configure the policy for loading other files types in the browser. Select the Set Default Rules button to configure the default rule for all document types ( Allow , Isolate , or Block ). You can also check a checkbox to Use different rules for Isolated and Non-Isolated sites . This allows you to customize when to Block or Allow a file based on if it is from an Isolated or Non-Isolated web site. In a non-isolated scenario Menlo Security must rely on analyzing the network transfer and cannot see the transfer controls (e.g., save as operation). Analyzing the network transfer is what existing solutions like firewalls and traditional proxies do, and it has accuracy limitations: you won’t always know if content is being transferred as a file or not. The ability to alter the behavior allows you to more aggressively harden the deployment or alternatively configure more accessibility into the deployment based on your requirements. In a standard configuration you isolate all websites ( Isolate all ), so you don't need to activate the Use different rules for Isolated and Non-Isolated sites option. Each file clicked on opens from an isolated web page. Because the isolated session is going to a disposable virtual container, Menlo Security is aware of any file transfer that is taking place (e.g., save as operation). Similarly, all documents are converted to HTML and presented in a special browser view. However, if you haven’t moved to Isolate all you may want to allow different rules on file transfers for isolated or non-isolated sites. If desired, you can also customize the rules by file-type by selecting the Edit button next to the file type. The following example shows the window for creating a detailed policy for any script or executable file. The available actions are: Allow : Allow the file. Block : Block the file. Headers for File Downloads File downloads that have passed through isolation now have the following headers (if available): X-Msip-Download : Original download URL X-Msip-Download-Source : Referrer X-Msip-User : Menlo User ID X-Msip-Download-Hash : SHA-256 file hash The following snippet shows an example header for an isolated .pdf: X-Msip-Download: http:\/\/www.example.com\/testfile.pdf X-Msip-Download-Hash: b8a251897eb68d541aa0bc710c9b65fd9f23dc86912b53a4ebfc6dab43c7454a X-Msip-Download-Source: http:\/\/www.example.com X-Msip-User: support@menlosecurity.com Supported Files File mapping to extension is done if Content Inspection doesn't identify the File. Supported file types are being added on an on-going basis. Please see for details. Other Downloads All other download types are controlled by the action set in this section. Use the Custom Files File Type to enter a user-defined file type extension. The action for these can be set to Allow (isolated) or Block . Use the + (add) icon to add additional custom file type extensions as needed. Note that this feature must be enabled for your tenant. Please contact Menlo Security support for more information. The Custom File Type feature must be enabled for your tenant. Please contact Menlo Security Support for more information. The Other Files and Documents File Type will apply policy to all other documents and files downloaded that are not covered by other rules. These downloads can be Allow (isolated) or Block . If desired, select the Block Download if Virus Detected to prevent downloads of files that are flagged by the anti-virus scan. An example Block page when the custom file extension-based rule is matched is shown in the figure below. Uploads Check the checkbox to configure the desired upload policy: Block Uploads for Isolated Sites : If enabled, no file uploads are allowed as long as the site is isolated. Web Apps This pane allows admins to access control policies for web applications like Chrome and Internet Explorer. You can define unique corporate browser standards for supported browser versions and set the action taken if a user uses an unsupported browser. Corporate Certified Browsers Use the fields in this section to define the unique corporate browser standards. To enable browser management, check the Enabled checkbox and select the Minimum Version to the right. In the Action on Older Version column, choose the behavior for any browser that is older than the minimum version. Select Use Application Rules to apply the Web Application policies to selectively allow access from unsupported browsers. Note that these policies only support allow and block policies. Isolation policies are only available to supported browsers. Select Block to prevent use of the application rules. A block page is returned that explains the browser is not supported. Application Rules Use this section to add and set rule precedence (the first rule has the highest priority) of any web application rules. Define a rule as follows: Select the rule source . Rules can have any of the following sources: Any Browser User Agent IP Address After selecting a source, define the Destination and choose the action to be taken ( Allow or Block ): Any Domain URL IP Address Category Threat Then specify whether this should apply to all requests or specifically for for requests identified as File Uploads . This uses a heuristic to determine whether a POST or PUT is attempting to perform a file upload. This can be fine-tuned for certain sites using the advanced settings if required. The advanced setting allows inspection\/blocking for POSTs and PUTs over a certain size. Entering a 0 in this field means all POSTs and PUTs are blocked for the given domains over the minimum size considerd for inspection (5 kb). Finally, define logging of application rule requests (set Log These Requests to Yes or No ). Menlo Security recommends logging of all requests for both Allow and Block situations. Optionally, enter a description for the rule. In the following figure, the first rule will allow and log access to a specified domain for any source. The second rule blocks and does not log IE10 from accessing any destination in the Alcohol & Tobacco category. External Application Links Use this feature to enable and add custom external application link support. When a link is enabled, the user can click on the link to launch the application through their web browser. Both anchor links (i.e., standard web page links) and javascript navigations (i.e., javascript opening an application) are supported. For information about enabling External Applications Links , contact Menlo Security. mailto links are now enabled for all MSIP tenants and is independent of the External Applications Links feature. By default, the following applications are provided. Click the Enabled checkbox to enable any application. Zoom : Zoom video conferencing app Mailto Links : Email links to your default email client Webex : Webex online meeting app To add a new external application: Press the Add External App button. Enter the Application Name and Link Prefix in the add window that opens. Link prefixes must end in \":\" or \":\/\/\" to be valid. The description is optional. Click Save to save changes. The new external application link is added to the list. Click the Enabled checkbox, and press Save Changes and then Publish to enable the application. Content Inspection Use the Content Inspection pane to configure policies for handling virus and malware analysis for uploaded and downloaded documents or files. The MSIP is able to check for virus infections and malicious activity using several plugins: By checking a \"hash signature\" of the file against a range of antivirus engines’ known malicious file hashes (See .) By scanning the file contents locally for viruses (if enabled) (See .) By sandboxing the upload\/download to look for malicious activity in a remote sandbox (if enabled) (See .) By sending the file, document, or an archive of files to Wildfire for analysis (See .) By sending the file, document, or an archive of files to a REST API through the Menlo File REST API (See .) Each of these plugins can be enabled or disabled using the Content Inspection dialog. These checks apply for uploads and downloads from isolated sites and additionally for requests identified as uploads and downloads on non-isolated sites when the MSIP is configured in “proxy mode”. If Full File Scan and SandBox Inspection are not present in this dialog, these options will need to be enabled for you by Menlo Security. File Hash Check If the File Hash Check is enabled, MSIP will send a hash of any document or file being downloaded to 50+ scanning engines. If any of the engines analyzing the file hash returns an \"infected\" status, MSIP sends an alert for the transfer. There are independent settings for documents and files which control if the infected transfer is Blocked or Allowed . Although it would be rare to want to allow the infected document\/file transfer to not be blocked, this option does exist to allow a scenario where you transfer a potentially infected document so that it can be further analyzed or cleansed. In some cases, the document or file may not be recognized in the virus scan and instead of returning Infected or Clean , Unknown is returned. The action when a document or file is not recognized in a scan can be set to Continue Inspection or Block . The rules on an Unknown File or Unknown Document response for documents and files can be set independently, but in most cases the same action is used. For example, you can err on the side of security ( Block ) for files and err on the side of accessibility ( Continue Inspection ) for documents. In the case of Continue Inspection , if a further content inspection plugin is enabled (such as the full file scan) then the file will have to pass through these subsequent plugin(s) before the file transfer is allowed. If an Unknown File or Unknown Document is Blocked by the hash check, the rest of the content inspection plugins are run if the action is a download only. The block is immediately recorded, and the remaining plugins are used only for logging and forensic archiving purposes. If the multi-engine hash check service is not available or cannot be contacted, you can specify if you wish the file transfer to be blocked or whether it should be allowed to continue on for further analysis (if any). The multi-engine hash check applies to downloads of files and documents. You can also control whether the content inspection applies to downloads and\/or uploads of the file hash. Check the Types of transfers to send checkboxes to enable content inspection for the desired transfer type(s). Full File Scan The multi-engine hash check is only capable of reporting on known good and known bad files. Many files will not have been identified previously as good or bad by the multi-engine hash check service. As a result, in order to identify virus infections, malware and malicious activity it is necessary to perform a full file scan on the file being transferred through the MSIP. The file scan process is embedded within a disposable virtual container inside the MSIP and the results obtained without needing to access a remote service. As with the multi-engine hash-check, you can specify what should happen in the event of a failure to scan the file ( Block or Continue Inspection with further analysis). The embedded full file scan applies to both files and documents. You can also control whether the content inspection applies to downloads and\/or uploads for full file scans. Check the Types of transfers to send checkboxes to enable content inspection for the desired transfer type(s). File Sandbox If this licensed feature is enabled, all infected files blocked by the AV engine and any other files deemed necessary by the local AV engine are sent to the remote sandbox environment (rare cases where it is not possible to identify a file as being either malicious or clean by both the multi-engine hash check and the full file scan). Files scanned by the sandbox are not retained in the sandbox after the scan is complete. The sandboxing happens in a remote cloud Virtual Machine which opens the file and analyses its activity over a short period of time. If it detects any potentially malicious activity taking place (such as attempts to change the Windows Registry settings) then the file will be blocked. Otherwise, the file will be marked as \"Clean\" and the results cached (30 days) for future downloads. The sandboxing can take up to 15 minutes and handles files up to 10 MB in size. You can specify what should happen if the sandboxing exceeds 15 minutes or fails in some other way ( Block or Continue Inspection with further analysis). In addition, you can control whether the sandbox should apply to file downloads and\/or file uploads. The sandbox currently handles files up to 10Mb in size. Finally, you can decide whether or not the detailed sandbox reports include screenshots of the detonated files. Refer to for details on enabling this feature. WildFire Analysis Files can be submitted to the WildFire API for analysis for MSIP Cloud, starting with release 2.56. Either a single file or an archive of up to 100 files can be analyzed by the WildFire API. To enable this feature, check the Enable checkbox next to WildFire Analysis and then use the Edit button to view and configure the plugin. There is a max file size limit that is set by the API itself (currently 10 MB). After the configuration is saved, the analysis is active. Note it may take anywhere from 20 seconds to 10 minutes between the file request and receipt of the file by the user, depending on whether the API performs a static or full dynamic analysis. All file types that match those configured in the Web Policy are sent to WildFire for analysis. If a file (or archive) is found to be clean, the file(s) are made available for download if permitted by the policy. A report is generated immediately with information about the analysis performed, and an admin can retrieve this report later using the file hash. Refer to for details on enabling this feature. Menlo File REST API Files can be submitted to an external REST API for analysis by a custom file analysis engine that complies with the Menlo File REST API. To enable this licensed feature, contact Menlo Security. Once the feature is enabled for use, check the Enable checkbox next to Menlo File REST API , and then use the Edit button to view and configure the plugin. This allows you to integrate existing or custom file analysis engines into the Menlo Security Isolation Platform file processing to control access to downloads and uploads. You must configure your REST API to be compliant with the specification. After the configuration is saved and your API endpoint is running, the following is sent to the API: file hashes, file metadata, and file content matching this rule. The API can respond with a decision to block or continue inspection as determined by your custom decision. The API can also respond with a report URL and additional information which is recorded in the file download log. See the link under Report in the figure below. Refer to for details on enabling this feature. Policy Settings Use the Policy Settings pane to configure the resource policy for all non-isolated resources. Check the Block all non-isolated resource requests checkbox to block these requests. Bandwidth Rules The Bandwidth Rules feature allows you to create video resolution and bandwidth rules for users\/groups. Please contact Menlo Security Support for more information about enabling this feature. Daily bandwidth limits are measured every 60 seconds. Thus, it is possible for a user to exceed their bandwidth limits for up to 60 seconds. The rule action (warning banner) triggers after the next measurement. To create\/modify a rule: Click the Add New Rule to create a new rule, or select the Edit button for an existing rule. The Bandwidth Rule window opens. Enter the following rule details information: Rule Name : Short name for the rule that appears in the Bandwith Rules pane Description : Optional description for the rule Position : Sets the position\/priority for the rule in the list of bandwidth rules If desired, enter user and\/or group names under Users and Groups . The default rule will apply to all users and groups that are not matched by one of the bandwidth rules. Click Next to open the Video Settings window. You can configure video resolution and bandwidth limits for YouTube and other sites here. YouTube : Under YouTube Resolution press the sliders to enable limits for Active and Background tabs. Once enabled, the desired resolution can be set using the pull-down menu below. Note that you can have different settings for active and background tabs. Other Sites : Under Other Services press the slider for the desired site(s). Then press the Bandwidth Limits for Other Sites sliders to enable limits for active and background tabs. Enter the limit value (MB\/s) in the field below. Again, different settings can be used for active and background tabs. Click Save to save the new rule or Cancel to discard it and return to the Bandwidth Rules pane. " }, 
{ "title" : "Non-Isolated Browser Resource Policy ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41898-non-isolated-browser-resource-policy.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Non-Isolated Browser Resource Policy ", 
"snippet" : "Introduction This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Support at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com Introduction In an isolation policy, page requests and resource requests have different policy...", 
"body" : "Introduction This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Support at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com Introduction In an isolation policy, page requests and resource requests have different policy options. Page Requests Page requests are top-level page loads. Usually the URL in your browser address bar represents a page load. The page request URL is highlighted below. Within some pages, there are also iframes , which the browser treats like a page load. These are often embedded elements, like advertisements or videos, where content from a different service is embedded into a page. Resource Requests Resources are all the component parts that make up a web page. These are things like images, css files, and javascript. When a page is loaded with an Allow policy (non-isolated load of the website) these resources are downloaded to the client browser to build the page. In the following figure, an image resource is highlighted. Page Requests vs. Resource Requests in the Context of Isolation This is important because policy options differ when dealing with page requests and resource requests. When a page request is loaded, an isolation session can be initiated. When a resource request like an image is loaded, that individual component of the page is not isolate-able. Because of this, the policy options differ when dealing with page requests and resource requests. Page Requests have all policy options available: Allow Block Isolate Resource Requests have only the following policy options: Allow Block Your existing policy for Categories, Threats, and Exceptions is also applied to resource requests. Block and Allow policies are directly applied to resources, since those actions match the available actions for resource requests. However, since the Isolate action does not apply to resources, we must map Isolate policies to either Block or Allow actions. Default Policy Mappings The default mappings described below address the most common use cases in isolation policies. These can be modified to provide a more permissive or restrictive resource policy. For example, a strict \"Isolate All\" policy map could map all Isolate actions to Block to deny any non-isolate-able resource loads. Please contact Menlo Security Customer Support to modify policy mappings. Threat Policies Threat isolation provides a safe way to access sites of questionable trustworthiness. Because of the suspicious nature of these sites, the default mapping for threats is: Isolate -> Block Category Policies Categories typically govern acceptable use policies, rather than security threats. Here, resources loaded from categories are not associated with security risks and has the following default mapping: Isolate --> Allow Domain Exceptions Similar to category policies, an Isolate policy for a domain exception permits access to that domain, therefore the default mapping is: Isolate --> Allow Known Limitations Vulnerable Service policies do not apply to resource requests. Resource policies are applied on the HTTP request headers. Vulnerable Service headers are not known until the server response is seen, so these cannot be enforced on resource requests. Only 'All User' policies apply to resource requests. Resource requests do not always include authentication cookies needed for association with a specific user. Because of this, user and group policies are not applied to resource requests and all resource exceptions are scoped to All Users. Configuring Resource Exceptions To use this feature, first enable enforcement of non-isolated resources policy. Open the Policy Settings pane ( Web Policy -> Policy Settings ) and check the Non-isolated Resources Enforce Policy checkbox. Once this is enabled, policy for Categories, Threats, and Exceptions ( Domain and Resource types) is applied. Resource exceptions are created in the same manner as other exceptions (see for details). These exceptions act as domain exceptions, but only the resources from the Domain\/IP\/Path are managed by the policy. For example: You have a site that pulls resources from another domain. In this case, the photo is a resource from the domain countriesnow.com and the resource domain loads with its own CSS and resources intact. Create a Resource Exception for the domain countriesnow.com and select the desired action ( Allow or Block ). After the policy is published, the first page does not load the resource (status 403 for all blocked resources), and the resource domain loads (as the page is not blocked), but all the resources do not load (CSS or images). All resource requests (both Allow and Block) are logged in the Web Logs pane as shown below. Note that this generates significantly more log entries. " }, 
{ "title" : "Integrated Data Loss Prevention (DLP) ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41899-integrated-data-loss-prevention--dlp-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Integrated Data Loss Prevention (DLP) ", 
"snippet" : "Introduction Data Loss Prevention (also known as Data Leak Prevention) detects potential data breaches or data ex-filtration transmissions and prevents them by detecting and optionally blocking sensitive data passing through the Menlo Security platform. The Integrated DLP feature provides capabiliti...", 
"body" : "Introduction Data Loss Prevention (also known as Data Leak Prevention) detects potential data breaches or data ex-filtration transmissions and prevents them by detecting and optionally blocking sensitive data passing through the Menlo Security platform. The Integrated DLP feature provides capabilities to capture and analyze potentially sensitive information in: File uploads User entered text into web pages When Integrated DLP is enabled, administrators can configure DLP Policy to control which types of information should be logged and optionally blocked as it passes through the Menlo Security Isolation Platform. Access to DLP is controlled as an RBAC privilege. If you enforce RBAC administrative controls, please ensure that you enable DLP access and DLP logs and dashboard areas for the chosen administrators. Otherwise, DLP will not be visible in the admin UI. DLP Policy DLP Policy consists of a set of active rules selected from a wide set of possible built-in matching expressions known as Dictionaries as well as a set of custom dictionaries created based on a specific string of text or a regular expression. Examples of built-in dictionaries include: Credit Card information Health Care information Financial Details Personal Addresses Region-specific dictionaries (e.g., UK Bank Account numbers, US Social Security Identifiers, etc.) To make it easier to manage the dictionaries, you can create groups of dictionaries and then add these to one or more rules. A DLP rule consists of one or more Dictionaries and\/or Dictionary Groups, along with criteria for when this rule applies such as on file upload or user input, or for certain users, sites, or categories. Each rule has a predefined trigger to reduce false positives. For example, the upload of a string containing a telephone number alongside a name may not trigger the \"Personally Identifiable Information\" rule, whereas the upload of 10 telephone numbers may. These triggers have been carefully designed to minimize false positives whilst still capturing both accidental and malicious upload of sensitive data. Creating a DLP Rule Example The following screens show an example rule that will block files uploaded to dropbox.com for the Marketing group where the file contains Credit Card information. Open the DLP Rules pane ( DLP Policy -> DLP Rules ) and select Add New Rule . Under DLP Rule , enter a Rule Name and select the desired Postion ( Top of List or Bottom of List ). You can also customize the block page notification if the rule is triggered in the User Notification box. Under Content Types , select the toggle for File Upload Inspection and set a Maximum File Size that will pass through DLP inspection. Note that for this rule, text inputs onto a page will NOT be inspected. Under Criteria , select the Users\/Group (in this case, only the users in group \"Marketing Team\"), Session Type (All Sessions, Isolated Sessions, or Non-isolated Sessions), Domains (\"dropbox.com\" only), Categories (e.g., \"Download Sites\"), and Protocol (HTTP and\/or HTTPS). Domains and Categories Criteria are optional. Under Action , select the desired Action ( Block , Log , or Skip Inspection ). If you have auditors who should review any hits to the DLP policy rule (to log the event or block the action), select the Send Audit Email toggle and enter the auditor(s). DLP auditors are configured in the DLP Auditors pane (see ???). Under Dictionaries\/Groups , select the checkbox next to the predefined dictionaries\/groups to use. You can filter the list by search term and\/or type, category, and region above the list. Click Save to save the new rule. You can create a separate rule to log (but continue to allow) upload and user input of any Personally Identifiable information. DLP Auditors There is an option to have an email alert sent whenever a DLP policy rule is hit (whether it is to log the event or block the action). The person(s) who will receive the alert are attached to the specific rule under the policy Action . To use this option, first configure the DLP Auditor profile in the DLP Auditor Configuration pane ( DLP Policy -> DLP Auditors ). Select Add New Profile to create a profile that contains the following details: Auditor Name : Name for the auditor profile group Description : User-defined description for the auditor profile group Email Addresses : Email addresses for each member of the auditor profile group Send File : Use this toggle to attach the file\/text that triggered the DLP rule to the email File Format : Select the file format to use for file\/text attachments (original file\/text, zip of the original file\/text, or encyrpted zip of the original file\/text) Maximum File Size : Select the maximum file size for any email attachments If Menlo Email Isolation is enabled, the email attachment sent as part of the DLP Audit alert may be isolated or blocked (depending on the Email Isolation rules). To prevent unwanted isolation\/block of these emails, be sure to create a rule to allow attachments from the following address: noreply@menlosecurity.com . In on-premise environments, the SMTP server used to send email alerts must be configured in the Central Manager Management templates or on the isolation appliance under Notifications . See . DLP on Non-Isolated Sites Sites in Allow mode (not isolated) can also be analyzed for Data Loss Prevention at the network level using the specified DLP Policy rules. However, there are some limitations to analysis at the network level compared to DLP analysis on isolated sites: The User ID is not always known due to cross domain cookie handling. This means that user and group specific rules cannot be applied. The Web and DLP logs will show \"Unknown\" for the user. The isolation platform is unable to prompt for passwords to decrypt files on non-isolated sites. Because the MSIP does not have complete control over the webpages on the \"allowed\" sites, it cannot prompt for a password to decrypt encrypted files being uploaded. These files will not be inspected for DLP. The isolation platform cannot serve block pages on Allowed sites unless the request was for a site navigation. Similarly, if the DLP violation occurred as a result of an XHR POST rather than a site navigation, it will be received as a response to the XHR POST and will not necessarily be rendered to the user. The behavior of the site is specific to the way the website has been programmed to respond to a 403 response to the XHR POST and cannot be determined by Menlo Security. POST\/PUT requests below 1Kb are treated as dynamic site interaction, rather than user submissions, and are not content inspected. POST\/PUT requests below 5Kb are not inspected as a file upload. In addition to executing DLP analysis on Allowed sites, logs will be generated for file uploads and POST traffic to provide additional visibility to file uploads and POSTs on non-isolated sites. Custom DLP Dictionaries For advanced cases where the built-in Dictionaries do not cover the type of data that needs to be captured, it is possible to create Custom Dictionaries by specifying a search string or regular expression and a trigger level. For example, this functionality can be used to identify company-specific strings that are not included within the default built-in Dictionaries. To create a Custom Dictionary, Open the DLP Dictionaries pane ( DLP Policy -> Dictionaries ), and Click the Create Custom Dictionary button. Add the Dictionary Details for the Custom Dictionary: Name : Custom Dictionary name Description : Description for the Custom Dictionary Category : Dictionary Category type (e.g., Document Classification, Personally Identifiable Information, Other, etc.) Country\/Region : Dictionary Country or Region (e.g., Global, UK, Other, etc.) Add the Criteria required for a match that will trigger a rule using the Custom Dictionary. All of the criteria in this tab must be matched for the dictionary to cause a rule to trigger. The following example is for a Custom Dictionary that triggers if the text being uploaded matches both: String : mycompany.com Expression : The words secret or confidential The DLP engine evaluates expressions using Perl Regular Expression syntax. See Perlre Documentation for details. Once a Custom Dictionary has been added, it will be shown in the list of Dictionaries and is available to be added to any DLP Rule. DLP Custom Thresholds If enabled for your tenant, administrators can also define custom thresholds to trigger the dictionary using either File Upload or User Input counts. DLP Logging A log viewer showing all DLP Log and Block events is now available in the Logs tab ( Logs -> DLP Logs ). A corresponding entry for the file upload or user input event will also be present in the Web Logs. If multiple DLP rules have been hit there will be several entries in the DLP Log for a single file upload or user input event. The Log Export API has also been enhanced to provide the ability to export DLP Logs in addition to the Web Logs. See for details. " }, 
{ "title" : "Reporting ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41900-reporting.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Reporting ", 
"snippet" : "Introduction Use the Reporting panes to configure and export reports. This is currently supported by the Cloud MSIP only. These panes are described in the sections below. Report Scheduler The Report Scheduler pane allows you to add and manage Risk and Top Category, Domain, Users and URL reports. The...", 
"body" : "Introduction Use the Reporting panes to configure and export reports. This is currently supported by the Cloud MSIP only. These panes are described in the sections below. Report Scheduler The Report Scheduler pane allows you to add and manage Risk and Top Category, Domain, Users and URL reports. These report can be configured here to be generated weekly or monthly and then emailed to desired recipients on the weekday of your choice. You can also use this screen to immediately generate any report. Add Report Click the Add Report button at the top right. A new Add Report window opens. Fill out all the fields in the window to configure the report. The following are provided: Report Name : Unique report name Description : Description of report Frequency : Report frequency. You can choose from Weekly, Monthly or Generate Now. Day of the Week : Day of the week that the report is generated on. Recipients : Enter the email addresses of the desired report recipients. Reports included : Click the checkboxes for the desired reports that will be generated and emailed. Click the Save button to save the report (or Cancel to discard it). If \"Generate Now\" was selected, the report takes a few seconds to generate. Click the Go to Generated Reports (see ) button to go the Generated Reports pane to download the new report. Edit Report To edit a report's configuration, click the Edit button inline with the report name and modify any of the desired fields in the window that displays. Click the Save button to save the updated report. Delete Report To delete a report, click the Delete button inline with the report name. A confirmation window appears before the report can be deleted. Generated Reports The Generated Reports pane provides a list of all previously generated reports. To view any report click the link in the Report column for the desired report. The following figure shows an example Top Domains report (.csv format). The detailed risk report can be downloaded in either .pdf or .html format. The following figure shows an example summary page from a risk report. " }, 
{ "title" : "Insights ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41901-insights.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Insights ", 
"snippet" : "Introduction Pressing the Insights button from the navigation bar opens a new tab or window with four panes. Use theses panes to view pre-defined and customize queries of user and admininistrative activity. You can also generate reports of up to 20 queries, schedule reports, and export these for fur...", 
"body" : "Introduction Pressing the Insights button from the navigation bar opens a new tab or window with four panes. Use theses panes to view pre-defined and customize queries of user and admininistrative activity. You can also generate reports of up to 20 queries, schedule reports, and export these for further analysis offline. Menlo captures very detailed and comprehensive logs of user and administrative activity. Some of this is visible in the Admin Console Logs pane. The new Insights feature adds the ability for you to write your own reports and queries to fufill your business needs and reporting requirements. Note that Logs are only retained for 30 days by default, which will affect the dataset that can be queried or reported. Different retention periods for the Menlo Insights logs are available. Please contact Menlo Security for details. The following Insights panes are discussed below: Queries The Queries pane displays all the default and saved custom queries. Default queries are queries that have been predefined by Menlo Security to help you get started. You can customize and save queries for later use from the Explore pane (see below). The default (Menlo-defined) queries have a colored bar on the left side of the query that represents the risk level associated with the search results. For example, if the query includes high-risk activities like downloading malware files, it has a red bar and is labeled as \"Risky\". The default queries can be viewed or copied, but they cannot be deleted. To modify a query (i.e., create a custom query that drilled down to the specific area of interest): Copy the default query by selecting the option from the 3 dot icon on the right. Enter a new query name and press Create copy to save the copy. The custom query has a gray bar on the left side. Custom queries can be viewed, copied, or deleted by selecting the desired action from the 3 dot icon. Reports Reports are collections of the results from a collection of up to 20 queries. Menlo has created a number of default reports with common collections of information. For example, the User Activity Report contains results from the following queries: Activity Time Chart Top Users Top Users accessing Threat Sites directly Top Users downloading from Threat Sites Top Threat Sites Isolated To quickly create a custom query, select the desired queries (up to 20) by clicking the top left circle next to each query. You can also make a copy of and default report and modify the copy. To create a custom report based on a default report: Copy the report by selecting the Copy action icon on the right next to the desired report. Modify the copy with any of the following: Remove queries : Unselect an unneeded query. Move queries : To modify the report layout, select the query title and then drag the query to the new location. Queries can be either full width or half width. Add queries : To add additional queries to the report, select the + icon where the query should appear. Select the query name from the presented list (note it only shows the top 10 queries), or search for a query by typing the query name. Schedule reports : Copy the report and click the Schedule action icon to schedule a default report. Scheduling Reports Only custom reports can be scheduled. If you wish to schedule a default report, you will need to copy it and provide a new name as described above. Scheduled reports are run at or shortly after the scheduled time and are then e-mailed to the recipient list. Reports can be scheduled as follows: Daily : Select the hour for the report to run. Weekly : Select the days of the week and the hour for the report to run. Monthly : Select either the first or last day of the month. All scheduling times are in UTC. Select the UTC time that matches your local timezone. You can enter multiple email addresses to allow for several report recipients. Please note that these reports might contain URLs to malicious websites, and they might be scanned and blocked by your own mail security services. The generated report can be sent in several formats: PDF, HTML or CSV. A copy of the report is also available in the GUI under Archived Reports ; you can download a copy here by selecting the required format. Only the formats selected when the report was scheduled are available for download from the GUI. Archived reports can be deleted by clicking the Delete action icon. Explore The Explore pane allows the user to review detailed log information. At the top of the page, select the desired Source (Web, Email or SMTP) and Time interval (Last 30 days, This week, Last week, Today, Yesterday, This hour, or Recent 15 minutes). The pane is updated with the events that match the selection above. You can filter the results by selecting a field\/value below or by entering a query in MQL (see for more information). For example, to see all activity for a specific user: Either select the user from the log entry, or select user from the panel on the left. As you apply the filter, the query is updated and the logs will be filtered to only show events that match this username. Continue adding filters until you have the exact data you require. Execute the query by pressing Return. If the query is valid, you can save it for future use. Press the Save button on the top right (or press Save as... and give the query a new name before saving). You can also export the results as a CSV file by pressing the Export CSV button. Using this process, complex queries can be built up that allow the user to quickly focus on the data that matters. You can also add views to the query to create a chart from the data. Exploring the Data The graphs and tables generated by queries include various automatic pivots and drill-downs. Hover over the data in the result to see all the ways you can explore the data. In most cases you can start with a pre-defined report and simply click around to customize it further. Events are color coded for security actions in the event log results as follows: Red : Danger Orange : Warning Green : Success Events When neither Aggregations nor View are provided, this returns the matching set of logs from Druid. This effectively acts as a filtered log viewer. Summary When one or more aggregations are provided without an explicit View , the Aggregations are run over the duration of the query without being bucketed by another field. Top This maps to the Druid topN query-type and buckets the aggregations by a given field. For example, top(browser) returns the top 10 browsers, but with the Filters applied. TopYX This is the equivalent of top(Y OVER X) and internally this is mapped to two topN Druid queries. The first topN query computes the top(Y) with the specified Filters ; the second topN query computes the top(X) for each of the Y’s. Timechart This maps to the Druid timeseries query-type and buckets the aggregations over time. The span (and hence the data points returned) is computed automatically based on the query interval. For example a query that has a duration of a month will have the span set to ‘day’. Time Split This internally maps to two Druid queries. The outer query is a topN query over the duration and the second is a topN query with a granularity set to the span. This effectively allows us to look at timechart, but each data point split by the specified field. Geo-Location The following new fields have been added to support Geo-location based policies and logging: Field Description Notes dst_country Destination country dst_state Destination state dst_city Destination city dst_location Destination location The latitude and longitude are separated by '|' src_country Source country src_state Source state src_city Source city src_location Source location The latitude and longitude are separated by '|' egress_country Egress country MSIP nodes or bounce nodes egress_state Egress state egress_city Egress city egress_location Egress location The latitude and longitude are separated by '|' Help The Help pane provides a reference for the Menlo Query Langugage (MQL), which is used to create custom queries in the other Insights panes. For more information about MQL, refer to the section below. Menlo Query Language (MQL) Menlo Query Language (MQL) is a powerful query pipeline to explore, analyze and report on the Menlo Security Isolation Platform logs. MQL is made of four ordered components, all of which are optional. ????????????At the simplest form, fields are name value pairs with an operator. Operators can be = , != , LIKE , NOT LIKE , > , >= , < , <= . Nested boolean expressions with AND and OR are also supported. Aggregations map directly to the underlying Druid aggregations and include count() and distinct(field) ; they also supported inlined filters. This allows a single query to compute two aggregations -- one with a filter and one without a filter. Interval Interval is essentially a time filter applied to the entire query. The interval can be an implied range, from a specific point in the past to now or an explicit range between a point in the past and an offset from that. When specified, it MUST be the first filter in the search pipeline. Query examples: Last day: interval=1d Last 15 minutes: interval=15m Since 2019-01-26T00Z: interval=2019-01-26T00Z Since 2019-01-26T00Z and 1 hour from then: interval=2019-01-26T00Z TO +1h Filters Filters are like the WHERE clause in SQL and act on fields to help narrow down the search. The various filters can be combined with complex boolean expressions to aid in data exploration. Query examples: Field equals value: action=block Field does NOT equal value: action!=block Field IN (value1, value2): action=(allow,isolate) Field contains pattern \"google\": domain LIKE \"%google%\" Field does NOT contains pattern \"google\": domain NOT LIKE \"%google%\" Filter on file size greater than\/equal to 1MB and less than\/equal to 25MB: file_size >= 1MB file_size <= 25MB Boolean expression filter for PDF file with domain that contains pattern \"google\" or \"yahoo\": file_type=PDF AND (domain LIKE \"%google%\" OR domain LIKE \"%yahoo%\") As a convenience, the values for numerical fields in filters (like file_size ) can be expressed as KB , MB , GB , etc. as well as 10K , 22M , etc. Aggregations The following aggreggation types are supported: string, numeric, and eval. String Aggregations String Aggregations (similar to GROUP BY in SQL) summarize events in various ways. MQL has support for two types ( count and distinct ), but with and without filters. Without a View , these summarize events for the entire Interval , but they can be bounded by the interval . Query examples: Count all block events: action=block Count all clicks in the past 7 days: interval=7d action=readonly_entry | clicks=count() Count distinct browsers in the last 2 weeks: interval=2w | browsers=distinct(browser) You can name an aggregation, but also include all Filter expressions to narrow down the search just for an aggregation. This allows you to compute multiple summaries with different criteria in a single query. The first argument to distinct is a field name to do the COUNT DISTINCT on. Query examples: Count email clicks and direct exit actions: clicks=count(action=readonly_entry), direct=count(action=direct_exit) Count distinct users (both all and risky ): interval=1d | all_users=distinct(user), risky_ones=distinct(user, code=(Y, G)) Count downloads, big (over 50MB) and small (less than\/equal to 50MB): download=true | \">50MB\"=count(file_size > 50MB), \"<=50MB\"=count(file_size <=50MB) Numeric Aggregations MQL also supports numeric aggregations including MIN , MAX and SUM . These are especially useful for fields that represent size (in bytes), counters (like number of links in an email) and also duration (time taken to rewrite links). Just like their string counterparts, you can name these aggregations, add filters to them and have multiple aggregations in a single query. Query examples: Min\/Max file sizes: file_size>1MB | min_sz=MIN(file_size) max_sz=MAX(file_size) Download bandwidth of the top 3 file types: download=true | SUM(file_size) | timechart(file_type, limit=3) Last, but not the least, MQL also supports a BUCKET aggregation to generate histograms of numeric fields. This can be combined with top and timechart views to explode the values over another field or over time. The range of a BUCKET aggregation can be specified with min and max options and the number of buckets with the bins option. Query examples: Histogram of file sizes: BUCKET(file_size) Full size tiers by top file types: BUCKET(file_size, bins=3) | top(file_type) File size tiers over time: BUCKET(file_size, bins=3) | timechart Eval Aggregations The eval aggregation allows one to materialize new fields using arithmetic expressions combining other aggregations. This can be useful in computing things like averages or percentages. Query examples: Average events count for each unique domain: events=count(), domains=distinct(domain) events_per_domain=eval (events\/domains) % isolation in the last week: interval=-1w ua_type=supported_browser user!=Unknown | total=count() allow=count (action=allow) \"isolation%\"=eval((total-allow)\/total, format=\"0.00%\") Views The following views are supported: events, summary, timechart, top, and timesplit. Events Views As noted above, when there are no Aggregations in the query pipeline and no explicit View , you get an Events view. This is simply the raw set of events potentially bounded by the Interval . This is also the default view when no query text is provided. Query examples: All allow events: action=allow Events with \"google\" domains in the last week: interval=1w domain LIKE \"%google%\" Summary Views When there are one or more aggregations, but explicit View , you get a summary view. This is simply the one or more specified aggregations applied across the specified interval . In some ways the timechart and top views below are exploded views of the summary for the give interval. For time-based views (see ???), the hints contain the query duration and the span of the data points. This allows the UI to compute “drill-downs” and clicks on charts without having to know much about the grammar or the syntax of MQL. The hints also contain an array of parsed “parts” so all drill-down & pivot operations in the UI simply become text-splicing operations to reconstitute a new MQL. Pre-pend vs. Proxy Users Example: Timechart Views Timechart view simply takes the Aggregations and renders them over time (like an activity chart). This can be used to see number of users over a period or the (filtered) count of events across time. The span (granularity) is automatically determined by the Interval . For example, if the Interval is a day, the span is an hour. If there are multiple aggregations, they are rendered as a stack chart. Query examples: Activity of code Y requests over the last day: interval=1d | count(code=Y) | timechart Malware and Phishing activity over the last day: interval=1d | mal=count(threat=Malware), phish=count(threat=Phishing) | timechart Timecharts allow you to drill down into narrower time slices by dragging a region in the chart. If there are mulitple aggregations (especially eval , you can also explicitly pick the metric to draw as a single series. The number of datapoints across the x-axis can be controlled by the bins option (capped at 1000). Query examples: Code R activity: codeY=count(code=Y), codeR=count(code=R) | timechart(metric=codeR) 300 datapoints of Code R activity: codeY=count(code=Y), codeR=count(code=R) | timechart(bins=300, metric=codeR) Top Views Top view computes the top limit (default 10) aggregations of the given field and then returns them in sorted order. The first aggregation is used for the sorting, but you can override that with the metric option. Query examples: Top 10 code=Y domains: interval=1d code=Y% | count() | top(domain) Top 10 code=Y and code=G domains: interval=1d | y=count(code=Y), g=count(code=G) | top(domain) Top 10 code=Y and code=G domains (sorted by G): interval=1d | y=count(code=Y), g=count(code=G) | top(domain, metric=g) You can specify both the sort order, as well as increase the default limit of 10. Query examples: Least visited categories: code=R | top(category, sort=asc) Top 15 allowed browsers: action=allow ua_type!=non_browser | top(browser, limit=15) Time Split Views Timechart can also be used to split a field and see the top values over time. This is a cross between a timechart and a top view in that we conceptually compute the topN over the specified interval and then further split that over the bounded time. Clicking on the series labels removes that particular value so you can easily exempt outliars. You can control the number of y-axis values with limit and the x-axis datapoints with bins . Query examples: Activity in the top categories over the last day: interval=1d | timechart(category) Activity in the top domains over the last day: interval=1w | timechart(domain) Activity in the top 3 domains over the last day: interval=1w | timechart(domain, limit=3, bins=200) Notes on MQL Syntax and Queries NA Depending on the log event, not all fields contain values. When this occurs, the value is set to \"NA\". If a counting search is then performed for the field, the result will return a count for NA results, e.g., top(risk_score) . These values can be exempted from the charts. " }, 
{ "title" : "Web Isolation Administration Settings (Legacy Admin Portal) ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41902-web-isolation-administration-settings--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Web Isolation Administration Settings (Legacy Admin Portal) ", 
"snippet" : "Introduction Use the Settings panes to configure the settings for user authentication and the automatic proxy. These panes are described in the sections below. Authentication Use the Authentication pane to define a set of Corporate Gateway IP addresses and enable authentication through Security Asse...", 
"body" : "Introduction Use the Settings panes to configure the settings for user authentication and the automatic proxy. These panes are described in the sections below. Authentication Use the Authentication pane to define a set of Corporate Gateway IP addresses and enable authentication through Security Assertion Markup Language (SAML). Corporate Gateway IPs This area allows you to define corporate IP addresses for SAML authentication and non-browser connections by defining individual IP addresses, a range of IP addresses, or an IP network with CIDR notation. Enter the IP address(es), IP range(s), or IP network with CIDR notation in the Gateways IP Addresses field. The policy relies on the source IP to identify the tenant, because the browser does not send any cookies until SSL negotiations are complete. Be sure to define your corporate gateway IPs in this section to avoid issues. If you enter an overlapping or an invalid CIDR range, the field is highlighted and the error is shown in red text. Single Sign-On Click the checkbox to enable editing of the fields below. Single-Sign-On functionality can come from integration with an existing Active Directory system (ADFS) or via a cloud-based solution, such as OneLogin, Okta, or Ping Identity. Complete configuration of these Single-Sign-On solutions is covered in the following specific guides as well as : Single Sign-on functionality is provided for all User accounts. You can also request Single Sign-On for Admin accounts. To enable Single Sign-On for Admin users, contact Menlo Security. This tab is normally not displayed. User Configuration Admin Configuration The following fields are provided for both account types. Select the User or Admin button to configure your settings for the selected account type: Enable user authentication using SAML : Check this box to enable SAML user authentication. The SSO fields below become editable once the box is checked. SAML Server Internet Accessible? : Select the Yes radio button if SAML server is internet accessible (external access will be allowed). Message for External SAML Unavailable : Press the Edit Message button to customize the message displayed if the external SAML login fails (e.g., if the user is out of the office and must connect to their VPN to complete authorization). You can also add a link with more information to the message display. Edit Message window Example Custom Message SAML Provider : Use the pull-down menu to select the appropriate SAML provider (ADFS, ADFS SSO, CA Single Sign-On, Azure Active Directory, Other). SAML 2.0 Endpoint : Enter the Identity provider URL in this field. Service Identifier (Issuer) : Enter the Identity provider Entity ID in this field. Require Authorization Attribute (Admin only): This optional configuration is used to differentiate admins from users where the same identity provider is configured for both the user and admin SAML login. Set to Group to to specify an authorized group membership or select Custom Attribute to enter an authorized name\/value SAML attribute pair for authentication. Attribute Name : Authorization attribute name (for Custom Attribute ) Attribute Value : Authorization attribute value (for Custom Attribute ) SAML Verbose Debugging : If you need verbose logging for assistance in troubleshooting, click the Enable for 2 Hours button here to turn on verbose logging for two hours. The debug logging is included in the authentication response. X.509 Certificate : Copy the X.509 Base64 encoded certificate (.pem file) into this field. Additional Certificates : Select to add additional certificates. When more than one certificate is provided, the SAML response is validated using both certificates, allowing for smooth rollover during certificate transition. If you have multiple certificates and wish to remove one, select the Remove Certificate button under the certificate to remove it. Manual SAML Configuration A manual SAML configuration is required to create the application on the SAML provider for both on-premise and cloud administrators. Use the following parameters to complete the SAML provider configuration to support both user and admin SAML authentication: Protocol : SAML 2.0 SAML Auth Mode : Service Provider Initiated Binding : HTTP POST NameID : User name, usually in email address format Entity\/Issuer Strings : MSIP Cloud SAML User Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml\/metadata MSIP Cloud SAML Admin Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml\/metadata MSIP Private Cloud (On-Prem) SAML User Authentication https:\/\/<your appliance name>\/safeview-auth-server\/saml\/metadata MSIP Private Cloud (On-Prem) SAML Admin Authentication https:\/\/<your appliance name>:8443\/api\/v1\/saml\/metadata Assertion Consumer\/Authentication URLs (where they POST the SAML assertion): MSIP Cloud SAML User Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml MSIP Cloud SAML Admin Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml MSIP Private Cloud (On-Prem) SAML User Authentication https:\/\/<your appliance name>\/safeview-auth-server\/saml MSIP Private Cloud (On-Prem) SAML Admin Authentication https:\/\/<your appliance name>:8443\/api\/v1\/saml Proxy Auto Config Use the Proxy Auto Config (PAC) pane to view the PAC file which should be used. It's also used to manage the browser's policy for resources that should not be requested via Menlo Security. Any domains or networks which are only available within the corporate network should be added here. The default PAC includes the corporate domain as an exception, as well as all private IP ranges (RFC 1918 10, 172, 192, etc.). In many cases, no additions are needed. The following is provided for each PAC: Default : The radio button is selected for the default PAC to use if you have multiple PAC files Display Name : The display name (short, descriptive name) used for the PAC file Proxy Mode : Proxy mode used for the PAC. This can be one of the following: SSL Inspection + Dedicated Proxy Port SSL Inspection + Single Sign-On No SSL Inspection + Dedicated Proxy Port No SSL Inspection + Single Sign-On Location : URL link to the PAC file which is used to steer browser traffic to Menlo Security. Copy the link in the Location field to your browsers (either directly or via AD GPO). See for more details on this process. Actions : Press this button to perform any of the following actions. Note that many of these actions are advanced configurations and not required for most customers. See Proxy Access Control (PAC) Server Customization for details. Edit : Use the PAC configuration wizard to customize the PAC server settings Clone : Clone the PAC file Domains : Use the PAC configuration wizard to customize the PAC server domain exceptions Set Default : Set the PAC file as the default PAC (the radio button will be selected) Preview : View the function that is being used for excepting traffic to the proxy. An example is provided below. Exceptions for domains or IP addresses added in the Proxy Auto Config pane differ in an important way from the exceptions added in the Web Policy -> Exceptions pane. End user systems can directly access the domains and IP addresses entered in the Proxy Auto Config pane, completely bypassing MSIP. In contrast, domains entered in the Web Policy -> Exceptions pane are first passed into the MSIP and then filtered, depending on the Allow , Isolate , or Block settings for those domains. Exceptions in the Proxy Auto Config pane prevent traffic from being processed by MSIP altogether; exceptions in the Web Policy -> Exceptions pane determine how to process traffic within the MSIP. Non-Standard HTTPS Ports This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com If enabled, administrators can now allow access to HTTPS sites that are hosted on non-standard (non-443) ports. By default, proxies normally block access to HTTPS sites on non-443 ports to prevent tunneling of other protocols through the proxy by making a TCP socket to random ports. Bypass Office 365 (Direct Connect) This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com If enabled for your tenant, the Bypass Office 365 feature allows administrators to add Office 365 tenant agnostic URLs to the selected PAC file (to reduce exposure to malicious content, no tenant-specific URLs are included by default). This feature is located in the Advanced Options section of a selected PAC file. Once configured, the customer's own Sharepoint and any Sharepoint-based applications (Word, Excel, Powerpoint, etc.) are isolated. To bypass the applications, the customer Office 365 tenant name(s) must be provided (up to 32 names may be specified). The Office 365 specific tenant names can be found by logging into Office 365 and opening any Sharepoint app. The tenant name is displayed in the URL preceeding \"-my.sharepoint.com\". In the example below the tenant is menlosec . Two-Factor Authentication Use the Admin Access Control pane to configure or reset two-factor authentication for administrator access to the Menlo Security isolation platform. Set Up Two-Factor Authentication To set up two-factor authentication, Open the Admin Access Control pane ( Settings -> Admin Access Control ) and select the Enable 2FA button for any Admin ID entry. A redirect window appears that asks you to log in again into the selected admin account. A Quick Response (QR) code is generated. The user should use this code with their authenticator app to generate a 6-digit code to use for authentication. Either the QR code or the manual code beneath the QR can be used. If needed, click Get a new code to refresh the QR code and manual code. Enter the 6-digit code from your authenticator app in the Enter your Two-Factor Verification Code field. After the code is submitted, you will get a success message like the following figure. The next time the user logs in, they are prompted for a verification code in addition to their password. Reset Two-Factor Authentication Code If a two-factor authentication user needs to change their two-factor code (after it has been set), perform the following steps to reset the code. The user must still have access to their current code and can log into the dashboard to perform this procedure. If the user cannot log in (e.g., their two-factor code is lost), they can perform a hard reset. Refer to . Open the Admin Access Control pane ( Settings -> Admin Access Control ) and select the Reset 2FA button for any Admin ID entry. A window opens that asks the user to enter their password and the two-factor code. After these are successfully submitted, the user is shown a new QR code and manual code to be used by their authenticator application. Enter the 6-digit code in the Enter your Two-Factor Verification Code field. The next time the user logs in, they are prompted for the new verification code in addition to their password. Disable Two-Factor Authentication To disable two-factor authentication for a user, Open the Admin Access Control pane ( Settings -> Admin Access Control ) and select the Disable 2FA button for any Admin ID entry. A window opens that asks the user to enter their password and the two-factor code. After success, the following window appears. Hard Reset of Two-Factor Authentication Perform the following steps if the user has misplaced their two-factor authentication code and cannot log in. On the Login window, click the Reset Two-Factor Code link. Enter the email address for the account to be recovered. A confirmation window appears to inform the user that a reset email has been sent. Click on the emailed link to complete the reset process. The user is sent to a page where they must enter their username and password. The confirmation window notes that two-factor authentication will be disabled for the user. They will not be asked for the authentication code when they next log in. RBAC Admin Roles Role-based access control (RBAC) is managed via the Admin Roles pane. On this pane, you can add and manage roles that will control access to MSIP administrator privileges. This pane is now provided for both Cloud and On-Prem web isolation. To add a new admin role: Click the Add Role button. A blank Add Admin Role window opens. Enter a unique Name and (optional) Description for the new role. Enter the users in the Admin Usernames box. By default, the role maps to the admin username (email). If available on your tenant, you can define SAML group\/attributes to use when enforcing role based access control. Contact Menlo Security for more information. Use the checkboxes in the Privilege table at the bottom to configure the privileges available when the user(s) log into the MSIP. These mirror the tabs available on the left side of all MSIP console screens. In the example above, users david@company.com and donald@company.com will only have read-only access to the Overview and Traffic Analysis panes from the Dashboard tab. They will also be able to view the Web Logs pane from the Logs tab. Use the + and - icons to expand and contract the list. This allows you to set a more granular sub-tab policy, if desired. When ready, click the Save icon to save the new role. Click Continue to confirm the save. Saved changes will be applied the next time the user logs in. For example, the user david@company.com will now see only the following tabs on the left side the next time he logs in. All roles are additive, excluding the default role. If a user has multiple roles, their privileges are the union of all the roles (except for the default role). If the admin is not a member of any of the defined roles, they will have the privileges given to the default role. Egress Routing The Egress Routing pane allows you to view and edit Egress settings specific to the tenant. These are configured by Menlo Security in advance. Egress Routing is a licensed feature. For information about enabling this feature, contact Menlo Security. To configure an Egress setting: Click the Edit button for the desired setting. Enter the desired domain and press the + Add button. Continue adding domains as needed, and press Save . Check the Enabled checkbox to enable the updated settings. Egress settings can be enabled at any time, but they do not take effect until domains are configured for the tunnel. Transparent Proxy In addition to proxy-chaining or using the Proxy-Auto-Config browser setting, you can route HTTP\/HTTPS traffic to MSIP in the cloud using IPSec VPN. In this deployment method, Menlo Security cloud will terminate the IPSec VPN and construct a proxy request for MSIP to process via the proxy and policy. To use this option, contact Menlo Security for assistance in setting up the configuration. API Tokens This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com The API Tokens pane provides a user interface for creating one or more API tokens to use with the Menlo REST APIs. Select Create Token and enter the following: Name : Unique token name Admin Role : Chose the appropriate admin role that can use the token Expires : Time before token expiration (Never, 30 days, 60 days, 3 months, 6 months, 1 year) Press Generate to create the API token. Copy the token for use with the any Menlo REST API. The API Token is only displayed once. Do not press OK or close the window before copying it. Existing tokens can be revoked prior to their expiration date by admins with the permissions to do so by selecting the Revoke button. Tokens are not recoverable after they have been revoked. " }, 
{ "title" : "Customization ", 
"url" : "41862-web-policy--legacy-admin-portal-/41892-web-administration-essentials-guide/41903-customization.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (Legacy Admin Portal) \/ Web Administration Essentials Guide \/ Customization ", 
"snippet" : "Introduction Use the Customization pane to customize the block page, indicators, and dialogs, documents, or files downloaded when the Isolate appliance identifies suspicious web pages. Customers can customize the warning message and button text, add a link to your company policy, and define the CSS ...", 
"body" : "Introduction Use the Customization pane to customize the block page, indicators, and dialogs, documents, or files downloaded when the Isolate appliance identifies suspicious web pages. Customers can customize the warning message and button text, add a link to your company policy, and define the CSS styles and logo used so they match any theme applied to company pages. The Email Customization pane is only used with Menlo Security Email Isolation; refer to for details. If the Integrated DLP feature is enabled, the block page that is shown can also be customized, go to for details. To perform web customization: Log into the Administrator Panel, and open the Web Customization pane ( Customization -> Web ). Select the tab for the item to be customized: Block Page : See . Indicators : See . Dialogs, Documents and Files : See . If desired, click the Preview button to view a sample using the new customization. Select the Reset button to return to the last saved settings, or select Save Changes to save them. Select Publish to implement the new customization. Block Page Use the radio button at the top of the page to select the desired level of web block page customization: Basic : Use the the default block page template and modify it using the settings provided on the Web Customization pane (described below). Advanced : Create a custom block page by entering HTML code in the box that appears. For Basic customization, enter the desired text\/links in the following sections: Block Page Content : Defines the heading and text used in the block page. Custom Link for Company Policy : If desired ( Show Link ), adds a link to your company policy to the block page. Block Page Theme : Use the menu to select a color theme (yellow, red, or white and silver) to use with the block page. To use a different color\/font scheme and add your company logo, check the Setup Custom Settings checkbox and enter the desired settings in the Logo\/Icon and CSS Styles sections below. Logo\/Icon : For custom settings you can upload a company logo to use on the block page. The image can be uploaded with or without a link to a customer-defined webpage (e.g., Company home page). If your logo was already uploaded for use with a banner or email\/mobile block page, use the Copy From menu to add the logo with one click. CSS Styles : For custom settings you can define the page type, colors used and font family for the custom block page. If an Email Block page has already been defined, use the Copy From menu to copy the CSS style with one click. Indicators Enter the desired text\/links in the following sections to customize the read-only and bypass indicators used on web pages: Indicators : Read-Only Indictor : Defines the text used in read-only indicators. You define if the indictor is displayed on small frames and add a shorter text description to the indictor if on a small frame. If desired, a tooltip can be defined for rollover actions on the indicator. Bypass Indicator : Defines the label and tooltip used for bypass indicators. Isolate Indicator : Select one or both of these checkboxes to enable an isolate indicator to be displayed when a page has been isolated. There are separate selections for prepend and proxy mode. If desired, enter text for a tooltip that will be displayed when the page is isolated. Theme Elements : Notifications Theme : Use the menu to select a color theme (dark blue, yellow, red, or white and silver) to use with the indicators. To use a different color\/font scheme and add your company logo, check the Setup Custom Settings checkbox and enter the desired settings in the Logo\/Icon and CSS Styles sections below. Logo\/Icon : For custom settings you can upload a company logo to use on the indicator. CSS Styles : For custom settings you can define the colors and font family for the indicator. If an Email Block page has already been defined, use the Copy From menu to copy the CSS style with one click. Dialogs, Documents and Files Dialogs and safe documents and files can be customized by Dialogs, Documents and Files Theme : Use the menu to select a color theme (blue or white and silver) to use with dialog boxes and in the header of safe documents and files. To add a logo\/icon to documents and\/or dialogs, or to define the colors used for action buttons (e.g., Download ), check the Setup Custom Settings checkbox and enter the desired settings below. Logo\/Icon for Documents and Logo\/Icon for Dialogs : For custom settings you can upload a company logo to use on safe documents and in dialog boxes. If an icon has already been defined, use the Copy From menu to copy the logo with one click. CSS Styles : For custom settings you can define the colors used for the primary action buttons. If the CSS style has already been defined elsewhere, use the Copy From menu to copy the CSS style with one click. Primary Action and Secondary Action button types: Under CSS styles, you can customize the appearance of primary (\"confirm\" or \"proceed\" action) and secondary buttons (\"cancel\" or \"go back\" action) in dialogs. The following figure shows an example dialog with a blue primary Proceed With Caution button and white\/outline secondary Go Back button. Content Blocked by DLP : This message is displayed to users when an attempted user submission has been blocked by a network inspection device such as a Data Leak Prevention (DLP) device. Upload Failed : This message is displayed when an attempted upload network connection fails. This is typically caused by network interruption, but in some cases, a network inspection device may block by causing a network failure. This message can be customized to match network behavior. DLP Block Page Customization Open the DLP Customization pane ( Customization -> DLP ) to set up the DLP Block Page. The radio button at the top of the page provides the following levels of DLP block page customization: Basic : Use the the default block page template and modify it using the settings provided on the DLP Customization pane (described below). Advanced : Create a custom block page by entering HTML code in the box that appears. For Basic customization, enter the desired text\/links in the following sections: Block Page Content : Defines the heading and text used in the block page. Show Filename(s) : Use the toggle to optionally show the filename in use for a file upload that triggers the DLP rule. Show User Notification : Use the toggle to optionally show any DLP block messages added to the specific DLP rule. Custom Link for Company DLP Policy : If desired ( Show Link ), adds a link to your company policy to the block page. Block Page Theme : Use the menu to select a color theme (yellow, red, or white and silver) to use with the block page. To use a different color\/font scheme and add your company logo, check the Setup Custom Settings checkbox and enter the desired settings in the Logo\/Icon and CSS Styles sections below. Logo\/Icon : For custom settings you can upload a company logo to use on the block page. The image can be uploaded with or without a link to a customer-defined webpage (e.g., Company home page). If your logo was already uploaded for use with a banner or email\/mobile block page, use the Copy From menu to add the logo with one click. CSS Styles : For custom settings you can define the page type, colors used and font family for the custom block page. If an Email Block page has already been defined, use the Copy From menu to copy the CSS style with one click. " }, 
{ "title" : "Web Policy (New Admin Portal) ", 
"url" : "41864-web-policy--new-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "", 
"url" : "41864-web-policy--new-admin-portal-/41904-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ ", 
"snippet" : "New Admin Portal Overview Menlo Security is introducing updates to our admin portal, starting with an improved experience for the web policy and settings features. These updates are now generally available to all customers. All existing configurations and settings will be retained after you migrate ...", 
"body" : "New Admin Portal Overview Menlo Security is introducing updates to our admin portal, starting with an improved experience for the web policy and settings features. These updates are now generally available to all customers. All existing configurations and settings will be retained after you migrate to the new admin portal. Documentation about the new admin portal is provided here: Note that you will not be able to revert back to the previous Admin Portal interface after upgrading to the new Admin Portal. All tenants can now enable the new Admin Portal. If you missed the webinar introducing the changes, we highly recommend you watch the recording: Preview of the new Admin Portal . Migration (Cloud Service) When you are ready to migrate to the new admin portal, the tenant administrator can confirm and activate the migration. Following migration, a New Version button appears on the top right, next to the current user icon. When you click the New Version button, a pop-up window appears that asks for confirmation that you wish to start using the new admin portal. If you decide that you would like to migrate at a later time, select Maybe Later . Otherwise, click Let's Go Now to continue. An optional guided tour is available that walks you through the major new features in the updated admin portal. Click Take the Tour to view the tour or Skip to immediately start using the admin portal. Migration (On-Prem Appliance) A New Version Available modal is provided at the top of the central manager admin portal screen. Select Upgrade Now when you are ready to migrate. If you decide that you would like to migrate at a later time, select the close icon in the top right to close the modal. The modal will reappear the next time you log into the admin portal. Refer to the for more information about how to create and manage policy in the new admin portal. Note that after you migrate you will need to use the App Switcher on the top right to navigate back to the other applications in the admin portal (Central Manager, Logs, etc.). Navigation in the Legacy Admin Portal Navigation in the Updated Admin Portal " }, 
{ "title" : "Web Policy Guide ", 
"url" : "41864-web-policy--new-admin-portal-/41905-web-policy-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ Web Policy Guide ", 
"snippet" : "Introduction The following document is intended only for the Web Policy application provided in the new Admin Portal. Other parts of the Admin Portal interface will be updated and added as additional apps in subsequent versions\/releases of the Menlo Isolation Core. Note that you will not be able to ...", 
"body" : "Introduction The following document is intended only for the Web Policy application provided in the new Admin Portal. Other parts of the Admin Portal interface will be updated and added as additional apps in subsequent versions\/releases of the Menlo Isolation Core. Note that you will not be able to revert back to the previous Admin Portal interface after upgrading to the new Admin Portal. All tenants can now enable the new Admin Portal. If you missed the webinar introducing the changes, we highly recommend you watch the recording: Preview of the new Admin Portal . App Switcher To access the Admin Portal panes for all other applications (e.g., Dashboard , Logs , Insights , etc.) select the App Switcher icon on the top right next to the search bar and choose the desired application. The following applications are available in the new Admin Portal: Web Policy : (described in this document) Settings : DLP : ??? (described in this document) CASB : Note that as of this release, the areas listed below will continue to use the legacy Admin Portal user interface. Please continue to reference the following sections for information about these screens: Dashboard : Logs : Insights : Customization : Overview of Web Policy Enforcement in the Isolation Core The Web Policy panes configure the policies used to manage traffic processing. At a high level, web policy can be configured as follows: Sites which users should NOT have access to will have an action of block. For example, sites which are categorized as gambling sites or sites that have a threat of malware. Set up the Isolation Core to enforce processing with a series of filters (Web Policy Rules). The Web Policy panes will allow configuration of these filters to set up the desired web isolation policies for your tenant. Web Policy Rules are enforced in order of precedence as shown below: Proxy Auto Config (PAC) : The PAC File is is used to determine which sites will be passed through to the Isolation Core (and ultimately, to a user). The administrator can specify the sites that will skip isolation and be presented directly to the user. The default PAC includes the corporate domain as an exception, as well as all private IP ranges (RFC 1918 10, 172, 192, etc.). In many cases, no additions are needed. Menlo Security also maintains a list of proxy exception sites for domains that are not processed by any components of the Isolation Core. The list is regularly reviewed and updated. See for details. SSL Decryption Exemption : SSL Decryption Exemption rules determine the actions taken when an HTTPS session takes place. Web Application Rules : Web Application rules define the behavior of non-browser and unsupported browser traffic. These can be used to define corporate browser standards and to set policy for unsupported browsers. Exceptions : Exception rules create policy rules that will allow some actions that are normally not allowed based on the Global Policy. For example, users in HR may be able to access Social Networking sites, but these sites could be blocked for everyone else in the company. An example of a site-based exception is if the same company that blocks Social Networking sites allows users to access LinkedIn. Note that Exceptions will take precedence over documents, archives\/compressed packages, and files policy rules, so if these sites are blocked, documents and files from those sites are also blocked. If an Exception rule will Isolate an HTTPS site that is already listed in the SSL Decryption Exemption rules, the Exception is ignored (i.e., the SSL rule takes precedence over the Exception rule). However, if the HTTPS site is set to Block , the site is blocked. If the Vulnerable Services Threat Rule is set to Block , it will not be enforced when the Category is set to Isolate (the page will be isolated). It will be enforced when the Category is set to Allow . Threat and Category Rules : Threat and Category rules have equal rule precedence. The strictest rule policy is enforced if a site matches both category and threat policy. For example, if a category rule is set to Isolate and the threat rule is set to Block , the site will be blocked. Threat rules control website access of items that pose the greatest risk to users. Category rules control other websites not covered by the Threat rules. Websites that are classified by categories (e.g., sports) can be configured with Allow , Isolate or Block when they are accessed by a user. If the Multi-Region Administration feature is enabled for your tenant, Exceptions policy is enforced in the following order: global policy (primary tenant), then local tenant policy, and finally by global post policy (default policy). See :ref: multi-region-admin for details. Web Policy Enforcement of Transfers In\/Out of Isolation Core In addition, the Web Policy panes provides the ability to configure policies for the transfer of documents and files; if applicable, you can also create a separate policy for isolated and non-isolated sites. Documents contain content which can be converted to HTML5. If isolated, these can be viewed in the Document Viewer. Files cannot be converted to HTML. Note that the Web Policy rules in effect for a page will not change the documents, archives, and file policy rules in place. For example: Domain is Allowed and Documents (.docx) are Isolated -> Page loads without isolation, but document downloads are isolated. The Isolation Core also supports a rule type for all other documents or files that are not supported by the platform (see the full list of and ). Risk Score Menlo Security performs a top-to-bottom first rule match to determine the web risk score for pages. These scores are used for policy decisions and are logged for each site. Web Risk Score Color Code Risk Level Precedence Comments R Red High 1 Has one or more of the following threats: Vulnerable Service, Phishing, Malware, Malvertising, Compromised Host, Botnet, Parked Domains, Command and Control Y Yellow Medium 2 Has one or more of the following threats: Uncategorized Site, Spam G Green Low 3 Has no known threats Recommended Global Rules and Exceptions Setup Typically, the Global Web Policy Rules and Exceptions are set up as follows: Design the Global Rules ( SSL Exemption , Threat , Category , and Docs and Archives Isolation , File Uploads and File Downloads rules) to err on the side of security by using the Isolate and Block actions. The goal is to filter known explicitly bad traffic and to isolate the rest. Typically: Unknown Categories and Vulnerable Services are set to Isolate . All other Threats are set to Block . Set the Category rules to Block known bad sites (e.g., pornography sites). Set the Category rules to Isolate all other categories (by default the action is set to Allow). Depending on the license purchased, an Isolate all policy can be implemented. This means that the rules can be configured to include the Isolate option, as well as Allow or Block ). Then set up the Exception rules for a small number of specific sites (e.g., business partners or exceptions for a particular user to go to a site). Over time the policy may be modified to Block only a few categories and Isolate everything else. Current choices remain in place so there will be a smooth transition to the Menlo Security Isolation Core from other products where there are already defined policies for behavior that are mirrored as closely as possible in the Isolation Core. Our goal is to always provide the same experience in isolation that you have in native browsers. However, some functions may not yet be supported. If you have problems in an isolated browsing session, please contact Menlo Security Customer Success . Policy Actions For most policy rules, the following actions are available. Note that some policy rule types like File Uploads and Resource Requests will have limited actions available (Allow or Block only): Allow : Allow direct access to the site and\/or direct access to the original document\/archive\/file. Access is logged and monitored, but no security is applied. Isolate : Allow access to the site via the Menlo Security Isolation Core. For documents, a safePDF can be produced and presented to the user for viewing and\/or downloads. Isolate + Read-Only : A read-only pane is loaded via the Menlo Security Isolation Core. Customization is available to show a notification icon that the pane is loaded in read-only mode. An example of the Isolate + Read-Only action is if a Facebook page loads with a Vulnerable Service threat. The user will be able to view the isolated page, but they cannot add a post to that page. Block : Do not allow access to the site and\/or do not allow viewing or downloads\/uploads of the document\/archive\/file. Users will receive a customizable “blocked site” message in the browser. Saving Policy Changes Making policy changes requires a two-step saving process. These steps can be performed one right after the other, or you can perform the first step ( Save Changes ) and then perform the second step ( Publish ) several hours later. The process is designed to allow an operations team to control exactly when desired changes are activated. Make the desired changes on the appropriate pane. The Save button becomes active. Use Reset changes to return to the previously saved policy. Click the Save button to save the modified rule(s). A message appears to confirm the save. Click the Publish button to deploy the changes to your account. A confirmation message appears after the new policies are applied. Policy changes are active on all enforcement points within 90 seconds of publishing. SSL Decryption Exemptions By default, the Menlo Security Isolation Core performs SSL decryption on all HTTPS sessions. SSL decryption is needed to perform security operations on these sessions, including isolating web requests and performing content inspection on data transferred. In some cases, there may be regulatory or privacy issues with the opening and re-encryption of a session, even though Menlo Security doesn't save or use the tunnelled traffic. For these cases, an administrator can use the policy editor to determine which sites should NOT be decrypted by Menlo Security (e.g., healthcare or finance\/banking sites). Since these sites will completely bypass the Isolation Core, the SSL exemption policy rules should be used cautiously. SSL decryption exemption policies apply to proxy requests from the client browser. They are not applied to requests originating from the isolated browser. To block these requests from loading in isolation, a Category or Domain Exception can be used. The following ciphers are supported for SSL decryption (TLS 1.2): ECDHE-RSA-AES128-GCM-SHA256 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-RSA-AES128-SHA256 ECDHE-RSA-AES128-SHA ECDHE-RSA-AES256-SHA384 ECDHE-RSA-AES256-SHA AES128-GCM-SHA256 AES256-GCM-SHA384 AES128-SHA256 AES128-SHA AES256-SHA256 AES256-SHA Integrations Bypass To simplify bypass of services such as Office 365, this feature will add SSL decryption exemptions for all domains published by the service provider. These domains can be reviewed via the Domains, IPs, and Tenants link. As domain updates are made by the service provider, this policy is automatically updated without the need for administrator intervention. Within the Domains, IPs and Tenants link for Office 365, the corporate tenant name can be added to narrow the scope of some domains used for content sharing. For example, rather than bypassing all SharePoint domains, adding a tenant will only bypass mytenant.sharepoint.com , which will allow files on non-corporate SharePoints to be inspected. If desired, administrators can add Office 365 tenant agnostic URLs by selecting the Domains, IPs and Tenants link on the right. To reduce exposure to malicious content, no tenant-specific URLs are included by default. The list of domains and IP addresses can be viewed in the section below the Scope section. Once configured, the customer's own Sharepoint and any Sharepoint-based applications (Word, Excel, Powerpoint, etc.) are isolated. To bypass the applications, the customer Office 365 tenant name(s) must be provided (up to 32 names may be specified). The Office 365 specific tenant names can be found by logging into Office 365 and opening any Sharepoint app. The tenant name is displayed in the URL preceeding \"-my.sharepoint.com\". In the example below the tenant is menlosec . Enforcing Existing Policies Administrators can create SSL decryption exemption policies to exempt the following from SSL inspection: Category : Exempt all websites that match this website category. Descriptions and examples of currently available Categories is provided here: . Destination Match : Exempt specific destinations (Domains, IPs or FQDN) from SSL inspection. Source Match : Exempt specific sources (Domains, IPs or FQDN) from SSL inspection. For Destination\/Source Match rules, the Import Values function can be used to select a text\/csv file containing comma or space-delimited IPs or CIDR notations. Enforce Block Policies The option to Enforce Block Web Policies on SSL Exemptions allows enforcement of existing web policies while the SSL exemption rules are analyzed. When this option is disabled , SSL exemptions override all other policy and a request matching an SSL exemption is allowed through without any further policy match. When this option is enabled , a connection matching an SSL exemption is further analyzed against web policy to determine if a block should be applied. For example, a connection to bank.example.com may match a broad exemption, like a \"Finance\" category exemption, but if a domain exception to block that specific domain is present, the block can be enforced. When SSL exemptions are enforced the connection is not yet decrypted. Internal connection data, such as user identity or file content, cannot be enforced. Category and domain rules are applied, but block policies applying to users, groups, and files are not applied in this SSL exemption policy. The following processing modes are available when the enforce block option is enabled: Serve Block Page : This mode will display the customized block page and log the username against the \"Block\" action in the Menlo logs. In order to achieve this, the Menlo proxy must decrypt the connection and prompt the user to authenticate. If the user's device does not trust the Menlo Security Root CA certificate, they will see a certificate warning in their browser which they can choose to click through (this occurs before the prompt for authentication). Reset Connection : This mode is simply resetting the connection which means a browser error is displayed instead of your customised block page. This mode does not decrypt the traffic so the end user's device does not need to trust the Menlo Security Root CA certificate. The logs will show the action as \"Reset\" and will not log the username. Currently, sessions blocked during SSL decryption processing will generate a low level block message without styling. Customized block pages will be added in an upcoming release. The log entry for the event will show the block action and the categorization of the website. This information is also available in Insights. Policy Exceptions Use the Policy Exceptions pane to create rules for certain (or all) users\/groups. User names are entered in email address format, and your authentication service user name (e.g., Active Directory User Principal Name) will match the user name seen in the Menlo Security logs. Group names must be manually entered and are automatically saved in lower case. Policy exceptions generally do either of the following: Allow User\/Group to perform certain actions that the general user is not allowed to take (e.g., IT may be allowed to download files from unclassified site for troubleshooting). Block riskier Users\/Groups from performing actions allowed for the general user (e.g., interns may have a greater number of website categories isolated\/blocked). Exceptions take precedence over all policy classifications. Precedence for exceptions is set by their placement in the User\/Group Exceptions table (exceptions at the top take precedence over those below). The available Exception types are listed below. Domain : Policy actions for specific domains. In addition to domains, this exception can also include URLs, paths, IP addresses, network ranges, and subnets. See ??? for details. File Download : Policy actions for all\/specific file type downloads. Document Isolation : Policy actions for all\/specific document types (both original and safePDF versions of each file). If desired, a file size exception for downloads is available. Since most malware files are smaller than average, using this setting allows you to create an exception for large files that are more likely to be legitimate. If Size is set to 0 MB, all documents (regardless of file size) are included in the exception. You can also configure whether content inspection is skipped. In addition, if your policy allows printing of safe documents, you can control if printing is blocked by default for specific sites\/users. File Upload : Policy actions for file uploads. Different rules can be applied to isolated and non-isolated sessions. In isolated sessions all file upload actions can be identified and the specified policy applied. In non-isolated sessions Menlo uses a heuristic approach to attempt to identify the POSTs and PUTs as file uploads; if necessary, this can be fine-tuned for certain websites by inspecting\/blocking POSTs and PUTs over a certain size using an advanced option (a 0 in this field blocks all POSTs and PUTs to the given domains over the minimum size considered for inspection (5kb)). File Upload Exceptions For the best File Upload control, site access via isolation is recommended. In isolation, upload policy is enforced at the point a site generates a request for the user to select a file. This allows perfect identification of file upload events without the possibility of bypass. Uploads in non-isolated sessions are detected by inspecting the POST content or PUT network data submissions to identify files. Uploads following known patterns or containing enough data to indicate a file transfer will be identified in most cases. Some sites can break files into small chunks or encode the data in ways that cannot be identified on the network. Tuning of advanced parameters may be required to apply more restrictive upload controls. Where possible, identify the specific URL where an upload is processed by a web application and apply a block policy to that URL if there are issues blocking non-upload POSTs. Encrypted file uploads have additional optional settings: Allow with inspection runs an AV scan on the file, Skip inspection skips the AV scan on the file, and Do not prompt blocks the file upload (no password prompt is presented to decrypt the file). Archive : Download rules for all\/specific archives and compressed package types. Advanced settings to allow\/block sharing of the original download URL and skip content inspection are also available. If an archive is encrypted, you can choose to have a password prompt presented to the user or allow\/block the download automatically without the prompt. Threat : Policy actions for traffic with the specific threats or vulnerable services (e.g., sites using Wordpress). Category : Policy actions for traffic on sites matching the category(ies) identified in the rule. Content Inspection : Override the content inspection module's ability to inspect documents, files, or specific file hashes. You can create an exception for content inspection to enable ALL content inspection plugin types for uploads, downloads, or both; note that these exceptions will override the base policy for uploads vs. downloads. Prepend Isolation : Users\/Groups will exit prepend isolation if they navigate to the list of defined domains. For example, if accounts.google.com is listed, the browser will not be isolated when a user is logged into a google account and then goes to a google application (e.g., gmail or youtube). Dynamic Domain List : Pulls an external domain list from a remote server at a specified interval. The external domain list must be in plain text format with one domain per line. The URL must use HTTPS to ensure integrity of domain list downloads. Authenticated requests can be made using the https:\/\/username:password@example.com\/list.txt syntax. You can validate this using the Test Source URL field when creating the exception. The policy uses string matching to match group names against the SAML group names. Regex and wildcards are not supported, but spaces are supported. To view the SAML auth response, enable verbose debugging and view the request\/response in the browser using developer tools. See for details. MCAS Unsanctioned : Policy actions for unsanctioned cloud app domains that are pulled from the MCAS provider. These domains can then be used within the Exception policies. See for more information. Geo-Location : Use the host country to determine if traffic is allowed. Geolocation Exception Examples Example 1 : A Geo-location policy isolates\/blocks traffic from the US. The domain being accessed is hosted in China, but a resource on the domain is hosted in the US. The resource is not blocked. Example 2 : A Geo-location policy isolates\/blocks traffic from China or Russia. The domain being accessed ends with .ru , but it is hosted in the US. The domain is not blocked. Resource : This exception will allow administrators to apply allow\/block policy for resource requests (e.g., javascript, images, css, etc.). See for more information. If enabled for your tenant, an Advanced Setting is available to define one or more Policy Headers (X-Headers) to use in policy exception rules (source match) for the following exception types: Domain, File Download, File Upload, Document Isolation, Threat, Category, or Resource. This ensures that the policy will only apply to connections with the specific Policy Headers listed. Domain Exceptions The Domain exception will accept several input forms, described below. A list of comma separated values can be imported or entered in the Domains field. Domain Names : For example, google.com . These exceptions apply to the domain and subdomains like mail.google.com . Top Level Domains : For example, info or ru . These broad exceptions will match on any subdomain within the TLD. ru will match with www.news.ru . Note that when you enter a TLD the preceding \".\" is not entered. When creating a TLD exception, a warning briefly appears at the bottom of the window to warn you that the domain is not a \"standard\" (i.e., fully qualified) domain. This will match on any domain ending in the TLD (e.g., 'login.test' and 'some.other.test'). Destination IP Addresses : For example, 8.8.8.8 . IP address exceptions can be entered as individual addresses, ranges like 8.8.8.0-8.8.8.100 , or in CIDR subnet notation like 8.8.8.8\/24 . URL : For example, www.example.com\/news\/ . URL exceptions include the URL path in the policy match. The URL policy is performed as a \"begins with\" match, and it matches any URL under the configured path . The URL policy matches both http: and https: URLs. If you include the protocol when inputting a URL exception, the protocol is removed when saved. URL path policy applies to all browser requests for both isolated and non-isolated requests. Within isolated sessions, URL path policies also apply to HTML5 navigation. HTML5 navigation is a technique in modern browsers that uses javascript to change the address bar URL within a single page www application. Sites that use this technique include youtube.com and github.com . Since the navigation is generated in javascript and not as a network request, HTML5 navigation policy only applies to isolated sessions. We recommend that sites requiring full URL policy control are accessed via isolate policies rather than allow. Time-based Enforcement If enabled, the Time-based Enforcement section is provided for Domain and Category exception policies. This allows you to use time as a source match criteria for acceptable use policies (day of the week and\/or time of day). Select Enforce time-based match criteria to enable enforcement. Time of Day : This rule type enforces policy based on the time of day. By default the time zone uses the Menlo Cloud region time zone (local AWS data center), but you can choose from the global list of time zones. You can also add additional time slots as needed. If there is an outage in the region used to enforce policy, the policy in effect for the fallover region is applied (i.e., policy enforcement is applied based on where the processing occurs). Rule Validity Period : This rule type applies if the current time is between the start and end time entered. By default there is no expiration date, but you can choose an expiration date for the rule for time-scoped projects. Time-based policies do not currently support HTML5 navigation policies (javascript-based URL patch changes within some sites). Isolation Bypass This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success or email support@menlosecurity.com . This feature can be used to allow all users to temporarily bypass isolation policies for the following exception types: Domains (Note that a domain with a path is unsupported (e.g., cnn.com\/travel) Categories Threat Types Geo-Location The isolation bypass only works on the top isolated frame, so if there is a bypass exception for foo.com and it is framed by bar.com , the bypass banner for foo.com will not appear. Global Policy (Threats and Category Rules) The next level of policy enforcement following SSL Decryption Exemptions and User\/Group Exceptions is managed via the Threats and Categories panes. Use these panes to configure the desired policy action for each threat and category type. See for more information about each action type. To change all threats\/categories there is a “select-all” option. This allows the same action to be set on all values selected. Specific information about Threats and Categories isolation is provided below. Threats and Vulnerable Services Web domain fraud is a growing risk for business, employees, and their customers. Having an advanced domain infringement detection strategy is critical. Menlo Security analyzes traffic as it is retrieved to determine whether it matches an exception domain rule or a major URL category. But it also determines whether the traffic looks like a threat. Threat analysis can be controlled by the rules editor in the Threats pane. All currently available Threat types are described here: . Additional information about the more common threat types is provided below: Uncategorized Sites These sites are typically small regional sites that have not been seen on the internet before (e.g., a high-school sports team site). It may not be desirable to block this type of site entirely (i.e., set the action to Block ), but an administrator may not want to allow this type of site with no protection. By setting the rule to Isolate or Isolate Read-Only , the site can be viewed safely with no harmful effects from a potentially risky site. Parked Domains It is recommended that the policy for the Parked Domains threat type should match the policy used for Malware threats. However, these policies can be changed independently of each other if required. Vulnerable Services Vulnerable Services are threats from the services used by websites which are un-patched or otherwise known to be easily compromised by hackers. Menlo Security examines such services on a website when a user visits it and can isolate the session to keep the user’s browser clean and unexposed to any threats which may exist. This can happen not just for new or unknown sites, but also for common sites which match a specific category. By default, the action setting for Vulnerable Services applies to all services. To customize the policy for different vulnerable services, unselect Use the same action for all vulnerable services , and add rules for each service below. Categories Most websites are associated with one or more URL categories depending on the content of the website (examples of categories include Financial Services , Shopping , News and Media , etc.). Category rules can be used in the Isolation Core to control how websites are handled based on their category association. The Categories pane configures policy rules for which actions are taken for website in specific categories. For websites associated with multiple categories, the strictest policy is applied. Thus, if one of the associated categories is set to Block and another is set to Isolate , the website will be Blocked . Block and Isolate + Read-Only information provided to users can be customized to provide additional information and potentially assist with training users on handling phishing or suspicious websites. Menlo Security provides a large number of and therefore can enforce a policy for most sites. However, for sites that may not be associated with existing categories (such as a small local website or a new website), threat rules or exceptions are used to configure actions. All currently available Category types and examples of each type are described here: . Global Policy (Documents, Archives, and Files) The Documents\/Archives , File Uploads and File Downloads panes are used to configure the desired policy action for all transfers of documents, archives\/compressed packages, and files in and out of the Isolation Core. See for more information about each action type. Specific information about Documents, Archives, and Files isolation is provided below. Default Rules in the New Admin Portal In the legacy Admin Portal, the following settings could be configured for individual file\/document types: Original Download Safe Download (of Isolated Documents) Share Original URL Skip content inspection (AV) After reviewing the most commonly applied policies, we have simplified these settings which are now configured for all file\/document types in the Default Rule . Customers still have the ability to manage options on a per-file type basis via a Policy Exception . You can apply these settings to individual file and document types using the following exceptions: File Download (Skip inspection for isolated and non-isolated sites) Doc Isolation (Safe Download of Isolated Documents, Block download of original document, Sharing and Printing, Encrypted Document, Skip content inspection) File Upload (Encrypted Files - isolated and non-isolated) Archive Isolation (Sharing, Encrypted Archive, Skip content inspection) Documents and Archives\/Compressed Packages Isolation Documents and archives can be altered to inject malware or otherwise harm end-user systems. These alterations are often written to exploit end-user software vulnerabilities which are difficult to patch and maintain. Unsuspecting users who open documents found on websites (legitimate or not) or in web searches can have their systems compromised. In many cases users don't even need to download the documents locally; they simply need to print and\/or view the documents. In these cases, Menlo Security can retrieve the document, open it in the Isolation Core, strip it of active content, and present a clean HTML5 view of the document to the end user. Please see Applying Security Awareness to the Cyber Kill Chain for more information about malware injection and Menlo Security Solution Briefs for our briefs on how we handle these threats. Supported Documents Supported document types are being added on an on-going basis. Please see for details. Currently supported document file types can be seen by selecting the tooltip next to All Document Types . Note that Some of these document formats (such as csv) can be viewed directly within the isolated browsing session. The document policy defined for these types will only apply if the file is being downloaded rather than viewed inline within the isolated browser itself. Document mapping is done using the file extension if the content inspection engine cannot identify the document (see ??? for information about setting up Content Inspection in the Isolation Core). If functions or fonts from documents are not displayed correctly in the isolated browser, please download and use the original file or contact Menlo Security support for assistance. Document Isolation Rules The Document Isolation rules configure policy for loading documents in the Document Viewer and all document downloads. Use the Default Rule to configure policy for all document types, and Document-specific Rules if additional customization is required. Default Rule The Default Rule customizes the default action for supported documents. Allow actions will not convert the document to HTML\/HTML5 while Isolate actions do convert all supported documents to HTML\/HTML5. If the action is set to Isolate , additional configuration options are available by selecting Document Isolation Options . The configurations include: Original Download of Isolated Documents : The action for the original document download can be set to either Block or Allow. Safe Download of Isolated Documents : The action for safe document downloads (clean PDF) can be set to Block , Allow , or Automatic (document behaves how it should natively). Other features that may be enabled for the tenant include: Allow sharing of original download URL Hide the document print action . This can hide the Document Viewer print button so the isolated document cannot be printed. Open document viewer in a modal dialog . Open a modal dialog window to view the isolated document. Create document exceptions to have the print button policy set by specific site\/user and group. Select Encrypted Document Options to control the action taken for encrypted documents. Different policies can be set for password-protected document types. Password Prompt : Prompt for password to decrypt documents to examine them before download. Skip Inspection : Skip inspection of encrypted documents of this type. Do Not Prompt : Do not prompt for password of encrypted documents of this type. Document-specific Rules If needed, rules can be created for specific document types. The same Allow\/Isolate\/Block actions are available as in the Default Rule. Add one or more document types to the Selected Docs table to configure a specific rule and select the policy action for the selected document type(s). Archives and Compressed Packages This section defines the behavior for downloads of compressed files and archives. If needed, rules can be created for specific archive types. Isolation of archives and compressed files will trigger inspection of the contents. If \"Block download if virus detected\" is selected, users are only allowed to download the original file if contents are deemed safe. In addition, policy can be customized for certain password-protected archives by selecting Archive Isolation Options . The configurations include: Block download of original archive Allow sharing of original download URL Modal dialog for isolated archives : Open a modal dialog window to view isolated archive contents. Apply policy to files in archives : Policy will be applied to sub files contained within the archive. You are now able to view the archive contents and then click a sub file to download (if the file scan is clean). If the sub file is encrypted, a password prompt is presented so you can decrypt the file for scanning when your policy is set to \"Continue\". You can also configure the timeout for archive inspection and nested archive depth (if your archive contains sub files that are also archives). Select Encrypted Archive Options to set the action for supported password-protected archives ( Password Prompt , Skip Inspection , or Do Not Prompt ). If different actions are need for specific archive types, select Add Rule and create Type-specific rules as required. File Downloads Files are divided into several classifications: Scripts and Excecutables, Calendar, and Multimedia. A full list of Supported File types is provided in . Supported file types are being added on an on-going basis. File Downloads cannot be converted into HTML\/HTML5 and presented in a Document Viewer like document downloads. Therefore, there is no Isolate action for file downloads. File are transferred to Menlo Security, checked for malicious content, and then transferred to the end user. If enabled, an Anti-Virus scan is performed before the file is checked against the rules defined by the administrator in the rules editor. If file downloads are set to Allow and Anti-Virus checks are Off , Menlo Security transfers the file directly to the end user from the origin server without examining the file. The following policy rules are available for file downloads: Use the Action menus to select the desired policy for each file type. If you wish to have different policy enforcement for file downloads from an Isolated Site versus a Non-Isolated Site , enable Treat file downloads from isolated sites differently from the non-isolated sites . Note that if all websites are isolated this is not necessary, as Menlo Security is aware of all file transfers that take place inside the disposable virtual container used for the isolated session. Select Add Custom Extension \/ MIME Type to enter a user-defined file type extension. The Custom File Type feature must be enabled for each tenant. Please contact Menlo Security Customer Success for more information. All other download types are controlled by the action set in the Other Files & Documents field. This rule applies policy to all downloads that are not covered by the other rules. File Uploads The File Uploads pane can be used to define rules for all file uploads. Note that different actions can be set for Isolated Sites and Non-Isolated Sites . Since there is no way to isolate file uploads, the only actions allowed are Block or Allow . The Default Rule will cover all file types. Web Policy Settings The Policy Settings pane provides policy rules for enforcement of non-isolated resources and mobile policy. Non-Isolated Resources This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success or email support@menlosecurity.com . In an isolation policy, page requests and resource requests have different policy options. Page Requests are top-level page loads. Usually the URL in the browser address bar represents a page load. The page request URL is highlighted below. Within some pages, there are also iframes , which the browser treats like a page load. These are often embedded elements, like advertisements or videos, where content from a different service is embedded into a page. Resource Requests are all the component parts that make up a web page, such as images, css files, and javascript. When a page is loaded with an Allow policy (non-isolated load of the website) these resources are downloaded to the client browser to build the page. In the following figure, an image resource is highlighted. Policy options differ when dealing with page requests and resource requests. When a page request is loaded, an isolation session can be initiated. Page requests have all policy options available (allow, block, isolate). When a resource request like an image is loaded, that individual component of the page cannot be isolated, so they have only Allow\/Block policy options. Your existing policy for Categories, Threats, and Exceptions is also applied to resource requests. Block and Allow policies are directly applied to resources, since those actions match the available actions for resource requests. However, since the Isolate action does not apply to resources, we must map Isolate policies to either Block or Allow actions. The default policy mappings are listed below. Default Policy Mappings The default mappings described below address the most common use cases in strict resource isolation policies. These can be modified to provide a more permissive or restrictive resource policy. For example, a strict “Isolate All” policy map could map all Isolate actions to Block so that resources that cannot be isolated are blocked. Please contact Menlo Security Customer Success to modify policy mappings. Threat Policies Threat isolation provides a safe way to access sites of questionable trustworthiness. Because of the suspicious nature of these sites, the default mapping for threats is: Isolate -> Block Category Policies Categories typically govern acceptable use policies, rather than security threats. Here, resources loaded from categories are not associated with security risks and have the following default mapping: Isolate –> Allow Domain Exceptions Similar to category policies, an Isolate policy for a domain exception permits access to that domain, therefore the default mapping is: Isolate –> Allow Known Limitations Vulnerable Service policies do not apply to resource requests. Resource policies are applied on the HTTP request headers. Vulnerable Service headers are not known until the server response is seen, so these cannot be enforced on resource requests. Only ‘All User’ policies apply to resource requests. Resource requests do not always include authentication cookies needed for association with a specific user. Because of this, user and group policies are not applied to resource requests and all resource exceptions are scoped to All Users. Mobile Policy The Mobile Policy Settings section provides policy rules for extending the policy rules to browsing on mobile devices. See for details about managing mobile policy. Content Inspection Use the Content Inspection pane to configure policies for handling virus and malware analysis for uploaded and downloaded documents, archives or files. The Isolation Core is can use several plugins to check for virus infections and malicious activity: By checking a “hash signature” of the file against a range of antivirus engines’ known malicious file hashes (See ???) By scanning the file contents locally for viruses (if enabled) (See ???) By sandboxing the upload\/download to look for malicious activity in a remote sandbox (if enabled) (See ???) By sending the file, document, or an archive of files to WildFire for analysis (See ???) By sending the file, document, or an archive of files to a REST API through the Menlo File REST API (See ???) Each of these plugins can be enabled or disabled. The checks apply for uploads and downloads from isolated sites and additionally for requests identified as uploads and downloads on non-isolated sites when the Isolation Core is configured in “proxy mode”. Some plugins may need to be enabled for your tenant by Menlo Security. Please Contact Menlo Security Customer Success for more information. File Hash Check When the File Hash Check is enabled, a hash of any document or file being downloaded is sent to 50+ scanning engines. If any of the engines analyzing the file hash returns an “Infected” status, Menlo Security sends an alert for the transfer. There are independent settings for documents and files which control if the infected transfer policy is Block or Continue Inspection . Although it would be rare to allow download of an infected document\/file, this option does exist to allow a scenario where a potentially infected file is transferred so that it can be further analyzed or cleansed. In some cases, the document or file may not be recognized in the virus scan and returns \"Unknown\". The action when a document or file is not recognized in a scan can be set to Continue Inspection or Block . The rules on an Unknown File or Unknown Document response for documents and files can be set independently, but in most cases the same action is used. For example, an administrator can select a more secure policy ( Block ) for files and can select a more accessible policy ( Continue Inspection ) for documents. In the case of Continue Inspection, if a further content inspection plugin is enabled (such as the full file scan), then the file will have to pass through these subsequent plugin(s) before the file transfer is allowed. If an Unknown File or Unknown Document is Blocked by the hash check, the rest of the content inspection plugins are only run if the action is a download. The block is immediately recorded, and the remaining plugins are used only for logging and forensic archiving purposes. If the file hash check service is not available or cannot be contacted, the policy can be set to Continue Inspection or Block the file\/document transfer. Full File Scan The multi-engine hash check is capable of reporting only on known good and known bad files. Many files will not have been identified previously as good or bad by the multi-engine hash check service. As a result, in order to identify virus infections, malware and malicious activity it is necessary to perform a full file scan on the file being transferred through the Isolation Core. The file scan process is embedded within a disposable virtual container inside the Isolation Core, and the results obtained without needing to access a remote service. As with the multi-engine hash-check, an administrator can specify what should happen in the event of a failure to scan the file ( Block or Continue Inspection with further analysis). The embedded full file scan applies to both files and documents. This file scan can be applied to downloads and\/or uploads. Use the Types of transfers to send controls to enable content inspection for the desired transfer type(s). File Sandbox If this licensed feature is enabled, all infected files blocked by the AV engine and any other files deemed necessary by the local AV engine are sent to the remote sandbox environment (rare cases where it is not possible to identify a file as being either malicious or clean by both the multi-engine hash check and the full file scan). Files scanned by the sandbox are not retained in the sandbox after the scan is complete. The sandboxing happens in a remote cloud Virtual Machine which opens the file and analyses its activity over a short period of time. If it detects any potentially malicious activity taking place (such as attempts to change the Windows Registry settings) then the file will be blocked. Otherwise, the file will be marked as \"Clean\" and the results cached (30 days) for future downloads. The sandboxing can take up to 15 minutes and handles files up to 10 MB in size. You can specify what should happen if the sandboxing exceeds 15 minutes or fails in some other way ( Block or Continue Inspection with further analysis). In addition, you can control whether the sandbox should apply to file downloads and\/or file uploads. The sandbox currently handles files up to 10Mb in size. Finally, you can decide whether or not the detailed sandbox reports include screenshots of the detonated files. If Capture screenshots from documents is selected, the reports will take screenshots from document files; it is possible that sensitive information in the documents will be captured if this setting is enabled. Refer to for details on enabling this feature. WildFire Analysis Files can be submitted to the WildFire API for analysis. Either a single file or an archive of up to 100 files can be analyzed by the WildFire API. Enable this feature using the WildFire Analysis slider. Note that there is a maximum file size limit that is set by the API itself (currently 10 MB). After the configuration is saved, the analysis is active. It may take anywhere from 20 seconds to 10 minutes between the file request and receipt of the file by the user, depending on whether the API performs a static or full dynamic analysis. All file types that match those configured in the Web Policy are sent to WildFire for analysis. If a file (or archive) is found to be clean, the file(s) are made available for download if permitted by the policy. A report is generated immediately with information about the analysis performed, and an administrator can retrieve this report later using the file hash. Refer to for details on enabling this feature. Menlo File REST API Files can be submitted to an external REST API for analysis by a custom file analysis engine that complies with the Menlo File REST API. To enable this licensed feature, contact Menlo Security Customer Success. Once the feature is enabled for use, select the Menlo File REST API slider to activate the feature. Existing or custom file analysis engines can be configured with the Isolation Core file processing to control access to downloads and uploads. You must configure your REST API to be compliant with the specification. After the configuration is saved and your API endpoint is running, the following is sent to the API: file hashes, file metadata, and file content matching this rule. The API can respond with a decision to Block or Continue Inspection as determined by your custom configuration. The API can also respond with a report URL and additional information which is recorded in the file download log. Refer to and contact Menlo Security Customer Success . for more information about this feature. Bandwidth Limits The Bandwidth Limits feature provides the ability to create video resolution and bandwidth rules for users or groups. Please contact Menlo Security Customer Success for more information about enabling this feature. The Default Rule will apply to all users\/groups. User-specific Rules are used to customize the bandwidth quota and video settings for one or more users. Bandwidth Quota This section defines the daily bandwidth quota per user and actions when the quota is approached and\/or exceeded. To enable the feature, set the Daily Bandwidth Quota Activate button to On and enter the desired quota in MB. Daily bandwidth limits are measured every 60 seconds. Thus, it is possible for a user to exceed their bandwidth limits for up to 60 seconds. The rule action (warning banner) triggers after the next measurement. The Action on Approaching Quota range can be set to any value between 50%-90% of the Daily Bandwidth Quota. When this lower limit is reached, the Action defined below is performed: Allow : Allow action. Warn : Log action and send a warning to the user that they are approaching the daily quota. The Action on Exceeded Quota simply sets the action if the quota is exceeded. The following actions are available: Allow : Allow action. Warn : Log action and send a warning to the user that they are approaching the daily quota. Block : The action is logged and the user is prevented from using more bandwidth. Video Settings This section configures the video resolution for streaming sites. To minimize bandwidth usage, administrators can set different resolution for Active vs. Background tabs. The Active Tab will be the tab that the user is currently interacting with (i.e., the \"top\" tab). The Background Tab(s) are other tabs that are open, but are not currently visible to the user. Menlo Security is able to guarantee the Active\/Background tab video resolution on YouTube using predefined limits, so these settings are configured separately from other streaming services. To enable the limits, click on the slider next to these fields under Youtube Resolution Limit , and use the pull-down menus to select the desired value. For Other Streaming Services , press the slider next to each field and enter a desired resolution in MB\/s. Examples of other streaming services include Vimeo and Dailymotion. Web Applications The Applications app located under Web Policy provides policy controls for web applications like Chrome and Internet Explorer. Use these screens to define unique corporate browser standards for supported browser versions and to set the action taken if a user opens an unsupported browser. Certified Browsers These fields define unique corporate browser standards for the major supported browsers. To enable management of any browser, set the toggle for the browser to \"on\". When enabled, you can type the minimum supported version number under Min Version and then select the desired action to take if an older version is used (use Application Rules policy defined under that screen or Block usage of that browser). Application Rules The Web Application Rules pane defines rules and precedence (the first rule has the highest priority) for both browser and non-browser web applications. Application rules can apply Allow\/Block actions only and logging of all events can be turned on\/off. To define an application-specific rule, add rules in the table below and re-order the list as needed for the desired rule precedence. Each rule has the following requirements: Rule Details and Action : Enter a name for the rule and the desired action (Allow\/Block). A toggle controls logging of each request; Menlo Security recommends logging of all requests for both Allow and Block situations. Source : Application source (Any, IP\/IP range, User Agent, or Browser) Destination : Application destination (Any, Domain\/IP, URL, Category, Threat, or Geo-location) Request Type : If the rule applies to all request types or just Downloads, Uploads, or Downloads and Uploads. An advanced setting is provided to enable policy based on HTTP method (POST\/PUT) and minimum file size for any policy that includes Upload requests. Entering a 0 in the minimum file size field means all POSTs and PUTs are blocked for the given domains over the minimum size considered for inspection (5 kb). File Types : Select the file, document, archive, or custom extensions\/MIME types for the rule. Reasons and Tags : If desired, enter a reason and\/or note and tag(s) to explain the purpose of the rule. Advanced Options If enabled for your tenant, an advanced option to define one or more Policy Headers (X-Headers) is provided for use in creating source match rules. If matched, the headers will skip SSL inspection. External Application Links The External Application Links pane provides controls for allowing webpages to open native applications like WebEx or Zoom from within an isolated session. When a link is enabled, the user can click on the link to launch the application through their web browser. Both anchor links (i.e., standard web page links) and javascript navigations (i.e., javascript opening an application) are supported. To add an external app to the list, select Add External App and enter the following details: Name : Unique name for the external app Link Prefix : App link prefix. Link prefixes must end in “:” or “:\/\/” to be valid. Description : Optional field to describe the external app mailto links are enabled for all tenants and is independent of the External Applications Links feature. Integrated Data Loss Prevention (DLP) Data Loss Prevention (also known as Data Leak Prevention) detects potential data breaches or data ex-filtration transmissions and prevents them by detecting and optionally blocking sensitive data passing through the Menlo Security platform. The Integrated DLP feature provides capabilities to capture and analyze potentially sensitive information in: File uploads User entered text into web pages When Integrated DLP is enabled, administrators can configure DLP Policy to control which types of information should be logged and optionally blocked as it passes through the Menlo Security Isolation Platform. Access to DLP is controlled as an RBAC privilege. If you enforce RBAC administrative controls, please ensure that you enable DLP access and DLP logs and dashboard areas for the chosen administrators. Otherwise, DLP will not be visible in the admin UI. DLP Policy DLP Policy consists of a set of active rules selected from a wide set of possible built-in matching expressions known as Dictionaries as well as a set of custom dictionaries created based on a specific string of text or a regular expression. Examples of built-in dictionaries include: Credit Card information Health Care information Financial Details Personal Addresses Region-specific dictionaries (e.g., UK Bank Account numbers, US Social Security Identifiers, etc.) To make it easier to manage the dictionaries, you can create groups of dictionaries and then add these to one or more rules. A DLP rule consists of one or more Dictionaries and\/or Dictionary Groups, along with criteria for when this rule applies such as on file upload or user input, or for certain users, sites, or categories. Each rule has a predefined trigger to reduce false positives. For example, the upload of a string containing a telephone number alongside a name may not trigger the \"Personally Identifiable Information\" rule, whereas the upload of 10 telephone numbers may. These triggers have been carefully designed to minimize false positives whilst still capturing both accidental and malicious upload of sensitive data. Creating a DLP Rule Example For example, to create a rule that will block files uploaded to dropbox.com for all users where the file contains Credit Card information: Open the DLP Rules pane ( DLP Policy -> DLP Rules ) and select Add Rule . Select the Template Category for the rule (Country\/Region and DLP policy type. For the Details section, enter a Name and select the desired Action ( Skip Inspection , Log or Block ). You can also customize the block page notification if the rule is triggered in the User Notification box. In Dictionaries and Templates , select Add Dictionaries and select the checkbox next to all applicable dictionaries that will be used by the rule. Under Content Types , use the toggles to enable User Input Inspection or File Upload Inspection if desired. For file uploads you can configure a Maximum File Size that will pass through DLP inspection. Use the Users\/Groups section to select the users\/groups affected by the rule. Protocol and Section Type sets which protocols (HTTP\/HTTPS) and sessions (isolated\/non-isolated\/all) are affected by the rule. Optionally, you can then add domains or page category types for the rule. You can also select a previously defined auditor profile if you wish to send any files for DLP analysis. Click Save to save the new rule. DLP Auditors There is an option to have an email alert sent whenever a DLP policy rule is hit (whether it is to log the event or block the action). The person(s) who will receive the alert are attached to the specific rule under the policy Action . To use this option, first configure the DLP Auditor profile in the DLP Auditor Configuration pane ( DLP Policy -> DLP Auditors ). Select Add Profile to create a profile that contains the following details: Auditor Name : Name for the auditor profile group Description : User-defined description for the auditor profile group Email Addresses : Email addresses for each member of the auditor profile group Send File : Use this toggle to attach the file\/text that triggered the DLP rule to the email File Format : Select the file format to use for file\/text attachments (original file\/text, zip of the original file\/text, or encyrpted zip of the original file\/text) File Size Limit : Select the maximum file size for any email attachments If Menlo Email Isolation is enabled, the email attachment sent as part of the DLP Audit alert may be isolated or blocked (depending on the Email Isolation rules). To prevent unwanted isolation\/block of these emails, be sure to create a rule to allow attachments from the following address: noreply@menlosecurity.com . In on-premise environments, the SMTP server used to send email alerts must be configured in the Central Manager Management templates or on the isolation appliance under Notifications . See . DLP on Non-Isolated Sites Sites in Allow mode (not isolated) can also be analyzed for Data Loss Prevention at the network level using the specified DLP Policy rules. However, there are some limitations to analysis at the network level compared to DLP analysis on isolated sites: The User ID is not always known due to cross domain cookie handling. This means that user and group specific rules cannot be applied. The Web and DLP logs will show \"Unknown\" for the user. The isolation platform is unable to prompt for passwords to decrypt files on non-isolated sites. Because the MSIP does not have complete control over the webpages on the \"allowed\" sites, it cannot prompt for a password to decrypt encrypted files being uploaded. These files will not be inspected for DLP. The isolation platform cannot serve block pages on Allowed sites unless the request was for a site navigation. Similarly, if the DLP violation occurred as a result of an XHR POST rather than a site navigation, it will be received as a response to the XHR POST and will not necessarily be rendered to the user. The behavior of the site is specific to the way the website has been programmed to respond to a 403 response to the XHR POST and cannot be determined by Menlo Security. POST\/PUT requests below 1Kb are treated as dynamic site interaction, rather than user submissions, and are not content inspected. POST\/PUT requests below 5Kb are not inspected as a file upload. In addition to executing DLP analysis on Allowed sites, logs will be generated for file uploads and POST traffic to provide additional visibility to file uploads and POSTs on non-isolated sites. Custom DLP Dictionaries For advanced cases where the built-in Dictionaries do not cover the type of data that needs to be captured, it is possible to create Custom Dictionaries by specifying a search string or regular expression and a trigger level. For example, this functionality can be used to identify company-specific strings that are not included within the default built-in Dictionaries. To create a Custom Dictionary, Open the DLP Dictionaries pane ( DLP Policy -> Dictionaries ), and Click the Add Custom Dictionary button. Add the Dictionary Details for the Custom Dictionary: Name : Custom Dictionary name Description : Description for the Custom Dictionary Category : Dictionary Category type (e.g., Document Classification, Personally Identifiable Information, Other, etc.) Country\/Region : Dictionary Country or Region (e.g., Global, UK, Other, etc.) Add the Criteria required for a match that will trigger a rule using the Custom Dictionary. All of the criteria in this tab must be matched for the dictionary to cause a rule to trigger. The following example is for a Custom Dictionary that triggers if the text being uploaded matches both: String : mycompany.com Expression : The words secret or confidential The DLP engine evaluates expressions using Perl Regular Expression syntax. See Perlre Documentation for details. Once a Custom Dictionary has been added, it will be shown in the list of Dictionaries and is available to be added to any DLP Rule. DLP Templates You can also create DLP templates that include your desired set of dictionaries (e.g., a combination of financial and personally identifiable information dictionaries) on the DLP Templates pane. After the template is saved, you can add it to any DLP rule (listed under the \"Group\" type in the Dictionaries and Templates section). DLP Custom Thresholds If enabled for your tenant, administrators can also define custom thresholds to trigger the dictionary using either File Upload or User Input counts. DLP Logging A log viewer showing all DLP Log and Block events is now available in the Logs tab ( Logs -> DLP Logs ). A corresponding entry for the file upload or user input event will also be present in the Web Logs. If multiple DLP rules have been hit there will be several entries in the DLP Log for a single file upload or user input event. The Log Export API has also been enhanced to provide the ability to export DLP Logs in addition to the Web Logs. See for details. " }, 
{ "title" : "Inline Cloud Application Security Broker (CASB) ", 
"url" : "41864-web-policy--new-admin-portal-/41906-inline-cloud-application-security-broker--casb-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ Inline Cloud Application Security Broker (CASB) ", 
"snippet" : "Introduction Inline CASB provides visibility into the cloud applications your users are accessing through the Menlo Cloud Proxy and helps prevent accidental, or intentional, data exposure. Inline CASB addresses these major areas of concern around cloud app usage: Cloud App Visibility & Discovery Vis...", 
"body" : "Introduction Inline CASB provides visibility into the cloud applications your users are accessing through the Menlo Cloud Proxy and helps prevent accidental, or intentional, data exposure. Inline CASB addresses these major areas of concern around cloud app usage: Cloud App Visibility & Discovery Visualize cloud app usage and associated risk across your organization Easy-to-navigate SaaS usage dashboards and detailed reporting Support for over 200 cloud apps and services Control Sanctioned and Unsanctioned Cloud Apps Monitor and control user sessions in real-time Block or limit specific functions within a cloud application — such as “login”, “share”, “search”, “upload”, “download”, “create” Enforce access to cloud apps through isolation Threat Protection Identify and block malware within SaaS applications Isolate document downloads from cloud apps Application Categories Cloud application categories include: Cloud File Sharing E-commerce and Accounting Human Capital Management Identity and Access Management Instant Messaging IT Services and Hosting Office Document and Productivity Payment Sales and CRM Social Networking Streaming Media Web Meetings Webmail How the CASB module works Inline CASB inspects traffic inline and acts as an intermediary between users and cloud applications. It consolidates security policy enforcement, enabling you to apply them to everything your business utilizes in the cloud. Granular controls over user interaction and file sharing gives you the ability to monitor and govern data protection with precision, giving you the flexibility to enable your users to safely use the cloud applications they depend on (we support over 200 of them). Enabling Inline CASB for your account Inline CASB is only available for Web isolation customers initially as an early access preview. Contact earlyaccessprogram@menlosecurity.com to enable access to the CASB module for a time limited trial. Inline CASB policy enforcement Inline CASB enforces policies that, if conflicting, have priority over previously configured rules. Enabling Inline CASB could allow (or block) access to apps previously controlled by categories, exceptions, threats, or policies. Be sure to review and document all your critical enforcement policies before setting up the module, and follow best practices for testing your changes in a staging environment before rolling out for production use. Please note that any selected apps must be already set to \"CASB Enforced\" before any user exceptions for the apps can take effect. Known Issues and Limitations Currently CASB does not support different policy actions between apps from the same provider CASB cannot provide different policy for apps from the same provider like O365. For example, if you want to block Excel edit functions, Word edit functions will also be blocked. As noted in the policy enforcement diagram above, Inline CASB is evaluated before policy exceptions. However, if you have a category exception to block all categories but allow Dropbox, login to Dropbox will fail since Dropbox makes a request to the following domain for login: http:\/\/arkoselabs.com If you require the policy above, a workaround is to create a domain exception for arkoselabs.com; you can then successfully log in to Dropbox and then CASB policy evaluation is performed for any actions taken in Dropbox. The Login function for some applications is controlled by a separate CASB app: for example, Microsoft Office 365 - Login controls the login for Microsoft OneNote (and other Office 365 applications). The browser access settings for both login and the main application must be compatible -- that is, you cannot set the login app to use non-isolated browsing and then open your application in isolated mode (the main application will not be able to access the login cookie). Users are identified with a cookie at the proxy using first party bounce tracking. For top level page requests Menlo sets a domain cookie on the destination domain and the user identity for almost all requests sent to the standard domain are known. If an application uses non-standard domains for background requests for resources and X-Headers, the action may be logged with an \"Unknown\" user ID, and the CASB user\/group exception rule will not be enforced. Get started with Inline CASB Initial setup and configuration of Inline CASB is a three-step process: Discover which applications are being used. Review the default profiles and rules. Classify applications based on your requirements. Discover which applications are being used The Application Discovery page contains details about all discovered applications, like application name, category, access count, associated CASB profile, and risk score. When you first use Inline CASB, there might not be much activity on this page, and all the apps listed will be unclassified. But it’s important to familiarize yourself with the contents here so you know when your user traffic navigates to new apps or the risk score for any app changes. App Insights All cloud apps in the Cloud Application Discovery pane are given a Risk score number between 1 and 10, with 10 being the most risky. Cloud app risk scores provide administrators with an understanding of the risk Shadow IT poses to their organization. These risk scores are calculated based on risk factors across several categories, including compliance, certifications, security, CVEs and web analysis. Roll over an app row entry and select the More Details (note) icon to view details about the individual risk score factors. Click icon to open Details pane Example App Details Pane The App Details pane provides the following information for the selected app: General : General app hosting company information including category, headquarters location, founding date (year), and the associated domains. Security : If an app supports certain security controls (e.g., use of trusted certificates or multi-factor authentication), a green check mark is displayed next to that control. A dash indicates the standard is not currently supported by the app. Compliance : If an app is compliant with various federal and international standards (e.g., ISO 9001, GDPR, etc.), a green check mark is displayed next to that standard. A dash indicates the standard is not applicable to the app. Reputation : Provides details about how the following are calculated for the app: Reputation Index : Risk breakdown as a percentage of URLs associated with the app as high\/suspicious\/moderate\/low\/trustworthy Domain Safety Score : Risk breakdown as a percentage of domains associated with the domain as high\/suspicious\/moderate\/low\/trustworthy Additional information about some items can be viewed by clicking on the blue Domains or Details link next to that entry. A pop-up window opens to display this content. Details for common vulnerabilities contain a link to the CVE details database. Click the Close button or click outside the pop-up window to close it. Example Details link pop-up window Close the App Details pane and return to the previous screen by clicking the back arrow. Review the default profiles and rules CASB Profiles allow you to apply Login, Upload rules and Download rules globally across multiple applications. These actions will not be available for every application that is assigned to the profile. Predefined Cloud Application Profiles Built-in policy profiles for sanctioned and unsanctioned cloud applications can be applied to individual applications or groups of applications, including by category. You cannot delete these profiles, however you are able to edit them to suit your needs. The global “Login” action is not yet available for MS applications since login for these apps is controlled by the O365 login. Ensure you have assigned the corresponding CASB profile to the login application (e.g., O365) as well as to individual apps (e.g., Teams, OneDrive, etc.). Custom Cloud Application Profiles Custom profiles can be created if you require a customized set of actions\/controls for application rules or user\/group exceptions. Cloud Application Rules Cloud Application Rules allow precise control over what specific actions a user can perform within the application. What actions can be controlled depends on the type of application. Cloud application categories include things like Cloud File Sharing (Box.com, Dropbox.com, G-Drive, OneDrive), Social Networking (Facebook, LinkedIn, Twitter, Snapchat), Office Document and Productivity (Google Docs, Office 365, iCloud), Webmail (Google Mail, Yahoo Mail, Outlook Web Mail), and others. Controlling login access Apps that use a single sign-on solution have a separate application to control login access for all the applications associated with it. For example, there are many Microsoft cloud applications managed by CASB, but the controls for logging in to Microsoft Office 365 are in an application called Microsoft Office 365 - Login . Enter “login” in the search bar to find all login applications. Custom controls You can restrict, or allow, some actions that users can perform within an application using custom controls. Which actions can be controlled depends on the category of the application. To use custom controls: Find the cloud application in the Cloud Application Rules page. Hover your cursor over the area to the right of the Custom Controls column, and click the pencil icon when it appears. Select Custom Controls. Change the controls listed to your needs. Select Save. Select Publish when you’re ready to make your changes available. Classify the important applications based on your requirements Once you understand the implications of profiles and rules, you can go back to the Application Discovery screen and start designating the applications most important to your organization. You can filter by category, or enter a term in the search bar to filter by to find applications from a specific vendor. Use the Apply Profile to Selected Items on the filter toolbar to apply the changes to many applications at once. (Optional) Create usage exceptions You can also create exceptions for specific users or groups that can bypass policy enforcement. To add a user or group exception: Go to the User\/Group Exceptions page, and click Add Exception . Give the exception rule a name and click Next . If the CASB rule should be applied to specific users\/groups, enable the CASB Enforced setting. This allows you to disable CASB for specific users or x-headers. Select the Applications (or Categories ) this exception applies to, and click Next . Make changes to the Profile\/General Security Policies as needed then click Next . Make changes to Specific Controls as needed then click Next . In the Users\/Groups section, specify the users or groups (including SAML Groups) that this exception applies to, then click Add for each user or group. Click Next . Click Save on the User\/Group Exceptions page. Click Publish . Inline CASB Logging Web Logs Events relating to Inline CASB actions performed by users are logged in the Web Logs pane. Audit Logs Changes to Inline CASB configuration are logged in the Audit Logs pane. CASB Dashboard CASB widgets with app category, upload, and profile information is now available from the Dashboard. CASB Reporting CASB-specific reports and queries are also now provided in Menlo Insights. " }, 
{ "title" : "Web Isolation Administrator Settings (New Admin Portal) ", 
"url" : "41864-web-policy--new-admin-portal-/41907-web-isolation-administrator-settings--new-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ Web Isolation Administrator Settings (New Admin Portal) ", 
"snippet" : "Introduction Administrators can use the Settings panes to manage the following areas: Traffic : Customize the Proxy Auto Config (PAC) file that manages the browser’s policy for resources not requested through Menlo Security isolation and Corporate Gateway IPs for SAML authentication and non-browser ...", 
"body" : "Introduction Administrators can use the Settings panes to manage the following areas: Traffic : Customize the Proxy Auto Config (PAC) file that manages the browser’s policy for resources not requested through Menlo Security isolation and Corporate Gateway IPs for SAML authentication and non-browser connections. Authentication : Set up user and administrator authentication through single sign-on, two-factor authentication, Role Based Access Control and Admin access control to the admin portal, and create and manage API tokens for use with Menlo REST APIs. Integrations : Integrations of the Menlo Security isolation core with other providers, like Microsoft Cloud Application Security (MCAS). To view these panes select Settings from the App Switcher. Traffic Proxy Auto Config Use the Proxy Auto Config (PAC) pane to view the PAC file which should be used. It's also used to manage the browser's policy for resources that should not be requested via Menlo Security. Any domains or networks which are only available within the corporate network should be added here. The default PAC includes the corporate domain as an exception, as well as all private IP ranges (RFC 1918 10, 172, 192, etc.). In many cases, no additions are needed. The following is provided for each PAC: Default : A checkmark appears next to the default PAC to to use if you have multiple PAC files. Display Name : The display name (short, descriptive name) used for the PAC file. Proxy Mode : Proxy mode used for the PAC. This can be one of the following: SSL Inspection + Menlo Authentication SSL Inspection + Single Sign-On No SSL Inspection + Menlo Authentication No SSL Inspection + Single Sign-On Location : URL link to the PAC file which is used to steer browser traffic to Menlo Security. Copy the link in the Location field to your browsers (either directly or via AD GPO). See for more details on this process. You can perform any of the following actions by selecting the appropriate icon to the right of any saved PAC file. Note that many of these actions are advanced configurations and not required for most customers. See Proxy Access Control (PAC) Server Customization for details. Default : Set the PAC file as the default PAC. Copy Location : Copy the PAC file location to the clipboard. Preview : View the function that is being used for excepting traffic to the proxy. An example is provided below. Clone : Clone the PAC file. The PAC configuration wizard opens so you can customize the new file. Delete : Delete the PAC file. Edit : Use the PAC configuration wizard to customize the PAC server settings. Exceptions for domains or IP addresses added in the Proxy Auto Config pane differ in an important way from the exceptions added in the Web Policy -> Exceptions pane. End user systems can directly access the domains and IP addresses entered in the Proxy Auto Config pane, completely bypassing MSIP. In contrast, domains entered in the Web Policy -> Exceptions pane are first passed into the MSIP and then filtered, depending on the Allow , Isolate , or Block settings for those domains. Exceptions in the Proxy Auto Config pane prevent traffic from being processed by MSIP altogether; exceptions in the Web Policy -> Exceptions pane determine how to process traffic within the MSIP. Editing PAC Settings Creating a new PAC file or editing an existing (or cloned) file opens the Edit PAC Settings pane. The Details section is used to configure the name, description, and PAC filename. Note that if the standard proxy mode ports cannot be used on your tenant, you will need to define a different proxy port in the Proxy and Roaming Settings section below. Direct Connect (Bypass Office 365) This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com This feature is located in the optional Direct Connect section of a selected PAC file. If enabled for your tenant, the Bypass Office 365 feature allows administrators to add Office 365 tenant agnostic URLs to the selected PAC file (to reduce exposure to malicious content, no tenant-specific URLs are included by default). A separate toggle is provided if your tenant requires bypass of Office 365 on US Government endpoints. Once configured, the customer's own Sharepoint and any Sharepoint-based applications (Word, Excel, Powerpoint, etc.) are isolated. To bypass the applications, the customer Office 365 tenant name(s) must be provided (up to 32 names may be specified). The Office 365 specific tenant names can be found by logging into Office 365 and opening any Sharepoint app. The tenant name is displayed in the URL preceeding \"-my.sharepoint.com\". Proxy and Roaming Settings If enabled, administrators can allow access to HTTPS sites that are hosted on non-standard (non-443) ports. By default, proxies normally block access to HTTPS sites on non-443 ports to prevent tunneling of other protocols through the proxy by making a TCP socket to random ports. You can also optionally provide a hostname and expected IP address for a corporate intranet to route users who are outside the corporate network via direct connections or custom proxies. Exceptions The Default Exceptions section provides a list of frequently used and trusted domains that you may wish to exclude from isolation, like SAML identity service providers, Google, Microsoft Windows, and Dropbox. Use the toggle to make any exception active\/inactive for the PAC file. For custom Domain Exceptions and Subnet\/IP Exceptions , expand these sections and add or import a list of fully qualified domain names and\/or subnets or IP addresses. These are typically private (corporate) domains or private ranges that you wish to be excluded from the isolation. Corporate Gateway IPs Use this pane to define corporate IP addresses for SAML authentication and non-browser connections by saving individual IP addresses, a range of IP addresses, or an IP network with CIDR notation. You can also import a .csv or .txt list instead of entering addresses individually. The policy relies on the source IP to identify the tenant, because the browser does not send any cookies until SSL negotiations are complete. Be sure to define your corporate gateway IPs in this section to avoid issues. Egress Routing Egress Routing is a licensed feature. For information about enabling this feature, contact Menlo Security. The Egress Routing pane allows you to view and edit egress settings specific to the tenant. These are configured by Menlo Security in advance. Select a saved region to enable\/disable it. Egress settings can be enabled at any time, but they do not take effect until domains are configured for the tunnel. Transparent Proxy In addition to proxy-chaining or using the Proxy-Auto-Config browser setting, you can route HTTP\/HTTPS traffic to MSIP in the cloud using IPSec VPN. In this deployment method, Menlo Security cloud will terminate the IPSec VPN and construct a proxy request for MSIP to process via the proxy and policy. To use this option, contact Menlo Security for assistance in setting up the configuration. Authentication Single Sign-On Single-Sign-On functionality can come from integration with an existing Active Directory system (ADFS) or via a cloud-based solution, such as OneLogin, Okta, or Ping Identity. More information about configuration of these Single-Sign-On solutions is covered in the following specific guides as well as : Use the toggle to enable\/disable single sign-on for either users or administrators. User Configuration Admin Configuration The following fields are provided for both account types. Select the User or Admin button to configure your settings for the selected account type: Enable user authentication using SAML : Enables SAML authentication. The SSO fields below become editable when this is active. SAML Server Internet Accessible? : Set this to active if SAML server is internet accessible (external access will be allowed). Edit Message for Unavailable SAML : Press this button to customize the message displayed if the external SAML login fails (e.g., if the user is out of the office and must connect to their VPN to complete authorization). You can also add a link with more information to the message display. SAML Provider : Use the pull-down menu to select the appropriate SAML provider (ADFS, ADFS SSO, CA Single Sign-On, Azure Active Directory, Okta, Other). SAML 2.0 Endpoint : Enter the Identity provider URL in this field. Service Identifier (Issuer) : Enter the Identity provider Entity ID in this field. Require Authorization Attribute (Admin only): This optional configuration is used to differentiate admins from users where the same identity provider is configured for both the user and admin SAML login. Set to Group to to specify an authorized group membership or select Custom to enter an authorized name\/value SAML attribute pair for authentication. Attribute Name : Authorization attribute name (for Custom Attribute ) Attribute Value : Authorization attribute value (for Custom Attribute ) SAML Verbose Debugging : If you need verbose logging for assistance in troubleshooting, enable this field to turn on verbose logging for two hours. The debug logging is included in the authentication response. Certificates : Select Add Certificate to add X.509 Base64 encoded certificates (.pem file). Click Edit and paste the certificate content into the window that displays. When more than one certificate is provided, the SAML response is validated using both certificates, allowing for smooth rollover during certificate transition. If you have multiple certificates and wish to remove one, select the Remove button under the certificate to remove it. Manual SAML Configuration A manual SAML configuration is required to create the application on the SAML provider for both on-premise and cloud administrators. Use the following parameters to complete the SAML provider configuration to support both user and admin SAML authentication: Protocol : SAML 2.0 SAML Auth Mode : Service Provider Initiated Binding : HTTP POST NameID : User name, usually in email address format Entity\/Issuer Strings : MSIP Cloud SAML User Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml\/metadata MSIP Cloud SAML Admin Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml\/metadata MSIP Private Cloud (On-Prem) SAML User Authentication https:\/\/<your appliance name>\/safeview-auth-server\/saml\/metadata MSIP Private Cloud (On-Prem) SAML Admin Authentication https:\/\/<your appliance name>:8443\/api\/v1\/saml\/metadata Assertion Consumer\/Authentication URLs (where they POST the SAML assertion): MSIP Cloud SAML User Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml MSIP Cloud SAML Admin Authentication https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml MSIP Private Cloud (On-Prem) SAML User Authentication https:\/\/<your appliance name>\/safeview-auth-server\/saml MSIP Private Cloud (On-Prem) SAML Admin Authentication https:\/\/<your appliance name>:8443\/api\/v1\/saml Two-Factor Authentication Use the Two-Factor Authentication pane to configure or reset two-factor authentication for administrator access to the Menlo Security isolation platform. Note that this pane provides a list of all tenant administrators if you need to audit who has admin rights on your tenant. Set Up Two-Factor Authentication To set up two-factor authentication: Select the Enable button for the Admin ID entry. A redirect window appears that asks you to log in again into the selected admin account. A Quick Response (QR) code is generated. The user should use this code with their authenticator app to generate a 6-digit code to use for authentication. Either the QR code or the manual code beneath the QR can be used. If needed, click Get a new code to refresh the QR code and manual code. Enter the 6-digit code from your authenticator app. After the code is submitted, you will get a success message. The next time the user logs in, they are prompted for a verification code in addition to their password. Reset Two-Factor Authentication Code If a two-factor authentication user needs to change their two-factor code (after it has been set), perform the following steps to reset the code. The user must still have access to their current code and can log into the dashboard to perform this procedure. If the user cannot log in (e.g., their two-factor code is lost), they can perform a hard reset. Refer to . Open the Admin Access Control pane ( Settings -> Admin Access Control ) and select the Reset button for the Admin ID entry. A window opens that asks the user to enter their password and the two-factor code. After these are successfully submitted, the user is shown a new QR code and manual code to be used by their authenticator application. Enter the 6-digit code. The next time the user logs in, they are prompted for the new verification code in addition to their password. Disable Two-Factor Authentication To disable two-factor authentication for a user: Select the Disable button for the Admin ID entry. A window opens that asks the user to enter their password and the two-factor code. Hard Reset of Two-Factor Authentication Perform the following steps if the user has misplaced their two-factor authentication code and cannot log in. On the Login window, click the Reset Two-Factor Code link. Enter the email address for the account to be recovered. A confirmation window appears to inform the user that a reset email has been sent. Click on the emailed link to complete the reset process. The user is sent to a page where they must enter their username and password. The confirmation window notes that two-factor authentication will be disabled for the user. They will not be asked for the authentication code when they next log in. Admin Roles Role-based access control (RBAC) is managed via the Admin Roles pane. On this pane, you can add and manage roles that will control access to MSIP administrator privileges. The Default admin role is provided for every tenant. This role will be applied to all administrators who are not assigned a new role. To add a new admin role: Click the Add Role button. A blank Create Admin Role window opens. Enter a unique Name and (optional) Description for the new role. Enter the users in the Administrators section. By default, the role maps to the admin username (email). If available on your tenant, you can define SAML group\/attributes to use when enforcing role based access control. Contact Menlo Security for more information. Use the checkboxes in the Permissions table to configure the read-write privileges available when the admin(s) log into the admin portal. These mirror the panes available on the admin portal. When ready, click the Save icon to save the new role. Saved changes will be applied the next time the user logs in. All roles are additive, excluding the default role. If a user has multiple roles, their privileges are the union of all the roles (except for the default role). If the admin is not a member of any of the defined roles, they will have the privileges given to the default role. Admin Access Control This pane defines a set of IP address, IP ranges, or IP networks with CIDR notation if you wish to restrict admin access to administrators logging in through certain addresses. A button is provided to copy the IP list saved in the Corporate Gateway IPs pane over to this pane. API Tokens This feature must be enabled for your tenant. To request enablement, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com The API Tokens pane provides a user interface for creating one or more API tokens to use with the Menlo REST APIs. Note that if you wish to create a new admin role with specific RBAC permissions for your new token, the role must be created first. See . To create a new token: Select Create Token and enter the following: Name : Unique token name Admin Role : Chose the appropriate admin role that can use the token Expires : Time before token expiration (Never, 30 days, 60 days, 3 months, 6 months, 1 year) Press Generate to create the API token. Copy the token for use with any Menlo REST API. The API Token is only displayed once. Do not press OK or close the window before copying it. Existing tokens can be revoked prior to their expiration date by admins with the permissions to do so by selecting the token Revoke button. Tokens are not recoverable after they have been revoked. Integrations Cloud Application Security The Cloud Application Security pane provides full Microsoft Cloud Application Security (MCAS) visibility into isolation sessions and control of unsanctioned applications within isolation. Prerequisites This feature requires API integration with Microsoft Cloud Application Security (MCAS). An active license and access to the MCAS portal is required. Perform the following steps on the MCAS Portal to generate an API token and add Menlo Security as a data source. Log into MCAS and access the API token generation page (Settings icon -> Security Extensions). Add a new token. Copy the following for the Menlo Security Admin Console CASB Settings pane: API token value MCAS URL To receive Menlo Security logs in MCAS, add a data source for Menlo Security in CEF format. The following steps will integrate MCAS with the Menlo Security isolation platform. Go to the Cloud Discovery Settings page (Settings icon -> Cloud Discovery Settings). Click Automatic log upload and then select Add data source . Enter the following settings: Name : MenloSecurityLogs (This name is used by the API log destination and cannot be changed). Source : Generic CEF log Receiver type : Syslog - UDP Complete the setup in the Menlo Security Admin Console as described in the following section. Configuring CASB on the Menlo Security Admin Console Confirm with Menlo Security Customer Success ( support@menlosecurity.com ) that this feature is enabled for your tenant. Log into the Admin Console and open the Cloud Application Security pane ( Settings -> Cloud Application Security ). Set the Enable Cloud Application security log Export toggle to ON and ensure the following settings are correct: Provider : Set to \"Microsoft Cloud Application Security (MCAS) MCAS URL : Set the URL provided by the MCAS API token MCAS Authorization Token : Set to the API token value provided MCAS Press the Validate button to confirm that the URL and authorization token are working. The following steps create an unsanctioned app exceptions that can be used to create a new CASB Unsanctioned Domain List rule. Follow the wizard to complete the exception list. Press Create Unsanctioned App Exception . Create an exception of type “MCAS Unsanctioned”: Type : CASB Unsanctioned Domain List List Name : Enter a name for the domain list Update Frequency : Select the update frequency (5 minutes, 30 minutes, 1 hour, or 1 day) View Domains : Press to add the domain list that is pulled from MCAS. Configure the Users\/Groups for the exception and Policy Action (Block, Isolate, Isolate + Read-Only, or Allow). If desired, click Next to add a Reason or Tag for the rule; otherwise, press Save to save the rule. The new rule is added to the list of Exception rules. Multiple rules can be added to allow for different policy actions for various user lists and groups. " }, 
{ "title" : "Multi-Tenant Administration ", 
"url" : "41864-web-policy--new-admin-portal-/41908-multi-tenant-administration.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ Multi-Tenant Administration ", 
"snippet" : "Introduction The Multi-Tenant Administration feature is a licensed feature and must be enabled for your tenants. Please contact Menlo Security Support for more information. Overview The multi-tenant administration feature allows customers to create global policies for multiple tenants. As of this re...", 
"body" : "Introduction The Multi-Tenant Administration feature is a licensed feature and must be enabled for your tenants. Please contact Menlo Security Support for more information. Overview The multi-tenant administration feature allows customers to create global policies for multiple tenants. As of this release, this feature is only applicable to web exceptions policy. This feature is designed for large organizations that wish to enforce certain broad exception policy across all tenants under their control, but will allow various subdivisions to configure specific policy in other areas as needed. Tenants are divided into the following groups: Primary Tenant : The upper level organization responsible for creating and managing global policy. Strict settings of web exception policy from this tenant are always applied regardless of secondary tenant settings. Secondary Tenant : The “mission partners” that fall under the upper level organization. The secondary tenants can define their own policy settings to override defaults, but global web exception policy. When the feature is enabled, the global policies on the exceptions page is updated with the following policy layers: Global Pre Policy : Global policy rules set the primary administrator that cannot be overridden by the secondary tenant. These are available in read-only mode on the secondary tenant. These are typically broad security controls to prevent accidental violations, like “Block requests to the list of known bad domains”. Tenant Policy Exceptions : The secondary tenant can apply tenant-specific policy here like any standalone tenant. These rules override the default settings for web isolation. Global Post Policy : These rules are applied if the secondary administrator has not made an explicit rule about the issue. For example, there may be a global rule to block social media websites, but one secondary tenant may need to access Facebook; that tenant would have a Tenant Policy Exception to allow Facebook while all other secondary tenants would be blocked from the site. Content Inspection Policy on Primary and Secondary Tenants Note that Primary Tenants will not be able to enforce an exception policy for content inspection on Secondary Tenants if the capability is not turned on in the Secondary Tenant. Confirm that the Secondary Tenant toggles for File Hash Check , Full File Scan and Sandbox Inspection are enabled before creating any exceptions in the Primary Tenant for content inspection. Tenant Registration and Policy Updates Flow The following flow describes the process for setting up tenants to use this feature and how policy is updated across tenants. Menlo Security enables a customer’s tenant to be designed as the “Primary Tenant”. The primary administrator can define global exception policy for any potential secondary tenants. Menlo Security will associate one or more “Secondary Tenants” with the Primary Tenant. The secondary tenant administrator will see a pop-up requesting approval for their tenant to be managed by the Primary Tenant. They can either Approve or Dismiss (Ignore) the request, but they cannot reject it. The pop-up will be displayed each time they log in. The Primary Tenant will be able to view the status of all managed\/secondary tenants by clicking the View Managed Tenants button. Following approval from the secondary tenant administrator, the action is logged and a pop-up is displayed to the primary tenant administrator that the request was approved. The Web Exceptions pane for the secondary tenant is updated with the three policy layers: Global Pre Policy, Tenant Policy Exceptions, and Global Post Policy. If the primary administrator saves and publishes a change to the Global Pre Policy rules, the secondary administrators are notified of the change and asked to update their policy file (i.e., the changes are not pushed to the managed\/secondary tenant until the secondary administrator approves of the change). If the tenant association needs to be removed, the primary administrator contacts Menlo Security Customer Success for assistance in removing the linkage. Logs The web logs and audit logs will be updated to show if events match a “Global Exceptions” rule in the Details for each applicable event. On a secondary tenant, clicking the Edit Policy button will open the read-only page for that global rule. Example Web Log Example Audit Log " }, 
{ "title" : "SaaS Tenant Restriction Headers ", 
"url" : "41864-web-policy--new-admin-portal-/41909-saas-tenant-restriction-headers.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Policy (New Admin Portal) \/ SaaS Tenant Restriction Headers ", 
"snippet" : "The SaaS Tenant Restriction headers feature allows administrators to enforce tenant restriction policies within SaaS services like Office 365. For example, you may wish to allow access to the Office 365 corporate account for all employees, but forbid them from accessing personal accounts. These rest...", 
"body" : "The SaaS Tenant Restriction headers feature allows administrators to enforce tenant restriction policies within SaaS services like Office 365. For example, you may wish to allow access to the Office 365 corporate account for all employees, but forbid them from accessing personal accounts. These restrictions are allowed via insertion of HTTP headers which specify the allowed tenants. With this feature enabled, the SaaS Headers panes are added to the Web Policy application. To create a header restriction, open the SaaS Header Restrictions pane and configure a custom destination or choose one of the pre-defined destinations for your rule: Office 365 (Enterprise or Consumer) G-Suite Slack YouTube Dropbox For pre-defined destinations, the domain(s) and header(s) requirements are listed below after an application is selected. Click Next to advance to the Users\/Groups section and choose the users or groups affected by the new rule. You can also optionally enter a reason or tag for the rule. With SaaS tenant restriction headers turned on, you can also limit access to the domains for the application (e.g., Office 365) to approved tenants by removing the login domains from the bypass list (SSL decryption exemptions or PAC direct connect settings) so headers can be inserted. A Bypass Login Services\/Domain toggle is added on both the SSL Decryption Exemptions and Edit PAC Settings panes for this option. Note that the SaaS tenant restriction headers feature is also fully integrated with Menlo Inline CASB. If CASB enforcement is desired for login to any cloud application, enable the CASB Enforced toggle for the login application on the CASB Cloud Application Rules pane and select the desired profile for the rule. " }, 
{ "title" : "Web Isolation Setup and Reference ", 
"url" : "41866-web-isolation-setup-and-reference.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Web Setup Essentials Guide ", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide ", 
"snippet" : "For an overview of the Menlo Security Isolation Platform and architecture, refer to . Additional information about the Menlo Security Isolation Platform interface is provided in . After performing the setup steps, make sure to refer to to validate the setup is working correctly. Proxy configuration ...", 
"body" : "For an overview of the Menlo Security Isolation Platform and architecture, refer to . Additional information about the Menlo Security Isolation Platform interface is provided in . After performing the setup steps, make sure to refer to to validate the setup is working correctly. Proxy configuration can be centrally managed by Active Directory (AD), enabling a simple deployment process for user groups of any size. For details, refer to . " }, 
{ "title" : "Introduction to Setting Up Web Isolation ", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide/41911-introduction-to-setting-up-web-isolation.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide \/ Introduction to Setting Up Web Isolation ", 
"snippet" : "This guide outlines the essential steps for setting up the Menlo Security Isolation Platform (MSIP) for the Cloud. The following topics are covered: Installation Prerequisites Connectivity Scenarios...", 
"body" : "This guide outlines the essential steps for setting up the Menlo Security Isolation Platform (MSIP) for the Cloud. The following topics are covered: Installation Prerequisites Connectivity Scenarios " }, 
{ "title" : "", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide/41912-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide \/ ", 
"snippet" : "Connectivity Scenarios Menlo Security can integrate with an existing web security gateway or firewall in the following scenarios: PAC File mode. In PAC file mode, the proxy configuration settings are altered directly on the browser via a Proxy Auto Config (PAC) file. For this mode, you will need a l...", 
"body" : "Connectivity Scenarios Menlo Security can integrate with an existing web security gateway or firewall in the following scenarios: PAC File mode. In PAC file mode, the proxy configuration settings are altered directly on the browser via a Proxy Auto Config (PAC) file. For this mode, you will need a list of internal subnets and partner sites to exempt from processing in the Menlo Security Isolation Platform (MSIP). By default, RFC-1918 (private subnets) are part of this exemption list. You should include any additional exemptions you do not want processed by MSIP in the PAC file. See for details. Proxy Chained mode. In a proxy chained mode, all requests are invisibly forwarded to Menlo Security by your SWG (Secure Web Gateway) or Firewall. For this mode, all customers should use a configuration on their SWG or Firewall that includes at least two MSIP proxies in a load balancing and fail-over configuration. See for details. Redirect mode. In redirect mode, the user is notified about all redirects, and requests are routed through Menlo Security by using a pre-pended URL. Your selection depends on the capabilities present in the partner product being integrated with. See for details. Pre-pend mode. This is normally a custom portal application that forces users to access the web using this configuration. See for details. In both the Proxy Chained and Redirect cases, the presence of a SWG or Firewall before Menlo Security allows you to start off sending only part of the overall traffic to the Isolation Platform and cut over more traffic as your familiarity with the system grows. Deployment Using PAC File Deploying the Menlo Security Isolation Platform (MSIP) is typically several steps: Configure traffic to go to the Isolation Platform. This is done by inserting a proxy server into the packet path. The proxy configuration settings are altered directly on the browser via Proxy Auto Config (PAC) Deployment . In a chained deployment configuration there will be at least two forwarding hosts for HA. The number of MSIP proxies assigned to be used as forwarding hosts may vary. If desired, you can customize the PAC server using the PAC configuration Wizard. This is an advanced configuration and is not required for most customers. For more information about this feature, see . Enable the security policy. This policy can be a combination of exceptions, site category rules, threat rules, and document rules. You can create a unique policy for your organization after evaluating your organization's goals and existing traffic patterns. Evaluate the isolation experience. Ensure that sites are being isolated as expected and modify policies as needed. Configure SSO. Configure HTTPS. Step 1: Configure traffic to go to the Isolation Platform The Isolation Platform supports both HTTP and HTTPS traffic. For simplicity most initial deployments start with only HTTP traffic isolation. Once this is working, you should implement HTTPS traffic isolation. It's important to implement HTTPS support before scaling the number of users in a deployment as there are many sites initially start with HTTP and then use HTTPS (for example, a site that uses HTTP for shopping and then uses HTTPS for checkout). These pages will not work properly unless the MSIP is configured for both HTTP and HTTPS traffic. Customers using Internet Explorer 11 should use the PAC option to fail closed to avoid the browser bypassing the proxy in cases of connection failure. In all cases, traffic needs to be pushed from the web browser to the Isolation Platform. The following steps describe how to set up a Proxy Auto Config (PAC) file for the browsers to use in your environment. Gather the list of internal subnets and partner sites to exempt from processing in the Menlo Security Isolation Platform. By default RFC-1918 internal subnets are part of this exemption list. Include any additional exemptions in the PAC file. Menlo Security can add these to your PAC file by request, or you can add them with appropriate privileges via the Settings -> Proxy Auto Config section of the Administrator Panel at the following site: admin.menlosecurity.com Have all users register for Menlo Security accounts at the following site: safe.menlosecurity.com\/account\/register This registration process can be used for POCS\/trials. For a large production deployment, authentication can be configured to leverage Active Directory (ADFS) or SAML (OneLogin, Okta, etc.) to avoid creating and managing additional user accounts just for Menlo Security. Configuration of these systems are covered in the section. Inform Menlo Security of \"administrators\" who are allowed to review web activity and set policies for your deployment using the Administrator Panel. Add a rule to your firewall to allow Menlo Security traffic. See the section. Determine the link to the appropriate PAC file. Web traffic from the user's device is proxied to the Menlo Security Isolation Platform via the PAC file on a proxy port (TCP\/3128 by default). The following is an example PAC URL. Yours is distributed to you and be specific to your company. This file (wpad.dat) only sends HTTP traffic to the Menlo Security Isolation Platform. Example: https:\/\/pac.menlosecurity.com\/companyname-0dd9c26472\/wpad.dat To send both HTTP and HTTPS traffic use the second file (wpad-ssl.dat). To use this file, you also need to follow the instructions in the section. There are other .dat files for Single Sign-On (SAML) ( wpad-sso.dat ) and SAML+SSL ( wpad-ssl-sso.dat ). Example: https:\/\/pac.menlosecurity.com\/companyname-0dd9c26472\/wpad-ssl.dat Determine PAC information via the Administrator Panel. Click the Settings button and open the Proxy Auto Config pane. The link is listed under Location . Confirm that users can access the Internet with a supported browser and configure each browser with the appropriate proxy settings. The examples below can be referenced for other similar OS and Browser configurations. In many cases, you can also automate these settings with Active Directory. See for details. Go to an HTTP site (e.g., cnn.com ) and confirm that the proxy is working. Confirm that administrators are able to login to the Administrator Panel and view traffic and threat analysis. Step 2: Enable the security policy After configuring the network and browsers to get traffic to the MSIP, define a policy to determine how traffic is handled. This policy is relevant for both HTTP and HTTPS traffic provided you've configured HTTPS traffic to be sent into the platform. In addition to traditional web site traffic, you can protect users from accessing documents from the web which may contain malicious embedded active content aimed at infecting end points. Menlo Security can retrieve the documents, execute the code, and push a harmless HTML 5.0 version of the documents to the browser. In this way a user receives clean content. Currently you can also allow users to download the original (potentially malicious content) if you configure this option for them (the download can be AntiVirus scanned as it's removed from isolation and blocked if it's infected). Step 3: Evaluate the isolation experience After the Menlo Security Isolation Platform (MSIP) has been in use for 2--3 weeks, you should have collected enough data in the Logs and Dashboard panes to understand how your users are accessing the Internet and what risks are being averted. You can also cross-check any internal tickets from your users to ensure the isolation process hasn't caused your end users unwarranted frustration: unloaded pages, degradation in performance, etc. Menlo Security handles any feedback on page load issues submitted via the Feedback GUI element on the bottom of a page (if enabled). To understand the use of MSIP make sure to examine the Threat Analysis section of the Dashboard pane. In this section the Threats Averted widget is one of the most critical. Drilling into this shows which types of threats are being seen and which users are hitting sites with known issues. If there is no or very little data here, there may not be enough Isolation actions in your deployment. Check the Threat Rules and make sure that the following (at a minimum) are set to Isolate : Uncategorized Site and Vulnerable Service . Look at the Actions Summary widget in the Traffic Analysis tab of the Dashboard pane to see the percentages of Isolate vs. Block and Allow . Second, examine the Traffic Analysis tab of the Dashboard pane to see which users and sites are the most popular. You can easily filter out a specific site by clicking it in the bar chart. Doing so takes you to the location in the Log View . You can click the Edit Policy icon and set a new policy for that site and\/or category (i.e., Block ). Next, check which types of documents have been converted into HTML 5.0 and which sites are hosting these documents. Navigate to the Threat Analysis tab of the Dashboard pane, and look at the Document Views widget. Drill into the chart to see the domain names of the sites which are hosting documents downloaded into your organization. To see which category these sites belong to drill further into the data to the actual log record, which includes a Category column. Step 4: Configure Single Sign-On Menlo Security uses SAML 2.0 to provide a standards-based single sign-on capability leveraging existing authentication services. SAML allows Menlo Security to authenticate users without any requirement for user creation, user credential management, or direct access into the corporate network. Passwords never leave the Identity Provider; a cryptographically signed token is passed to Menlo Security for user authorization. SAML Authentication Flow When a user connects to the Menlo Security service for the first time, their browser is redirected to the SAML identity provider for authentication. Once the authentication is completed, the identity provider provides a signed SAML assertion to Menlo Security. Once that process is complete, the user is logged into Menlo Security and does not need to re-authenticate unless their browser state is reset. Single sign-on functionality can come from integration with an existing Active Directory system (ADFS) or via a cloud-based solution, such as OneLogin, Okta, or other Identity-as-a-Service (IDaaS) provider using SAML. Refer to for configuration details for Menlo Security as well as pointers to the relevant partner integration guides. Step 5: Configure HTTPS (SSL) Isolation Malware increasingly uses encrypted sessions to hide activity and bypass existing security solutions. Menlo Security has the ability to isolate and protect HTTPS traffic. In addition to the security, you can view how much HTTPS traffic is in use, where this traffic is going, and who is using it. It also allows you to render documents retrieved from sites using HTTPS. A few important points: Menlo Security can exclude selected categories or sites from SSL inspection via Web Policy -> SSL Inspection . The Menlo Security root CA is completely protected. It is operated offline, and never attaches to a network. The CA device is physically secured and only powered on as needed to generate updated signing certificates. Client Side certificates sessions which allow only an SSL session from a particular endpoint can't be intercepted. But, when these are in use, there is the security stance that both ends are totally trusted and therefore Menlo Security is not needed. \"Certificate Pinning\" doesn't break SSL termination. Browsers do not block SSL validation if the certificate is trusted by a user-installed enterprise CA certificate, so this does not present a problem for Menlo Security SSL termination. Menlo Security checks the validity of the certificates of the sites we are connecting to and will pass through any alerts we see. The SSL termination process validates the destination WWW serverâ€™s certificate as part of the SSL handshake process. If there are any issues with the destination sites they are passed through to the WWW browser which will generate browser warnings. In the case of a self-signed certificate, the SSL termination certificate will be signed with an intentionally untrusted certificate to trigger the appropriate browser warnings. In order to support HTTPS, the Menlo Security Isolation Platform must be trusted to act on behalf of the endpoint devices. There are two options to implement this: The first option is to use an existing Certificate Authority which has a trust relationship with the endpoints and can establish trust between that and Menlo Security. This is typically the situation in a Private Cloud deployment. The second option is to import the Menlo Security certificate directly into the endpoints. This is typically used for a Public Cloud deployment. For a POC this can be a short lived certificate (i.e. months); for full production it can be a multi-year certificate. HTTPS Isolation in Cloud Based Configuration To set up HTTPS Isolation for cloud based configuration do the following: Make sure that your network allows outbound traffic. Outbount port TCP 3129 must be open to Menlo Security for HTTPS Isolation to work properly. Make sure that your account has been setup with HTTPS\/SSL Isolation. Make sure a PAC of the type wpad-ssl.dat is present. This PAC has a statement to return HTTPS traffic to proxy-nnnnnnnnnn.menlosecurity.com:3129;DIRECT . Configure a Policy for which categories or sites to Exempt (i.e., Health or Finance) via the Web Policy -> SSL Inspection Finally, follow the process of importing the Menlo Security certificate into the initial POC user systems. Refer to the following links for details: HTTPS Isolation in Private Cloud Configuration Menlo Security doesn't store or otherwise have access to data for any of the tenants of the public cloud offering (SSL or even non-SSL). However, if you do not wish to use the public cloud model, you can opt to install the Isolation Platform in your own datacenters, manage all your own certificates, and be 100% independent. In this mode users can load a Menlo Security CA certificate or their organization's own enterprise CA certificate (e.g., Active Directory Certificate Services). To set up HTTPS Isolation in a Private Cloud environment, refer to . In either Public Cloud or Private Cloud (on-prem) scenarios you will use the Web Policy -> SSL Inspection editor to decide which sites to exclude from SSL Inspection. Proxy Chaining and Redirect Mode to MSIP Cloud Chained proxy mode uses the proxy configuration to selectively forward requests through Menlo Security. All proxy-chaining customers should use a configuration that includes at least two MSIP proxies in a load balancing and fail-over configuration. As tenants grow, the number of MSIP proxies may need to be adjusted. Note that Menlo Security currently already creates proxy0 and proxy1 for every tenant. Proxy Chained Networking Configuration In any chained configuration, your organization needs to have network access to the MSIP as follows: Your web security gateway must be able to connect to the servers\/ports outlined in . Additionally, if you use Redirect mode , your user devices must be able to connect to safe.menlosecurity.com on TCP port 443 . Proxy Chained User Management In a chained proxy configuration users are validated in one of two modes: anonymous mode or authenticated mode. Anonymous Proxy Chained Users . If you don't require user tracking or if the existing gateway already performs user authorization, Menlo Security can work in anonymous mode. In this mode, users are never prompted for credentials. To operate in this mode, you must supply the corporate gateway IP address . Any request from that IP address is associated with the corporate account and assigned a pseudo user ID. Authenticated Proxy Chained Users . In this mode users are authenticated whenever connections are sent to Menlo Security. To operate in this mode, users must create Menlo Security user accounts by registering at the following URL: safe.menlosecurity.com\/account\/register Single sign-on authentication can also be performed via integration with Active Directory Federation Services (ADFS) or standard SAML services such as OneLogin or Okta. Configuration of these systems is covered in the following documents: Setting Up Proxy Chaining and Redirect Mode Use your unique hostname to chain your systems to Menlo Security in the cloud. Refer to the following product-specific guides for information about setting up proxy chaining: To determine your unique hostname: Login to admin.menlosecurity.com . Go to Settings -> Proxy Auto Config . Click Preview at the bottom of the page. Scroll to the bottom of the PAC preview window. You will find a line that reads return 'PROXY proxy0-nnnnnnnn.menlosecurity.com:NNNN;DIRECT . proxy0-nnnnnnnn.menlosecurity.com is your unique hostname. Pre-Pend Mode to MSIP Cloud Customers accessing Menlo Security via Pre-Pend configurations (for example, https:\/\/safe.menlosecurity.com\/www.cnn.com ) need to determine how to force users to access the web via this method. This is usually done via a custom portal application which is out of scope for this document. " }, 
{ "title" : "Deployment Using PAC File ", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide/41913-deployment-using-pac-file.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide \/ Deployment Using PAC File ", 
"snippet" : "Introduction Deploying the Menlo Security Isolation Platform (MSIP) is typically several steps: Configure traffic to go to the Isolation Platform. This is done by inserting a proxy server into the packet path. The proxy configuration settings are altered directly on the browser via Proxy Auto Config...", 
"body" : "Introduction Deploying the Menlo Security Isolation Platform (MSIP) is typically several steps: Configure traffic to go to the Isolation Platform. This is done by inserting a proxy server into the packet path. The proxy configuration settings are altered directly on the browser via Proxy Auto Config (PAC) Deployment . In a chained deployment configuration there will be at least two forwarding hosts for HA. The number of MSIP proxies assigned to be used as forwarding hosts may vary. If desired, you can customize the PAC server using the PAC configuration Wizard. This is an advanced configuration and is not required for most customers. For more information about this feature, see . Enable the security policy. This policy can be a combination of exceptions, site category rules, threat rules, and document rules. You can create a unique policy for your organization after evaluating your organization's goals and existing traffic patterns. Evaluate the isolation experience. Ensure that sites are being isolated as expected and modify policies as needed. Configure SSO. Configure HTTPS. Step 1: Configure traffic to go to the Isolation Platform The Isolation Platform supports both HTTP and HTTPS traffic. For simplicity most initial deployments start with only HTTP traffic isolation. Once this is working, you should implement HTTPS traffic isolation. It's important to implement HTTPS support before scaling the number of users in a deployment as there are many sites initially start with HTTP and then use HTTPS (for example, a site that uses HTTP for shopping and then uses HTTPS for checkout). These pages will not work properly unless the MSIP is configured for both HTTP and HTTPS traffic. Customers using Internet Explorer 11 should use the PAC option to fail closed to avoid the browser bypassing the proxy in cases of connection failure. In all cases, traffic needs to be pushed from the web browser to the Isolation Platform. The following steps describe how to set up a Proxy Auto Config (PAC) file for the browsers to use in your environment. Gather the list of internal subnets and partner sites to exempt from processing in the Menlo Security Isolation Platform. By default RFC-1918 internal subnets are part of this exemption list. Include any additional exemptions in the PAC file. Menlo Security can add these to your PAC file by request, or you can add them with appropriate privileges via the Settings -> Proxy Auto Config section of the Administrator Panel at the following site: admin.menlosecurity.com Have all users register for Menlo Security accounts at the following site: safe.menlosecurity.com\/account\/register This registration process can be used for POCS\/trials. For a large production deployment, authentication can be configured to leverage Active Directory (ADFS) or SAML (OneLogin, Okta, etc.) to avoid creating and managing additional user accounts just for Menlo Security. Configuration of these systems are covered in the section. Inform Menlo Security of \"administrators\" who are allowed to review web activity and set policies for your deployment using the Administrator Panel. Add a rule to your firewall to allow Menlo Security traffic. See the section. Determine the link to the appropriate PAC file. Web traffic from the user's device is proxied to the Menlo Security Isolation Platform via the PAC file on a proxy port (TCP\/3128 by default). The following is an example PAC URL. Yours is distributed to you and be specific to your company. This file (wpad.dat) only sends HTTP traffic to the Menlo Security Isolation Platform. Example: https:\/\/pac.menlosecurity.com\/companyname-0dd9c26472\/wpad.dat To send both HTTP and HTTPS traffic use the second file (wpad-ssl.dat). To use this file, you also need to follow the instructions in the section. There are other .dat files for Single Sign-On (SAML) ( wpad-sso.dat ) and SAML+SSL ( wpad-ssl-sso.dat ). Example: https:\/\/pac.menlosecurity.com\/companyname-0dd9c26472\/wpad-ssl.dat Determine PAC information via the Administrator Panel. Click the Settings button and open the Proxy Auto Config pane. The link is listed under Location . Confirm that users can access the Internet with a supported browser and configure each browser with the appropriate proxy settings. The examples below can be referenced for other similar OS and Browser configurations. In many cases, you can also automate these settings with Active Directory. See for details. Go to an HTTP site (e.g., cnn.com ) and confirm that the proxy is working. Confirm that administrators are able to login to the Administrator Panel and view traffic and threat analysis. Step 2: Enable the security policy After configuring the network and browsers to get traffic to the MSIP, define a policy to determine how traffic is handled. This policy is relevant for both HTTP and HTTPS traffic provided you've configured HTTPS traffic to be sent into the platform. In addition to traditional web site traffic, you can protect users from accessing documents from the web which may contain malicious embedded active content aimed at infecting end points. Menlo Security can retrieve the documents, execute the code, and push a harmless HTML 5.0 version of the documents to the browser. In this way a user receives clean content. Currently you can also allow users to download the original (potentially malicious content) if you configure this option for them (the download can be AntiVirus scanned as it's removed from isolation and blocked if it's infected). Step 3: Evaluate the isolation experience After the Menlo Security Isolation Platform (MSIP) has been in use for 2--3 weeks, you should have collected enough data in the Logs and Dashboard panes to understand how your users are accessing the Internet and what risks are being averted. You can also cross-check any internal tickets from your users to ensure the isolation process hasn't caused your end users unwarranted frustration: unloaded pages, degradation in performance, etc. Menlo Security handles any feedback on page load issues submitted via the Feedback GUI element on the bottom of a page (if enabled). To understand the use of MSIP make sure to examine the Threat Analysis section of the Dashboard pane. In this section the Threats Averted widget is one of the most critical. Drilling into this shows which types of threats are being seen and which users are hitting sites with known issues. If there is no or very little data here, there may not be enough Isolation actions in your deployment. Check the Threat Rules and make sure that the following (at a minimum) are set to Isolate : Uncategorized Site and Vulnerable Service . Look at the Actions Summary widget in the Traffic Analysis tab of the Dashboard pane to see the percentages of Isolate vs. Block and Allow . Second, examine the Traffic Analysis tab of the Dashboard pane to see which users and sites are the most popular. You can easily filter out a specific site by clicking it in the bar chart. Doing so takes you to the location in the Log View . You can click the Edit Policy icon and set a new policy for that site and\/or category (i.e., Block ). Next, check which types of documents have been converted into HTML 5.0 and which sites are hosting these documents. Navigate to the Threat Analysis tab of the Dashboard pane, and look at the Document Views widget. Drill into the chart to see the domain names of the sites which are hosting documents downloaded into your organization. To see which category these sites belong to drill further into the data to the actual log record, which includes a Category column. Step 4: Configure Single Sign-On Menlo Security uses SAML 2.0 to provide a standards-based single sign-on capability leveraging existing authentication services. SAML allows Menlo Security to authenticate users without any requirement for user creation, user credential management, or direct access into the corporate network. Passwords never leave the Identity Provider; a cryptographically signed token is passed to Menlo Security for user authorization. SAML Authentication Flow When a user connects to the Menlo Security service for the first time, their browser is redirected to the SAML identity provider for authentication. Once the authentication is completed, the identity provider provides a signed SAML assertion to Menlo Security. Once that process is complete, the user is logged into Menlo Security and does not need to re-authenticate unless their browser state is reset. Single sign-on functionality can come from integration with an existing Active Directory system (ADFS) or via a cloud-based solution, such as OneLogin, Okta, or other Identity-as-a-Service (IDaaS) provider using SAML. Refer to for configuration details for Menlo Security as well as pointers to the relevant partner integration guides. Step 5: Configure HTTPS (SSL) Isolation Malware increasingly uses encrypted sessions to hide activity and bypass existing security solutions. Menlo Security has the ability to isolate and protect HTTPS traffic. In addition to the security, you can view how much HTTPS traffic is in use, where this traffic is going, and who is using it. It also allows you to render documents retrieved from sites using HTTPS. A few important points: Menlo Security can exclude selected categories or sites from SSL inspection via Web Policy -> SSL Inspection . The Menlo Security root CA is completely protected. It is operated offline, and never attaches to a network. The CA device is physically secured and only powered on as needed to generate updated signing certificates. Client Side certificates sessions which allow only an SSL session from a particular endpoint can't be intercepted. But, when these are in use, there is the security stance that both ends are totally trusted and therefore Menlo Security is not needed. \"Certificate Pinning\" doesn't break SSL termination. Browsers do not block SSL validation if the certificate is trusted by a user-installed enterprise CA certificate, so this does not present a problem for Menlo Security SSL termination. Menlo Security checks the validity of the certificates of the sites we are connecting to and will pass through any alerts we see. The SSL termination process validates the destination WWW serverâ€™s certificate as part of the SSL handshake process. If there are any issues with the destination sites they are passed through to the WWW browser which will generate browser warnings. In the case of a self-signed certificate, the SSL termination certificate will be signed with an intentionally untrusted certificate to trigger the appropriate browser warnings. In order to support HTTPS, the Menlo Security Isolation Platform must be trusted to act on behalf of the endpoint devices. There are two options to implement this: The first option is to use an existing Certificate Authority which has a trust relationship with the endpoints and can establish trust between that and Menlo Security. This is typically the situation in a Private Cloud deployment. The second option is to import the Menlo Security certificate directly into the endpoints. This is typically used for a Public Cloud deployment. For a POC this can be a short lived certificate (i.e. months); for full production it can be a multi-year certificate. HTTPS Isolation in Cloud Based Configuration To set up HTTPS Isolation for cloud based configuration do the following: Make sure that your network allows outbound traffic. Outbount port TCP 3129 must be open to Menlo Security for HTTPS Isolation to work properly. Make sure that your account has been setup with HTTPS\/SSL Isolation. Make sure a PAC of the type wpad-ssl.dat is present. This PAC has a statement to return HTTPS traffic to proxy-nnnnnnnnnn.menlosecurity.com:3129;DIRECT . Configure a Policy for which categories or sites to Exempt (i.e., Health or Finance) via the Web Policy -> SSL Inspection Finally, follow the process of importing the Menlo Security certificate into the initial POC user systems. Refer to the following links for details: HTTPS Isolation in Private Cloud Configuration Menlo Security doesn't store or otherwise have access to data for any of the tenants of the public cloud offering (SSL or even non-SSL). However, if you do not wish to use the public cloud model, you can opt to install the Isolation Platform in your own datacenters, manage all your own certificates, and be 100% independent. In this mode users can load a Menlo Security CA certificate or their organization's own enterprise CA certificate (e.g., Active Directory Certificate Services). To set up HTTPS Isolation in a Private Cloud environment, refer to . In either Public Cloud or Private Cloud (on-prem) scenarios you will use the Web Policy -> SSL Inspection editor to decide which sites to exclude from SSL Inspection. " }, 
{ "title" : "Proxy Chaining and Redirect Mode to MSIP Cloud ", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide/41914-proxy-chaining-and-redirect-mode-to-msip-cloud.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide \/ Proxy Chaining and Redirect Mode to MSIP Cloud ", 
"snippet" : "Introduction Chained proxy mode uses the proxy configuration to selectively forward requests through Menlo Security. All proxy-chaining customers should use a configuration that includes at least two MSIP proxies in a load balancing and fail-over configuration. As tenants grow, the number of MSIP pr...", 
"body" : "Introduction Chained proxy mode uses the proxy configuration to selectively forward requests through Menlo Security. All proxy-chaining customers should use a configuration that includes at least two MSIP proxies in a load balancing and fail-over configuration. As tenants grow, the number of MSIP proxies may need to be adjusted. Note that Menlo Security currently already creates proxy0 and proxy1 for every tenant. Proxy Chained Networking Configuration In any chained configuration, your organization needs to have network access to the MSIP as follows: Your web security gateway must be able to connect to the servers\/ports outlined in . Additionally, if you use Redirect mode , your user devices must be able to connect to safe.menlosecurity.com on TCP port 443 . Proxy Chained User Management In a chained proxy configuration users are validated in one of two modes: anonymous mode or authenticated mode. Anonymous Proxy Chained Users . If you don't require user tracking or if the existing gateway already performs user authorization, Menlo Security can work in anonymous mode. In this mode, users are never prompted for credentials. To operate in this mode, you must supply the corporate gateway IP address . Any request from that IP address is associated with the corporate account and assigned a pseudo user ID. Authenticated Proxy Chained Users . In this mode users are authenticated whenever connections are sent to Menlo Security. To operate in this mode, users must create Menlo Security user accounts by registering at the following URL: safe.menlosecurity.com\/account\/register Single sign-on authentication can also be performed via integration with Active Directory Federation Services (ADFS) or standard SAML services such as OneLogin or Okta. Configuration of these systems is covered in the following documents: Setting Up Proxy Chaining and Redirect Mode Use your unique hostname to chain your systems to Menlo Security in the cloud. Refer to the following product-specific guides for information about setting up proxy chaining: To determine your unique hostname: Login to admin.menlosecurity.com . Go to Settings -> Proxy Auto Config . Click Preview at the bottom of the page. Scroll to the bottom of the PAC preview window. You will find a line that reads return 'PROXY proxy0-nnnnnnnn.menlosecurity.com:NNNN;DIRECT . proxy0-nnnnnnnn.menlosecurity.com is your unique hostname. " }, 
{ "title" : "Fixed Egress IP ", 
"url" : "41866-web-isolation-setup-and-reference/41910-web-setup-essentials-guide/41915-fixed-egress-ip.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Web Setup Essentials Guide \/ Fixed Egress IP ", 
"snippet" : "Introduction The following licensed feature must be enabled for your tenant. Please contact Menlo Security Customer Success for more information. Fixed Egress IP Address Routing provides a method to control the source IP address your traffic can originate from when accessing selected services throug...", 
"body" : "Introduction The following licensed feature must be enabled for your tenant. Please contact Menlo Security Customer Success for more information. Fixed Egress IP Address Routing provides a method to control the source IP address your traffic can originate from when accessing selected services through MSIP. Fixed Egress Routing Use Cases Provide a known source IP address for services that require access from a known address Some services require access to originate from a known source IP address. By default, sessions originate from a shared IP address and that address can change session to session. Fixed Egress provisions an IP address which is dedicated to the purchasing tenant. The address is dedicated to that tenant. So, it can be treated like a corporate-owned IP address and used for IP authorization into services. Grant region-specific egress traffic both to and from approved geolocations When a user accesses services from a country different from where they are located, the content in the www sessions is tailored for the country of the egress IP. For example, a French user wants to egress from Paris when isolated via London or Frankfurt, but when traveling to New York or Tokyo, they want to egress from the local address. Provide egress from a dedicated corporate IP address and avoid unnecessary blocking Hosting services are vulnerable to malicious use via probes, attacks, and content theft. As a result, services block access from service provider IP ranges. The reputation for AWS addresses are bad due to past transient malicious use. Egress traffic from Menlo Security isolation uses an IP address from a pool of AWS IP addresses. Some services require a defined source IP address to authorize access, creating the need for a dedicated static IP address for access to those services. Egress routing policy is configurable per domain in the Menlo Security admin portal. Configuration To configure Fixed Egress you first need to contact Menlo Security Customer Success to: Add Fixed Egress to your service. Help you to determine the deployment specifics and provision the associated resources. Help you to determine the regions in which Fixed Egress service is needed. Once Fixed Egress service is provisioned, administrators can specify which domains they would like to use Fixed Egress IP for whichever AWS regions they are deployed in. To configure Fixed Egress Routing (once enabled): Go to the Admin Console Egress Routing pane: Settings > Egress Routing . Click Edit for a routing cluster to view your assigned Fixed Egress IP addresses. Add new domains or IP addresses by clicking Add , then adding the domain or address. " }, 
{ "title" : "Menlo Security Threat Rule and Category Rule Mapping ", 
"url" : "41866-web-isolation-setup-and-reference/41916-menlo-security-threat-rule-and-category-rule-mapping.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Menlo Security Threat Rule and Category Rule Mapping ", 
"snippet" : "Introduction Menlo Security classifies URLs using Threat Rules (e.g., site uses vulnerable services like WordPress) and Category Rules (e.g., site provides sports, news, etc. content). This document describes those classifications and also lists example sites. New tenants will now use the category l...", 
"body" : "Introduction Menlo Security classifies URLs using Threat Rules (e.g., site uses vulnerable services like WordPress) and Category Rules (e.g., site provides sports, news, etc. content). This document describes those classifications and also lists example sites. New tenants will now use the category list provided in . In addition, existing tenants that are enabled for the categorization update will use this list (please contact Menlo Security support for details). The category database and policy enforcement from a tenant using legacy categories are unchanged after the update. Until the update is performed, the legacy category list in remains in effect. Threat Rules Name Description Vulnerable Service Menlo Security analyzes the software packages (WordPress, vBulletin, VanillaForum, Squid, Python, PHP, Perl, nginx, Microsoft-IIS, MediaWiki, Joomla!, Drupal, Apache) used to serve the web page being requested. If the packages are versions which have known CVE's\/Vulnerabilities, the request is marked as Vulnerable Service . There are policy controls on the individual services (via the Central Manager Web Policy -> Threat Rules -> Detailed screen). Uncategorized Site Any site which has not been categorized (sports, news, etc.). Sites which are uncategorized generally represent a significant source of malware or phishing, as hackers are constantly trying to create new sources to serve malicious software. Flash Site Sites which leverage Flash to serve content (games, videos, ads, etc.). Note that this is not listed on the Threats pane but is available as an exception. Spam URLs contained in SPAM. Phishing Phishing, pharming, and other sites that pose as a reputable site, usually to harvest personal information from a user. Malware Malicious content including executables, drive-by infection sites, malicious scripts, viruses, trojans, and code. Spyware or Adware sites that provide or promote information gathering or tracking that is unknown to, or without the explicit consent of, the end user or the organization. Also unsolicited advertising popups and programs that may be installed on a user's computer. Downloads and discussion of software agents that track a user's keystrokes or monitor their web surfing habits. Includes subcategory names: Key Loggers and Monitoring , Dead Sites , Spyware and Addware . Malvertising Malware delivered via ad networks. Often classified generically in the Malware category. Compromised Host System observed operating as a Tor exit node or performing scans of ranges of internet addresses. Command and Control System observed either hosting malware command and control communications or connecting to a command and control server. Botnet These are URLs, typically IP addresses, which are determined to be part of a Bot network, from which network attacks are launched. Attacks may include SPAM messages, DOS, SQL injections, proxy jacking, and other unsolicited contacts. Parked Domains Registered internet domain name that is not associated with any services such as e-mail or a website. Category Rules The following table lists all classifications available in the Menlo category list. Category Rules Name Description Example Sites Advertisements and Pop-Ups Advertisements, media, content, and banners http:\/\/casalemedia.com Alcohol and Tobacco Sites that provide information on, promote, or support the sale of alcoholic beverages or tobacco products and associated paraphernalia. https:\/\/thompsoncigar.com or https:\/\/wineinsiders.com Anonymizers Proxy servers and other methods to gain access to URLs in any way that bypasses URL filtering or monitoring. Web-based translation sites that circumvent filtering. http:\/\/anonymouse.org Arts Combined with the Entertainment category Business Business firms, corporate websites, business information, economics, marketing, management, and entrepreneurship. Sites that pay users in the form of cash or prizes, for clicking on or reading specific links, email, or web pages. https:\/\/www.samsung.com or https:\/\/www.ups.com Chat Combined with the Instant Messaging category Child Abuse Images Combined with the Pornography\/Sexually Explicit category Computers and Technology Computer\/Internet security, security discussion groups. General computer and Internet sites, technical information. SaaS sites and other URLs that deliver internet services. Online storage and posting of files, music, pictures, and other data. Delivery of content and data for third parties, including ads, media, files, images, and video. Free or paid hosting services for web pages and information concerning their development, publication and promotion. Includes subcategory: Computer and Internet Security . https:\/\/www.mcafee.com or https:\/\/system.netsuite.com Criminal Activity Criminal activity, how not to get caught, copyright and intellectual property violations, etc. https:\/\/newid.com or http:\/\/kidneykidney.com Cults Methods, means of instruction, or other resources to interpret, affect or influence real events through the use of astrology, spells, curses, magic powers, satanic or supernatural beings. Includes horoscope sites. http:\/\/horoscopes.com or https:\/\/astronet.hu Dating and Personals Dating websites focused on establishing personal relationships. https:\/\/eharmony.com or https:\/\/christianmingle.com Download Sites Software, screensavers, icons, wallpapers, utilities, ringtones. Includes downloads that request a donation, and open source projects. https:\/\/download.cnet.com Education Pre-school, elementary, secondary, high school, college, university, and vocational school and other educational content and information. Distance education and trade schools, online courses, vocational training, software training, skills training. Personal, professional, or educational reference material, including online dictionaries, maps, census, almanacs, library catalogues, genealogy, and scientific information. https:\/\/www.colorado.edu or http:\/\/www.reference.com Entertainment Motion pictures, videos, television, music and programming guides, books, comics, movie theatres, galleries, artists or reviews on entertainment. Performing arts (theatre, vaudeville, opera, symphonies, etc.). Museums, galleries, artist sites (sculpture, photography, etc.). http:\/\/eonline.com or http:\/\/highlightgallery.com Fashion and Beauty Fashion or glamour magazines, beauty, clothes, cosmetics, style. https:\/\/visionmodels.co.uk Finance Banking services and other types of financial information, such as loans, accountancy, actuaries, banks, mortgages, and general insurance companies. Promotion and facilitation of securities trading and management of investment assets. Also includes information on financial investment strategies, quotes, and news. https:\/\/www.paypal.com or https:\/\/www.morningstar.com Forums and Newsgroups Combined with the Leisure and Recreation category. Gambling Gambling or lottery web sites that invite the use of real or virtual money. Information or advice for placing wagers, participating in lotteries, gambling, or running numbers. Virtual casinos and offshore gambling ventures. Sports picks and betting pools. Virtual sports and fantasy leagues that offer large rewards or request significant wagers. http:\/\/www.powerball.com Games Game playing or downloading, video games, computer games, electronic games, tips, and advice on games or how to obtain cheat codes. Also includes sites dedicated to selling board games as well as journals and magazines dedicated to game playing. Includes sites that support or host online sweepstakes and giveaways. Includes fantasy sports sites that also host games or game-playing. Sites designed specifically for children and teenagers. Includes subcategory names: Kids . https:\/\/www.duowan.com General Domains that generate content dynamically based on arguments to their URL or other information (like geo-location) on the incoming web request. Can contain Portal Pages. Government Information on military branches, armed services, and military history. Information on government, government agencies and government services such as taxation, public, and emergency services. Also includes sites that discuss or explain laws of various governmental entities. Includes local, county, state, and national government sites. https:\/\/www.defense.gov or https:\/\/www.nasa.gov Greeting Cards Greeting card sites. http:\/\/123greetings.com Hacking Illegal or questionable access to or the use of communications equipment\/software. Development and distribution of programs that may allow compromise of networks and systems. Avoidance of licensing and fees for computer programs and other systems. http:\/\/www.hackplayers.com Hate and Intolerance Sites that contain content and language in support of hate crimes and racism such as Nazi, neo-Nazi, Ku Klux Klan, etc. http:\/\/nazi-lauck-nsdapao.com Health and Medicine General health, fitness, well-being, including traditional and non-traditional methods and topics. Medical information on ailments, various conditions, dentistry, psychiatry, optometry, and other specialties. Hospitals and doctor offices. Medical insurance. Cosmetic surgery. https:\/\/webmd.com Illegal Drug Discussion or remedies for illegal, illicit, or abused drugs such as heroin, cocaine, or other street drugs. Information on legal highs: glue sniffing, misuse of prescription drugs or abuse of other legal substances. Marijuana use, cultivation, history, culture, legal issues. https:\/\/wwwshroomery.org or http:\/\/passyourdrugtest.com Illegal Software Combined with the Criminal Activity category Image Sharing Photo and image searches, online photo albums\/digital photo exchange, image hosting. https:\/\/www.gettyimages.com Information Security Combined with the Computers and Technology category. Instant Messaging Internet telephony, messaging, VoIP services and related businesses https:\/\/skype.com Job Search Assistance in finding employment, and tools for locating prospective employers, or employers looking for employees. https:\/\/www.monster.com or http:\/\/www.51job.com Leisure and Recreation Information, associations, forums and publications on recreational pastimes such as collecting, kit airplanes, outdoor activities such as hiking, camping, rock climbing, specific arts, craft, or techniques; animal and pet related information, including breed-specifics, training, shows and humane societies. https:\/\/www.craftster.org Network Errors This category has been deprecated and will be removed from the interface in a future version. News Current events or contemporary issues of the day. Also includes radio stations and magazines, newspapers online, headline news sites, newswire services, personalized news services, and weather sites. http:\/\/abcnews.go.com Non-profits and NGOs A variety of topics, groups, and associations relevant to the general populace, broad issues that impact a variety of people, including safety, children, societies, and philanthropic groups. https:\/\/www.unicefusa.org or https:\/\/www.dar.org Nudity Nude or seminude depictions of the human body. These depictions are not necessarily sexual in intent or effect, but may include sites containing nude paintings or photo galleries of artistic nature. This category also includes nudist or naturist sites that contain pictures of nude individuals. https:\/\/www.nude-art-models.com Peer-to-Peer Peer to peer clients and access. Includes torrents, music download programs. https:\/\/thepiratebay.org Personal Sites Personal websites posted by individuals or groups, as well as blogs. https:\/\/www.blogger.com or https:\/\/wordpress.org Politics Politics, philosophy, discussions, promotion of a particular viewpoint or stance in order to further a cause. Legal websites, law firms, discussions and analysis of legal issues. https:\/\/www.democrats.org Pornography\/Sexually Explicit Sexually explicit material for the purpose of arousing a sexual or prurient interest. Adult products including sex toys, CD-ROMs, and videos. Online groups, including newsgroups and forums, that are sexually explicit in nature. Erotic stories and textual descriptions of sexual acts. Adult services including videoconferencing, escort services, and strip clubs. Sexually explicit art and child abuse images. http:\/\/www.playboy.com or https:\/\/union.fr Private IP Addresses This category has been deprecated and will be removed from the interface in a future version. Real Estate Information on renting, buying, or selling real estate or properties. Tips on buying or selling a home. Real estate agents, rental or relocation services, and property improvement. http:\/\/prudentialproperties.com or https:\/\/www.realtor.com Religion Conventional or unconventional religious or quasi-religious subjects, as well as churches, synagogues, or other houses of worship. http:\/\/sdrock.com or https:\/\/biblesociety.ca Restaurants and Dining City guides and tourist information, including restaurants, area\/regional information, and local points of interest. http:\/\/downtownlr.com School Cheating Sites that support cheating and contain such materials, including free essays, exam copies, plagiarism, etc. http:\/\/essay.org Search Engines and Portals Search interfaces using key words or phrases. Returned results may include text, websites, images, videos, and files. Web sites that aggregate a broader set of Internet content and topics, and which typically serve as the starting point for an end user. https:\/\/google.com Sex Education Information on reproduction, sexual development, safe sex practices, sexually transmitted diseases, sexuality, birth control, sexual development, tips for better sex as well as products used for sexual enhancement, and contraceptives. Abortion topics, either pro-life or pro-choice. https:\/\/www.o.school or https:\/\/www.sexetc.org\/ Shopping Department stores, retail stores, company catalogs and other sites that allow online consumer or business shopping and the purchase of goods and services. Swimsuits, intimate apparel or other types of suggestive clothing. Home issues and products, including maintenance, home safety, decor, cooking, gardening, home electronics, design, etc. Sites that support the offering and purchasing of goods between individuals as their main purpose (auction sites). Does not include classified advertisements. http:\/\/ebay.com http:\/\/quibids.com or https:\/\/www.amazon.com Social Networking Sites that have user communities where users interact, post messages, pictures, and otherwise communicate. https:\/\/www.facebook.com or https:\/\/twitter.com Sports Team or conference web sites, international, national, college, professional scores and schedules; sports-related online magazines or newsletters, fantasy sports and virtual sports leagues. Sport hunting, gun clubs, and fishing. http:\/\/www.nba.com Streaming Media and Downloads Sales, delivery, or streaming of audio or video content, including sites that provide downloads for such viewers. Music sales, distribution, streaming, information on musical groups and performances, lyrics, and the music business. http:\/\/itunes.com http:\/\/www.ustream.tv or http:\/\/stations.warpradio.com Tasteless Tasteless humor, get rich quick sites, and sites that manipulate the browser user experience or client in some unusual, unexpected, or suspicious manner. Vomit and other bodily functions, bloody clothing, etc. https:\/\/9gag.com Translators URL and language translation sites that allow users to see URL pages in other languages. These sites can also allow users to circumvent filtering as the target page's content is presented within the context of the translator's URL. https:\/\/translate.google.com Transportation Car reviews, vehicle purchasing or sales tips, parts catalogs. Auto trading, photos, discussion of vehicles including motorcycles, boats, cars, trucks and RVs. Journals and magazines on vehicle modifications. https:\/\/www.carmax.com Travel Airlines and flight booking agencies. Travel planning, reservations, vehicle rentals, descriptions of travel destinations, or promotions for hotels or casinos. Car rentals. https:\/\/www.cheapflights.com or https:\/\/www.expedia.com Violence Sites that advocate violence, depictions, and methods, including game\/comic violence and suicide. Weapons Sales, reviews, or descriptions of weapons such as guns, knives or martial arts devices, or provide information on their use, accessories, or other modifications. http:\/\/www.browning.com or https:\/\/www.gunpartscorp.com Web-based Email Sites offering web-based email and email clients. https:\/\/www.google.com\/gmail The following categories cannot be configured as exceptions in the Exceptions pane: Anonymizers, Arts, Business, and Chat. Category Rules (Updated) Name Description Example Sites Abortion Abortion topics, either pro-life or pro-choice http:\/\/prochoiceamerica.org or http:\/\/abortion.procon.org Abused Drugs Discussion or remedies for illegal, illicit, or abused drugs (heroin, cocaine, or other street drugs) and misuse or abuse of other legal substances (glue sniffing, prescription drugs, or other substances) http:\/\/shrommery.org or http:\/\/passyourdrugtest.com Adult and Pornography Sexually explicit material for the purpose of arousing a sexual or prurient interest. Adult products including sex toys, CD-ROMs, and videos. Online groups, including newsgroups and forums, that are sexually explicit in nature. Erotic stories and textual descriptions of sexual acts. Adult services including videoconferencing, escort services, and strip clubs. Sexually explicit art. http:\/\/playboy.com or http:\/\/union.fr Alcohol and Tobacco Sites that provide information on, promote, or support the sale of alcoholic beverages or tobacco products and associated paraphernalia. http:\/\/thompsoncigar.com or http:\/\/wineinsiders.com Auctions Sites that support the offering and purchasing of goods between individuals as their main purpose. Does not include classified advertisements. http:\/\/ebay.com or http:\/\/quibids.com Business and Economy Business firms, corporate websites , business information, economics, marketing, management, and entrepreneurship http:\/\/samsung.com or http:\/\/ups.com Cheating Sites that support cheating and contain such materials, including free essays, exam copies, plagiarism, etc. http:\/\/wowessays.com or http:\/\/freeessays.cc Computer and Internet Info General computer and Internet sites, technical information. SaaS sites and other URLs that deliver internet services. http:\/\/ranking.com or http:\/\/system.netsuite.com Computer and Internet Security Computer\/Internet security, security discussion groups. General computer and Internet sites, technical information. SaaS sites and other URLs that deliver internet services. https:\/\/www.mcafee.com Content Delivery Networks Delivery of content and data for third parties, including ads, media, files, images, and video http:\/\/akamaitech.net or http:\/\/edgestream.com Cult and Occult Methods, means of instruction, or other resources to interpret, affect or influence real events through the use of astrology, spells, curses, magic powers, satanic or supernatural beings. Includes horoscope sites. http:\/\/horoscopes.com or http:\/\/astronet.hu Dating Dating websites focused on establishing personal relationships http:\/\/dating.com or http:\/\/askmen.com Dynamic Content Domains that generate content dynamically based on arguments to their URL or other information (like geo-location) on the incoming web request Educational Institutions Pre-school, elementary, secondary, high school, college, university, and vocational school and other educational content and information,including enrollment, tuition, and syllabus http:\/\/mit.edu or http:\/\/carlsbadusd.k12.ca.us Entertainment and Arts Motion pictures, videos, television, music and programming guides, books, comics, movie theatres, galleries, artists or reviews on entertainment. Performing arts (theatre, vaudeville, opera, symphonies, etc.). Museums, galleries, artist sites (sculpture, photography, etc.). http:\/\/eonline.com or http:\/\/highlightgallery.com Fashion and Beauty Fashion or glamour magazines, beauty, clothes, cosmetics, style http:\/\/beauty.ivillage.com or http:\/\/genejuarez.com Financial Services Banking services and other types of financial information, such as loans, accountancy, actuaries, banks, mortgages, and general insurance companies. Does not include sites that offer market information, brokerage or trading services. http:\/\/firstpremierbankcards.com or http:\/\/paypal.com Food and Dining Restaurants and food websites (category not currently in use) Gambling Gambling or lottery web sites that invite the use of real or virtual money. Information or advice for placing wagers, participating in lotteries, gambling, or running numbers. Virtual casinos and offshore gambling ventures. Sports picks and betting pools. Virtual sports and fantasy leagues that offer large rewards or request significant wagers. Hotel and Resort sites that do not enable gambling on the site are categorized in Travel or Local Information. http:\/\/gambling.com or http:\/\/www.powerball.com\/pb_home.asp Games Game playing or downloading, video games, computer games, electronic games, tips, and advice on games or how to obtain cheat codes. Also includes sites dedicated to selling board games as well as journals and magazines dedicated to game playing. Includes sites that support or host online sweepstakes and giveaways. Includes fantasy sports sites that also host games or game-playing. http:\/\/duowan.com or http:\/\/games.espn.com Government Information on government, government agencies and government services such as taxation, public, and emergency services. Also includes sites that discuss or explain laws of various governmental entities. Includes local, county, state, and national government sites. http:\/\/nasa.gov or http:\/\/premier-ministre.gouv.fr Gross Vomit and other bodily functions, bloody clothing, etc. http:\/\/ratemyvomit.com or http:\/\/bloody-disgusting.com Hacking Illegal or questionable access to or the use of communications equipment\/software. Development and distribution of programs that may allow compromise of networks and systems. Avoidance of licensing and fees for computer programs and other systems. http:\/\/darkwarez.pl or http:\/\/hackforums.net Hate and Racism Sites that contain content and language in support of hate crimes and racism such as Nazi, neo-Nazi, Ku Klux Klan, etc. http:\/\/nazi-lauck-nsdapao.com or http:\/kkk.com Health and Medicine General health, fitness, well-being, including traditional and non-traditional methods and topics. Medical information on ailments, various conditions, dentistry, psychiatry, optometry, and other specialties. Hospitals and doctor offices. Medical insurance. Cosmetic surgery. http:\/\/webmd.com or http:\/\/health-centerlive.com Home and Garden Home issues and products, including maintenance, home safety, decor, cooking, gardening, home electronics, design, etc. http:\/\/homedepot.com or http:\/\/waysidegardens.com Hunting and Fishing Sport hunting, gun clubs, and fishing http:\/\/fishingworks.com or http:\/\/wildlifelicense.com Illegal Criminal activity, how not to get caught, copyright and intellectual property violations, etc. http:\/\/newid.com or http:\/\/kidneykidney.com Image and Video Search Photo and image searches, online photo albums\/digital photo exchange, image hosting http:\/\/images.google.fr or http:\/\/gettyimages.com Individual Stock Advice and Tools Promotion and facilitation of securities trading and management of investment assets. Also includes information on financial investment strategies, quotes, and news. http:\/\/stockstar.com or http:\/\/morningstar.com Internet Communications Internet telephony, messaging, VoIP services and related businesses http:\/\/skype.com or http:\/\/netzero.net Internet Portals Web sites that aggregate a broader set of Internet content and topics, and which typically serve as the starting point for an end user http:\/\/yahoo.com or http:\/\/qq.com Job Search Assistance in finding employment, and tools for locating prospective employers, or employers looking for employees http:\/\/linkedin.com\/jobs or http:\/\/51job.com Kids Sites designed specifically for children and teenagers http:\/\/disney.go.com or http:\/\/kids.yahoo.com Legal Legal websites, law firms, discussions and analysis of legal issues http:\/\/grahamlegal.org or http:\/\/free-law-library.com Local Information City guides and tourist information, including restaurants, area\/regional information, and local points of interest http:\/\/downtownlittlerock.com or http:\/\/sandiegorestaurants.com Marijuana Marijuana use, cultivation, history, culture, legal issues http:\/\/howtogrowmarijuana.com or http:\/\/cannaweed.com Military Information on military branches, armed services, and military history http:\/\/defense.gov or http:\/\/goarmy.com Motor Vehicles Car reviews, vehicle purchasing or sales tips, parts catalogs. Auto trading, photos, discussion of vehicles including motorcycles, boats, cars, trucks and RVs. Journals and magazines on vehicle modifications. http:\/\/hotautoweb.com or http:\/\/getmyvolt.com Music Music sales, distribution, streaming, information on musical groups and performances, lyrics, and the music business http:\/\/itunes.com or http:\/\/bandcamp.com News and Media Current events or contemporary issues of the day. Also includes radio stations and magazines, newspapers online, headline news sites, newswire services, personalized news services, and weather sites http:\/\/abcnews.go.com or http:\/\/newsoftheworld.co.uk Nudity Nude or seminude depictions of the human body. These depictions are not necessarily sexual in intent or effect, but may include sites containing nude paintings or photo galleries of artistic nature. This category also includes nudist or naturist sites that contain pictures of nude individuals. < https:\/\/www.nude-art-models.com >`_ Online Greeting Cards Online greeting card sites http:\/\/123greetings.com or http:\/\/greeting-cards.com Open HTTP Proxies Proxy server open to any user Pay to Surf Sites that pay users in the form of cash or prizes, for clicking on or reading specific links, email, or web pages http:\/\/cashcrate.com or http:\/\/inboxdollars.com Peer to Peer Peer to peer clients and access. Includes torrents, music download programs. http:\/\/mininova.org or http:\/\/bitcomet.com Personal Sites and Blogs Personal websites posted by individuals or groups, as well as blogs http:\/\/blogger.com or http:\/\/wordpress.org Personal Storage Online storage and posting of files, music, pictures, and other data http:\/\/photobucket.com or http:\/\/box.net Philosophy and Political Advocacy Politics, philosophy, discussions, promotion of a particular viewpoint or stance in order to further a cause http:\/\/stopthefetincrease.com or http:\/\/climatecrisis.net Private IP Addresses Private IP addresses GE3.0.0.0\/8 or 6.0.0.0\/8 Proxy Avoidance and Anonymizers Proxy servers and other methods to gain access to URLs in any way that bypasses URL filtering or monitoring. Web-based translation sites that circumvent filtering. http:\/\/anonymouse.org or http:\/\/surfen-op-school.com Questionable Tasteless humor, get rich quick sites, and sites that manipulate the browser user experience or client in some unusual, unexpected, or suspicious manner http:\/\/collegehumor.com or http:\/\/9gag.com Real Estate Information on renting, buying, or selling real estate or properties. Tips on buying or selling a home. Real estate agents, rental or relocation services, and property improvement. http:\/\/prudentialproperties.com or http:\/\/realtor.com Recreation and Hobbies Information, associations, forums and publications on recreational pastimes such as collecting, kit airplanes, outdoor activities such as hiking, camping, rock climbing, specific arts, craft, or techniques; animal and pet related information, including breed-specifics, training, shows and humane societies. http:\/\/genealogy.com or http:\/\/craftster.org Reference and Research Personal, professional, or educational reference material, including online dictionaries, maps, census, almanacs, library catalogues, genealogy, and scientific information http:\/\/reference.com or http:\/\/wikipedia.org Religion Conventional or unconventional religious or quasi-religious subjects, as well as churches, synagogues, or other houses of worship http:\/\/therocksandiego.org or http:\/\/biblesociety.ca Search Engines Search interfaces using key words or phrases. Returned results may include text, websites, images, videos, and files. http:\/\/google.com or http:\/\/sogou.com Sex Education Information on reproduction, sexual development, safe sex practices, sexually transmitted diseases, sexuality, birth control, sexual development, tips for better sex as well as products used for sexual enhancement, and contraceptives https:\/\/www.o.school or https:\/\/sexetc.org Shareware and Freeware Software, screensavers, icons, wallpapers, utilities, ringtones. Includes downloads that request a donation, and open source projects http:\/\/download.com or http:\/\/sourceforge.net Shopping Department stores, retail stores, company catalogs and other sites that allow online consumer or business shopping and the purchase of goods and services http:\/\/amazon.com or http:\/\/groupon.com Social Networking These are social networking sites that have user communities where users interact, post messages, pictures, and otherwise communicate. These sites were formerly part of Personal Sites and Blogs but have been removed to this new category to provide differentiation and more granular policy. http:\/\/facebook.com or http:\/\/twitter.com Society A variety of topics, groups, and associations relevant to the general populace, broad issues that impact a variety of people, including safety, children, societies, and philanthropic groups http:\/\/dar.org or http:\/\/unicefusa.org Sports Team or conference web sites, international, national, college, professional scores and schedules; sports-related online magazines or newsletters, fantasy sports and virtual sports leagues. http:\/\/nba.com or http:\/\/schoenen-dunk.de Streaming Media Sales, delivery, or streaming of audio or video content, including sites that provide downloads for such viewers http\/\/youtube.com or http:\/\/ustream.tv Swimsuits and Intimate Apparel Swimsuits, intimate apparel or other types of suggestive clothing http:\/\/victoriassecret.com or http:\/\/www.jockey.com Training and Tools Distance education and trade schools, online courses, vocational training, software training, skills training http:\/\/trainingtool.com or http:\/\/prezi.com Translation URL and language translation sites that allow users to see URL pages in other languages. These sites can also allow users to circumvent filtering as the target page's content is presented within the context of the translator's URL. These sites were formerly part of Proxy Avoidance and Anonymizers, but have been removed to this new category to provide differentiation and more granular policy. http:\/\/translate.google.com or http:\/\/microsofttranslator.com Travel Airlines and flight booking agencies. Travel planning, reservations, vehicle rentals, descriptions of travel destinations, or promotions for hotels or casinos. Car rentals. http:\/\/cheapflights.com or http:\/\/expedia.com Violence Sites that advocate violence, depictions, and methods, including game\/comic violence and suicide http:\/\/sfdt.com or http:\/\/happytreefriends.com Weapons Sales, reviews, or descriptions of weapons such as guns, knives or martial arts devices, or provide information on their use, accessories, or other modifications http:\/\/browning.com or http:\/\/e-gunparts.com Web Advertisements Advertisements, media, content, and banners http:\/\/casalemedia.com or http:\/\/justwebads.com Web Based Email Sites offering web based email and email clients http:\/\/google.com\/mail or http:\/\/foxmail.com Web Hosting Free or paid hosting services for web pages and information concerning their development, publication and promotion http:\/\/siteground.com or http:\/\/bluehost.com " }, 
{ "title" : "Supported Documents and Files ", 
"url" : "41866-web-isolation-setup-and-reference/41917-supported-documents-and-files.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Supported Documents and Files ", 
"snippet" : "Introduction This page provides a list of all currently supported document\/file formats. See the following sections for details: Support for additional formats is being added on an on-going basis. As features are rolled out, this page will be updated. Encrypted documents\/files must be decrypted befo...", 
"body" : "Introduction This page provides a list of all currently supported document\/file formats. See the following sections for details: Support for additional formats is being added on an on-going basis. As features are rolled out, this page will be updated. Encrypted documents\/files must be decrypted before they can be isolated in the document\/archive viewer and scanned by some content inspection engines. See for details about creating policy for encrypted document\/file download. MS Office files encrypted with ECMA-376 (Extensible Encryption) or XOR Obfuscation are not currently supported. Other limitations are noted in the tables below. Supported Documents Document Downloads (Original Document) Application File Type (extension) Download Support Not Encrypted or Protected Download in Protected View Encrypted Engineering Visio (vsd, vsdx) Yes N\/A N\/A AutoCad (dwg) Yes N\/A N\/A Presentation PowerPoint (ppt, pptm, pptx) Yes N\/A Yes (post PowerPoint 97-2003) OpenOffice Presentation (odp) Yes N\/A N\/A Hancom HanShow (hsa) Yes N\/A N\/A StarOffice StarImpress (sdd) Yes N\/A N\/A Productivity MS Project (mpp) Yes N\/A N\/A MS One Note (one) Yes N\/A N\/A Spreadsheets Excel (xls, xlsm, xlsx) Yes Yes Yes OpenOffice Spreadsheet (ods) Yes Yes N\/A Hangul Hancom HanCell (hca) Yes N\/A N\/A StarOffice StarCalc (sdc) Yes N\/A N\/A Lotus 123 (123) Yes N\/A N\/A Comma Separated Value (csv) Yes N\/A N\/A Word Processors Word (doc, docm, docx) Yes Yes Yes Ichitaro (jtd) Yes N\/A N\/A Portable Document Format (pdf) Yes N\/A Yes XMP Paper Specification (xps, oxps) Yes N\/A N\/A OpenOffice Text (odt) Yes N\/A N\/A Word Perfect (wp, wpt, wpd) Yes N\/A N\/A Hancom Hanword (hwp) Yes Yes N\/A StarOffice StarWriter (sdw, sgl) Yes N\/A N\/A Lotus WordPro (lwp) Yes N\/A N\/A Other Rich Text Format (rtf) Yes N\/A N\/A StarOffice StarChart (sds) Yes N\/A N\/A StarOffice StarDraw (sda) Yes N\/A N\/A StarOffice StarMath (smf) Yes N\/A N\/A Electronic Publication (epub) Yes N\/A N\/A vCard (vcf) Yes N\/A N\/A Document Downloads (Isolated Documents) Application File Type (extension) Download Support Not Encrypted or Protected Download in Protected View Encrypted Engineering Visio (vsd, vsdx) Yes N\/A N\/A AutoCad (dwg) Yes N\/A N\/A Presentation PowerPoint (ppt, pptm, pptx) Yes, excluding dynamic content (e.g., macros) N\/A Yes, excluding dynamic content (e.g., macros). Post PowerPoint 97-2003 only. OpenOffice Presentation (odp) Yes N\/A N\/A Hancom HanShow (hsa) Yes N\/A N\/A StarOffice StarImpress (sdd) Yes N\/A N\/A Productivity MS Project (mpp) Yes N\/A N\/A MS One Note (one) Yes N\/A N\/A Spreadsheets Excel (xls, xlsm, xlsx) Yes, excluding dynamic content (e.g., macros). Post Excel 5.0\/95 (BIFF) only. Yes, excluding dynamic content (e.g., macros). Post Excel 5.0\/95 (BIFF) only. Yes, excluding dynamic content (e.g., macros). Post Excel 5.0\/95 (BIFF) only. OpenOffice Spreadsheet (ods) Yes, excluding dynamic content (e.g., macros) Yes, excluding dynamic content (e.g., macros) N\/A Hangul Hancom HanCell (hca) Yes N\/A N\/A StarOffice StarCalc (sdc) Yes N\/A N\/A Lotus 123 (123) Yes N\/A N\/A Comma Separated Value (csv) Yes N\/A N\/A Word Processors Word (doc, docm, docx) Yes, excluding dynamic content (e.g., macros) Yes, excluding dynamic content (e.g., macros) N\/A Ichitaro (jtd) Yes N\/A N\/A Portable Document Format (pdf) Yes N\/A Yes XMP Paper Specification (xps, oxps) Yes N\/A N\/A OpenOffice Text (odt) Yes N\/A N\/A Word Perfect (wp, wpt, wpd) Yes N\/A N\/A Hancom Hanword (hwp) Yes Yes N\/A StarOffice StarWriter (sdw, sgl) Yes N\/A N\/A Lotus WordPro (lwp) Yes N\/A N\/A Other Rich Text Format (rtf) Yes N\/A N\/A StarOffice StarChart (sds) Yes N\/A N\/A StarOffice StarDraw (sda) Yes N\/A N\/A StarOffice StarMath (smf) Yes N\/A N\/A Electronic Publication (epub) Yes N\/A N\/A vCard (vcf) Yes N\/A N\/A Document Uploads Application File Type (extension) Upload Support Not Encrypted or Protected Download in Protected View Encrypted Engineering Visio (vsd, vsdx) Yes N\/A N\/A AutoCad (dwg) Yes N\/A N\/A Presentation PowerPoint (ppt, pptm, pptx) Yes N\/A Yes (post PowerPoint 97-2003) OpenOffice Presentation (odp) Yes N\/A N\/A Hancom HanShow (hsa) Yes N\/A N\/A StarOffice StarImpress (sdd) Yes N\/A N\/A Productivity MS Project (mpp) Yes N\/A N\/A MS One Note (one) Yes N\/A N\/A Spreadsheets Excel (xls, xlsm, xlsx) Yes Yes Yes OpenOffice Spreadsheet (ods) Yes Yes N\/A Hangul Hancom HanCell (hca) Yes N\/A N\/A StarOffice StarCalc (sdc) Yes N\/A N\/A Lotus 123 (123) Yes N\/A N\/A Comma Separated Value (csv) Yes N\/A N\/A Word Processors Word (doc, docm, docx) Yes Yes Yes Ichitaro (jtd) Yes N\/A N\/A Portable Document Format (pdf) Yes Yes Yes XMP Paper Specification (xps, oxps) Yes N\/A N\/A OpenOffice Text (odt) Yes N\/A N\/A Word Perfect (wp, wpt, wpd) Yes N\/A N\/A Hancom Hanword (hwp) Yes Yes N\/A StarOffice StarWriter (sdw, sgl) Yes N\/A N\/A Lotus WordPro (lwp) Yes N\/A N\/A Other Rich Text Format (rtf) Yes N\/A N\/A StarOffice StarChart (sds) Yes N\/A N\/A StarOffice StarDraw (sda) Yes N\/A N\/A StarOffice StarMath (smf) Yes N\/A N\/A Electronic Publication (epub) Yes N\/A N\/A vCard (vcf) Yes N\/A N\/A Document Content Inspection Application File Type (extension) Content Inspection Support File Hash Check Full File Scan Sandbox Inspection Engineering Visio (vsd, vsdx) Yes Yes N\/A AutoCad (dwg) Yes Yes N\/A Presentation PowerPoint (ppt, pptm, pptx) Yes Yes Yes OpenOffice Presentation (odp) Yes Yes N\/A Hancom HanShow (hsa) Yes N\/A N\/A StarOffice StarImpress (sdd) Yes N\/A N\/A Productivity MS Project (mpp) Yes Yes N\/A MS One Note (one) Yes Yes N\/A Spreadsheets Excel (xls, xlsm, xlsx) Yes Yes Yes OpenOffice Spreadsheet (ods) Yes Yes N\/A Hangul Hancom HanCell (hca) Yes Yes N\/A StarOffice StarCalc (sdc) Yes Yes N\/A Lotus 123 (123) Yes Yes N\/A Comma Separated Value (csv) Yes Yes N\/A Word Processors Word (doc, docm, docx) Yes Yes Yes Ichitaro (jtd) Yes Yes N\/A Portable Document Format (pdf) Yes Yes Yes XMP Paper Specification (xps, oxps) Yes Yes N\/A OpenOffice Text (odt) Yes Yes N\/A Word Perfect (wp, wpt, wpd) Yes Yes N\/A Hancom Hanword (hwp) Yes Yes N\/A StarOffice StarWriter (sdw, sgl) Yes Yes N\/A Lotus WordPro (lwp) Yes Yes N\/A Other Rich Text Format (rtf) Yes Yes N\/A StarOffice StarChart (sds) Yes Yes N\/A StarOffice StarDraw (sda) Yes Yes N\/A StarOffice StarMath (smf) Yes Yes N\/A Electronic Publication (epub) Yes Yes N\/A vCard (vcf) Yes Yes N\/A Supported Archives and Compressed Packages Archive Downloads (Original Archive) Archive\/Compressed Package Type (extension) Download Support Not Encrypted or Protected Download in Protected View Encrypted 7-zip Archive (7z) Yes (N\/A if archive includes password-protected file) N\/A Yes (N\/A if archive includes password-protected file) ARJ Archive (arj) Yes (N\/A if archive includes password-protected file) N\/A Yes (N\/A if archive includes password-protected file) Bzip2 Archive (bz2, bzip) Yes (N\/A if archive includes password-protected file) N\/A No Microsoft Cabinet Compressed File (cab) Yes (N\/A if archive includes password-protected file) N\/A No Gnu Gzip (gzip) Yes (N\/A if archive includes password-protected file) N\/A No LZH Archive (lzh) Yes (N\/A if archive includes password-protected file) N\/A No Roshel Archive Compressed File (rar) Yes (N\/A if archive includes password-protected file) N\/A Yes (v1-v4 only). N\/A if archive includes password-protected file. Tape Archive (tar) Yes (N\/A if archive includes password-protected file) N\/A No Zip Archive (zip) Yes (N\/A if archive includes password-protected file) N\/A Yes ISO image (iso) Yes N\/A N\/A Archive Downloads (Isolated Archive) Archive\/Compressed Package Type (extension) Download Support Not Encrypted or Protected Download in Protected View Encrypted 7-zip Archive (7z) Yes N\/A Yes ARJ Archive (arj) Yes N\/A Yes Bzip2 Archive (bz2, bzip) Yes N\/A No Microsoft Cabinet Compressed File (cab) Yes N\/A No Gnu Gzip (gzip) Yes N\/A No LZH Archive (lzh) Yes N\/A No Roshel Archive Compressed File (rar) Yes (v1-v4 only) N\/A Yes (v1-v4 only) Tape Archive (tar) Yes N\/A N\/A Zip Archive (zip) Yes N\/A Yes ISO image (iso) Yes N\/A N\/A Archive Uploads Archive\/Compressed Package Type (extension) Upload Support Not Encrypted or Protected Upload in Protected View Encrypted 7-zip Archive (7z) Yes (N\/A if archive includes password-protected file) N\/A Yes (N\/A if archive includes password-protected file) ARJ Archive (arj) Yes (N\/A if archive includes password-protected file) N\/A Yes (N\/A if archive includes password-protected file) Bzip2 Archive (bz2, bzip) Yes (N\/A if archive includes password-protected file) N\/A N\/A Microsoft Cabinet Compressed File (cab) Yes (N\/A if archive includes password-protected file) N\/A N\/A Gnu Gzip (gzip) Yes (N\/A if archive includes password-protected file) N\/A N\/A LZH Archive (lzh) Yes (N\/A if archive includes password-protected file) N\/A N\/A Roshel Archive Compressed File (rar) Yes (N\/A if archive includes password-protected file) N\/A Yes (v1-v4 only). N\/A if archive includes password-protected file. Tape Archive (tar) Yes (N\/A if archive includes password-protected file) N\/A N\/A Zip Archive (zip) Yes (N\/A if archive includes password-protected file) N\/A Yes (N\/A if archive includes password-protected file) ISO image (iso) Yes N\/A N\/A Archive Content Inspection Archive\/Compressed Package Type (extension) Content Inspection Support File Hash Check Full File Scan Sandbox Inspection 7-zip Archive (7z) Yes Yes Yes ARJ Archive (arj) Yes Yes Yes Bzip2 Archive (bz2, bzip) Yes Yes N\/A Microsoft Cabinet Compressed File (cab) Yes Yes N\/A Gnu Gzip (gzip) Yes Yes N\/A LZH Archive (lzh) Yes Yes N\/A Roshel Archive Compressed File (rar) Yes Yes Yes (v1-v4 only) Tape Archive (tar) Yes Yes N\/A Zip Archive (zip) Yes Yes Yes ISO image (iso) Yes Yes N\/A Supported Files File Downloads (Original File) Application File Type (extension) Original File Download Support Not Encrypted or Protected Upload in Protected View Encrypted Scripts and Executables Windows executable (com, exe, dll, msi, scr) Yes N\/A N\/A Linux executable (ELF 32-bit LSB, ELF 64-bit LSB, rpm, deb) Yes N\/A N\/A Mac executable (Mach-O 64-bit, Mach-O i386) Yes N\/A N\/A Script (py, reg, sh vb, vbe, bat, vbs, cmd, msh, msi, pif, msc, ps1) Yes N\/A N\/A Java (jar, war, ear) Yes N\/A N\/A Multimedia Audio (mp2, mp3, wav, ra) Yes N\/A No Video (mpg, 3gp, mp4, webm) Yes N\/A No Calendar iCalendar (ics) Yes N\/A No PostScript PostScript (ps) Yes N\/A N\/A Microsoft Database Microsoft Access (accdb, snp, mdb) Yes N\/A N\/A Flash Content Flash Content (swf, flv) Yes N\/A N\/A Custom Extension\/MIME Type (user-defined) Yes N\/A N\/A File Downloads (Isolated Files) Application File Type (extension) Isolated File Download Support Not Encrypted or Protected Upload in Protected View Encrypted Scripts and Executables Windows executable (com, exe, dll, msi, scr) N\/A N\/A N\/A Linux executable (ELF 32-bit LSB, ELF 64-bit LSB, rpm, deb) N\/A N\/A N\/A Mac executable (Mach-O 64-bit, Mach-O i386) N\/A N\/A N\/A Script (py, reg, sh vb, vbe, bat, vbs, cmd, msh, msi, pif, msc, ps1) N\/A N\/A N\/A Java (jar, war, ear) N\/A N\/A N\/A Multimedia Audio (mp2, mp3, wav, ra) N\/A N\/A N\/A Video (mpg, 3gp, mp4, webm) N\/A N\/A N\/A Calendar iCalendar (ics) N\/A N\/A N\/A PostScript PostScript (ps) N\/A N\/A N\/A Microsoft Database Microsoft Access (accdb, snp, mdb) N\/A N\/A N\/A Flash Content Flash Content (swf, flv) N\/A N\/A N\/A Custom Extension\/MIME Type (user-defined) N\/A N\/A N\/A File Uploads Application File Type (extension) Upload Support Not Encrypted or Protected Upload in Protected View Encrypted Scripts and Executables Windows executable (com, exe, dll, msi, scr) Yes N\/A N\/A Linux executable (ELF 32-bit LSB, ELF 64-bit LSB, rpm, deb) Yes N\/A N\/A Mac executable (Mach-O 64-bit, Mach-O i386) Yes N\/A N\/A Script (py, reg, sh vb, vbe, bat, vbs, cmd, msh, msi, pif, msc, ps1) Yes N\/A N\/A Java (jar, war, ear) Yes N\/A N\/A Multimedia Audio (mp2, mp3, wav, ra) Yes N\/A N\/A Video (mpg, 3gp, mp4, webm) Yes N\/A N\/A Calendar iCalendar (ics) Yes N\/A N\/A Custom Extension\/MIME Type (user-defined) Yes N\/A N\/A File Content Inspection Application File Type (extension) Content Inspection Support File Hash Check Full File Scan Sandbox Inspection Scripts and Executables Windows executable (com, exe, dll, msi, scr) Yes Yes Yes Linux executable (ELF 32-bit LSB, ELF 64-bit LSB, rpm, deb) Yes Yes N\/A Mac executable (Mach-O 64-bit, Mach-O i386) Yes Yes N\/A Script (py, reg, sh vb, vbe, bat, vbs, cmd, msh, msi, pif, msc, ps1) Yes Yes N\/A Java (jar, war, ear) Yes Yes N\/A Multimedia Audio (mp2, mp3, wav, ra) Yes Yes N\/A Video (mpg, 3gp, mp4, webm) Yes Yes N\/A Calendar iCalendar (ics) Yes Yes N\/A Custom Extension\/MIME Type (user-defined) Yes Yes N\/A " }, 
{ "title" : "Encrypted Documents and Files ", 
"url" : "41866-web-isolation-setup-and-reference/41918-encrypted-documents-and-files.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Web Isolation Setup and Reference \/ Encrypted Documents and Files ", 
"snippet" : "Introduction This page describes the policy actions available for encrypted documents and files. Encrypted documents\/files must be decrypted before they can be isolated in the document\/archive viewer and scanned by some content inspection engines. Policy options allow control over the action taken: ...", 
"body" : "Introduction This page describes the policy actions available for encrypted documents and files. Encrypted documents\/files must be decrypted before they can be isolated in the document\/archive viewer and scanned by some content inspection engines. Policy options allow control over the action taken: Password Prompt : Users are prompted for passwords for decryption Skip Inspection : Encrypted files are allowed through (Content Inspection that requires decrypted files is skipped) Do not prompt : Content Inspection runs and blocks the download if an encrypted file is present The Encrypted File\/Document policy currently only applies to Downloads . This policy will be extended to Uploads in a future release. The Menlo Security File Hash Check does not require file decryption. You can set this policy for documents, files, and individual document and file types that support decryption. You can also set this policy in the Document and File Download Exceptions. The default and recommended option is to Password Prompt . Documents and Files Policy Exceptions Policy Encrypted downloads will allow up to three incorrect password entry attempts before the download is blocked. Refer to ??? for policy examples (that assume a content inspection option in use requires decryption). ??? provides summary tables for the action taken when policy is set by Document\/Files Policy or Document\/File Download Exception Policy . MS Office files encrypted with ECMA-376 (Extensible Encryption) or XOR Obfuscation are not currently supported. Other limitations are noted in the tables below. Encrypted Documents\/Files Policy Examples The following examples assume that at least one content inspection option is enabled that requires that the file\/document be decrypted so it can be scanned. Encrypted Files\/Documents set to Password Prompt on documents and files with policy set to: Allow : The encrypted file or document will be Isolated and the password must be input by the user to display in the viewer. The original file download will be Allowed once the decrypted file is scanned and is clean. Isolate : The encrypted file or document will be Isolated and the password must be input by the user to display in the viewer. The original file download will be Allowed once the decrypted file is scanned and is clean if Original Download Policy is set to only Block if an infection is found. Block : The encrypted file or document is Blocked . We do not prompt for a password. Encrypted Files\/Documents set to Skip Inspection on documents and files with policy set to: Allow : Content inspection requiring a decrypted file will be skipped and document\/archive isolation will not occur. The encrypted file or document will be Allowed . This setting is not recommended as it bypasses some or all content inspection and document\/archive isolation. Isolate : Content inspection requiring a decrypted file will be skipped and document\/archive isolation will not occur. The encrypted file or document will be Allowed or Blocked based on the Original Download policy specified for this file type. This setting is not recommended as it bypasses some or all content inspection and document\/archive isolation. Block : The encrypted file or document is Blocked . We do not prompt for a password. Encrypted Files\/Documents set to Do not prompt on documents and files with policy set to: Allow : Content inspection requiring a decrypted file will be run as normal. If any content inspection option requires a decrypted version of the file or document, the plugin will fail and apply the \"action on failure\" policy, which is normally a block action. Document\/archive isolation will not occur. The encrypted file or document will be Blocked unless no content inspection requiring the decrypted file needed to be run, in which case the file or document will be Allowed . Isolate : Content inspection requiring a decrypted file will be run as normal. If any content inspection option requires a decrypted version of the file or document, the plugin will fail and apply the \"action on failure\", policy which is normally a Block action. Document\/archive isolation will not occur. The encrypted file or document will be Blocked unless no content inspection requiring the decrypted file needed to be run, in which case the file or document will be Allowed or Blocked based on the Original Download policy specified for this file type. Block : The encrypted file or document is Blocked . We do not prompt for a password. If you have a Document or File Download Exception Policy with the following conditions: Action: Isolate Encrypted Document\/File policy: Skip The Original Document\/File Download checkbox determines whether the original file can be accessed. By default, this checkbox is set to Block original Document\/File downloads. Encrypted Document\/File Policy and Exception Policy Actions Encrypted Document\/File Policy with Content Inspection Enabled Site Policy Isolate Allow Isolate\/Block Original if Virus Detected Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt No Prompt Block Isolate\/Always Block Original Download Password Prompt Request Password Request Password (Original Download Blocked) Skip Inspection Block Block Do Not Prompt Block Block Allow\/Block Original if Virus Detected Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Block Block Allow\/Always Allow (Uncheck \"Block\") Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Direct Download Direct Download Encrypted Document\/File Policy with Content Inspection Disabled (except Hash Enabled or Disabled) Site Policy Isolate Allow Isolate\/Allow Original Download Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Direct Download Direct Download Isolate\/Always Block Original Download Password Prompt Request Password Request Password Skip Inspection Block Block Do Not Prompt Block Block Allow Password Prompt Direct Download Direct Download Skip Inspection Direct Download Direct Download Do Not Prompt Direct Download Direct Download Encrypted Document\/File Download Exception with Content Inspection Enabled Site Policy Isolate Allow Isolate\/Allow Original Download Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Block Block Isolate\/Always Block Original Download Password Prompt Request Password Request Password Skip Inspection Block Block Do Not Prompt Block Block Allow Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Block Block Encrypted Document\/File Download Exception with Content Inspection Disabled (except Hash Enabled or Disabled) Site Policy Isolate Allow Isolate\/Allow Original Download Password Prompt Request Password Request Password Skip Inspection Direct Download Direct Download Do Not Prompt Direct Download Direct Download Isolate\/Always Block Original Download Password Prompt Request Password Request Password Skip Inspection Block Block Do Not Prompt Block Block Allow Password Prompt Direct Download Direct Download Skip Inspection Direct Download Direct Download Do Not Prompt Direct Download Direct Download " }, 
{ "title" : "Email Isolation ", 
"url" : "41868-email-isolation.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Email Setup Essentials Guide ", 
"url" : "41868-email-isolation/41919-email-setup-essentials-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Setup Essentials Guide ", 
"snippet" : "This guide provides an introduction to the Menlo Security Email Isolation service. The following topics are covered: Information about setting up your virtual machine and installing the Email Isolation appliance is available in . Information about setting up rules and configuring the Email Isolation...", 
"body" : "This guide provides an introduction to the Menlo Security Email Isolation service. The following topics are covered: Information about setting up your virtual machine and installing the Email Isolation appliance is available in . Information about setting up rules and configuring the Email Isolation appliance is available in . " }, 
{ "title" : "Introduction to Setting Up Email Isolation ", 
"url" : "41868-email-isolation/41919-email-setup-essentials-guide/41920-introduction-to-setting-up-email-isolation.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Setup Essentials Guide \/ Introduction to Setting Up Email Isolation ", 
"snippet" : "Description The Menlo Security Isolation Platform (MSIP) is the foundation for all Menlo Security Services, including Web Isolation and Email Isolation. These services can be used separately or together to protect your users: The Web Isolation service uses disposable containers to isolate and\/or blo...", 
"body" : "Description The Menlo Security Isolation Platform (MSIP) is the foundation for all Menlo Security Services, including Web Isolation and Email Isolation. These services can be used separately or together to protect your users: The Web Isolation service uses disposable containers to isolate and\/or block web pages. This service is available as a Cloud service or On-Prem using your own servers and virtual machines. Information about setting up a virtual machine and installing the Web Isolation appliance for On-Prem is available in . For more information about the Cloud service, refer to . The Email Isolation service leverages the Isolation Platform to perform the same isolation as the Web service for pages opened via email links. In addition, it provides key functionality not possible with just the Web service: Risk Score calculation on links to block known bad and allow administratively controlled options on any other type of link (including full isolation and isolation combined with read-only controls to avoid credential theft). Configurable workflow for training users to respond appropriately to emails with links and attachments, including surfacing information about the clicked link and resulting site to help users make informed decisions. Other solutions relying only on training or only on good\/bad analysis simply can't stop today's sophisticated attacks. Menlo Security combines the best of several approaches including blocking the known malicious, using Isolation to secure everything else and training the users throughout the process. This combination of approaches protects users from not only the simple regular phishing campaigns, but also the most dangerous spear-phishing attacks for which no good\/bad signature exists. Required Open Ports and Network Access In most deployments, outbound traffic to the Menlo Security Isolation Platform doesn't need any special firewall configuration. The necessary outbound ports are already allowed by default in the network. However, some deployments allow nothing except the existing proxy or filter all outbound traffic. In these cases refer to the table below. Use caution when opening outbound ports: only open necessary ports. Use the domain name of the server when possible to account for live resolution; otherwise, use the IP address of the server as indicated. Menlo Security can add IP addresses as needed over time. Server Port Access (TCP Outbound) Functionality\/Details safe.menlosecurity.com 443 Isolation platform access admin.menlosecurity.com 443 Needed for administrators isolate.menlosecurity.com 443 Isolation platform access " }, 
{ "title" : "Email Flow and Concepts ", 
"url" : "41868-email-isolation/41919-email-setup-essentials-guide/41921-email-flow-and-concepts.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Setup Essentials Guide \/ Email Flow and Concepts ", 
"snippet" : "Email Isolation is designed to deal with the following threats from malicious email links: Malware Infections: Menlo Security can stop malicious code from getting injected into the user's system when the site is opened. Credential and Data Loss: Menlo Security can make sure users do not accidentally...", 
"body" : "Email Isolation is designed to deal with the following threats from malicious email links: Malware Infections: Menlo Security can stop malicious code from getting injected into the user's system when the site is opened. Credential and Data Loss: Menlo Security can make sure users do not accidentally type their sensitive information (for example username and password) into a site which isn't legitimate. Aside from the regular management and MSIP service infrastructure, Email Isolation is achieved by the use of a link Transform and Restore process. The SMTP Proxy model with a Transform and Restore Appliance is described below; this model can vary depending on how you integrate (Connectors or SMTP Proxy). An email is received by the customer and goes through any of the company's normal external filtering (e.g., spam filtering) The Menlo Security Transform SMTP proxy appliance opens the email and inspects the URLs inside it. All non-whitelisted links are rewritten to point to the isolation platform when they are clicked. Domains added to the whitelist are not rewritten. These domains can be imported from a file, selected from a list of most popular sites, or manually entered by an admin. The message is sent to the email server and delivered to the user. When a user clicks a link in their email, Menlo Security computes a risk score for that URL. Menlo Security applies a user-configurable policy using the risk score to the web page when opening it in the isolation platform. Menlo Security uses both industry standard feeds and a checklist of other security factors (matches against known bad phishing feeds, common phishing terms in the URL, variations in URL length, domain age, presence of fake domain components, etc.) to calculate the Risk Score. High risk pages can be completely blocked by the isolation platform. A block page explains why the page was blocked. If an email link is leading to a phishing attack (known bad), then there is no reason to allow the user to access that site (you can simply block it). High Risk Example Medium risk pages may be opened in a read-only mode. A banner at the top of the page explains why the page was opened in this mode. If allowed, the user may be able to click a button and open the page in read-write mode. Medium Risk Example Low risk pages may be opened in standard read-write mode, but a banner at the top of the page can caution the user and provide some information about the domain, including the registration location. Low Risk Example If the email is forwarded to another person, the Restore appliance converts the URLs back to their original pointers. " }, 
{ "title" : "Email Integration Options ", 
"url" : "41868-email-isolation/41919-email-setup-essentials-guide/41922-email-integration-options.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Setup Essentials Guide \/ Email Integration Options ", 
"snippet" : "Cloud Connectors Connectors allow the Menlo Security Email Isolation service in the cloud to integrate with other cloud email services. Both Office 365 and Gmail are described below. Office 365 The high level configuration steps in Office 365 to route emails for select users include the following: A...", 
"body" : "Cloud Connectors Connectors allow the Menlo Security Email Isolation service in the cloud to integrate with other cloud email services. Both Office 365 and Gmail are described below. Office 365 The high level configuration steps in Office 365 to route emails for select users include the following: Add Menlo Security's Email Isolation Platform as an Office365-Menlo Mail Connector. Add rules to exempt emails originating from Menlo Security Email IP ranges. Add rules to reroute emails for specific users to the connector. Refer to for more information. Hybrid MTA The high level configuration steps When setting up a hybrid deployment include the following: Configure your upstream servers to route traffic to the Menlo Security Email Platform. Configure your downstream servers to accept traffic from Menlo Security Email Platform. Configure required uses to use this configuration. Refer to the for more information. Gmail The high level configuration steps in Gmail to route emails for select users include the following: Add a sub organization so you can choose a subset of users. Add the Menlo Security Email Platform host. Configure content compliance rules to reroute emails to Menlo Security. Whitelist Menlo Security Email IP ranges in the inbound gateway. Add users to the sub organization. Refer to for more information. SMTP Proxy Deployment The Menlo Security Email appliance can be deployed from a single OVA and configured in one of two modes: Transform or Restore . In either Transform or Restore mode the appliance has both a Mail Proxy component as well as a URL Re-writer component. In the case of Transform mode the URL re-writer alters the links in the email message to point them to the Menlo Security Isolation Platform. The Restore mode appliance is responsible for removing the link modification so when a message leaves the organization there are no links back to the Isolation Platform (which wouldn't be available to outside organizations). In addition, optional Attachment Worker appliances can be added to generate Safe PDF versions of attachments and perform content inspection and malware analysis on email attachments. These appliances are deployed and added to the Central Manager to work with the Transform node. At least one Attachment Worker appliance is needed if the attachment policy is configured to either add Safe PDF versions of attachments to emails or to perform policy decisions based on Attachment Risk identified by content inspection. Attachment Content Inspection is a separately licensed feature. Please contact Menlo Security for details. The following is a high level diagram of the flow. " }, 
{ "title" : "Email Administration Essentials Guide ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide ", 
"snippet" : "The following topics are covered in this guide:...", 
"body" : "The following topics are covered in this guide: " }, 
{ "title" : "Introduction to Email Isolation Administration ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41924-introduction-to-email-isolation-administration.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Introduction to Email Isolation Administration ", 
"snippet" : "This guide outlines the administration essentials for using and managing the Menlo Security Email Isolation service. The service checks links in email and applies risk scores to them. These scores can then be used to implement security policy. High scores are provided for known phishing sites (and c...", 
"body" : "This guide outlines the administration essentials for using and managing the Menlo Security Email Isolation service. The service checks links in email and applies risk scores to them. These scores can then be used to implement security policy. High scores are provided for known phishing sites (and can be blocked), medium scores trigger popups and webpage banners that warn and educate the user, and low scores usually simply isolate links. This guide assumes the Email Isolation service has already been installed and configured. For details, refer to . " }, 
{ "title" : "Logs ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41925-logs.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Logs ", 
"snippet" : "Introduction The Logs tab provides access to panes with detailed information about all traffic and any actions taken by the proxy service. Note that only administrators have access to these panes. Use the filter buttons at the top of each pane to configure the list displayed below. Web Logs This pan...", 
"body" : "Introduction The Logs tab provides access to panes with detailed information about all traffic and any actions taken by the proxy service. Note that only administrators have access to these panes. Use the filter buttons at the top of each pane to configure the list displayed below. Web Logs This pane provides information about web traffic and actions taken by Menlo Security Web Isolation. Refer to for details about the web isolation product. Email Logs This pane provides detailed information about all email traffic and any actions taken by the proxy service. Use the toggle at the top of the pane to choose the type of email logs to view: Rewrite Logs , SMTP Logs , or Attachment Logs . The Rewrite Logs can be filtered by any of the following categories: User group : The ability to group users will be available in a future release. Time period : Click to select the time period to view in the log below. Receiver : Click to filter by a specific email receiver. Sender : Click to filter by a specific email sender. Domain : Click to filter by a domain URL. Subject : Click to filter by an email subject. Message ID : Click to enter a message ID to use as a filter. Message Charset : Click to enter a message character set to use as a filter. Actions taken : Click to sort by action taken: All Actions , Not Transformed , Transformed , or Whitelist . Reasons : Click to sort by reason given for isolation: All Reasons , Default Transform , Private Name , Private IP , Popular Sites , Manual , File Import , Malformed URL , Whitelist Undefined , Unsupported Char . If more than one filter is selected, the list is filtered by all filters in place (i.e., AND conditions are supported, but OR conditions are not supported). After changing any filters, click the Filter button to view the updated list. Click the Clear button to remove all filters from the list. The SMTP Logs can be filtered by any of the following categories: User group : The ability to group users will be available in a future release. Time period : Click to select the time period to view in the log below. Receiver : Click to filter by a specific email receiver. Sender : Click to filter by a specific email sender. Message ID : Click to enter a message ID to use as a filter. Actions taken : Click to sort by action taken: All Actions , Accepted , All Errors , Rejected , Aborted , or Sent Unmodified . Reasons : Click to sort by reason given for the action taken. Directions : Click to sort by email isolation appliance: Both directions , Transform , or Restore . SMTP Code : Click to enter a SMTP status code to filter the list by (e.g., 451 to search for message delivery failures). The Attachments Logs can be filtered by any of the following categories: User group : The ability to group users will be available in a future release. Time period : Click to select the time period to view in the log below. Receiver : Click to filter by a specific email receiver. Sender : Click to filter by a specific email sender. Audit Logs This pane provides detailed information about all actions taken and events that occurred in the web proxy service. Refer to for details about the web isolation product. " }, 
{ "title" : "Editing Email Policies and Importing Whitelists ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41926-editing-email-policies-and-importing-whitelists.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Editing Email Policies and Importing Whitelists ", 
"snippet" : "Introduction The Email Policy panes configure the policies used to manage email processing. Email Isolation can be configured through the application of Link Policy (Link Isolation and Mobile Policy panes) and Link (Email) Settings (Whitelist, Phish Target, and URL Transform panes). Link Isolation T...", 
"body" : "Introduction The Email Policy panes configure the policies used to manage email processing. Email Isolation can be configured through the application of Link Policy (Link Isolation and Mobile Policy panes) and Link (Email) Settings (Whitelist, Phish Target, and URL Transform panes). Link Isolation The Isolation Policy Rules pane is used to create and manage isolation policy rules. There are two isolation rule types available: Standard : These rules compare the assigned risk score against the selected User Experience mode, Entry Action , and Exit Action . Advanced : These rules are used to bypass standard rules for specific user-defined URLs. They can be applied to specific users or to all users and groups. The selected Menlo Security action is applied to User Experience mode, Entry Action , and Exit Action . To create an isolation policy rule: Open the Isolation pane ( Email Policy -> Link Policy -> Link Isolation ). To import policy rules from a file, select the Import\/Export pulldown menu and choose Import Rules . Use the Browse function to select the saved rules file and select Import . One Default Action rule is provided. To modify these settings, select the Edit button. If desired, you can also manually add additional isolation policy rules by selecting the Add New Rule button. Configure the default or new rule in the window that appears. When ready, select Save Changes to save new or changed rule, and then select Publish to start using them. For all rule types, use the Must Match pull-down menu to force enforcement of the new rule if Any or All of the conditions below match. Use the Attribute fields to define the rule attributes. For Standard Rules , the Attribute can be set to User or Group . For Advanced Rules , the Attribute must be a URL that you define using the Relation and Value fields on the right. Set the attribute Relation to any of the following: Equals , Does Not Equal , Contains , Starts with , and Ends with . For the Value field enter a string value. Click the + icon to add additional attributes to the rule. For Advanced Rules , this is a URL. Configure the user experience or application of the rules: For Standard Rules , the Menlo Risk Score , User Experience , Entry Action , and Exit Action pull-down menus configure the user experience type if the rule is matched. More information is provided below. For Advanced Rules , there is no Menlo Risk Score , but the same User Experience , Entry Action , and Exit Action pull-down menus configure the user experience type if the rule is matched. You can configure if this will apply to all users and groups, or define the users\/groups in the fields immediately above the user experience. More information about the , and is provided below. Menlo Risk Score The Menlo Risk Score is calculated by Menlo Security by analyzing all URLs (by domain age, character patterns, URL length, etc.) that are not whitelisted by your administrator. Your administrator can then customize the experience based on the risk level associated with the linked web page (low, medium, or high). This is applicable for Standard Rules only. Menlo Security uses both industry standard feeds and a checklist of other security factors (matches against known bad phishing feeds, common phishing terms in the URL, variations in URL length, domain age, presence of fake domain components, etc.) to calculate the Risk Score. User Experience The User Experience configures the level of training to provide. Standard rules allow for all of the following modes; Advanced rules only provide Basic and No Banner modes. Basic mode is designed to be minimally invasive. A customizable message appears at the top of the page. Usually the page is loaded as an isolated page in \"Read-Write\" mode. Educate mode provides a first level of phish training. A customizable message appears at the top of the page with information about why the page was opened in this mode. Usually this page is loaded as an isolated page in Read-Only mode, and the user may or may not be allowed to click on the banner to open a writeable page. Coach mode provides the highest level of phish training. A pop-up window that explains why the user is in a protected mode opens when the link is clicked, and the window contains additional context-sensitive warning messages (e.g., the URL elements that triggered the risk score). Coach can also be used on a block page. The following figure shows an example of the additional phish training on a blocked page. No Banner mode opens the links in pre-pend mode, but there will be no banner for training at the top of the page. This mode is non-invasive, but the user is still protected by isolation. Note that because there is no banner, there is no exit mode for this option. Entry and Exit Actions The Entry Action pull-down menu configures the allowed actions when a user clicks on a link. This is applicable for Standard and Advanced rules only. Read-Only opens an isolated page with web forms disabled. Read-Write will allow the user to open the page and submit info on any web forms, but this page is isolated (so website malware cannot be injected into the user's system). Connect Direct opens the page without isolation. Block prevents the page from being opened. The Exit Action pull-down menu configures the allowed actions after the page is opened. The following are supported: Read-Write , Connect Direct , and Not Allowed . Mobile Policy The Mobile Exceptions pane allows you to define rules that will bypass standard rules for specific user-defined URLs. They are applied to all mobile users. The selected Assigned Risk is used to determine how the isolation rules are applied. To create a mobile exception isolation policy rule: Open the Mobile Exceptions pane ( Email Policy -> Link Policy -> Mobile Policy ). To modify settings on any rule, select the Edit button next to the rule. If desired, you can also manually add additional isolation policy rules by selecting the Add New Rule button. Configure the default or new rule in the window that appears. When ready, select Save Changes to save new or changed rule, and then select Publish to start using them. Use the Attribute fields to define the rule attributes. Enter one ore more URL entries that are defined using the Relation and Value fields on the right. Set the attribute Relation to any of the following: Equals , Does Not Equal , Contains , Starts with , and Ends with . For the Value field enter a string value. Click the + icon to add additional attributes to the rule. Use the Position pull-down menu to move the new\/modified rule to the top or bottom of the exceptions rules list. You can also drag and drop rules to re-order them. Configure the Assigned Risk value by selecting Low, Medium, or High from the pull-down menu. Users The Users List pane can be used to define groups of users via their email addresses. You can define the group by either directly entering email addresses into the Add Users List dialog, or you can upload a .txt file containing the list of email addresses with one email address per line . User lists can be used within the pane to define group-wide policy. For example, a user list of all Marketing Department users can be created so a set of attachment policies will be defined based on this group. If enabled for your tenant, you can create a user list that uses a synchronized AD group. Please see for more information. Email Settings Whitelist Whitelists are domains that are privileged and allowed to pass through Email Isolation without isolation or blocking. Whitelists are managed from the Whitelist pane. To set up or import a whitelist: Open the Whitelist pane ( Email Policy -> Email Settings -> Whitelist ). To manually add domains, enter the domain in the Domain field and select Add . The entry appears below with a Manual source. If creating a whitelist rule on a full URL (instead of just a domain), select Add and enter the URL. URLs with a similar domain will be merged, and any email that contains the path is matched and whitelisted. A warning box appears before whitelisted URLs are merged. Select Continue to merge. The merged \"path\" URLs will appear in a single rule for that domain. Once it is saved, you can click the Edit button from the Whitelist pane to modify\/manage the paths. To import domains from a file or from the list of the most popular domains, select the Import From pull-down menu and select either Popular Sites or File . Select the Import button to import the domains\/URLs. Check the checkboxes to select items to add, and then select the Add Selected Items button. Select the Save Changes button and then the Publish button to save and start using the new whitelist. Phish Target The Phish Targets pane can be used to define custom, environment-specific phish targets. These targets are used in conjunction with other risk factors used by the Menlo risk scoring algorithm to improve the identification of low, medium, and high risk URLs. For example, if your company is a phish target, you can enter your company name ( mycompany ); links that go to another domain ( mycompany.phish.com ) are given a higher risk score and are picked up by email isolation. More information about the Menlo risk scoring algorithm is provided here: . To add a phish target: Open the Phish Targets pane ( Email Policy -> Email Settings -> Phish Target ). Click the Add button and enter the desired name in the window that appears. Note that email isolation will search for this exact term before .com in any email links, but it will not pick up variations in the name (e.g., it will look for companyname , but not company-name ). If desired, add a description. Click Save to continue. The phish target is added. Click Save Changes and then Publish to add the target to your email isolation policy. URL Transform Check any of the following boxes to configure URL rewrite or obfuscation: Check the Enable Transformation of Subject URLs checkbox if you wish to rewrite links found in email subject fields. Check the Enable URL Obfuscation checkbox if you wish the link to be obfuscated so a user cannot copy and paste the link into a browser. Note that if both Enable Transformation of Subject URLs and Enable URL Obfuscation checkboxes are checked, links found in the email subject will also be obfuscated. Check the Enable Tenant Encoding checkbox if you wish to encode the tenant ID in the rewritten url (e.g., safe.menlosecurity.com\/1\/967837383\/www.example.com ) to allow for tenant-based features. Enter the tenant ID in the field that appears below. Check the Enable URL Transform Exceptions checkbox if you wish to configure specific actions (Obfuscate, Tenant Encoding, or Prepend the URL) for a user list. The actions are applied to all people in the selected group. Attachments Settings Several panels are provided to configure and manage the Email Attachment Isolation feature. This feature allows the user to filter user and attachment types, and to configure attachment isolation. More information about this feature is provided below. Email Attachment Isolation is a licensed feature. For information about enabling this feature, contact Menlo Security. If the source MTA sends a single email with multiple recipients in the envelope, any one of those recipients will cause the mail attachments to be isolated for all recipients of the email for which email isolation is in use. User List Caching The email-to-user-list cache exists independently on each email worker node and uses the email address as a key. Cache entries are populated on addresses from both the sender and recipients of an email (which includes FROM:, TO:, CC:, and BCC). Cache entries persist for one hour. Cache reads do not extend the life of a cache entry. However, if an email includes an address that is not in the cache, all addresses in that email get their cache refreshed (including addresses already in the cache). After a refresh the one hour TTLs are reset. Addresses that are not in any groups are also cached as such in the same way. Emails for all domains get cached -- not just the domains that the customer uses. Attachments Policy The Attachments Policy pane can be used to configure email attachment isolation. When this feature is enabled, email attachments can be selectively blocked (removed) from the email or isolated (encoded and re-attached to the email as an html attachment type). If isolated, the following occurs when the recipient views the attachment: The attachment is isolated by MSIP, scanned, and either allowed or blocked for download or The attachment is sent to Document Isolation for safe viewing. It is also possible to specify a policy of Isolate + Safe PDF that isolates the attachment and additionally attaches a \"Safe PDF\" version of the attachment into the email with the filename <original filename>_safe.pdf . The Isolate + Safe PDF features can only attach Safe PDF versions of non-encrypted document-type attachments that can be re-rendered as a Safe PDF without disrupting the flow of email. Attachments that do not meet this criteria are still isolated, but there will not be the additional <original filename>_safe.pdf attachment version added to the email. Additionally note that though the email recipient can quickly view the Safe PDF in their native PDF viewer (permitting access to these attachments when offline), the preferred solution is to use the isolated attachment option as this opens it within the MSIP platform that provides higher security levels. In on-premise environments Isolate + Safe PDF functionality is only available if Attachment Worker appliances are deployed and added to the same appliance group as the Email Transform appliances. This pane specifies the set of policy rules used for attachment analysis and their processing order (top down). If a rule matches an attachment type and any entries in the From and To lines, the specified action is taken. A Default Rule specifies what should happen to attachments that do not match any of the given rules (the default action is to allow all attachments). To create a rule: Click the Add New Rule button. Enter a Rule Name and Description for the rule. Use the Sender and Receiver fields to select the applicable user lists(s) (or \"all\") who are affected by the new attachment rule. Press Next to continue. Select Common and\/or General attachment types to isolate by checking the relevant checkbox(es). Press Next to continue. Select the rule precedence order using the Position pull-down menu (note that saved rules can also be reordered by dragging and dropping them in the Attachments Policy pane). The Action menu determines what is done with the attachment (allow, block or isolate). Attachment Risk Analysis If Attachment Risk Analysis with ReversingLabs has been enabled it is possible to add a Risk option in the attachment policy rules based on Content Inspection results. There are three Content Inspection options available: Do not Inspect : The attachment is not inspected by ReversingLabs. Send for Offline Analysis : The attachment is inspected by ReversingLabs, but the results will not form part of the attachment policy. The results are also not logged by Menlo Security; they are available in the ReversingLabs appliance for later offline analysis. Retrieve File Risk Rating : The content inspection results are used to assign a risk (\"High\", \"Medium\", or \"Low\") which can be incorporated into the attachment policy to determine an outcome ( Allow , Isolate , or Block ) for attachments that match this rule. The analysis results will be available in the MSIP logs. You can use the Content Inspection and Risk options to design an attachment policy to ensure that different actions are taken based on the identified risk of any attachment. For example, block high risk attachments, isolate medium risk attachments, and allow low risk attachments. Isolated attachments are also reassessed for risk using further content inspection when they are opened (if configured in the Web Policy for Content Inspection under Web Policy -> Documents & Files ). Attachment Risk Analysis with ReversingLabs is a licensed feature. For information about enabling this feature, contact Menlo Security. " }, 
{ "title" : "Email Isolation Policy Dashboard ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41927-email-isolation-policy-dashboard.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Email Isolation Policy Dashboard ", 
"snippet" : "Introduction The Dashboard tab provides various widgets that display information about traffic and threats identified by the MSIP. The following panes are provided: The Overview pane has the key widgets from the other tabs, as well as Virus Scan information (if this feature is enabled). The Dashboar...", 
"body" : "Introduction The Dashboard tab provides various widgets that display information about traffic and threats identified by the MSIP. The following panes are provided: The Overview pane has the key widgets from the other tabs, as well as Virus Scan information (if this feature is enabled). The Dashboard first opens to this pane. The Threat Analysis pane provides information about the domains and events that were flagged as threats. The Traffic Analysis pane provides information about web traffic and any actions taken by the proxy service. The Email Analysis pane provides information about email links, user clicks and any actions taken by the Menlo Security Email Isolation Platform. The Email Traffic pane provides information about the numbers of emails processed and error actions and error reasons identified by email isolation. Refer to for details about the widgets in the Overview , Threat Analysis and Traffic Analysis panes. Only the email isolation widgets are described below. Use the filter buttons ( Groups and Time ) to update the widgets on the Overview pane for the selected filter. The Time filter updates the widgets for the selected time period (e.g., last 12 hours). The Groups filter (e.g., Administrator) updates the widgets for the selected group. Filtering the Overview pane allows you to quickly view relevant data for the user group type or a specific time period without having to go through and filter each widget individually. Click the Expand icon in the top right corner of each widget to expand the widget and view additional information. To return to the pane, click the Close icon in the top right corner of the expanded widget. You can also drill in and view more specific data by selecting a threat\/domain from the expanded widget. Expand a widget (e.g., \"Top Category Clicks\"). Select a category by clicking on the graph (e.g., \"Travel\"). Click on the graph to view the pre-filtered Web Logs pane for the selection. All of the widgets available from the Email Analysis and Email Traffic panes are described below. The ordering of the widgets is configurable and may vary on your installation. Select and drag any widget on the pane to re-order the widgets displayed. Top User Clicks This widget displays a count of all transformed URL clicks by each user. Top Category Clicks This widget displays the email URL clicks sorted by category. Both the total click count and the last access time are provided. Threat Type Clicks This widget displays the count and last access time for URL clicks sorted by threat type (low risk, phishing, flash, etc.). Menlo Risk Score Clicks This widget displays the count and last access time for URL clicks sorted by their low\/medium\/high Menlo Risk Score. Menlo Security uses both industry standard feeds and a checklist of other security factors (matches against known bad phishing feeds, common phishing terms in the URL, variations in URL length, domain age, presence of fake domain components, etc.) to calculate the Risk Score. Links Observed This widget displays the count of URL links that are transformed, restored, and unmodified each day. Exit Mode Behavior This widget displays the count and last access time for each exit mode behavior used by the isolation appliance. The following actions can be configured in your email policy: Read-Write : Users may open the linked pay and submit information, but malware cannot be injected into the user's system. Read-Only : An isolated page opens with all web forms disabled. Connect Direct : Page opens without isolation. Block : Page cannot be opened. Exit Mode Behavior -- Read-Write This widget displays the count and last access time for URL links that used the Read-Write exit mode behavior. Exit Mode Behavior -- Connect Direct This widget displays the count and last access time for URL links that used the Connect Direct exit mode behavior. Emails Processed This widget displays the date and count of all emails processed by the isolation appliance. Total Time This widget displays the date, count, and average time (in seconds) required to process emails. Errors (count) This widget displays the numbers of errors encountered in email isolation sorted by action: rejected, aborted, or sent unmodified. Error Actions This widget displays the total count for the following error action types: rejected or aborted. Error Reasons This widget displays a count of SMTP error reasons and the action associated with each. " }, 
{ "title" : "Email Settings ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41928-email-settings.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Email Settings ", 
"snippet" : "Introduction Email Isolation is managed by two appliances: a Transform appliance that receives incoming email, checks the links, and rewrites links (e.g., https:\/\/www.phishinglink.com is rewritten as https:\/\/email.example.com\/www.phishinglink.com ) and a Restore appliance that un-writes the link cha...", 
"body" : "Introduction Email Isolation is managed by two appliances: a Transform appliance that receives incoming email, checks the links, and rewrites links (e.g., https:\/\/www.phishinglink.com is rewritten as https:\/\/email.example.com\/www.phishinglink.com ) and a Restore appliance that un-writes the link change when the email is sent on (e.g., if the email is forwarded). Additionally, Attachment Worker appliances can be deployed to analyze email attachments passed to it from Transform appliances. Transform appliances will automatically find and load balance between any Attachment Worker appliances in the same Central Manager appliance group. Transform and Restore appliances will perform the wrapping\/re-writing. Email Attachment Worker appliances are only used for generating Safe PDF versions of attachments when Attachment Analysis has been enabled on the Transform appliances. Attachment Analysis is a licensable feature; please contact Menlo Security for more information. Mail Settings Use the Mail Settings pane to configure the following: URL Processing : Configures the mode (Transform or Restore) and Isolation Platform Hostname. Destination Mailserver : Configures the hostname, port, and TLS requirements for the destination mailserver. Authorized Senders : Configures sender authorization (all senders allowed or restrict senders by IP address or IP range). Attachment Analysis : Configures email isolation to allow, block, isolate, or analyze documents in real time, based on policy configurations. This is a separately licensed feature. Please contact Menlo Security to enable this feature. ReversingLabs Offline Analysis (On-Prem only) : Configures the appliance to push attachments to the external ReversingLabs service to view email attachments in isolation (threat assessment by ReversingLabs is not yet available). This is a separately licensed feature which requires the implementation of the Attachment Analysis feature as a prerequisite. If a policy is set to do real-time scanning by ReversingLabs, the attachment is scanned once the email is received. If there is a document policy for sandboxing, the sandbox will scan at document download time. Thus, if both of these policies are configured, two scans will be done at different times using two different providers. Use the Mail Settings pane to manage attachment analysis performed during mail processing. If enabled on Email Isolation, the Transform nodes will send attachments to the Attachment Worker in the same group. The Attachment Worker then analyzes the attachments and apply the specified policy. In the case of risk-based attachment analysis, you should specify the ReversingLabs host (and optionally the port) and authentication token here. If you are using ReversingLabs with a self-signed certificate, please ensure that it has been added to the list of CA Certificates on the Attachment Worker Settings tab. Both Attachment Analysis and ReversingLabs integration are separately licensable features. Please contact Menlo Security for more information. Appliance Settings Use the Settings panes to configure networking, logging, and user management in the Email Isolation appliance. The following panes are provided: Network Settings : Configures appliance network settings (DHCP or Static IP). Service Settings : Configures the management group and the certificate file for appliance communication. Proxy : Configures the upstream internet proxy host and port. Logs and Alerts : Configures the logging server. User Management : Configures authentication requirements. Web Settings : If Require Authentication for Web is set to Yes , user authentication is required before web pages are opened (e.g., from an LDAP server). If Get Identity for X-Authenticated-User Header is set to Yes , the user authentication is obtained from a previous device (e.g., from a Blue Coat box that performs authentication). Email Settings : If Require Authentication for Web is set to Yes , user authentication is required before web pages are opened from the email isolation appliance. Active Directory LDAP authentication settings : Configures the Active Directory LDAP connection type, host, port, and domain information. Active Directory Administrator Authentication : Enables or disables AD admin authentication for the username entered here. Dynamic User Policies : Configures user account lookup and revocation checks, as well as the service account and service account password. " }, 
{ "title" : "Email Customization ", 
"url" : "41868-email-isolation/41923-email-administration-essentials-guide/41929-email-customization.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Administration Essentials Guide \/ Email Customization ", 
"snippet" : "The Email Isolation appliance warns users if a website link in an email is suspicious. Customers can customize the warning message and button text, add a link to your company policy, and define the CSS styles and logo used in the banner or block page. To perform customization: Log into the Central M...", 
"body" : "The Email Isolation appliance warns users if a website link in an email is suspicious. Customers can customize the warning message and button text, add a link to your company policy, and define the CSS styles and logo used in the banner or block page. To perform customization: Log into the Central Manager appliance, and open the Email Customization pane ( Customization -> Email ). Use the pulldown menus to select a default Banner Theme or Block Page Theme . The blue links below provide a preview of the theme in use. For more customization, check the Setup Custom Settings checkbox and use the tabs to customize text, CSS styles, and the logo used in the banner or block page. Select the Reset button to return to the default settings, or select Save Changes to save them. Select Publish to implement the new customization. " }, 
{ "title" : "Email Deployment Guide: Google G Suite Gmail ", 
"url" : "41868-email-isolation/41930-email-deployment-guide--google-g-suite-gmail.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Deployment Guide: Google G Suite Gmail ", 
"snippet" : "Introduction This guide outlines the configuration of Google G Suite Gmail with Email Isolation from Menlo Security. Email Isolation works in tandem with Gmail to rewrite links in email. When users click on links, they are sent to the Menlo Security Isolation Platform (MSIP) that protects them from ...", 
"body" : "Introduction This guide outlines the configuration of Google G Suite Gmail with Email Isolation from Menlo Security. Email Isolation works in tandem with Gmail to rewrite links in email. When users click on links, they are sent to the Menlo Security Isolation Platform (MSIP) that protects them from phishing and malware attacks. The Isolation Platform also renders the web site in read-only mode to prevent credential theft. With Email Isolation, the MX records for your company continue to point to the Gmail servers. Using Content Compliance rules, inbound email is rerouted to Menlo Security's Inbox MTA where the links are rewritten and sent back to the inbox. Similarly, outbound email (recipients outside your organization) are rerouted to Menlo Security's Outbox MTA where the rewritten links are removed and sent back to the Gmail SMTP Relay Service. This neatly sidesteps any DomainKeys Identified Mail (DKIM) or Sender Policy Framework (SPF) issues since Menlo Security servers are not designated as a trusted sender of your organization's email. Configuration is comprised of the following steps: Configure Required Hosts: Route mail to Email Isolation Transform Route Mail to Email Isolation Restore Modify General Settings: Accept mail from Email Isolation Transform Route mail to Email Isolation to be transformed Route mail to Email Isolation to be restored Accept mail from Email Isolation Restore These steps are described in more detail in the sections below. Configure Required Hosts Email Isolation configuration requires two hosts. Log into the G Suite Admin Console, go to the Advanced settings for Gmail, and click on Hosts . Refer to G Suite Administration Help: Configure Advanced Settings for Gmail for details. Click the ADD ROUTE button to add the new mail routes. Enter the following settings to add the Route mail to Email Isolation Transform host: The <ID> component of the Email server name shown below must be replaced by the identifier assigned to you. This will take the form of a 32-character hexadecimal number. Name: Route mail to Email Isolation Transform Specify email server: Single host Email server: transform0-<ID>.menlosecurity.com : 25 Select the following options: Require TLS delivery and Require CA signed certificate Enter the following settings to add the Route mail to Email Isolation Restore host: The <ID> component of the Email server name shown below must be replaced by the identifier assigned to you. This will take the form of a 32-character hexadecimal number. Name: Route mail to Email Isolation Restore Specify email server: Single host Email server: restore0-<ID>.menlosecurity.com : 25 Select the following options: Require TLS delivery and Require CA signed certificate Modify General Settings The Spam, Compliance, and Routing settings are modified to support Email Isolation. Gmail settings can be arranged into organizational units that act as containers for specific subsets of users within an organization. All settings must be made on the root organization unless indicated otherwise. Spam In the Gmail Advanced Settings, open the General Settings tab. Scroll down to the Spam section. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Configure the following Inbound Gateway settings in the Add setting dialog box: Description: Accept mail from Email Isolation Transform Gateway IPs: Add the following IP addresses: us-east-1 34.202.62.128\/27 us-west-1 13.56.32.0\/27 eu-west-1 52.215.251.0\/27 eu-central-1 52.59.184.0\/27 eu-west-2 35.177.154.0\/27 ap-northeast-1 13.115.242.0\/27 ap-southeast-1 13.229.252.0\/27 ap-south-1 13.127.70.0\/27 ap-northeast-2 13.124.145.128\/27 ap-southeast-2 13.210.1.128\/27 us-east-1 (legacy) 23.21.65.62 54.235.203.168 54.163.243.220 54.225.122.232 174.129.42.141 184.73.162.55 Uncheck Automatically detect external IP (recommended) Connections: Require TLS for connections from the email gateways listed above Message Tagging: Message is considered spam if the following header regexp matches Regexp: ^(?i:X-Gm-Spam:\\s*([0-9.-]+))$ Regexp extracts a numeric score Message is considered spam if extracted numeric score is: Select: Greater than or equal to and enter a value of 1 Check Disable Gmail spam evaluation on mail from this gateway; only use header value Click ADD SETTING . Compliance Two content compliance settings are required for Email Isolation configuration. In the Gmail Advanced Settings, open the General Settings tab. Scroll down to the Content Compliance section, and click the CONFIGURE button adjacent to the heading. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Add a Route mail to Email Isolation to be transformed compliance setting with the following settings in the Add setting dialog box: This setting may be added to organization units instead of the root organization to apply email transformation to only a subset of users. Alternatively, this setting may be applied to the root organization and then disabled in any required organization units by selecting the organization unit, locating the Route mail to Email Isolation to be transformed entry, and clicking on the DISABLE \/ USE INHERITED toggle button. Description: Route mail to Email Isolation to be transformed Email messages to affect: Inbound Add expressions that describe the content you want to search for in each message: If ALL of the following match the message Metadata match: us-east-1 Attribute: Source IP . Match Type: is not within the following range: 34.202.62.128\/27 us-west-1 Attribute: Source IP . Match Type: is not within the following range: 13.56.32.0\/27 eu-west-1 Attribute: Source IP . Match Type: is not within the following range: 52.215.251.0\/27 eu-central-1 Attribute: Source IP . Match Type: is not within the following range: 52.59.184.0\/27 eu-west-2 Attribute: Source IP . Match Type: is not within the following range: 35.177.154.0\/27 ap-northeast-1 Attribute: Source IP . Match Type: is not within the following range: 13.115.242.0\/27 ap-southeast-1 Attribute: Source IP . Match Type: is not within the following range: 13.229.252.0\/27 ap-south-1 Attribute: Source IP . Match Type: is not within the following range: 13.127.70.0\/27 ap-northeast-2 Attribute: Source IP . Match Type: is not within the following range: 13.124.145.128\/27 ap-southeast-2 Attribute: Source IP . Match Type: is not within the following range: 13.210.1.128\/27 us-east-1 (legacy) Attribute: Source IP . Match Type: is not within the following range: 23.21.65.62 Attribute: Source IP . Match Type: is not within the following range: 54.235.203.168 Attribute: Source IP . Match Type: is not within the following range: 54.163.243.220 Attribute: Source IP . Match Type: is not within the following range: 54.225.122.232 Attribute: Source IP . Match Type: is not within the following range: 174.129.42.141 Attribute: Source IP . Match Type: is not within the following range: 184.73.162.55 If the above expressions match, do the following: Select Modify message in the dropdown box Headers: Add X-Gm-Spam and X-Gm-Phishy headers Route: Change route and Also reroute spam Select Route mail to Email Isolation Transform Encryption (onward delivery only) Require secure transport (TLS) Click Show options Account types of affect: Users , Groups , and Unrecognized\/Catch-all It will not be possible to affect Group or Unrecognized \/ Catch-all account types unless this setting is applied to the root organization. Click ADD SETTING . Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Add a Route mail to Email Isolation to be restored compliance setting to the Edit setting dialog box: Description: Route mail to Email Isolation to be restored Email messages to affect: Outbound Add expressions that describe the content you want to search for in each message: If ALL of the following match the message Metadata match: us-east-1 Attribute: Source IP . Match Type: is not within the following range: 34.202.62.160\/27 us-west-1 Attribute: Source IP . Match Type: is not within the following range: 13.56.32.32\/27 eu-west-1 Attribute: Source IP . Match Type: is not within the following range: 52.215.251.32\/27 eu-central-1 Attribute: Source IP . Match Type: is not within the following range: 52.59.184.32\/27 eu-west-2 Attribute: Source IP . Match Type: is not within the following range: 35.177.154.32\/27 ap-northeast-1 Attribute: Source IP . Match Type: is not within the following range: 13.115.242.32\/27 ap-southeast-1 Attribute: Source IP . Match Type: is not within the following range: 13.229.252.32\/27 ap-south-1 Attribute: Source IP . Match Type: is not within the following range: 13.127.70.32\/27 ap-northeast-2 Attribute: Source IP . Match Type: is not within the following range: 13.124.145.160\/27 ap-southeast-2 Attribute: Source IP . Match Type: is not within the following range: 13.210.1.160\/27 us-east-1 (legacy) Attribute: Source IP . Match Type: is not within the following range: 54.225.194.201 Attribute: Source IP . Match Type: is not within the following range: 50.16.230.34 Attribute: Source IP . Match Type: is not within the following range: 54.197.237.108 Attribute: Source IP . Match Type: is not within the following range: 54.221.216.72 Attribute: Source IP . Match Type: is not within the following range: 54.243.221.103 Attribute: Source IP . Match Type: is not within the following range: 184.73.234.203 If the above expressions match, do the following: Select Modify message in the dropdown box Route: Change route and Also reroute spam Select Route mail to Email Isolation Restore Encryption (onward delivery only) Require secure transport (TLS) Click Show options Account types of affect: Users , Groups , and Unrecognized\/Catch-all It will not be possible to affect Group or Unrecognized \/ Catch-all account types unless this setting is applied to the root organization. Click ADD SETTING . Routing In the Gmail Advanced Settings, click on the General Settings tab. Scroll down to the SMTP relay service section. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Configure the following SMTP relay service settings: Description: Accept mail from Email Isolation Restore Allowed senders: Only addresses in my domains Authentication: Only accept email from the following IP addresses: us-east-1 Add 34.202.62.160\/27 us-west-1 Add 13.56.32.32\/27 eu-west-1 Add 52.215.251.32\/27 eu-central-1 Add 52.59.184.32\/27 eu-west-2 Add 35.177.154.32\/27 ap-northeast-1 Add 13.115.242.32\/27 ap-southeast-1 Add 13.229.252.32\/27 ap-south-1 Add 13.127.70.32\/27 ap-northeast-2 Add 13.124.145.160\/27 ap-southeast-2 Add 13.210.1.160\/27 us-east-1 (legacy) Add 54.225.194.201 Add 50.16.230.34 Add 54.197.237.108 Add 54.221.216.72 Add 54.243.221.103 Add 184.73.234.203 Encryption: Require TLS encryption Temporary Disabling Rules In the event there is an issue and you want to remove Menlo Security from the email processing path, you can disable the rules routing email to the transform and restore nodes. The rules you need to disable (if you followed the instructions above) are as follows: Route mail to Email Isolation to be transformed Route mail to Email Isolation to be restored For Gmail there is a DISABLE \/ ENABLE toggle button visible when hovering the mouse over the content compliance rule. Disable both rules. " }, 
{ "title" : "Email Deployment Guide: Microsoft Office 365 ", 
"url" : "41868-email-isolation/41931-email-deployment-guide--microsoft-office-365.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Email Isolation \/ Email Deployment Guide: Microsoft Office 365 ", 
"snippet" : "Introduction This guide outlines the configuration of Office 365 Exchange to incorporate Email Isolation from Menlo Security. Email Isolation works in tandem with Office 365 to rewrite links in email. When users click on links, they are sent to the Menlo Security Isolation Platform (MSIP) that prote...", 
"body" : "Introduction This guide outlines the configuration of Office 365 Exchange to incorporate Email Isolation from Menlo Security. Email Isolation works in tandem with Office 365 to rewrite links in email. When users click on links, they are sent to the Menlo Security Isolation Platform (MSIP) that protects them from drive-by-downloads and malware. The Isolation Platform can also render the web site in read-only mode to prevent phishing and spear-phishing attacks. Configuration is comprised of the following steps: Gather Domains to be Isolated Add Email Isolation Connectors: Route mail to Email Isolation Transform Connector Route mail to Email Isolation Restore Connector Accept mail from Email Isolation Restore Connector Add Email Isolation Rules: Route mail to Email Isolation to be Transformed Rule Route mail to Email Isolation to be Restored Rule Accept mail from Email Isolation Transform Rule Accept spam from Email Isolation Transform Rule Accept high confidence spam from Email Isolation Transform Rule These steps are described in more detail in the sections below. A PowerShell module that offers automated configuration of the Email Isolation integration is also available (see: MSIP.ExchangeOnline PowerShell module ). Gather Domains to be Isolated First, we need to gather the list of domains for which email is to be isolated. This list must be submitted to Menlo Security to be registered against your tenant. It will also be required when adding the email isolation rules (see Add Email Isolation Rules). The list of mail domains accepted by your Office 365 account may be viewed by: Log into the Office 365 Admin Center and open the Mail Flow pane. Refer to the Microsoft Exchange Admin Center Page for details. Select accepted domains . Add Email Isolation Connectors To add the Email Isolation connectors that will be used to reroute emails so any links in the emails are rewritten. Log into the Office 365 Admin Center and open the Mail Flow pane. Refer to the Microsoft Exchange Admin Center Page for details. To create new connectors, select connectors and click the + icon to add a new connector. Configure the Route mail to Email Isolation Transform connector with the following settings: Select your mail flow scenario: From: Office 365 To: Your organization's email server New connector: Name: Route mail to Email Isolation Transform Description: Route incoming mail to be transformed by Email Isolation When do you want to use this connector: Select the Only when I have a transport rule set up that redirects messages to this connector radio button. How do you want to route email messages: The <ID> component of the smart host name shown below must be replaced by the identifier assigned to you. This will take the form of a 32-character hexadecimal number. Click the + icon to add the following smart host: transform0-<ID>.menlosecurity.com How should Office 365 connect to your email server: Select the checkbox Always use Transport Layer Security (TLS) to secure the connection (recommended) Connect only if the recipient's email server certificate matches this criteria . Then select Issued by a trusted certificate authority (CA) and And the subject name or subject alternative name (SAN) matches this domain name: Then enter the following domain name: transform.menlosecurity.com Validate: Click the + icon to add the following: validate@transform.menlosecurity.com . Click Validate . Office 365 will validate the Email Isolation connector. Once complete, click Save . Configure the Route mail to Email Isolation Restore connector with the following settings: Select your mail flow scenario: From: Office 365 To: Your organization's email server New connector: Name: Route mail to Email Isolation Restore Description: Route outgoing mail to be restored by Email Isolation When do you want to use this connector: Select the Only when I have a transport rule set up that redirects messages to this connector checkbox. How do you want to route email messages: The <ID> component of the smart host name shown below must be replaced by the identifier assigned to you. This will take the form of a 32-character hexadecimal number. Click the + icon to add the following smart host: restore0-<ID>.menlosecurity.com How should Office 365 connect to your email server: Check the Always use Transport Layer Security (TLS) to secure the connection (recommended) checkbox. From the list below Connect only if the recipient's email server certificate matches this criteria , select Issued by a trusted certificate authority (CA) and And the subject name or subject alternative name (SAN) matches this domain name: and enter restore.menlosecurity.com Validate: Click the + icon to add the following: validate@restore.menlosecurity.com . Click Validate . Office 365 will validate the Email Isolation connector. Once complete, click Save . Configure the Accept mail from Email Isolation Restore connector with the following settings and click Save when complete: Select your mail flow scenario: From: Your organization's email server To: Office 365 New connector: Name: Accept mail from Email Isolation Restore Description: Accept incoming mail once restored by Email Isolation How should Office 365 identify email from your email server: Select By verifying that the subject name on the certificate that the sending server uses to authenticate with Office 365 matches this domain name (recommended) and enter restore.menlosecurity.com Add Email Isolation Rules Configuration requires the following rules to route emails to Email Isolation for transform and restore. Configure the rules as follows: The intended behavior of these rules may be influenced by the presence of other rules manipulating email messages' attributes and routing. The precise ordering and conditional logic associated with these rules should be evaluated within the context of any pre-existing rules in order to achieve the exact mail flow desired. Log into the Office 365 Admin Center and open the Mail Flow pane. Refer to the Microsoft Exchange Admin Center Page for details. To create new rules, select rules and click the + icon and select Create a new rule... Create the Route mail to Email Isolation to be transformed rule with the following settings: Click on More options... at the bottom of the form to enable the required additional settings. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Name: Route mail to Email Isolation to be transformed Apply this rule if...: Choose The sender... then is external\/internal and select Outside the organization Click on add condition , choose The recipient... then domain is Individually enter each domain from the list of domains to be isolated (see Gather Domains to be Isolated) and click the + icon. Optionally click on add condition , choose The recipient... then is this person and add the list of users in order to apply email transformation to only a subset of users. Do the following...: Choose Redirect the message to... then the following connector and select Route mail to Email Isolation Transform Except if...: Click on add exception , choose The sender... then IP address is in any of these ranges or exactly matches and us-east-1 Enter the following CIDR range 34.202.62.128\/27 and click the + icon us-west-1 Enter the following CIDR range 13.56.32.0\/27 and click the + icon eu-west-1 Enter the following CIDR range 52.215.251.0\/27 and click the + icon eu-central-1 Enter the following CIDR range 52.59.184.0\/27 and click the + icon eu-west-2 Enter the following CIDR range 35.177.154.0\/27 and click the + icon ap-northeast-1 Enter the following CIDR range 13.115.242.0\/27 and click the + icon ap-southeast-1 Enter the following CIDR range 13.229.252.0\/27 and click the + icon ap-south-1 Enter the following CIDR range 13.127.70.0\/27 and click the + icon ap-northeast-2 Enter the following CIDR range 13.124.145.128\/27 and click the + icon ap-southeast-2 Enter the following CIDR range 13.210.1.128\/27 and click the + icon us-east-1 (legacy) Enter the following IP address 23.21.65.62 and click the + icon Enter the following IP address 54.235.203.168 and click the + icon Enter the following IP address 54.163.243.220 and click the + icon Enter the following IP address 54.225.122.232 and click the + icon Enter the following IP address 174.129.42.141 and click the + icon Enter the following IP address 184.73.162.55 and click the + icon Check the Stop processing more rules checkbox. Create the Route mail to Email Isolation to be restored rule with the following settings: Click on More options... at the bottom of the form to enable the required additional settings. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Name: Route mail to Email Isolation to be restored Apply this rule if...: Choose The recipient... then is external\/internal and select Outside the organization Click on add condition , choose The sender... then domain is Individually enter each domain from the list of domains to be isolated (see Gather Domains to be Isolated) and click the + icon. Do the following...: Choose Redirect the message to... then the following connector and select Route mail to Email Isolation Restore . Except if...: Click on add exception , choose The sender... then IP address is in any of these ranges or exactly matches and us-east-1 Enter the following CIDR range 34.202.62.160\/27 and click the + icon us-west-1 Enter the following CIDR range 13.56.32.32\/27 and click the + icon eu-west-1 Enter the following CIDR range 52.215.251.32\/27 and click the + icon eu-central-1 Enter the following CIDR range 52.59.184.32\/27 and click the + icon eu-west-2 Enter the following CIDR range 35.177.154.32\/27 and click the + icon ap-northeast-1 Enter the following CIDR range 13.115.242.32\/27 and click the + icon ap-southeast-1 Enter the following CIDR range 13.229.252.32\/27 and click the + icon ap-south-1 Enter the following CIDR range 13.127.70.32\/27 and click the + icon ap-northeast-2 Enter the following CIDR range 13.124.145.160\/27 and click the + icon ap-southeast-2 Enter the following CIDR range 13.210.1.160\/27 and click the + icon us-east-1 (legacy) Enter the following IP address 54.225.194.201 and click the + icon Enter the following IP address 50.16.230.34 and click the + icon Enter the following IP address 54.197.237.108 and click the + icon Enter the following IP address 54.221.216.72 and click the + icon Enter the following IP address 54.243.221.103 and click the + icon Enter the following IP address 184.73.234.203 and click the + icon Check the Stop processing more rules checkbox. Create the Accept mail from Email Isolation Transform rule with the following settings: Click on More options... at the bottom of the form to enable the required additional settings. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Name: Accept mail from Email Isolation Transform Apply this rule if...: Choose A message header... then matches these text patterns and Click on Enter text... and specify header name X-Forefront-Antispam-Report-Untrusted Click on Enter text patterns... and Enter the following pattern SCL:-1 and click the + icon Enter the following pattern SCL:0 and click the + icon Enter the following pattern SCL:1 and click the + icon Enter the following pattern SCL:2 and click the + icon Enter the following pattern SCL:3 and click the + icon Enter the following pattern SCL:4 and click the + icon Click on add condition , choose The sender... then IP address is in any of these ranges or exactly matches and us-east-1 Enter the following CIDR range 34.202.62.128\/27 and click the + icon us-west-1 Enter the following CIDR range 13.56.32.0\/27 and click the + icon eu-west-1 Enter the following CIDR range 52.215.251.0\/27 and click the + icon eu-central-1 Enter the following CIDR range 52.59.184.0\/27 and click the + icon eu-west-2 Enter the following CIDR range 35.177.154.0\/27 and click the + icon ap-northeast-1 Enter the following CIDR range 13.115.242.0\/27 and click the + icon ap-southeast-1 Enter the following CIDR range 13.229.252.0\/27 and click the + icon ap-south-1 Enter the following CIDR range 13.127.70.0\/27 and click the + icon ap-northeast-2 Enter the following CIDR range 13.124.145.128\/27 and click the + icon ap-southeast-2 Enter the following CIDR range 13.210.1.128\/27 and click the + icon us-east-1 (legacy) Enter the following IP address 23.21.65.62 and click the + icon Enter the following IP address 54.235.203.168 and click the + icon Enter the following IP address 54.163.243.220 and click the + icon Enter the following IP address 54.225.122.232 and click the + icon Enter the following IP address 174.129.42.141 and click the + icon Enter the following IP address 184.73.162.55 and click the + icon Do the following...: Choose Modify the message properties... then set the spam confidence level (SCL) and select Bypass spam filering . Create the Accept spam from Email Isolation Transform rule with the following settings: Click on More options... at the bottom of the form to enable the required additional settings. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Name: Accept spam from Email Isolation Transform Apply this rule if...: Choose A message header... then matches these text patterns and Click on Enter text... and specify header name X-Forefront-Antispam-Report-Untrusted Click on Enter text patterns... and Enter the following pattern SCL:5 and click the + icon Enter the following pattern SCL:6 and click the + icon Click on add condition , choose The sender... then IP address is in any of these ranges or exactly matches and us-east-1 Enter the following CIDR range 34.202.62.128\/27 and click the + icon us-west-1 Enter the following CIDR range 13.56.32.0\/27 and click the + icon eu-west-1 Enter the following CIDR range 52.215.251.0\/27 and click the + icon eu-central-1 Enter the following CIDR range 52.59.184.0\/27 and click the + icon eu-west-2 Enter the following CIDR range 35.177.154.0\/27 and click the + icon ap-northeast-1 Enter the following CIDR range 13.115.242.0\/27 and click the + icon ap-southeast-1 Enter the following CIDR range 13.229.252.0\/27 and click the + icon ap-south-1 Enter the following CIDR range 13.127.70.0\/27 and click the + icon ap-northeast-2 Enter the following CIDR range 13.124.145.128\/27 and click the + icon ap-southeast-2 Enter the following CIDR range 13.210.1.128\/27 and click the + icon us-east-1 (legacy) Enter the following IP address 23.21.65.62 and click the + icon Enter the following IP address 54.235.203.168 and click the + icon Enter the following IP address 54.163.243.220 and click the + icon Enter the following IP address 54.225.122.232 and click the + icon Enter the following IP address 174.129.42.141 and click the + icon Enter the following IP address 184.73.162.55 and click the + icon Do the following...: Choose Modify the message properties... then set the spam confidence level (SCL) and select 6 . Create the Accept high confidence spam from Email Isolation Transform rule with the following settings: Click on More options... at the bottom of the form to enable the required additional settings. Note that the IP ranges will vary between different rules. Take care to enter the correct IP range list for each rule. Name: Accept high confidence spam from Email Isolation Transform Apply this rule if...: Choose A message header... then matches these text patterns and Click on Enter text... and specify header name X-Forefront-Antispam-Report-Untrusted Click on Enter text patterns... and Enter the following pattern SCL:7 and click the + icon Enter the following pattern SCL:8 and click the + icon Enter the following pattern SCL:9 and click the + icon Click on add condition , choose The sender... then IP address is in any of these ranges or exactly matches and us-east-1 Enter the following CIDR range 34.202.62.128\/27 and click the + icon us-west-1 Enter the following CIDR range 13.56.32.0\/27 and click the + icon eu-west-1 Enter the following CIDR range 52.215.251.0\/27 and click the + icon eu-central-1 Enter the following CIDR range 52.59.184.0\/27 and click the + icon eu-west-2 Enter the following CIDR range 35.177.154.0\/27 and click the + icon ap-northeast-1 Enter the following CIDR range 13.115.242.0\/27 and click the + icon ap-southeast-1 Enter the following CIDR range 13.229.252.0\/27 and click the + icon ap-south-1 Enter the following CIDR range 13.127.70.0\/27 and click the + icon ap-northeast-2 Enter the following CIDR range 13.124.145.128\/27 and click the + icon ap-southeast-2 Enter the following CIDR range 13.210.1.128\/27 and click the + icon us-east-1 (legacy) Enter the following IP address 23.21.65.62 and click the + icon Enter the following IP address 54.235.203.168 and click the + icon Enter the following IP address 54.163.243.220 and click the + icon Enter the following IP address 54.225.122.232 and click the + icon Enter the following IP address 174.129.42.141 and click the + icon Enter the following IP address 184.73.162.55 and click the + icon Do the following...: Choose Modify the message properties... then set the spam confidence level (SCL) and select 9 . Save the new rules. At this point, all chosen recipients will have their emails automatically forwarded to Menlo Security's Email Isolation. All links in the emails are rewritten so that when they are clicked on the user is taken to the link in the Menlo Security Isolation Platform. Temporary Disabling of Email Isolation In the event that you wish to temporarily disable Email Isolation from the mail flow, then this may be achieved by clearing the ON checkboxes adjacent to the Route Mail to Email Isolation to be Transformed Rule and Route Mail to Email Isolation to be Restored Rule rules. " }, 
{ "title" : "Private Cloud (Legacy Admin Portal) ", 
"url" : "41870-private-cloud--legacy-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Private Cloud (On-Prem) Prerequisites ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41932-private-cloud--on-prem--prerequisites.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Private Cloud (On-Prem) Prerequisites ", 
"snippet" : "Introduction This document describes the system and installation requirements for a Private Cloud (a.k.a., \"On-Prem\") deployment of the Menlo Security Isolation Platform (MSIP). Both the Web and Email solutions can be deployed in a Private Cloud. The installation of either solution is done via a sim...", 
"body" : "Introduction This document describes the system and installation requirements for a Private Cloud (a.k.a., \"On-Prem\") deployment of the Menlo Security Isolation Platform (MSIP). Both the Web and Email solutions can be deployed in a Private Cloud. The installation of either solution is done via a similar process (and image). The following topics are covered: ????????????Overview Menlo Security's isolation-centric approach splits web browsing between the user's device and an isolated, Disposable Virtual Container (DVC) away from the endpoint. All risky code is executed in the isolated DVC and never reaches the endpoint. Only safe display data is sent to the user's browser. Administrators will need to select a role during deployment: Web Isolation Standalone : Single system which has both a proxy path as well as isolation path (hosts the disposable virtual containers for isolated browsing sessions). This can be managed directly or with the Central Manager. Web Isolation Master : This system is the proxy path through the MSIP. It can make the decision to send through proxy (itself) or through one to many Isolation Workers (systems which contain the Disposable Virtual Containers). Web Isolation Worker : This is a system which loads and runs Disposable Virtual Containers for the isolated web sessions of end users. Adding many of these workers allows the entire solution to scale out for service provider or very large enterprise load handling. Email Processor : This is a node which can be set to transform URLs in email isolation (change the incoming URLs via email to point to the MSIP) or restore them on the way out of an organization (i.e., change back to the original URL so people receiving a forwarded message donâ€™t have broken links). Attachment Worker : This is an optional node which can be used to perform additional processing on email attachments such as generation of Safe PDF versions of attachments and to analyze emails attachments for malware to isolate\/block attachments based on perceived attachment risk. Email Processor nodes will automatically find and load balance between any Attachment Worker appliances in the same Central Manager appliance group. At least one Attachment Worker appliance is needed if the attachment policy is configured to either add Safe PDF versions of attachments to emails or to perform policy decisions based on attachment risk identified by content inspection. Attachment Content Inspection is a separately licensed feature. Please contact Menlo Security for details. Central Manager : Management system for all node types. In every Private Cloud install at least one web isolation system will be required. System Requirements The On-Prem Menlo Security solution can be deployed as dedicated hardware appliances (Menlo Security XL150, XL50 or ML50) or as virtual machines. Appliance Role As mentioned above, each appliance can have one of three roles. Role selection is done during deployment with the virtual appliance. (You set this as part of the initial OVA import.) For hardware appliances the role is already defined. For example, ML50 is the Central Management appliance, and XLs are different sizes of the Web Isolation Platform. Network Access The following network access is required for all deployments: Virtual appliance or hardware appliance accessible to end users on TCP\/80 and TCP\/443. If using a PAC they are accessible by default on TCP\/3128 and TCP\/3129, respectively. Internet access (proxy or direct) Syslog permitted to the log collector (by default UDP\/514) SNMP traps from the virtual appliance (by default UDP\/162) DNS and NTP servers available from virtual appliance Port 8442 has bidirectional traffic between the CMR and isolation appliance Port 8444 is open on the master CMR and accessed from the secondary CMR Port 8123 is open on the master CMR and accessed from the isolation appliance(s) At a minimum, the following network access is required for outbound traffic. The appliance must be able to access any www site that will be isolated: updates.menlosecurity.com:443 brightcloud.com This includes: localdb-url-daily.brightcloud.com localdb-url-rtu.brightcloud.com api.bcti.brightcloud.com For Email deployments the following additional Network Access requirements exist: SMTP Proxy Port (by default TCP\/25) Hypervisor Environment The following is required in the Hypervisor environment: Administrator access to vCenter with VM creation privileges VMware vCenter 6.0, 6.5 or 6.7 VMware ESXi 6.0 - 6.7 Windows native client Web client - Flash based (as of vSphere 6.5, HTML5 client does not support OVA customization Virtual Appliance Resources The following virtual appliance resources are also required: 32 GB RAM (minimum) 8 vCPUs 270GB Virtual Disk space: one 200GB drive and one 70GB drive on the VM, which are created automatically. The second virtual drive can be expanded if necessary. One VNIC. For Hardware appliances two physical NICs will need to be cabled: one for DRAC hardware management and the other for MSIP functions (mgmt and system network traffic combined onto a single interface). Refer to for information about using the operational monitoring capabilities of the MSIP. You can create alerts to determine the Key Performance Indicators (KPIs) and assess system capacity. For example, if you have more than 50 users, the minimum Virtual Appliance resources listed above may not be sufficient. Installation Prerequisites The Menlo Security appliance requires some settings to be defined and configured prior to doing the installation. Some of the external dependencies, such as DNS hostname, certificate creation and IP address should be configured prior to starting the installation. High Level Overview Proper registration of DNS names and certificate creation is critical in making sure the deployment goes smoothly. Pay close attention to these sections. You will see 503 Service Errors when the certificates aren't trusted and\/or DNS isn't working properly. Static Network Configuration Parameters The following Static network configuration parameters are required: IP Address Subnet Mask Default Gateway DNS Servers NTP Servers Syslog Server Address Syslog Server Port Number SNMP Trap Destination Address SNMP Community String DNS Entries The following DNS Entries are required for the appliance. Hostnames and a \"Service Domain\" are required for certificate security and performance reasons. These should be configured in corporate DNS servers. Primary hostname for each appliance (e.g., safeweb-appliance-1.company.com ). This is for management of that particular appliance. Service Domain for MSIP communications (local browser to DVC), (e.g., safeweb.company.com ). This could be used to access the service directly in pre-pend mode. (For example, https:\/\/safeweb.company.com\/www.cnn.com ). In a small deployment or a chained deployment, this could just be the same as the Primary hostname listed above ( safeweb-appliance-1.company.com ). In a larger deployment you could create an application name safeweb.company.com which only exists in DNS\/F5. The service domain on the Menlo Appliance points to a local F5 load balancer (i.e., it locks the connection to a region). The hostname is specific to an individual appliance and differs from the service domain. Service Domain prepended with xhr- , e.g., xhr-safeweb.company.com (or in a small or chained deployment xhr-safeweb-appliance-1.company.com ). The DNS records would be similar to the following: safeweb.company.com A 1.2.3.4 or for a small or chained setup - safeweb-appliance-1.company.com A 1.2.3.4 xhr-safeweb.company.com CNAME safeweb.company.com or for a small or chained setup xhr-safeweb-appliance-1.company.com CNAME safeweb.company.com Trusted Certificates and User Authentication Certificates and user authentication required include: Trusted certificate for appliance SSL communications: Certificate must contain \"subject alt names\" for both the Service Domain and xhr-ServiceDomain. Certificate must be signed by an authority trusted by user desktops (an external CA trusted by browsers or an internal CA (e.g., Active Directory, or AD) trusted by the standard desktop build). Certificate with altname for both Service Domain and xhr-ServiceDomain in combined PEM format SSL Inspection Certificate (certificate used to open user sessions going to https websites) Example using openssl req -new -newkey rsa:2048 -sha256 -days 365 -nodes -x509 -keyout myCA.pem -out myCA.pem : Resulting myCA.pem includes both private key and public certificate. To provide just the certificate you can edit the file or issue openssl x509 -in myCA.pem -out myCAcert.pem (pem format). To download the Menlo Security CA certificate for SSL inspection, please navigate to the following link: https:\/\/support.menlosecurity.com\/instructions\/cert User Authentication LDAP\/AD authentication settings (when enabled) Internet Access The appliance Internet access must provide open Internet access free of limitations (i.e., allow access without site category filters or requiring authentication). VMware Infrastructure (when applicable) No additional software appliances (VM's) are necessary if using hardware appliances, however a mix of both types of appliances is supported. If VMware Infrastructure is used, the following is required: OVA file downloaded and accessible to vSphere Client Address of vCenter Server Administrator Account for VMware Virtual Infrastructure Parameters are known VMware ESXi Datastore (Thick Provisioned format) Virtual Network End to End Example Refer to the following example to help illustrate each of the minimum requirements. One Central Manager (kjp-cam.menlotest.com with DNS A record of 10.11.104.106) One Web Isolation Appliance (kjp-lab-101.menlotest.com with DNS A record of 10.11.104.101 and xhr-kjp-lab-101.menlotest.com CNAME kjp-lab-101.menlotest.com) Service Domain to be entered into the Web Isolation Appliance (kjp-lab-101.menlotest.com) SSL Bump Certificate. You should inspect SSL traffic. To do so you can import your own certificate which is already trusted by browsers or other elements in your organization, or you can simply use the certificate Menlo provides via the Web Isolation appliance ( Settings -> Proxy -> SSL Inspection Proxy Port and Certificate Details ). Appliance Communication Certificate (loaded into Settings -> Service Settings -> Appliance Communications Certificate for both the Central Manager and the Web Isolation Appliance). The example certificate below shows the necessary \"subject alt names\". Sample Certificate The CMR hostname does not need to be included as a SAN on the appliance communication certificate unless you are creating a certificate for the CMR itself. See for an overview of the SSL certificates used on Menlo appliances. " }, 
{ "title" : "OVA Deployment Guide ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41933-ova-deployment-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ OVA Deployment Guide ", 
"snippet" : "Introduction This guide covers the steps required to set up a Private Cloud deployment of the Menlo Security Central Manager, Web Isolation, and Email Isolation appliances. Menlo Security uses an encrypted channel to do processing and relies on valid certificates for creating the channel. It's impor...", 
"body" : "Introduction This guide covers the steps required to set up a Private Cloud deployment of the Menlo Security Central Manager, Web Isolation, and Email Isolation appliances. Menlo Security uses an encrypted channel to do processing and relies on valid certificates for creating the channel. It's important to replace the self-signed certificate that is used during installation with a certificate generated by a trusted certificate authority. In most cases, this is created by the Active Directory server that manages user desktops. Ensure your system and environment meet the requirements listed in . That document also lists the network configuration parameters required to successfully deploy the components. Also, it's important each appliance have a unique hostname and IP address. The following topics are discussed below: ??????????????????????????????????????????Deployment Overview The most basic Private Cloud deployment of the Menlo Security Isolation Platform (MSIP) is the deployment of a single Web Isolation appliance. In this scenario, the Web Isolation appliance allows pre-pend or proxy connections directly to the appliance, implements only an Isolate-All policy, and allows you to send logs out to another device via syslog. Each isolation node is fully autonomous and cannot share connections, cookies, etc. To have the following features, you must install a Central Manager appliance as well as a Web Isolation appliance ( Isolation Standalone or Isolation Master and Isolation Worker ). See Dashboard status Centrally manage a granular policy (e.g., block social networking sites, isolate uncategorized sites, allow sports sites, etc.) Implement Document Isolation View logs natively Finally, for a Private Cloud Email Isolation deployment, you must have both a Central Manager appliance and deploy the necessary Email Isolation appliances ( Transform and Restore VMs). Creating Appliances The following sections provide steps for creating simple appliances for use in an On-Prem deployment. If a Central Manager will be used, it should be created before any Web or Email Isolation appliances are created. Basic bootstrapping is done with the OVF template parameters to get the appliance up and running; additional network configuration will be done using the browser interface in the ??? section below. Deploy an Appliance without vCenter Turn on the appliance and wait for the boot to complete. The appliance goes in a \"provisional state\". Log into the console with admin credentials and confirm the following message appears: Appliance is uninitialized. [1] Isolation Standalone [2] Isolation Master [3] Isolation Worker [4] Email Processor [5] Attachment Worker [6] Central Manager Enter mode: Enter the mode for the desired appliance type (usually the Central Manager is created first). The system restarts. Continue with configuration. See ???. Create a Central Manager Appliance (VMware) Log into VMware Virtual Center. Use the OVF Template wizard to create a new appliance ( File -> Deploy OVF Template... ). Click the Browse button and select the Menlo Security OVA file to use as a source file. The same OVA file is used for all three installation types (Central Manager, Web Isolation, and Email Isolation). Click Open to choose the file, and click Next > to continue. The next screen provides information about the virtual appliance. Confirm your installation disk has sufficient storage for the thick provisioned size on disk requirements, and click Next > . Read the End User License Agreement on the screen, and click the Accept button. Then click Next > . Enter a name for the appliance, and click Next > . Select a location that has sufficient storage for the appliance. No special drive type is required. Click Next > to continue. Select the disk format to use. To immediately reserve the required disk space, use Thick Provision Lazy Zeroed (recommended); for testing or POC purposes, use Thin Provision . Click Next > when ready. Choose the network to use in the Destination Networks column; there is only a single virtual NIC available for the template. This network will be used for both management and data (user) traffic. Future versions will split this traffic into different NICs. Click Next > to continue. The Properties screen provides customization specific to the MSIP appliance. Configure the following, and then click Next > to continue: Install Type : Select Central Manager from the menu. The Central Manager will manage both web and email isolation appliances (installed on additional virtual machines). Hostname : Enter the full hostname (A-record type). Static IP Address : Enter the IP address associated with the hostname. Netmask Default Gateway If using DHCP instead of Static IP, select the DHCP checkbox. The Networking properties below the checkbox are ignored. Hardware appliances simply use DHCP and there is no need to select a role (it is built into the appliance from the factory.) DNS Servers : Enter a comma separated list of DNS servers for the VM. This is ignored if DHCP is in use. The Management Registration (Optional) section is not relevant for a Central Manager deployment. Review the setup parameters, click the Power on after deployment checkbox, and then click the Finish button to create the appliance. Deployment takes a few minutes. A progress window appears during deployment, and another window appears when the appliance is ready and can be logged into. Create a Web Isolation Appliance: Isolation Master and Isolation Worker (VMware) Perform Steps 1-9 in ???, using a unique name for the Web Isolation appliance, to deploy an OVF Template. The same .ova file is used for all three appliances. The Properties screen provides customization specific to the appliance. Configure the following: Install Type : Select Web Isolation from the menu. Hostname : Enter a different hostname (A-record type) for web isolation. In the background the A-record is associated with an xhr- record of CNAME type. Static IP Address : Enter the IP address associated with the web isolation hostname. Net Mask (same as Central Manager) Default Gateway (same as Central Manager) Management Registration (Optional) : If you want the Web Isolation appliance to register itself with the Central Manager immediately, enter the IP of the manager as well as the pre-defined shared secret. If you haven't already configured a shared secret on the manager, leave this section blank and add the appliance from the manager screen. Review the setup parameters, click the Power on after deployment checkbox, and then click the Finish button to create the appliance. Deployment takes a few minutes. Create an Email Isolation Appliance (VMware) Perform Steps 1-9 in ???, using a unique name for the Email Isolation appliance, to deploy an OVF Template. The same .ova file is used for all three appliances. The Properties screen provides customization specific to the appliance. Configure the following: Install Type : Select Email Isolation from the menu. Hostname : Enter a different hostname (A-record type) for email isolation. In the background the A-record is associated with an xhr- record of CNAME type. Static IP Address : Enter the IP address associated with the web isolation hostname. Net Mask (same as Central Manager) Default Gateway (same as Central Manager) Management Registration (Optional) : If you want the Email Isolation appliance to register itself with the Central Manager immediately, enter the IP of the manager as well as the pre-defined shared secret. If you haven't already configured a shared secret on the manager, leave this section blank and add the appliance from the manager screen. Review the setup parameters, click the Power on after deployment checkbox, and then click the Finish button to create the appliance. Deployment takes a few minutes. If you intend to use the Isolate + Safe PDF attachment policy or the Attachment Analysis feature, you should repeat the steps above to deploy an Attachment Worker appliance. This node should be added to the same group as the Email Processor appliances in the Central Manager. The relationship between Transform Email Isolation Appliance and Attachment worker appliance is 1-N; the Transform node is aware of all available attachment workers and does load balancing among them. Note that Attachment Analysis is a licensed feature. Most customers should skip this step. Contact Menlo Security for more information before deploying this type of node. Creating Oracle VM Appliances The procedure for deploying Oracle VMs for the Menlo Security Central Manager, Web Isolation or Email appliances is similar to VMware. However, with an Oracle deployment you will leverage the Menlo appliance terminal in order to set the appropriate role (Manager, Web, Email). The procedure is described below. From the Repositories tab, select the Virtual Appliances folder of the desired repository in the left-hand pane and then click on the Import Virtual Applianceâ€¦ button from the toolbar at the top of the right-hand pane. Enter the URI to the OVA image to be imported (i.e., replace Enter URI of OVA image text in the following figure): Once the OVA has been successfully imported, select its entry from the list in the right-hand pane and click on the Create Virtual Machine from the toolbar at the top of the right-hand pane: Select the desired Server Pool within which to create the virtual machine and then click OK : Once the virtual machine has been successfully created, it will appear on the Servers and VMs tab when the specified Server Pool is selected in the left-hand pane and the Perspective is set to Virtual Machines in the right-hand pane: Configuring Appliances The following sections provide the steps for completing the configuration of new appliances using the Dashboard. Central Manager Appliance Configuration Obtain the IP address for your appliance. If using a hardware appliance, connect the Ethernet cable to the appliance as shown below to get the IP address. The appliance will boot using DHCP. Connect a monitor to the appliance to view the IP address for log in. To get the IP address for a virtual appliance, start the appliance in VMware vCenter Server if it's not already powered on. The VM console will provide the IP address to access the Dashboard from a web browser, or you can enter the hostname to view the Dashboard . Enter the Dashboard IP address in a web browser followed by :8443 (e.g., https:\/\/10.11.104.103:8443 ), and accept the self-signed certificate. This will be replaced later with a valid certificate. Log into the Dashboard with the following account: Username : admin Password : password You are immediately asked to change the password. Record the password, since it cannot be recovered if it is lost. Click OK to save the new password. Log in using the new admin password. Open the Network Settings screen ( Settings -> Network ) to complete the configuration of the Central Manager appliance network settings. Update the Nameserver field and select Save when done. The system requires a restart to accept the new settings. Click Confirm to reboot. After logging in again, open the Service Settings pane ( Settings -> Service ). Use the Browse button to find and the Upload button to upload a new certificate. Then select Save to save the new configuration. Another service restart is required. Click the Browse... button to open the certificate file (.pem) on your system. Traffic is encrypted between the isolation appliances and the Central Manager as well as web browsers and appliances. This certificate is for appliance communications. Later you can install an SSL inspection certificate which will allow you to inspect https sessions your users initiate to web servers. The self-signed certificate should be replaced with a valid certificate to ensure you do not receive error messages when using the appliance FQDN while accessing the Isolation Platform via Static IP. Click the Upload button to upload the file to your system. The system requires another restart. Click Confirm to continue. After logging in following the restart, note that the Secure Connection (lock) icon turns green, indicating that the certificate was accepted and the connection is secure. Open the Time Settings pane ( Settings -> Time ) and use the Timezone menu to set the correct time zone for the appliance. You are now able to add and manage isolation appliances with the Central Manager. Web Isolation Master and Isolation Worker Appliance Configuration Obtain the IP address or Hostname for your appliance. Enter the Dashboard address\/hostname followed by :8443 (e.g., https:\/\/10.11.104.103:8443 or https:\/\/YourCentralManagerName.com:8443 ), and accept the self-signed certificate. This will be replaced later with a valid certificate. Log into the Dashboard with the following account: Username : admin Password : password You are immediately asked to change the password. Record the password, since the password cannot be recovered if it is lost. Click OK to save the new password. Log in using the new admin password. Open the Network Settings screen ( Settings -> Network ) to complete the configuration of the Isolation Manager\/Worker appliance network settings. Update the Nameserver and select Save when done. For more information about using templates to manage appliances, refer to . The nameserver and NTP server use the same addresses used by the Central Manager, if present. The system requires a restart to accept the new settings. Click Confirm to reboot. Log in and open the Web Settings pane ( Web Settings ). Set the following toggles to Yes to allow the MSIP to control file downloads and uploads. This is required for both Isolation Master and Isolation Worker appliances: File Downloads File Uploads Open the Service Settings pane ( Settings -> Service ). Use the Browse button to find and the Upload button to upload a new certificate. Then select Save to save the new configuration. Another service restart is required. The self-signed certificate should be replaced with a valid certificate to ensure you do not receive error messages when using the appliance FQDN while accessing the Isolation Platform via Static IP. After logging in following the restart, note that the Secure Connection (lock) icon turns green, indicating that the certificate was accepted and the connection is secure. Next, input your chosen names into the Appliance Hostnames form on the Service Settings pane ( Settings -> Service Settings ). All the hostnames must be configured in DNS and be present in the appliance's certificate alt-names. Login Name : This is the name users will see for the isolation appliance. In most cases, this name can also be used as the Service Name . However, in deployments where a logical name spans several clusters (e.g., a DNS geographic routing configuration), the Login Name may be set to a global name, and the Service Name will be region specific. Service Name : This name is used for the MSIP ACR sessions used to manage the isolation session. If the same name is used for login, set this to Yes . XHR Name : This name is derived from the Service Name and is also used for MSIP ACR sessions. IE Zone Authorization : This is an optional configuration which allows MSIP authorization across IE integrity levels. If the site being accessed is in a different integrity level than the MSIP authorization cookie, the request cannot be authorized. This setting passes the MSIP cookie into another integrity level, allowing MSIP sessions to be authorized. The domain name used here must also be configured in IE settings to associate it with the needed integrity level. For example, if the appliance Login Name is in the Internet zone, the IE Authorization hostname should be assigned to a zone in the medium integrity level (by default, Trusted Sites is in the medium integrity level). IE keeps separate cookie stores per integrity level, and an additional flag automatically puts any site that bypasses the proxy into the Internet zone. By default, sites in your Intranet are in the medium integrity level. Integrity level will be either low or medium for a zone, depending on whether protected mode is enabled for that zone. If you will always use proxy mode you don't need the IE Authorization Hostname to exist in your DNS. If you have prepend mode IE users, the users are redirected to the IE Authorization Hostname upon first login, and it must be configured in your DNS. The service domain can be the same as the actual web isolation FQDN if you are doing a small POC (Manager and Web Isolation VM) or if you are proxy chaining. In a global pre-pend case you may want a generic service domain (safeweb.company.com) which will be routed to based on location\/geo. After templates are set up and in use, the service domain can be managed via a template. Log in using the new admin password following the system restart. Open the Time Settings pane ( Settings -> Time ) and use the Timezone menu to set the correct time zone for the appliance. For Isolation Master appliances, you can upload the SSL Inspection certificate on the Proxy Settings pane ( Settings -> Proxy ). Click the Browse... button to open the SSL Inspection certificate file (.pem) on your system and upload it. After uploading this the service restarts. The isolation appliances should now be ready to be managed with the Central Manager. Email Isolation Appliance Configuration Start the appliance in VMware vCenter Server. Note the address required to access the Administrator panel. Enter the Administrator panel address in a web browser, and accept the self-signed certificate. This will be replaced later with a valid certificate. Log into the panel with the following account: Username : admin Password : password You are immediately asked to change the password. Record the password, since the password can not be recovered if it is lost. Click OK to save the new password. The Dashboard opens to the Status pane. Complete configuration of the Email Isolation appliance network settings using either the Network Settings pane ( Settings -> Network Settings ) or by using a Central Manager Template. The following are required: Nameserver NTP Server For more information about using templates to manage appliances, refer to . The system requires a restart to accept the new settings. Click Confirm to reboot. Open the Service Settings pane ( Settings -> Service Settings ). By default the Central Manager groups systems according to their service domain. In an Email deployment the Email appliance doesn't have a service domain so you are given the option to enter a FQDN to group the systems (e.g., management-datacenter-1.company.com). This will allow automatic grouping by the manager. Click the Browse... button to open the certificate file (.pem) on your system. Traffic is encrypted between the isolation appliances and the Central Manager as well as web browsers and appliances. This certificate is for appliance communications. The self-signed certificate should be replaced with a valid certificate to ensure you do not receive error messages when using the appliance FQDN while accessing the Isolation Platform via Static IP. Click the Upload button to upload the file to your system. The system requires another restart. Click Confirm to continue. Log in using the new admin password to start using the Email Isolation appliance. Verify Successful Deployment of Appliances In the following steps you will add a Web Isolation appliance to the Central Manager and confirm that policy changes are successfully deployed when a user browses isolated and blocked web pages. Test Creation and Distribution of Web Isolation Policy with the Central Manager The following steps describe how to set up a simple cluster (one Central Manager, one Isolation Master, and one Isolation Worker) and test distribution of a web isolation policy to the appliances. From the Central Manager Dashboard, open the Manage Groups pane ( Management -> Groups ). Select the Add Group button to add a new group. Enter the desired Name and set the Type toggle to \"Cluster\" for a cluster group. Click Save when finished. The Cookie Storage tab allows you to set up the server to manage cookies for all group members. In this example, we will skip this option, but the group can be edited at any time to add\/update this information. The new group will appear in the Manage Groups pane. Open the Manage Appliances pane ( Management -> Appliances ) and select the Add Appliance button to add the appliances to be managed by the Central Manager. In the Add Appliance window, enter the following: Enter the Hostname . The port cannot be configured. Click Next to continue. In this example, we will start by adding an Isolation Master . Confirm the certificate against the appliance. Click Next to continue. Log into the appliance. Note that you must have already logged into the Web Isolation appliance at least once through the Dashboard to change the default admin password to one of your choosing. Click Next to continue. Use the Group menu to select the group for the appliance. Click Add Appliance to continue. The managed appliance is now displayed in the Manage Appliances pane. Repeat the above step to add an Isolation Worker . To easily test policy management, open the Category Rules pane ( Web Policy -> Category Rules ) and pick one category to Block and a second category to Isolate . Other categories should be set to Allow . For example: Block Alcohol & Tobacco sites Isolate Education sites Allow News sites Policies saved in the Central Manager are pushed to all appliances it is managing. Click the Save Changes button to save the new rules. Click the Publish button to implement the new rules. Open a web browser and confirm it trusts the certificate authority (Active Directory or a .pem file). Refer to the following documents for more information about adding a CA certificate for testing purposes: Confirm that the proxy server is working. Select the new proxy server cluster, and confirm the proxy port is 3129 . Go to a website in the Block category and verify that the page is not loaded. Go to a website in the Allow category, and view the page source to confirm the page is not isolated. Go to a website in the Isolate category, and view the page source to confirm the page is isolated. Open the Web Logs pane ( Logs -> Web Logs ) and confirm that logging information was gathered by the MSIP. Refer to for more information about the screens provided for setting up user or group authentication, logging, using other policy types, and performing system updates. Configuring FireEye AX on an OVA The Menlo OVA can submit files to a FireEye appliance for analysis. To enable this, the Menlo OVA must be configured to direct files to the FireEye appliance. From the Central Manager Dashboard, open the Edit Groups pane ( Management -> Groups -> Group Edit button -> Sandbox -> FireEye ) and select Enable to enable the FireEye appliance. Next, open the Content Inspection pane ( Web Policy -> Content Inspection ). Select the checkbox for the FireEye service name to enable the service. Next, click the Edit button to configure the plugin. The following key settings should be configured: Base URL : URL for the FireEye appliance Username : Web Services Application Programming Interface (WSAPI) account username. This is a FireEye user account with the api_analyist role. Password : Password for WSAPI account above Types of Transfers to Send : Click the checkbox(es) for the types of transfers to send to the FireEye appliance ( Downloads and\/or Uploads ). Max Timeout : Total time allowed before plugin is aborted. Since the FireEye appliance has a limited number of concurrent analyses allowed, this allows file processing to be aborted if the file is not processed within the timeout period. Max Size : Max size of files to submit Action for Transfers Which Can't be Processed : What to do if the plugin encounters an error (e.g., timeout, network issues, etc.) Action for Transfers Above Size Limit : What to do if the file is above the max size limit Certificate : Root CA for the FireEye appliance. The appliance uses a self-signed certificate to secure the https connection, so the CA must be provided to the Menlo OVA to validate the connection. The certificate can be exported from the FireEye appliance dashboard. Once exported, use cat (or another command) to view the file in an editor and copy-paste the contents. Profiles (optional) : Defines the list of guest images (OS profiles) available to the FireEye appliance to submit the file to. If empty, files are submitted to all. The full list is available from the FireEye appliance dashboard ( Guest Images ). Analysis Type : Sandbox or Live analysis. Sandbox analysis simulates L\/WAN access, and Live analysis will allow the FireEye appliance to communicate outside the FireEye appliance. Analysis Duration : Duration (in minutes) that the file is sandboxed for analysis Click Save Changes when finished editing the configuration. Once the FireEye plugin is enabled, all files passing through the MSIP are submitted to the FireEye appliance for analysis. This is unlike the cloud sandbox that only submits files that \"fail\" the local scan. Note that FireEye processing will significantly extend the duration between requesting a file download and the receipt of the file. File analysis requires the WSAPI to be enabled using the Menlo Command Line Interface (CLI). The Menlo FireEye AX has already been enabled. To enable the WSAPI service log in as an administrator and enter the following commands: en \/\/ enable conf t \/\/ configure terminal wsapi enable \/\/ enable wsapi service wr mem \/\/ write memory When a file is submitted to the FireEye AX, an indicator is provided that notes the file download will take the analysis duration. If there are connectivity issues, this is noted at approximately 5 minute intervals in the operational logs. In a future release the FireEye analysis outcome will be reported in the Logs pane. Command Line Interface (CLI) The MSIP also provides a Command Line Interface (CLI) that can be used for basic configuration and troubleshooting of the MSIP. This can only be used after the appliances have been created and deployed. For more information the commands available through the CLI, refer to ???. " }, 
{ "title" : "Central Manager and Isolation Appliance Administrator Guide ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41934-central-manager-and-isolation-appliance-administrator-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Central Manager and Isolation Appliance Administrator Guide ", 
"snippet" : "Introduction This guide outlines the interface and related features used to control the Menlo Security Central Manager and Isolation appliances. The following topics are covered: The guide assumes that the Central Manager has already been installed and configured. For details, refer to . Review Syst...", 
"body" : "Introduction This guide outlines the interface and related features used to control the Menlo Security Central Manager and Isolation appliances. The following topics are covered: The guide assumes that the Central Manager has already been installed and configured. For details, refer to . Review System and Appliance Status The Central Manager appliance Status panes provide current information about the operational status of all managed appliances and any issues present. The following panes are provided: System Health : Lists the number of appliances running, all appliance groups, and a list of current issues. Use the Actions menu to perform an action on the appliance. The available Actions include: Export Support Bundle : Export a set of data (logs and key system statistics) for troubleshooting. Upload Support Bundle : Upload to the Menlo Upload server. You will need to enter your Support Ticket # and then wait for the upload to complete. Export Settings : Export the full set of settings. You are asked to enter a password to protect the settings file before the file can be downloaded. Import Settings : Import the full set of settings. You must enter the settings file password to import the file. Note that all current configuration is replaced and the system is rebooted during import. Console : Display the Command Line Interface (CLI) console for basic configuration and troubleshooting. See for details. The Firefox browser has a known limitation when using the Firefox browser that prevents use of the hyphen (-) and underscore (_) keys. See GitHub shellinabox bug for details. A workaround for this issue is to open the onscreen keyboard from the CLI's context menu and use that to enter these characters. Restart : Restart the system services. Reboot : Reboot the entire appliance. Shut Down : Shuts down the appliance. Appliances : Displays the following information for each appliance: hostname, type, assigned group, version, CPU usage, RAM usage, Disk status, and number of isolated browsers. Use the Group Appliances pull-down menu to group appliances by name or service domain. Details : Displays detailed information about the appliance selected from the menu at the top right. This can vary slightly based on the type of appliance. Information includes CPU usage, RAM usage, and Disk status. In some cases, such as a Web Isolation system, the Disk status is divided into Operating System, System Logs and File Inspection Service (disk which is used to temporarily process documents during isolation and relevant only for this type of appliance). Menlo Security can assist in changing the storage values or debugging issues if these values change from Normal (to Warning or Alert ). Click the Login to Appliance button to login and manage the appliance from the appliance Dashboard . Healthcheck URL The healthcheck URL provides appliance health status via HTTP response codes. This may be useful if you use an integrated product (e.g., BlueCoat) that relys on healthcheck codes to manage isolation nodes. If an unexpected HTTP response is received (anything other than 200 ), the isolation node can be taken out of the forwarding group. Prior to any appliance upgrades, please update the healthcheck URL string to the following: GET \/healthcheck\/?status=1 HTTP\/1.1\\r\\nConnection: Close\\r\\n\\r\\n Valid responses: 200 : GO State 400 : STOP State (Appliance is in Maintenance mode or there are issues on the Dashboard) Managing Appliances, Groups, Templates, and Updates The Management panes allow you to add or delete appliances managed by the Central Manager. The Central Manager also provides a Configuration Templates feature that applies a user-defined set of networking and logging settings to selected appliances with a simple publish action. You can also enact certain management actions on multiple appliances at once (basic actions like reboot, download and install updates, and perform rollbacks). Managing Appliances Use the Manage Appliances pane ( Management -> Appliances ) to add, delete, assign templates, or group appliances. To delete, assign a template, or group an appliance, select it using the checkbox and then use the pulldown menu for grouping or use the appropriate button to Assign Template or Delete it. To add an appliance: Open the Manage Appliances pane. Click the Add Appliance button. Enter the appliance Hostname and click Next . The Port is provided for reference and cannot be edited. Confirm the appliance certificate and click Next . Enter the admin username and password, and then click Add Appliance . The appliance appears in the list on the Manage Appliances pane. Managing Groups This pane provides a list of all appliance groups. An admin can group appliances so their cluster type and cookie storage policy is consistent across all appliances in the group. The group name is also displayed on the Manage Appliances pane for your reference. To create a group: Open the Manage Groups pane ( Management -> Groups ). Click the Create Group button. Enter a name in the Group Info tab. The Description is optional. Use the Type toggle to define the group as a Cluster or Non Cluster (Auto) type. If you wish to enable NFS cookie storage for the group, click the Cookie Storage tab and set the toggle to Enable . You will then be able to enter the IP address and Mount Location in this tab. Click the Save button to save the group. The new group appears in the Manage Groups pane list. Once appliances are added to a group, you can click the + icon on the left of each group name to view the appliance names nested below the group. Managing Templates This pane provides a list of all appliance templates. The templates allow an admin to easily configure network settings and logging, as well as to set up special user or group category rules. In this way identical settings are published to all appliances assigned that template, and the Central Manager performs heartbeat checks to ensure all appliances remain up-to-date with the latest values in the template. Create Template To create a template and assign it to an appliance: Open the Configuration Templates pane ( Management -> Templates ). Click the Create Template button. A Create Configuration Template window opens to the Info tab. Select the appropriate Appliance Type for the template and then enter a Template Name name. The following appliance types are available: Isolation Standalone : Single system which has both a proxy path as well as isolation path (hosts the disposable virtual containers for isolated browsing sessions). This can be managed directly or with the Central Manager. Isolation Master : This system is the proxy path through the MSIP. It can make the decision to send through proxy (itself) or through one to many Isolation Workers (systems which contain the Disposable Virtual Containers). Isolation Worker : This is a system which loads and runs Disposable Virtual Containers for the isolated web sessions of end users. Adding many of these workers allows the entire solution to scale out for service provider or very large enterprise load handling. Email Processor : This is a node which can be set to transform URLs in email isolation (change the incoming URLs via email to point to the MSIP platform) or restore them on the way out of an organization (i.e., change back to the original URL so people receiving a forwarded message donâ€™t have broken links). Attachment Worker : This is a node which can be used to analyze email attachments for malware, isolate or block attachments, and generate Safe PDF versions of attachments. Email Processor nodes will automatically find and load balance between any Attachment Worker appliances in the same Central Manager appliance group. Use the Web Settings tab (or Email Settings for Email Processor templates) to select the web\/email isolation settings that will be managed by the central manager. Web Settings Tab Email Settings Tab The Web Settings tab now includes a Profile setting that can be used to optimize resources (idle time) for users. Check the checkbox and set to \"Moderate\" to use optimization, or leave it as \"Disabled\" (default). Use the Authentication tab to select authentication settings (AD, SAML, Users and Admin) that will be managed by the central manager. Use the System Settings tab to select other appliance system settings that will be managed by the central manager. This includes the following: Network : Appliance network settings (nameserver and upstream internet proxy). See . Service : Login host. This is either the appliance FQDN or a special domain which maps to DNS\/LoadBalancing. Refer to and for more information. Proxy (Web Isolation only): The Proxy ports which will be used for the service (i.e., what the browsers or downstream chaining device will connect to). See . Access Control : Controls services allowed to manage the infrastructure and internal management communications, as well as the services that can connect to Menlo Security (e.g., services that allow email processors to send email to the Menlo Security Transform\/Restore systems). See . Logs and Alerts : User session and system log hosts, protocol, port number, and log format. See . Time : Configures the server timezone and time format. See . CA Certificates : Enables certificate management from the template. See . Forensic Archive (Web Isolation only): Configures the archiving of files being accessed by users to a remote scp (secure copy) server using public key exchange. Files being downloaded from isolated sites will be zipped and archived to this server. For security, the scp server should be write-only (disallowing file downloads). See . Use the License tab to manage the license using the central manager. Click the Save button to save the template. The new template appears in the list. Return to the Manage Appliances pane and click the checkbox for the appliance that will use the template. Click the Assign Template button. Click the Publish button to apply the configuration template to the appliance. After the template is successfully published, the Configuration Status ( In sync with template ) is displayed in the list. Import Template If an appliance already has all the desired settings that should be populated to other appliances, use the Import from Appliance button to save those settings in a new configuration template. If the desired settings have been exported from an appliance into a file, use the Import from File button. Then browse to the file location and select Next to save those settings into the configuration template. Clone and Edit Templates You can also select a template and click the Clone button to copy it; then make modifications to the template and save it under a new name. To modify a saved template, click the Edit button and click the Save button to save changes. As soon as a change to the template is made, the appliance Configuration Status warns the user that the appliance is out of sync. Export Templates If you wish to export the template to a file that can be used elsewhere, click the Export button next to the desired template to save it to a location of your choice. Assign Templates To view the assigned templates for each appliance, open the Manage Appliances pane ( Management -> Appliances ). Each appliance is listed under the Status tab. If you wish to assign a saved template to one or more appliances: Check the checkbox(es) associated with those appliances. Press the Assign Template button. Select the desired template and save changes. Note that the template is not published until the Publish Template action is complete. Managing Updates Use the Manage Appliances pane ( Management -> Appliances ) to perform centralized updates to one or more appliance at one time. You can also rollback to a previous installation and view current jobs for all appliances from this pane. Centralized Appliance Image Downloads The Central Manager checks the Menlo Security updates server for any available upgrades based on the license configured for an appliance. If any build is outdated, an \"Update Available\" message appears on the Status column for an appliance. To download updates for one or more appliances: Select the desired appliance(s) from the Manage Appliances Updates pane ( Management -> Appliances -> Updates ) by checking the relevant checkbox(es). Press the Download Image button. Select the following in the window that appears: Download Source : Source for the download package (Menlo Security Cloud, CMR, or Peer appliance). The Menlo Security Cloud source pulls the package from the Menlo Security Updates server. Peer and CMR obtain the package from the configured peer or CMR appliance. If the CMR or Peer appliance do not yet have the image configured for download, it will first download the image to the source (from Menlo Security Cloud) and then distribute it to the selected appliances. Start Download : Select the download time: Now or Schedule (select desired date\/time). Action : Desired action: Download Only or Download and Install . If Download and Install is selected, the following additional parameters appear: Install (now or schedule a time for install), Simultaneous Installations (number of simultaneous installations allowed), Action When Installation Fails (action to take if an install fails -- continue or stop). Press Download or Download and Install to download the image. The job runs either immediately or when scheduled. Centralized Appliance Updates Installation If an image was downloaded earlier, select the desired appliance(s) and press the Install button to run the install job. Note that if multiple appliances are selected, all must have the same version downloaded for the job to run. If there are different install versions, the installations can be run separately on the appliances. A warning is issued if any appliance runs an install of an out-of-date version. Centralized Installation Rollback Select the Rollback Image button to roll back an installation to a previously installed version on an appliance. You can run this action on several appliances, but all appliances selected at one time must have a common version that they are rolling back to. You can schedule a rollback for a specific date\/time and also decide how many appliances can be rolledback at the same time. Centralized Appliance Actions The following actions can be performed on one or more appliances in a single step: Reset Reboot Shutdown Enter Maintenance Mode Exit Maintenance Mode To perform any of these (e.g., \"enter maintenance mode\"): Select the desired appliance(s) from the Manage Appliances Updates pane ( Management -> Appliances -> Updates ) by checking the relevant checkbox(es). Press the Actions button. Select the desired action from the menu that appears. Press Confirm to perform the action for the appliances listed in the window that appears. A graceful shutdown of the centralized appliance may take up to five (5) minutes. Centralized Appliance Jobs Log All of the centralized update jobs (download image, install, rollback) are posted to a Jobs Log ( Management -> Appliances -> Updates -> View Jobs ). The icon next to a job name toggles between - and + . Press + to expand the job to view all tasks associated with it. If desired, you can cancel any active or scheduled jobs from the Jobs Log window. If the job being cancelled is in the middle of a task, the current task finishes before the cancellation takes effect (all further tasks are not run). Managing Appliance Registration The Appliance Registration pane ( Management -> Registration ) allows you to define a secret key used when registering a web or email appliance with the Central Manager. There are two options to register a web or email appliance with the Central Manager: Add the appliance using the Central Manager ( Management -> Appliances -> Add Appliance ). This step is performed after the web or email appliance is on the network (has already been deployed via VM\/OVA process). Have the web or email appliance register itself automatically with the Central Manager as part of the VM\/OVA deployment process. This is useful when you have different teams working with the product. For example, a VMware Admin who will do the web or email VM appliance deployments independently of a security team managing the Menlo Security policy. The secret key is required if you are doing Option 2 above. You will need to set Enable Trust Secret to Yes and enter your key below. Provide the key to the administrator deploying the VM\/OVA so they can insert it during that process. Web and Email Policy Depending on your deployment you may have Web Policy and\/or Email Policy panes present in the Central Manager. These panes are the same if the system is in the Cloud or On-Prem. These panes will be used to configure all appliances managed by the Central Manager. Refer to to understand the design of the Menlo Security Web policy. This includes topics like exception precedence, types of rules (threat vs. category), SSL inspection, and document handling. Refer to to understand the design of the email URL re-writing rules and whitelisting process. Manage Authentication The Authentication panes configure the policies used to manage Lightweight Directory Access Protocol (LDAP) and Security Assertion Markup Language (SAML) authentication for users and admins. The administrator can use these panes to associate the authentication provider (LDAP or SAML) independently to users or admins. One possible scenario is: All users in the company will access the MSIP via \"anonymous\" or \"x-authenticated-user\" settings if chaining from an existing device (e.g., Forcepoint). The MSIP admin requires Active Directory group membership and a password to set the policy inside the MSIP Web GUI. To configure the MSIP, perform the following steps: Open the AD pane ( Authentication -> AD ). Enter the Active Directory LDAP Authentication Settings to get the authentication provider working. Open the User pane and set Authentication Method to \"None\" and Get Identity from X-Authenticated-User Header to \"Yes\" to allow Menlo Security to accept the user from the downstream device. Open the Admin pane and set Enable to the desired authentication provider. Then enter the admin group name in the Administrator Group field (e.g., \"Menlo-admins\"). AD Authentication Settings Use this pane to configure the Active Directory authentication settings and Custom Attribute names. SAML The following options are available for Single Sign-On: SAML Provider : Select the SAML provider (ADFS or Other) from the pull-down menu. SAML 2.0 Endpoint : Enter the Identity provider URL in this field. Service Identifier (Issuer) : Enter the Identity provider Entity ID in this field. X.509 Certificate : Copy the X.509 Base64 encoded certificate (.pem file) into this field. Additional Certificates : Select to add additional certificates. When more than one certificate is provided, the SAML response is validated using both certificates, allowing for smooth rollover during certificate transition. Generate Signed SAML Requests : Set to Yes to generate signed SAML requests. SAML Static Entity Enabled . Set to Yes to enable a static authenticator. If you have multiple certificates and wish to remove one, select the Remove Certificate button under the certificate to remove it. Admin The following controls are provided for Administrator Authentication: External Administrator Authentication : Enables\/Disables Active Directory authentication for the administrator using LDAP or SAML . You can also enter the Authorization Group name here. Session Settings : Controls the amount of inactive time allowed before the admin portal session will time out. This can be set to any integer from 1 to 1440 (minutes). If no timeout is configured, the following default values are used: Central Manager: 30 minutes Isolation Master\/Worker: 60 minutes Admin Roles Use the Admin Roles pane to add and manage roles that will control access to MSIP administrator privileges. To add a new admin role: Click the Add Role button. A blank Add Admin Role window opens. Enter a unique Name and (optional) Description for the new role. Enter the users in the Admin Usernames box. The role maps to the admin username (email). SAML group support will be enabled in future releases for users with SAML\/SSO. Use the checkboxes in the Privilege table at the bottom to configure the privileges available when the user(s) log into the MSIP. These mirror the tabs available on the left side of all MSIP console screens. In the example above, users david@company.com and donald@company.com will only have read-only access to the Overview and Traffic Analysis panes from the Dashboard tab. They will also be able to view the Web Logs pane from the Logs tab. Use the + and - icons to expand and contract the list. This allows you to set a more granular sub-tab policy, if desired. When ready, click the Save icon to save the new role. Click Continue to confirm the save. Saved changes will be applied the next time the user logs in. For example, the user david@company.com will now see only the following tabs on the left side the next time he logs in. All roles are additive, excluding the default role. If a user has multiple roles, their privileges are the union of all the roles (except for the default role). If the admin is not a member of any of the defined roles, they will have the privleges given to the default role. User (Isolation Master only) Use this pane to set a user authentication method and then define the authentication settings for web and\/or email. This pane is used only in web\/email isolation master appliances. Configuring Settings Use the Settings panes to configure networking, service settings, logging, and user management in the Central Manager appliance. The panes are described below. Network Use the Network Settings pane to configure the appliance network settings (DHCP or Static IP). You can also configure the Upstream Internet proxy in this pane if you are in a chaining situation with another proxy between Menlo Security and the internet. In this situation you should add the CA certificate for the proxy in the pane so that proxy device can do SSL-bump and then set Enable to \"Yes\" under Upstream Internet proxy and set up the proxy chaining pieces. If the proxy device is doing SSL inspection, you can set the Upstream Proxy is inspecting HTTPS traffic toggle to \"Yes\" on both the Isolation Master and Worker so Menlo Security can send the connections (including the X-Auth-User, X-Forwarded-For, and Proxy-Auth headers) up to that proxy device. This option should only be enabled if the connection to the upstream proxy is controlled (i.e., on a private network\/vlan), since this options sends HTTPS traffic to the proxy as HTTP. This setting relies on the upstream proxy to do all certificate validation and any further encryption to the internet. Only enable this if your upstream proxy will control the X-Auth-User, X-Forwarded-For, and Proxy-Auth headers. It may take up to five (5) minutes for updated network settings to take effect. Service The Service Settings pane is used on the Central Manager to import a certificate file for appliance communication. There is a similar pane on a Web Isolation appliance where you define the Service Domain in addition to the certificate import. There is a basic requirement that the Appliance Hostname Login Name is the same across all appliances in the cluster (Isolation Master and Worker). Usually, you will use the name of the Isolation Master in this field. Access Control The Access Control Settings pane is used to configure systems and networks which can connect inbound to the various role types (Central Manager, Isolation Worker, Isolation Master, etc.) for management. This includes what systems can connect through the system (i.e., proxy through the architecture). Note that if the IP restriction setting is enabled, only SMTP connections from the host are allowed. This pane changes depending on the server type you are connected to, as shown in the figures below. The following areas are available, depending on appliance type: Management Services : All appliance types. Configures systems allowed to manage the infrastructure (admin web GUI) and internal management communications. If desired, set ICMP Ping to \"Enabled\" to monitor the appliance via Ping; this is set to \"Disabled\" by default. SNMP : All appliance types. If set to \"Enabled\", this enables control of the SNMP server so external machines can pull messages from it. Enter the Read-Only Community string in the RO Community String field. Access Control: Central Manager Cluster Communications : Isolation Manager and Worker. Configures communication between the Isolation Master and Isolation Worker. Access Control: Isolation Master Access Control: Isolation Worker Web Services : Isolation Manager only. Controls the systems allowed to connect through Menlo Security (infrastructure like desktop computers that connect through MSIP to the internet). Logs and Alerts The Logs and Alerts Settings pane is used on the Central Manager to configure local logging (or not use local logging). In either case, you have the option to also log to syslog (i.e., send logs to a dedicated SIEM). If you do not log locally, you will not get data into either the Dashboard or the Logs panes. The Dashboard widgets are all driven by local log information. Local Logs : Enable this field to allow for local log collection. You can configure the log retention in number of days below. The following is provided for all Remote Logs : User Session Logs track who went to which sites or accessed downloads. You can send the logs in Key-Value Pair for systems like Splunk, CEF for systems like ArcSight, and LEEF for IBM QRadar. Log Event Extended Format (LEEF) has a header that includes the LEEF version, product vendor, product name, product version, and an event ID. This is followed by a string of tab-delimited key-value pairs. To configure LEEF logs to be sent to QRadar, set the syslog host in the Dashboard Log Settings pane to be the IP address or the hostname of the QRadar system. If needed, configure the protocol and port to work with the QRadar configuration. If logs are not automatically detected and sent to QRadar, consult the QRadar documentation to set up manual detection. System Logs track what is happening on the system itself (e.g., administrator logged out of the admin interface). Operations Logs activates additional logs for full platform monitoring (e.g., statistics around resource utilization). These fields configure the operational logging syslog output destination. See for more information. Operations Metrics activates stats for full platform monitoring (e.g., statistics around resource utilization). These fields configure the operational metrics host, protocol, port and prefix. See for more information. Alerts : These fields configure SNMP alerts (trap host, port and community string). It is possible to configure two different destinations for each syslog output (session, system and operational), allowing logs to be output to different SIEMs (Security Information and Event Management). The log outputs can be configured in different formats if required: Key-Value Pair, Common Event Format (CEF) or Log Event Extended Format (LEEF). It may take up to five (5) minutes for updated logging settings to take effect. Notifications The Notifications pane is used to configure the mail server and user for all scheduled reports and notifications that are emailed. Mail Server : IP address of mail server Port : Mail server port number. If a non-standard port will be used, select Other and enter the port number in the field to the right. Mode : TLS mode requirement (SMTPS, SMTP StartTLS Required, SMTP StartTLS Optional, or No TLS (not recommended)) Username : Administrator username for SMTP service Password : Administrator password for SMTP service From Address : From address used for emailed reports and notifications Time The Time Settings pane is used to configure the NTP server and timezone settings. The browser and appliance current time are displayed below. It may take up to five (5) minutes for updated time settings to take effect. CA Certificates The CA Certificates Settings pane can be used to import, view, and manage CA certificates. These certificates will enable encrypted sessions to an upstream proxy in a manner which can be decrypted by that system for SSL inspection (i.e., upstream chaining with SSL support). To download the Menlo Security CA certificate for SSL inspection, please navigate to the following link: https:\/\/support.menlosecurity.com\/instructions\/cert To add a certificate perform the following steps: Click the Add CA Certificate button in the top right corner. Select the Browse... button and find the desired certificate on your system. Select the file and click Open . Click the Add button to add the certificate. If the certificate is invalid or the wrong file type, an alert is displayed. A new, valid certificate will be added to the CA Certificates pane. Invalid Certificate Warning To view details for any certificate click the View button inline with the desired certificate. The window that appears displays the common name, organizational unit name, locality name, state\/province name, country name, SHA1 fingerprint, and certificate validity time period. Click the OK button to close the window. To delete a certificate select the Delete button inline with the certificate to be removed. A window appears to confirm deletion. Proxy This pane configures the network proxy settings for a web isolation appliance. In addition, the Listen Proxy Protocol setting has been added for customers who wish to limit the hosts that are trusted to send the PROXY protocol (enter trusted IPs of load balancers in the Trusted IPs field). You can also import an SSL bump certificate into the Isolation Master from this pane. Forensic Archive (Isolation Appliances only) Configures the archiving of files being accessed by users to a remote SCP (secure copy) server using public key exchange. Files being downloaded from isolated sites will be zipped and archived to this server. For security, the SCP server should be write-only (disallowing file downloads). The settings should be configured either directly on isolation appliances or in a management template. Use this screen to discover the Menlo Security Isolation Platform Security Key. This security key is a public key generated by the Central Manager and is unique to the deployment. The MSIP Security Key is used with scp server requests to validate request authenticity. Copy and paste the key into your SCP server configuration to complete the public key exchange. This key normally goes into the ~\/.ssh\/authorized_keys file on Linux SCP servers in the home directory of the user configured for the scp connection. Delete other public keys before saving the browser recorder settings to ensure that multiple public keys from the same SCP server are not present. To use this feature: Enter the Hostname , Port and Username of the SCP server. Optionally specify a file path on the server and a password for the zip files. Click Fetch to attempt to establish an ssh connection to the server and obtain its public key. If you cannot automatically obtain the key, then you should obtain it from the server and paste it into the Public Key field. You should validate that the key corresponds with your SCP server's public key. To complete the public key exchange save the template and open the Forensic Archive Settings pane ( Management -> Templates -> Edit Configuration Template -> System Settings -> Forensic Archive ). Copy the Menlo Security Isolation Platform Security Key (the public key generated by the Central Manager) into your SCP server. Web Settings (Isolation Appliances only) The Web Settings pane can be used to configure isolated browser settings for isolation appliances. The following settings can be configured in this pane. If any changes are made, press the Save button at the bottom of the page to save the new configuration before going to another pane. Certificates Use these fields to manage browser certificates. The following is provided: Invalid Certificates : Set the default action for invalid certificates: Block the page from loading automatically, or Ask User to confirm if they wish to proceed. Strict Certificate Name Validation : Set to True if you wish for the certificate name to be validated using a list of trusted certificate authorities. Skip Certificate Revocation Check : Set to True to optionally skip the certificate revocation check. This check may be redundant if revocation checks are already performed during SSL inspection by next-hop proxies. Custom Name Use the Platform Branding field to customize the name used for dialog boxes and messages generated by the system. This should be set to a recognizable name like \"Secure Web\" or \"Web Isolation Platform.\" Resource Optimization Use these fields to optimize browser resources and configure the tab detach feature. Resource Optimization Max Tabs per User : Sets the maximum number of tabs a user can have open during a session. Tab Detach : Browser tabs can be detached from DVCs (Disposable Virtual Containers) after a period of non-use so that the system can free up resources and handle more users. Detached tabs will continue to display current content (e.g., video\/audio may play buffered content and animated gifs will still animate, but otherwise the page is static). As soon as user input is detected, the page is refreshed. Background tabs are refreshed when they become foreground tabs. Profile : Sets a resource optimization profile to use for the appliance. There are three predefined optimization profiles: Relaxed , Moderate , and Aggressive . Each profile defines the amount of time that must pass before a tab is detached from the DVC. The Aggressive profile will detach tabs more frequently, whereas the Relaxed profile will detach tabs less frequently. Custom optimization profiles may also be defined. It is recommended that one of the predefined profiles are used, and custom profiles are only used when predefined profiles do not meet your requirements. The custom profile will allow minimum timeout values of 10 minutes and a maximum value of 24 hours. Timeouts may be disabled for particular tab types. Foreground Tab : Tab currently viewable in the browser window. The predefined profiles use a longer timeout for this tab because it is in use. Background Tab : Tabs not in view in the browser window. The predefined profiles use a shorter timeout for these tabs because they are not in use. Media : Tabs playing audio or video. The predefined profiles have no timeout for media tabs so that music or video are not interrupted. Input : Tabs containing input fields such as forms. The predefined profiles use a longer timeout for tabs with input to avoid disruption when completing forms. Header Fields Use these fields to configure the infomration provided for header forwarding: Include User's IP Address as X-Forwarded-For Header : If True , the user's IP address is included in x-forwarded-for header. Populate Header With : Source used for header field Enable X-Authenticated-User Header Forwarding : If True , header forwarding is enabled for x-authenticated users. Web Security Gateway Prepend Use these fields to manage web gateway security. Restrict Prepend Access to Websites Forwarded by Web Gateway : If set to True , users cannot modify the URL to bypass the proxy security policy. Ensure New Domains are Reauthorized by Web Gateway Policy : If set to True , users are restricted to the initial domain, and any links on the page that direct the user to a new domain are subject to the proxy security policy. Files These fields manage file download and upload policy. Note that if a Central Manager is used, these should be set to Allow , and the Central Manager will set the granular file and document policy for all appliances. File Downloads : If set to Allow , file downloads are allowed (or the file policy is set by the Central Manager). File Upload : If set to Allow , file uploads are allowed (or the file policy is set by the Central Manager). Maximum File Size (Gb) : Sets the maximum file size in Gb. DLP Visibility These fields configure DLP (Data Loss Prevention) visibility so isolated traffic uploads and user input can be analyzed by third party DLP appliances. The applicable traffic is formatted and replayed by the DLP service. Enable DLP Visibility : Turns On the DLP visibility feature. DLP Block Message : Any HTTP response other than \"200 MSIP_OK\" is treated as a DLP block. Native : This shows the DLP block message from the 3rd party DLP product for both uploads and user input DLP blocks. Menlo Block Messages : This shows the Menlo block message for both uploads and user input DLP blocks. Data Encoding : Select either Multipart-form or URL Form for the desired data encoding to use. System Update The System Update panes allow an administrator to set up automatic checks for system updates and upload updates, as well as to roll the software back to a previous version or the factory default (initial installation). Add License Key All appliances must have a valid license installed. In most cases, the same license will be used for all of the deployment. If any system updates or rollbacks fail, confirm that a valid license is configured before downloading and installing updates. Before checking for or installing update packages, open the License Key pane ( System Update -> License Key ) to enter your unique license key. Click Save to save the key on the Central Manager appliance. A message will appear if the key validates correctly or if there is an issue with the key. License keys can be restricted to allow only specific product updates and should not be distributed or shared outside your organization. The status of any licensed features is provided below. Performing System Updates or Rollbacks There are two types of updates which can be applied: full system updates via the Menlo Security Update servers or hot patch updates from a file uploaded to the system. All appliances, including the separately licensed email attachment worker, can be centrally upgraded from the Central Manager. To perform a system update from the Menlo Security Update servers: Confirm the License Key has been entered. Check the Check For Updates Automatically checkbox. When updates are available, a message is displayed in this field. To immediately check for an update, click the Check For Update button. If an update is available, a message appears in the pane. To update the system, click the Download button. After running the update, the appliance will restart automatically if it needs to do so in order to complete the update. To apply a Hot Patch from an Update Package : Confirm the License Key has been entered. Click the Browse... button to find the package file on your system. Click Upload to continue. Click the Update button and select Apply to confirm the change. The appliance will be restarted. In some cases a web or email isolation appliance will ask if it should come up in Maintenance Mode which means it won't announce itself as available to start taking connections. This mode can be changed by logging into the appliance and clicking Exit Maintenance Mode . This control helps make sure systems being worked on in a load balancing scenario don't start taking sessions before you have fully completed your upgrade. To Rollback to a previous version, use the Rollback Version pull-down menu: Determine the rollback version you wish to use: To return to a version with saved settings, select the desired Version number from the menu. To return to the factory default settings (all user-entered settings will be lost), select Factory Reset from the menu. Click the Rollback button. Enabling New Features After a System Update Customers must explicitly \"opt-in\" to use new features that are added to the cloud and on-prem system updates. Features such as the custom block page will not take effect until after the admin saves and publishes the change. Customization Use the Customization pane to customize the block page used when the Isolate appliance blocks suspicious web pages. Customers can customize the warning message and button text, add a link to your company policy, and define the CSS styles and logo used in the banner or block page. The Email Customization pane is only used with Menlo Security Email Isolation; refer to for details. To perform customization: Log into the Administrator Panel, and open the Web Customization pane ( Customization -> Web ). Customization is enabled by default. Select the radio button for the desired level of customization: Basic : Use the the default block page template and modify it using the settings provided on the Web Customization pane. Advanced : Create a custom block page by entering HTML code in the box that appears. For Basic customization, enter the desired text\/links in the following sections: Block Page Contents : Defines the heading and text used in the block page. Custom Link for Company Policy : Adds a link to your company policy to the block page. Block Page Theme : Use the menu to select a color theme (yellow, red, or white and silver) to use with the block page. To use a different color\/font scheme and add your company logo, check the Setup Custom Settings checkbox and enter the desired settings in the new fields that appear. If desired, click the Preview button to preview the block page. Example Block Page Custom Settings Select the Reset button to return to the last saved settings, or select Save Changes to save the new settings. Select Publish to implement the new customization. " }, 
{ "title" : "Logging for Private Cloud (On-Prem) OVAs ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41935-logging-for-private-cloud--on-prem--ovas.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Logging for Private Cloud (On-Prem) OVAs ", 
"snippet" : "Introduction This document describes the logging available for a Private Cloud (a.k.a., \"On-Prem\") deployment of the Menlo Security Isolation Platform (MSIP). Web, SMTP, Email Rewriter, and Admin logging are supported. Common SMTP Transaction Event Logs The SMTP transaction event log will start with...", 
"body" : "Introduction This document describes the logging available for a Private Cloud (a.k.a., \"On-Prem\") deployment of the Menlo Security Isolation Platform (MSIP). Web, SMTP, Email Rewriter, and Admin logging are supported. Common SMTP Transaction Event Logs The SMTP transaction event log will start with one of the following event types: inbound-message-start : A new SMTP session has been received. upstream-accept : The SMTP transaction has completed and the message delivery was acknowledged by the next-hop MTA. upstream-reject : The SMTP transaction was rejected by next-hop MTA; details are included in the event log. The following SMTP transaction IDs are recorded: External MTA to Menlo Transaction : The transaction ID from the External MTA is logged in the \"stat\" field of the outbound message log. Menlo to Internal MTA Transaction : The transaction ID from Menlo to the Internal MTA is passed in the SMTP session close. Inbound Message Received Displays the message received by the Menlo appliance. Message and Source attributes are available. Example 20032003-08-24T05:14:15.000003-07:00 192.0.2.1 msip 8710 inbound-message-start - device=“msip” hostname=“msip-transform5.comany.com” event=“inbound-message-start\" message_tid=“8888-eeee-aaaa-1111-2222” message_id=“<69B3@SBECMX003.mta.company.com>” from=\"<jack@acme.com>” to=\"<bob.jones@company.com>” src_ip=“192.168.0.1” src_port=“55363” src_tls=“true\" Response Parameter Description Example inbound-message-start Start of inbound message NA device Device msip hostname Email processor hostname msip-transform5.comany.com event Event inbound-message-start message_tid Menlo transaction ID for correlation across all Menlo logs 8888-eeee-aaaa-1111-2222 message_id SMTP Message ID from message headers 69B3@SBECMX003.mta.company.com from Envelope send (MAIL FROM) jack@acme.com to Envelope recipients bob.jones@company.com src_ip Source IP Address 192.168.0.1 src_port Source port 55363 src_tls Whether transport layer security was used talking to the source MTA true Message Sent Displays the message passed to the next-hop MTA. Full log infomation is available. Example 2003-08-24T05:14:15.000003-07:00 192.0.2.1 msip 8710 upstream-accept - device=\"msip\" hostname=\"msip-rewriter5.company.com\" event=\"upstream-accept\" message_tid=\"8888-eeee-aaaa-1111-2222\" message_id=\"69B3@SBECMX003.mta.company.com>\" from=\"jack@acme.com\" to=\"bob.smith@company.com\" src_ip=\"192.168.0.1\" src_port=\"55363\" src_tls=\"true\" dst_ip=\"192.0.3.1\" dst_from_port=\"33454\" dst_tls=\"true\" time_taken=\"0.12\" total_links=\"5\" rewritten_links=\"3\" stat=\"250 2.0.0 u0KJBTQx001471 Message accepted for delivery\" Response Parameter Description Example upstream-accept Start of message NA device Device msip hostname Email processor hostname msip-rewriter5.company.com event Event upstream-accept message_tid Menlo transaction ID for correlation across all Menlo logs 8888-eeee-aaaa-1111-2222 message_id SMTP Message ID from message headers 69B3@SBECMX003.mta.company.com from Envelope send (MAIL FROM) jack@acme.com to Envelope recipients bob.jones@company.com src_ip Source IP Address 192.168.0.1 src_port Source port 55363 src_tls Whether transport layer security was used talking to the source MTA true dst_ip Destination IP address 192.0.3.1 dst_from_port When connection is established with downstream MTA, MTA's port is fixed, but local port requires indicating - useful for diagnosing issues based on connection, which is identified by tuple (local IP, local port, remote IP, remote port). 33454 time_taken Total time spent in seconds processing email 0.12 total_links Number of links in the email 5 rewritten_links Number of links rewritten 3 stat Any identifier received from next-hop MTA 250 2.0.0 u0KJBTQx001471 Message accepted for delivery Upstream-reject Displays the message returned if rejected by the next-hop MTA. Example 2003-08-24T05:14:15.000003-07:00 192.0.2.1 msip 8710 upstream-reject - device=\"msip\" hostname=\"mailsrv.company.com\" event=\"upstream-reject\" message_tid=\"8888-eeee-aaaa-1111-2222\" message_id=\"69B3@SBECMX003.mta.company.com\" from=\"jack@acme.com\" to=\"bob.smith@widgetco.com\" src_ip=\"192.168.0.1\" src_port=\"55363\" src_tls=\"true\" dst_ip=\"192.0.3.1\" dst_from_port=\"33454\" dst_tls=\"true\" error=\"WrongDomainError\" errorMessage=\"500 Can’t accept message to bob.smith@widgetco.com\" Response Parameter Description Example upstream-reject Start of message NA device Device msip hostname Email processor hostname mailsrv.company.com event Event upstream-reject message_tid Menlo transaction ID for correlation across all Menlo logs 8888-eeee-aaaa-1111-2222 message_id SMTP Message ID from message headers 69B3@SBECMX003.mta.company.com from Envelope send (MAIL FROM) jack@acme.com to Envelope recipients bob.jones@company.com src_ip Source IP Address 192.168.0.1 src_port Source port 55363 src_tls Whether transport layer security was used talking to the source MTA true dst_ip Destination IP address 192.0.3.1 dst_from_port When connection is established with downstream MTA, MTA's port is fixed, but local port requires indicating - useful for diagnosing issues based on connection, which is identified by tuple (local IP, local port, remote IP, remote port). 33454 dst_tls Whether transport layer security was used talking to the destination MTA true error Error type WrongDomainError errorMessage Error message 500 Can’t accept message to bob.smith@widgetco.com Transform and Restore Logs Each Transform and Restore log entry is logged as an \"url-rewrite\" event. For the rewritten parameter, the following actions are available: Transform : URL is transformed Whitelisted : URL whitelisted and not transformed For the reason parameter, the following reasons behind the action are available: Default : Any URL not otherwise configured is rewritten Manual : The Domain is manually added to the whitelist Menlo : The Domain is added to the whitelist via import from the Menlo Popular Sites list Blacklist : Very few sites are overridden. For example, sites.google.com hosts user content, not the typical Google corporate content Several examples are provided below. Example 1: Transform (Default) Aug 24 18:44:44 rewrite: event=\"url-rewrite\" pid=19030 time=\"2017-08-24T18:44:44.074Z\" rewritten=\"transform\" reason=\"default\" message_tid=\"069cbab0-53b9-11e8-957d-0798c7fe30db\" to=[\"alice@example.com\"] from=[\"donotreply@sender.com\"] subject=\"Good News\" message_id=\"23498msgid@sender.com\" delivered_to=[\"alice@example.com\"] charset=\"us-ascii\" domain=\"www.menlosecurity.com\" url=\"https:\/\/www.menlosecurity.com\" filename=\"\" mime_type=\"\" bytes=\"\" sha256=\"\" unix_time=1525891484 unix_time_iso=\"2017-08-24T18:44:44.074Z\" Example 2: Whitelist (Menlo) Aug 24 18:44:44 rewrite: event=\"url-rewrite\" pid=19030 time=\"2017-08-24T18:44:44.074Z\" rewritten=\"whitelist\" reason=\"menlo\" message_tid=\"069cbab0-53b9-11e8-957d-0798c7fe30db\" to=[\"alice@example.com\"] from=[\"donotreply+tji@sender.com\"] subject=\"Good News\" message_id=\"23498msgid@sender.com\" delivered_to=[\"alice@example.com\"] charset=\"us-ascii\" domain=\"www.google.com\" url=\"https:\/\/www.google.com\" filename=\"\" mime_type=\"\" bytes=\"\" sha256=\"\" unix_time=1525891484 unix_time_iso=\"2017-08-24T18:44:44.074Z\" Example 3: Transform (Blacklist) Aug 24 18:44:44 rewrite: event=\"url-rewrite\" pid=19030 time=\"2017-08-24T18:44:44.074Z\" rewritten=\"transform\" reason=\"blacklist\" message_tid=\"069cbab0-53b9-11e8-957d-0798c7fe30db\" to=[\"alice@example.com\"] from=[\"donotreply+tji@sender.com\"] subject=\"Good News\" message_id=\"23498msgid@sender.com\" delivered_to=[\"alice@example.com\"] charset=\"us-ascii\" domain=\"sites.google.com\" url=\"http:\/\/sites.google.com\" filename=\"\" mime_type=\"\" bytes=\"\" sha256=\"\" unix_time=1525891484 unix_time_iso=\"2017-08-24T18:44:44.074Z\" Response Parameter Description Example rewrite event Transform or Restore log entry url-rewrite timestamp Start time of the requesting log (internal to the log database) 2017-08-24T18:44:44.074Z rewritten Action taken transform reason Why action was taken default message_tid Message transaction identifier (in all log messages pertaining to a given message transaction) 069cbab0-53b9-11e8-957d-0798c7fe30db to List of recipients reported by To: header fields contained within the email message or the addresses provided along with the RCPT TO SMTP command if no To: header fields are present alice@example.com from The sender reported by From: header field within the email message or the address provided along with the MAIL FROM SMTP command if no From: header field is present donotreply@sender.com sender The sender of the email (automatically filtered by console logs but appears in syslog output) null subject Contents of the Subject: header field Good News reply_to Email reply_to value null email_date Value of Date: header field of the email 2017-03-28T 13:47:17+01:00 message_id Message identifier 23498msgid@sender.com delivered_to Address the message was delivered to alice@example.com tid Menlo Security tenant identifier -1 charset Character set encoding used to represent URL us-ascii domain Hostname part of URL (used to optimize filtering by domain) www.menlosecurity.com url URL (either the one isolated during transform or the one restored during undo) https:\/\/www.menlosecurity.com reason The rationale behind the modification default rewritten The operation performed transform pid Process ID of rewriter process that performed the event being reported 5761 time Timestamp of the event in ISO8601 format 2017-08-24T18:44:44.074Z unix_time Time in seconds since Unix epoch 1525891484 unix_time_iso Timestamp of event in ISO8601 format 2017-08-24T18:44:44.074Z " }, 
{ "title" : "Secondary Central Managers ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41936-secondary-central-managers.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Secondary Central Managers ", 
"snippet" : "Introduction This document provides some guidelines for when a Secondary Central Manager may be beneficial, how to deploy one, and what happens if you have a failover of the Primary Central Manager. When to Deploy a Secondary Central Manager Should I Deploy a Secondary Central Manager? Secondary Cen...", 
"body" : "Introduction This document provides some guidelines for when a Secondary Central Manager may be beneficial, how to deploy one, and what happens if you have a failover of the Primary Central Manager. When to Deploy a Secondary Central Manager Should I Deploy a Secondary Central Manager? Secondary Central Managers are most beneficial for environments that use SAML for authentication and in cases where policy exceptions are applied to groups of users. All proxy traffic is handled by the Isolation Standalone and Isolation Master applicance types. However, the Central Manager stores SAML atttributes and must be accessible during SAML authentication. If you have only one Central Manager, the following issues can occur if the Central Manager becomes unavailable: Group Exceptions are no longer enforced . For example, you may have a policy to block blockeddomain.com for all members of the group \"mydomainrestricted\". Without an active Central Manager, the Menlo cluster will not be able to determine a user's group membership and will apply your threat or category policy for blockeddomain.com instead. This can be problematic if your category policy is less restrictive. New browsing sessions cannot be initiated . Any SAML authenticated user who attempts to start a new browsing session will see a blank page with a spinning circle instead of the desired page. Existing sessions will continue as before, but new navigations will be affected by Issue 1 described above. Secondary Central Manager Functions A Secondary Central Manager can provide the following: Displays a readonly interface for viewing Web Policy settings, appliance groups and templates, Email Policy settings, and customization settings Stores a copy of the SAML attributes required for group exceptions and successful SAML authentication Secondary Central Manager Limitations Note that a Secondary Central Manager will NOT do any of the following: Allow you to change policy Become the Active\/Primary Central Manger when your Primary Central Manager is unavailable. The Secondary Central Manager remains readonly even when the Primary Central Manager is down. Provide access to the Dashboard, Logs, or Insights How to Deploy a Secondary Central Manager This section outlines the steps for deploying a secondary central manager in the MSIP. For additional assistance, please contact Menlo Security Support. Deploy a new Central Manager (the Secondary Central Manager) on your hypervisor. Ensure that this appliance can talk to the existing (Primary) Central Manager across the network and both hostnames are resolvable. The two Central Managers will communicate over port 8444 for HA replication. Log in to the admin web console on the Primary Central Manager (the existing Central Manager) and go to the Manage Appliances pane ( Management -> Appliances ). Select the Add Appliance button. Enter the Hostname of your Secondary Central Manager (the new Central Manager) and click Next . View the Secondary Central Manager appliance certificate and click Next . Enter a password for the Secondary Central Manager and click Next . Enter a Display Name for the Secondary Central Manager and add it to the managers group. Click Add Appliance to proceed. The Primary Central Manager admin dashboard restarts. Log into the Primary Central Manager again and the Secondary Central Manager will be viewable at the Manage Appliances pane ( Management -> Appliances ) under the \"managers\" group. OVA Failover This section assumes appliance version 2.62.5 or later is in use. Please contact Menlo Security Support for details. This section provides information about OVA failover if a member of the cluster group becomes unavailable\/unreachable. The examples below were tested with the following cluster environment: 2 Central Manager nodes (CMR) 2 Master nodes 1 Worker node 1 HAProxy virtual machine to load-balance end users' traffic to the Master nodes All nodes used a single NIC, with Master and Worker nodes belonging to a single Appliance Group. Network-related issues were simulated by physically unplugging each node from the network so they would be unreachable. Primary Central Manager Node is Unavailable If the Primary Central Manager becomes unreachable, end users' traffic is not impacted -- traffic is routed through the Master nodes, which are still able to fetch and enforce the cluster's policy using the Secondary Central Manager. Cluster administrators are affected as follows: The Secondary Central Manager remains Read-Only . Administrators can not edit the policy or cluster topology\/settings. Administrators can review the cluster's health, Web and Email policy, and other cluster and appliance settings. Administrators cannot access the Web, Email, or Audit logs. The missing logs will be available on the Primary Central Manager after it becomes reachable again. Master Node is Unreachable If your appliance group contains more than one Master node, the end users' web traffic must be load-balanced to your Master nodes. If a Master node becomes unreachable, your load-balancing software should detect the issue and then route traffic to the available Master nodes. The following figure shows an example of an unavilable Master node ( master_1 ) where the node was unplugged from the network. Provided the load-balance is correctly configured, end users' web traffic should not be impacted by this event, as the traffic will be routed through a working Master node. " }, 
{ "title" : "Network Management ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41937-network-management.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Network Management ", 
"snippet" : "Introduction Menlo Security appliances can be configured with up to four network interfaces so that different types of traffic can be separated out onto different networks. These four network interface types are: Inbound : Network interface that is connected the internal user network and provides in...", 
"body" : "Introduction Menlo Security appliances can be configured with up to four network interfaces so that different types of traffic can be separated out onto different networks. These four network interface types are: Inbound : Network interface that is connected the internal user network and provides ingress to the Menlo Security proxy and isolation services External : Network interface that is connected to the external network and has a route to the internet Management : Network interface that is connected to the management network and hosts the Admin Portal (web user interface) Cluster : Network interface that is connected to a dedicated network for handling communication between Menlo Security appliances 2 Network Mode will separate traffic into a Production interface (for Inbound and External traffic) and a Management interface. 3 Network Mode will use Inbound , External , and Management network interfaces. The following table shows the network interface mappings for each network mode. Network Interface 1 Net Mode 2 Net Mode 3 Net Mode 4 Net Mode Inbound eth0 eth0 eth2 eth2 External eth0 eth0 eth0 eth0 Cluster eth0 eth1 eth1 eth3 Management eth0 eth1 eth1 eth1 The network interfaces and network mode can be configured in both the Admin Portal (web UI) and from the CLI. Details for each are provided below. Managing Network Interfaces in the Admin Portal Log into the Admin Portal and open the Network Settings pane ( Settings > Network ) to configure the network interfaces and the network mode. The pane displays the currently configured network profile: Edit Settings To define the settings for any interface, select the Edit Settings button and update them as needed: Mode : Network mode (not editable). See ???. Status : Network connection status (not editable) MAC Address : Interface MAC address (not editable) Protocol : Routing protocol. If DHCP service is available this can be switched to DHCP . IP Address : Interface IP address. For static assignment, IP addresses must be entered with CIDR notation (e.g., an IP address of 10.10.10.10 with a subnet mask of 255.255.255.0 must be expressed as 10.10.10.10\/24 ). Gateway : Interface Gateway (for the external interface) Hostname : Hostname Change Mode To change the network mode, select the Change Mode button. A modal opens that provides a drop-down list of all available network modes. Select a mode from the list to view its description and a topology diagram of the mode. Any change will not take effect until the Apply button is pressed. Only relevant modes are available in the menu. If the appliance has only two network interfaces, the menu will not display \"3 Network Mode\" or \"4 Network Mode\". Managing Network Interfaces from the CLI Use the following commands to configure network interfaces, routes, and the network mode from the CLI. For more information about the CLI commands, see ???. configure_network The configure_network command configures the specified network interface (eth0, eth1, eth2, or eth3). For example, to configure the static IP address and subnet mask to 10.10.10.10\/24 on eth1, enter: configure_network eth1 static -i 10.10.10.10 -m 255.255.255.0 route and persist_route The route and persist_route commands are used to add static routes. Note that the route command immediately applies changes to the routing table, but these changes do not persist after a reboot. For example, to immediately add routes to eth1: route add -net 10.10.10.0 netmask 255.255.255.0 gw 10.10.10.1 dev eth1 To have the routes persist following a reboot, the persist_route command must also be used: persist_route add -net 10.10.10.0 netmask 255.255.255.0 gw 10.10.10.1 dev eth1 configure_network_mode The configure_network_mode command displays the current network mode and allows users to change the network mode as needed. Use help configure_network_mode to view the usage and all options for this command. To show the current network mode: configure_network_mode --show To change the network mode, enter the command with the number that corresponds to the desired mode (1 through 4). For example, to switch to 4 Network Mode: configure_network_mode 4 " }, 
{ "title" : "Command Line Interface Guide ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41938-command-line-interface-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ Command Line Interface Guide ", 
"snippet" : "Introduction This guide outlines the interface and features provided for the Menlo Security Isolation Platform (MSIP) Command Line Interface (CLI). The CLI can be used for basic configuration and troubleshooting of the MSIP after the appliances have been created and deployed. For more information ab...", 
"body" : "Introduction This guide outlines the interface and features provided for the Menlo Security Isolation Platform (MSIP) Command Line Interface (CLI). The CLI can be used for basic configuration and troubleshooting of the MSIP after the appliances have been created and deployed. For more information about initial deployment of the Menlo Security Web Isolation, Email Isolation, and Central Manager appliances, refer to . For a full description of each command, see its manpage. The Firefox browser has a known limitation when using the Firefox browser that prevents use of the hyphen (-) and underscore (_) keys. See GitHub shellinabox bug for details. A workaround for this issue is to open the onscreen keyboard from the CLI's context menu and use that to enter these characters. Complete CLI Command Reference arp authorized_key_add authorized_key_list authorized_key_remove certreset clean_logs clear configure_network configure_network_mode date dig disk_status EOF exit export_config export_logs free generate_csr help history hostname httptest icap_bypass_list ifconfig ifdown ifquery ifup import_config install_cert iostat license netstat nslookup ntpsync passwd password_policy persist_route ping ps reboot restart route show shutdown status sysadmin_account syslog_settings tail tcpdump telnet timezone top tracepath uptime view_cert version arp Purpose: Display the Address Resolution Protocol (ARP) cache Usage: arp [-v] [-n] Options: Flag Description -a Display all hosts in alternative (BSD) style -n Don't resolve names -v Verbose authorized_key_add Purpose: Add authorized SSH key for public key authentication Usage: authorized_key_add The CLI will prompt for public key data. authorized_key_list Purpose: List signatures and metadata of authorized keys for public key authentication Usage: authorized_key_list authorized_key_remove Purpose: Remove specified key from public key authentication authorized keys. Usage: authorized_key_remove <public key signature> where <public key signature> is the desired public key to be removed certreset Purpose: Reset certificate Usage: certreset clean_logs Purpose: Clean the system logs by removing or purging the system logs. This command can be used to reduce disk usage. Usage: clean_logs clear Purpose: Clear the terminal screen Usage: clear configure_network Purpose: Configures the specified network interface Usage: configure_network eth0|eth1 dhcp configure_network eth0|eth1 static [-i IP] [-m MASK] [-g GW] [-n NSIP] Options (for static configuration): Flag Description -i IP address -m Network mask -g Gateway -n Nameserver configure_network_mode Purpose: Displays the current network mode and changes the network mode Usage: configure_network_mode <mode> where <mode> is any of the following: 1 : 1-network-mode (One interface handles all traffic) 2 : 2-network-mode (Separate interfaces for proxy and management traffic) 3 : 3-network-mode (Separate interfaces for inbound, management, and outbound traffic) 4 : 4-network-mode (Separate interfaces for inbound, management, outbound, and cluster traffic) Options: Flag Description --show Show the current network-mode profile and other supported network modes according to the number of available interfaces and the appliance type date Purpose: Print the current system time Usage: date dig Purpose: DNS lookup utility Usage: dig @NAMESERVER HOSTNAME TYPE where TYPE indicates what kind of query is required: TYPE Description ANY = * All cached records A Address record (default) AAAA IPv6 address record CNAME Canonical name record DNSKEY DNS Key record IPSECKEY IPsec key LOC Location record MX Mail exchange record NAPTR Naming Authority Pointer NS Name server record PTR Pointer record RRSIG DNSSEC signature (RRSIG: resource record digital signature) SOA Start [a zone of] authority record SRV Service locator SSHFP SSH Public Key Fingerprint TXT Text record OPT Option disk_status Purpose: Print info about all mounted disks Usage: disk_status EOF Purpose: Exit on system end of file character Usage: EOF exit Purpose: Exit the interpreter with this command or by using Ctrl-D Usage: exit export_config Purpose: Export the appliance configuration to JSON structure: \"format_rev\": 1, \"config\": {appliance configuration} \"cmr_db\": {group and template configuration - CMR only} \"policy_db\": {policy configuration - CMR only} \"tenant_config\": {system configuration - CMR only} Usage: export_config [-E [USER@]HOST:[PATH] ] If no option is specified, the JSON is printed. Options: Flag Description -E [USER@]HOST:[PATH]] Optional target. When supplied, the configuration will be exported by scp (secure copy) to this target. export_logs Purpose: Prepares a compressed tar.gz file of logs and diagnostics to export. This uploads the file to the specified scp (secure copy) address, specifying the ssh HOST, USER, and target PATH. If the PATH contains no filename, the default filename is used: msip_logs_HOSTNAME_TIMESTAMP.tar.gz . Usage: export_logs [-n DAYS] [USER@]HOST:[PATH] Options: Flag Description -n DAYS Number of DAYS of logs to send (default: -n 2) For example, to send the logs and diagnostics for a month, use -n 30 ; to send two weeks' logs and diagnostics, use -n 14 . free Purpose: Human readable free Usage: free generate_csr Purpose: Generate a certificate signing request (CSR) Usage: generate_csr {server|inspection} [options] Options: Flag Description --cn Certificate's common name. Required for inspection CSR. Ignored for server CSR. --country country name --state state\/province name --locality city name --org organization\/company name --dep department name --additional-names Optional additional names for the system's subject alternative names (ignored for inspection CSR) --key-len length of private key (2048, 3072 or 4096) --include-ips include system's IPs in subject alternative names (server only) By default, the system's hostname, service-name, etc. are automatically included in the CSR. help Purpose: List available commands or view detailed help Usage: help : Lists all available commands. help [COMMAND] : Provides detailed help for the command. history Purpose: Show command history Usage: history [NUM] : Show NUM entries of command history (by default all). hostname Purpose: Show all interfaces in the machine You can also use the show hostname command to show all interfaces in the machine. Usage: hostname hostname [-i <interface>] <new hostname> Options: Flag Description -i Specify the interface to set the hostname on. If this is not set, the default interface eth0 will be used. httptest Purpose: Check internet connectivity from the appliance by sending a HTTP request Usage: httptest [-d] [-pm] [-k] [-pr] HOST Options: Flag Description -pm Show HTTP header information -d Display the returned html\/object -k Ignore certificate errors -pr Bypass system proxy icap_bypass_list Purpose: View ICAP bypass list Usage: icap_bypass_list ifconfig Purpose: Show network interface info Usage: ifconfig [-a] [-v] [-s] [INTERFACE] Options: Flag Description -a all interfaces, including if down -v Verbose -s Short list   If interface is not specified, all interfaces are listed. ifdown Purpose: Take the network interface down Usage: ifdown ifquery Purpose: Parse the interface configuration Usage: ifquery ifup Purpose: Bring network interface up Usage: ifup import_config Purpose: Import a configuration backup file generated from the export_config command, and accept the input from the screen as the default. Usage: import_config [-E [USER@]HOST:[PATH] ] Options: Flag Description -E [USER@]HOST:[PATH]] Optional target. When supplied, the configuration will be imported by scp (secure copy) from this target. install_cert Purpose: Install signed SSL certificate Usage: install_cert {server|inspection} The CLI will prompt for the cert PEM content. iostat Purpose: Displays statistics for CPU and disk IO Usage: iostat [ -x ] [ interval [ count ] ] Options: Flag Description -x Display extended statistics interval Specifies the duration of time in seconds between each report. If count is set, interval must be greater than 0 count Specifies the number of reports generated at interval seconds apart license Purpose: Print license key Usage: license netstat Purpose: Display networking information Usage: netstat -an : Show all sockets, don't resolve names netstat [-ral] [-tuwx] [-en] Options: Flag Description -r Routing table -a All sockets -l Listening sockets (otherwise: connected sockets) -t TCP sockets -u UDP sockets -w Raw sockets -x Unix sockets (otherwise: all socket types) -e Other\/more information -n Don't resolve names nslookup Purpose: Query DNS for domain name or IP address mapping or any specific DNS record Usage: nslookup HOSTNAME [NAMESERVER] ntpsync Purpose: Sync with the configured NTP server Usage: ntpsync passwd Purpose: Reset password Usage: passwd password_policy Take care when setting up your password policy. If the policy is too strict you may get locked out of your system (for example, if --unlock_time is set to 0 or a very large number). Purpose: Change password policy Usage: password_policy Unknown macro: {basic|strict} Options for strict mode: Flag Description --retry_attempts number of password attempts before account is locked --unlock_time time in seconds the account is locked (0 means forever) --minlen minimum length of new passwords --minclass minimum number of different character classes required in new passwords --pw_history number of previous passwords stored in history to restrict reuse of passwords persist_route Purpose: Permanently store the effects of a respective route command. This command takes the same exact options\/arguments as the route command when adding\/deleting routes with route add and route del . However, unlike the route command which installs\/removes the route to\/from the kernel's dynamic routing table (which does not survive reboots), this command persists the route in the system network interface configuration files. You should first install and test the route with the route command, and only after verifying that it works, use persist_route with the exact same arguments to make the route permanent across system reboots. Usage: persist_route add ... : Permanently stores the route from route add ... persist_route del ... : Permanently deletes the route as route del ... ping Purpose: Test reachability of DESTINATION on IP network Usage: ping [-qv] [-aBnU] [-DO] [...] DESTINATION ping [...] [-c count] [-i interval] [-l preload] DESTINATION ping [...] [-w deadline] [-W timeout] DESTINATION Options: Flag Description -q Quiet -v Verbose -a Audible ping -B Do not allow source address change -n Numeric output, no DNS lookups -U Report full user-to-user network latency (old behavior) (unaffected by DNS failures) -D Print timestamp before each line -O Report outstanding requests with -D option -c Count pings to send before exiting (default is 5) -i Secs inteval between pings (float, in seconds). Reg user = 0.2 secs or more. Superuser is less than 0.2 secs (200 ms). -l Preload max pings to send without reply. Reg user = 1 to 3. Superuser = more than 3. -w Deadline seconds (integer) -W Timeout seconds (integer) ps Purpose: Display a snapshot of current system processes Usage: ps [-s sort_field] (memory_percent, cpu_percent, pid) reboot Purpose: Instantly reboot system Usage: reboot restart Purpose: Immediately restart services Usage: restart [all | dashboard] route Purpose: Show\/manipulate the IP routing table Usage: route [-nNvee] [-FC] [<AF>] : List kernel routing tables; AF: address family route [-v] [-FC] {add|del|flush} : Modify routing table for Address Family Options: Flag Description -v, --verbose Be verbose -n, --numeric Don't resolve names -e, --extend Display other\/more information -F, --fib Display Forwarding Information Base (default) -C, --cache Display routing cache instead of FIB show Purpose: Print system status and various settings. \"show all\" prints all available information. A subcategory like \"show network\" prints all network-related information, and \"show timezone\" prints only the specific item. You may also list multiple topics on the command line at the same time. Lowest level items have an associated command that may be run directly to get the same information. E.g. with \"show route\", help lists also the respective route command in its list of \"Documented commands\". Running route without arguments prints the kernel routing table. But route command can also be used to manipulate routes when used with other options and arguments. Other show subcommands are undocumented, e.g. \"show timezone\" is equivalent to running the timezone command, but as a non-standard command, it is undocumented and not listed by help among its main list of Documented Commands. (There is no other use for it than running it without args to get the timezone.) Usage: show TOPIC [TOPIC] [...] Usage Definitions: show all : Print info from all subcategories: show network : Network: show hostnames : Show all interfaces in the machine show route : Kernel routing table show persist_route : Persistent route table show ifconfig : Network interface configuration info show system : System: show status : System status show syslog_settings : Configured syslog settings show disk_status : Info about all mounted disks show free : Amount of free and used memory (physical\/swap) show info : Miscellaneous: show date : Current system date\/time show timezone : Timezone of the machine show license : License key show version : Menlo Security Isolation Platform version shutdown Purpose: Brings the system down and powers it off Usage: shutdown status Purpose: System status Usage: status sysadmin_account Purpose: Enable\/Disable sysadmin account Usage: sysadmin_account Unknown macro: {enable|disable} If sysadmin is enabled, its login shell is limited to the following: sysadmin> help passwd : Change password sysadmin> help unlock_admin : Unlock admin account syslog_settings Purpose: Print the configured syslog settings Usage: syslog_settings tail Purpose: Display tail end of file Usage: tail [-s SEARCH_TERM] [FILENAME, such as haproxy, syslog, squid] tcpdump Purpose: Dump traffic on a network Usage: tcpdump -i INTERFACE -s 0 [ -X ] [ -A ] tcp host HOST port PORT with a predicate string: tcpdump -n -i eth0 [ EXPRESSION ] tcpdump -n -i eth0 \"(host IP-ON-ETH0 or ICMP)\" tcpdump -n -i eth0 \"(host IP-ON-ETH0 and port 23456)\" Options: Flag Description -A Print each packet in ASCII (good for capturing web pages) -B <bufsize> Set OS capture bufsize (buffersize) in KiB (1024 bytes) -c <count> Exit after receiving <count> packets -D Interface list tcpdump can capture packets on -E [USER@]HOST:[PATH]] Saves tcpdump output to a temp file; when done, output is saved by scp (secure copy) to this target. -i <interface> Target interface -n Numeric output, no DNS lookups -P in | out | inout Choose send\/receive direction for packet captures -s <snaplen> Snarf <len> bytes\/packet CLI defaults to 0 bytes per packet with max 65535. -X -XX -x -xx Control what gets printed for each packet -v -vv -vvv Verbosity -t -tt -ttt No\/unformatted\/delta timestamp -tttt -ttttt Standard timestamp\/ms-deltas between current and 1st line of each dump telnet Purpose: Connect to server using the TELNET protocol Usage: telnet HOST [PORT] timezone Purpose: Print the timezone of the machine Usage: timezone top Purpose: Monitor processes (CPU usage, memory, etc.) Usage: top [-b] [-n COUNT] [-d SECONDS] Keys: Key Description N Sort by pid M Sort by mem P Sort by cpu T Sort by time R Reverse sort H Toggle threads Q, ^C Exit tracepath Purpose: Traces the path to a destination-discovering MTU along this path. It uses UDP port PORT or some random port. It is similar to traceroute , but it does not require superuser privileges and has no fancy options. Usage: tracepath [-n] [-b] [-l LENGTH] [-m MAX_HOPS] [-p port] DESTINATION Options: Flag Description -n Print primarily IP addresses numerically -b Print both host names and IP addresses -l Sets the initial packet length to LENGTH instead of 65535 for tracepath or 128000 for tracepath6 . -m Set maximum hops (or maximum TTLs) to MAX_HOPS instead of 30. -p Sets the initial destination port to use. uptime Purpose: Displays the system uptime information Usage: uptime [-p] [-s] Options: Flag Description -p or --pretty Print uptime in pretty format (x weeks, y days, z hours, xx minutes) -s or --since Print system up since time view_cert Purpose: Display certificate data Usage: view_cert {server|inspection} version Purpose: Print version of the Menlo Security Isolation Platform Usage: version " }, 
{ "title" : "SSL Certificates on Private Cloud (On-Prem) Appliances ", 
"url" : "41870-private-cloud--legacy-admin-portal-/41939-ssl-certificates-on-private-cloud--on-prem--appliances.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (Legacy Admin Portal) \/ SSL Certificates on Private Cloud (On-Prem) Appliances ", 
"snippet" : "Introduction There are three categories of SSL appliances used on private cloud appliances: Appliance Communication Certificates SSL Inspection Certificates CA Certificates Appliance Communication Certificates Appliance communication certificates are required for all appliance types . These must be ...", 
"body" : "Introduction There are three categories of SSL appliances used on private cloud appliances: Appliance Communication Certificates SSL Inspection Certificates CA Certificates Appliance Communication Certificates Appliance communication certificates are required for all appliance types . These must be created by the administrator and signed by a certificate authority which is trusted by client browsers. The appliance communication certificate secures connections to the following entities and therefore must contain a Subject Alt Name (SAN) for each: Appliance FQDN (for the admin web interface) Service domain XHR domain The Service domain is the collective hostname of your MSIP cluster. Your initial connection to the MSIP proxy uses the service domain. Authentication with the Menlo proxy also uses the service domain. This communication is encrypted. After the initial connection and authentication with the service domain, the client browser pairs with a surrogate via a request to the XHR domain . Once paired, the browser continues encrypted communication with the Menlo surrogate over the XHR “channel”. The only exception here is resource requests – request for images, fonts and css are still requested using the cluster’s service domain. The service and xhr domains are the same on every node in your cluster. The FQDN of each appliance is unique. Alternatively, you could create a wildcard certificate so that you can use the same certificate across your whole cluster. If you choose to create a wildcard certificate, a subject alt name will still be required to ensure compatibility with Chrome. The CMR appliance communication certificate does not require the SANs for the Service and XHR domains. SSL Inspection Certificates SSL inspection certificates are used on Master and Isolation Standalone nodes. It is the administrator’s responsibility to create SSL inspection certificates, but Menlo appliances do come with an SSL inspection certificate pre-loaded which you can use instead of your own. The pre-loaded SSL inspection certificate would need to be downloaded from the appliance and added to your browser’s trusted certificate store. The SSL inspection certificate is for re-encrypting traffic that has been decrypted during the SSL inspection process. SSL inspection is a requirement for isolating https sites. CA Certificates CA certificates are applicable for all appliance types . These certificates are imported from other sites and appliances using the Central Manager CA Certificates pane ( Settings -> CA Certificates ). These are imported to the Menlo appliance's trusted certificate store. Certificates you would consider adding here are the signing certificates for SSL inspection devices on your network. For example, all of your traffic goes out through a firewall which is performing SSL inspection. That firewall is using its own certificate to encrypt traffic. The firewall’s certificate is signed by an internal certificate authority which does not exist in the trusted certificate store of the Menlo appliance. The appliance must trust the signing certificate of the firewall in order to avoid certificate validation errors (which effectively result in loss of connectivity). Adding the firewall’s signing certificate in the appliance’s CA Certificates config ensures proper communication between the Menlo appliance and the firewall in this example. " }, 
{ "title" : "Private Cloud (New Admin Portal) ", 
"url" : "41872-private-cloud--new-admin-portal-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (New Admin Portal) ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Appliance Manager ", 
"url" : "41872-private-cloud--new-admin-portal-/41940-appliance-manager.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Private Cloud (New Admin Portal) \/ Appliance Manager ", 
"snippet" : "Introduction Use the Appliance Management App to create and manage appliance groups, clusters, and stand-alone appliances. With this app you can view, edit, and delete settings for all isolation appliance types. Select the Try New Appliance Manager App button for a walkthrough of the new features in...", 
"body" : "Introduction Use the Appliance Management App to create and manage appliance groups, clusters, and stand-alone appliances. With this app you can view, edit, and delete settings for all isolation appliance types. Select the Try New Appliance Manager App button for a walkthrough of the new features in the app. Use the app switcher icon at the top right part of the screen to switch between apps. The policy management, system settings, customization, and authentication panes are now located under the Appliance Manager app. Existing customers will note that the Management pane is removed from the left sidebar. You will need to use the App Switcher to access the Appliance Manager functions after you migrate to the app. The System Updates pane is also removed as it has been moved into the Central Manager app. Appliance Group Creation Wizard Use this wizard to create appliance groups. From the Manage Appliances pane, select Add Group . A window opens that guides you step by step through the group creation process. Select the desired group type (cluster, email isolation, or standalone web isolation) and press Next to continue. In the Group Details step, enter the desired unique group name and optional description. Web Isolation Groups : In the Settings step, enter login service names and NTP server and timezone settings for Web Isolation . Login DNS Name : Appliance login name Service Name : If enabled, the service name and login name are the same XHR Name : XML HTTP Request object name NTP Server Address : Network timing protocol server address Timezone : Select the desired timezone for the NTP server. Browser Current Time : NTP server current time per the selected timezone above. Email Isolation Groups and Clusters : The following additional settings are available: Management Group (Email Only): Management group name for email appliance (usually this name can also be used as the Service Name) Sandbox : FireEye and the File REST API can be enabled for the email appliance. Finally, in the Add appliances step, enter the deployed appliances that are part of the group\/cluster. The wizard automatically connects to and presents the certificates for review for each appliance. You can proceed with group creation without adding appliances (e.g., before appliances are created). This creates a placeholder group that is clearly marked as \"non-functional\". You can then return and add appliances to the group when they are ready. The following default groups are available: Unassigned (appliances that are not assigned to any group), Auto (automatically assign appliances to group based on service domain), Manager (central manager appliances). The wizard will need to log in to each appliance, so login credentials must be provided before the appliances are added to the cluster\/group. If the login does not exist yet, the user can select Initialize Password to create credentials. At the end of the process, you can create descriptive names for each appliance. This will be displayed on the Manage Appliances pane when the cluster\/group is expanded. Press the Finish button to complete the wizard. Review Cluster and Appliance Status Manage Appliances and Groups Use the Manage Appliances pane ( Management > Appliances ) to add, delete, assign templates, or group appliances. To delete, assign a template, or group an appliance, select it using the checkbox and then use the pulldown menu for grouping or use the appropriate button to Assign Template or Delete it. If applicable, appliances are organized by Cluster and\/or Group on this pane. An administrator can group appliances so their cluster type and cookie storage policy is consistent across all appliances in the group. The group name is also displayed on the Manage Appliances pane for your reference. To create a group, press the Add Group button. Set the group type ( Cluster or Non Cluster\/Auto ), and configure NFS cookie storage to use an NFS datastore for cookie storage across all appliances in the group if desired (this option requires the IP address and Mount Location if enabled). To log in to an appliance, hover over an appliance and select the Login button. You can also select one or more appliances from this pane to perform some actions (Assign Template, Restart, Reboot, Shutdown, Delete, and Enter\/Exit Maintenance Mode). Healthcheck URL for Appliance Status The healthcheck URL provides appliance health status via HTTP response codes. This may be useful if you use an integrated product (e.g., BlueCoat) that relys on healthcheck codes to manage isolation nodes. If an unexpected HTTP response is received (anything other than 200 ), the isolation node can be taken out of the forwarding group. Prior to any appliance upgrades, please update the healthcheck URL string to the following: GET \/healthcheck\/?status=1 HTTP\/1.1\\r\\nConnection: Close\\r\\n\\r\\n Valid responses: 200 : GO State 400 : STOP State (Appliance is in Maintenance mode or there are issues on the Dashboard) Managing Appliance Registration The Registration pane ( Management > Registration ) provides the option to define a secret key which is used to automatically register appliances with the central manager when they are deployed. Automatic registration is useful when you have different teams working with the product. For example, a VMware Admin who will do the web or email VM appliance deployments independently of a security team managing the Menlo Security policy. The secret key is required if automatic registration is enabled and optional otherwise. You will need to turn on Enable Trust Secret and enter your key below. Provide the key to the administrator deploying the VM\/OVA so they can insert it during that process. The Automatic Group assignment feature to enable automatic group assignments based on the service domain assigned to any new appliance is disabled by default and not displayed. For more information, please contact Menlo Security Customer Success at support@menlosecurity.com . Managing Templates Appliance templates allow an administrator to easily configure settings including network, authentication, licenses and logging. In this way identical settings are published to all appliances assigned that template, and the Central Manager performs heartbeat checks to ensure all appliances remain up-to-date with the latest values in the template. From this pane you can: Import Template : Press this button to copy all the settings from an existing appliance or import them from a saved file into a new configuration template. Add Template : Press this button to create a new configuration template. More information about the settings that can be configured is provided in below. Export Template : Select one or more templates and then press the Export (folder) icon to save the configuration template to a location of your choice. Delete Template : Select one or more templates and then press the Delete (trash can) icon to delete the templates. A confirmation message appears before the templates are deleted. Edit Template : Select a template and then press the Edit (pencil) icon. The template settings are displayed and can be edited as needed. Press the Save button at the top of the pane to save changes. As soon as a change to the template is made, the appliance Configuration Status warns the user that the appliance is out of sync. Creating Templates Templates are used to select and configure various settings for isolation appliances that will be managed by the central manager. Saved templates can then be assigned to one or more appliances in the Manage Appliances pane as described in . The following sections provide an overview of the fields that are available in a template. Template Info This section provides general template information. New Template : Select this to create a new template without any pre-existing settings. Provide a unique Template Name and choose the applicable Appliance Type before advancing. Import from Appliance : Select this to copy settings from an existing appliance. Choose an appliance and then press the Import button to populate all the configuration fields in the new template. Web Settings This section configures isolated browser settings for web isolation appliances. If any field should be managed by the central manager, select the checkbox next to the field and enter the desired configuration value to the right. Press the Save button to save the new configuration settings before going to another pane. Certificates Invalid Certificates : Set the default action for invalid certificates: Block the page from loading automatically, or Ask User to confirm if they wish to proceed. Strict Certificate Name Validation : Set to True if you wish to check the certificate Subject Alterable Name (SAN). Custom Name Platform Branding : Customizes the name used for dialog boxes and messages generated by the system. This should be set to a recognizable name like \"Secure Web\" or \"Web Isolation Platform.\" Resource Optimization Max Tabs per User : Sets the maximum number of tabs a user can have open during a session. Tab Detach : Browser tabs can be detached from DVCs (Disposable Virtual Containers) after a period of non-use so that the system can free up resources and handle more users. Detached tabs will continue to display current content (e.g., video\/audio may play buffered content and animated gifs will still animate, but otherwise the page is static). As soon as user input is detected, the page is refreshed. Background tabs are refreshed when they become foreground tabs. Profile : Sets a resource optimization profile to use for the appliance. There are three predefined optimization profiles: Relaxed , Moderate , and Aggressive . Each profile defines the amount of time that must pass before a tab is detached from the DVC. The Aggressive profile will detach tabs more frequently, whereas the Relaxed profile will detach tabs less frequently. Custom optimization profiles may also be defined. It is recommended that one of the predefined profiles are used, and custom profiles are only used when predefined profiles do not meet your requirements. The custom profile will allow minimum timeout values of 10 minutes and a maximum value of 24 hours. Timeouts may be disabled for particular tab types. Foreground Tab : Tab currently viewable in the browser window. The predefined profiles use a longer timeout for this tab because it is in use. Background Tab : Tabs not in view in the browser window. The predefined profiles use a shorter timeout for these tabs because they are not in use. Media : Tabs playing audio or video. The predefined profiles have no timeout for media tabs so that music or video are not interrupted. Input : Tabs containing input fields such as forms. The predefined profiles use a longer timeout for tabs with input to avoid disruption when completing forms. Header Fields Include User's IP Address as X-Forwarded-For Header : If True , the user's IP address is included in x-forwarded-for header. Enable X-Authenticated-User Header Forwarding : If True , header forwarding is enabled for x-authenticated users. Web Security Gateway Prepend Restrict Prepend Access to Websites Forwarded by Web Gateway : If set to True , users cannot modify the URL to bypass the proxy security policy. Ensure New Domains are Reauthorized by Web Gateway Policy : If set to True , users are restricted to the initial domain, and any links on the page that direct the user to a new domain are subject to the proxy security policy. Files File Downloads : If set to Allow , file downloads are allowed (or the file policy is set by the Central Manager). File Upload : If set to Allow , file uploads are allowed (or the file policy is set by the Central Manager). DLP Visibility These fields configure DLP (Data Loss Prevention) visibility so isolated traffic uploads and user input can be analyzed by third party DLP appliances. The applicable traffic is formatted and replayed by the DLP service. Enable DLP Visibility : Turns On the DLP visibility feature. DLP Block Message : Any HTTP response other than \"200 MSIP_OK\" is treated as a DLP block. Native : This shows the DLP block message from the 3rd party DLP product for both uploads and user input DLP blocks. Menlo Block Messages : This shows the Menlo block message for both uploads and user input DLP blocks. Data Encoding : Select either Multipart-form or URL Form for the desired data encoding to use. Mail Settings This section configures isolated browser settings for email isolation appliances. If any field should be managed by the central manager, select the checkbox next to the field and enter the desired configuration value to the right. Press the Save button to save the new configuration settings before going to another pane. URL Processing Mode : Select the processing mode (Transform or Restore). Isolation Platform Hostname : Enter the hostname for the isolation platform. Destination Mailserver Destination Mailserver Hostname : Enter the hostname for the destination mailserver. TLS : Configures requirements for TLS protocol on the appliance (Required, When Available, or Disabled). Verify Certificate for TLS : Request client authentication on the Transform or Restore nodes. Attachment Analysis Enable : If you have a license for the attachment analysis feature, use this field to enable\/disable use of the feature. ReversingLabs Offline Analysis Enable : If you have a license for the attachment analysis feature, use this field to enable\/disable use of the feature. ReversingLabs URL : Enter the URL for offline analysis in this field. Authentication This section configures authentication settings for appliances. If any field should be managed by the central manager, select the checkbox next to the field and enter the desired configuration value to the right. Press the Save button to save the new configuration settings before going to another pane. Authentication Service SAML : Enter Admin and\/or User SAML provider, endpoint, Issuer ID, and certificate information. AD : Enter AD server settings (hostname or IP and global catalog port), connection type (Clear, TLS, or STARTTLS), and custom user attributes to use with the Active Directory authentication service. User Authentication User Authentication Method : Select the authentication method to use for users (LDAP, SAML, or None). This is only applicable to web or email Isolation Master appliances. Require Authentication : Enable to require user authentication for web and\/or email. Session Timeout : If set to Periodic , the session will timeout after the number of days set by the field below. Get Identity from X-Authenticated-User header : Enable to use the X-Authenticated-User header for the user identity. Admin Authentication Authentication Method : Select the authentication method to use for external administrators (LDAP, SAML, or None). This is applicable to all appliance types. Authorization Method : Select the authorization group or define a custom property and value to use for authorization. Session Inactivity Timeout : If set to Periodic , the session will time out after the number of minutes set by the field below. System Settings This section configures system settings for appliances. If any field should be managed by the central manager, select the checkbox next to the field and enter the desired configuration value to the right. Press the Save button to save the new configuration settings before going to another pane. Network : Appliance network settings (nameserver and upstream internet proxy). See . Service : Login host. This is either the appliance FQDN or a special domain which maps to DNS\/LoadBalancing. Refer to and for more information. Proxy (Web Isolation only): The Proxy ports which will be used for the service (i.e., what the browsers or downstream chaining device will connect to). See . Access Control : Controls services allowed to manage the infrastructure and internal management communications, as well as the services that can connect to Menlo Security (e.g., services that allow email processors to send email to the Menlo Security Transform\/Restore systems). See . Logs and Alerts : User session and system log hosts, protocol, port number, and log format. See . Time : Configures the server timezone and time format. See . Note that this is managed at the group level for clusters. CA Certificates : Enables certificate management from the template. See . Forensic Archive (Web Isolation only): Configures the archiving of files being accessed by users to a remote scp (secure copy) server using public key exchange. Files being downloaded from isolated sites will be zipped and archived to this server. For security, the scp server should be write-only (disallowing file downloads). See . Browser Recorder (Web Isolation only): Configures the browser recorder feature that captures browsing data by users (network data, screenshots, input data, and final field input states). This feature requires a provisioned S3 bucket and a user who can access the bucket. Notifications (Email Isolation only): Configures the SMTP service settings (mail server address, port, username and password, and from address). License This section configures license key management of appliances. If any field should be managed by the central manager, select the checkbox next to the field and enter the license key in the field below. Press the Save button to save the new configuration settings before going to another pane. Assigning Templates Once a template has been saved, it can be assigned to one or more appliance from the Manage Appliances pane. Select the checkboxes next to the appliances that will use the saved template, and press the Assign Template button. Choose the saved template from the pull-down menu and press Assign to save changes. Note that the template is not published until the Publish Template action is complete. Managing Updates and Patches There are two types of updates which can be applied to appliances: Full system updates via the Menlo Security Update servers, or Hot patch updates from a file uploaded to the system. All appliances, including the separately licensed email attachment worker, can be centrally upgraded from the Central Manager. An administrator can also set up automatic checks for system updates and upload updates and configure the action that is automatically done if the installation fails. If updates are available for any appliance, an indication is displayed next to the appliance(s) on the Manage Appliances pane ( Appliances > Manage Appliances ). You can also select the Check for Updates button to run a check for updates at any time. Check the checkbox(es) next to any appliance(s) to update, and then press Update Selected to install updates. You can monitor installation progress on the Jobs pane (see ). If any system updates or rollbacks fail, confirm that a valid license is configured before downloading and installing updates. See for details. In some cases a web or email isolation appliance will ask if it should come up in Maintenance Mode which means it won't announce itself as available to start taking connections. This mode can be changed by logging into the appliance (from the Central Manager app) and selecting Exit Maintenance Mode . This control helps make sure systems being worked on in a load balancing scenario don't start taking sessions before you have fully completed your upgrade. Scheduling Updates Administrators can configure downloads and installations of software updates from the Manage Appliances pane. Select Update Settings to view and configure any of the following: Action : Select the desired action to take during the schedule set below (Download and Install or Download Only). Source : Select the source for the download package (Menlo Security Cloud, CMR, or Peer appliance). The Menlo Security Cloud source pulls the package from the Menlo Security Updates server. Peer and CMR obtain the package from the configured peer or CMR appliance. If the CMR or Peer appliance do not yet have the image configured for download, it will first download the image to the source (from Menlo Security Cloud) and then distribute it to the selected appliances. When using peer appliances for the update source, peer appliances must have valid DNS resolvable hostnames and be network accessible on port 8442 by peer appliances. Download Schedule : Set the time to start the download (now or a user-defined time). Installation Schedule : Set the time to start update installations (now or a user-defined time). You can also set the number of simulataneous installations to run at the stated time. Appliances will restart following an update, so this allows administrators to schedule this during off-hours. Action in Case of Installation Failure : Choose the desired action to take if installation fails: Rollback to the previous version, Stop installation , or Continue with installation . Rolling the Software Back to a Previous Version If needed, an administrator can roll the software back to a previous version or the factory default (initial installation). From the Updates pane ( Updates > Updates ), select the Rollback button on the appliance and choose the rollback version to use from the window that appears. Viewing Jobs and Licenses View update jobs status and license information for the appliances by opening the Jobs pane ( Update Manager > Updates > View Jobs button) and License pane ( Update Manager > License ) as discussed below. Viewing Jobs All of the centralized update jobs (download image, install, rollback) are posted to a log on the the Jobs pane ( Update Manager > Updates > View Jobs button). The pane displays the status of active and recently completed or failed appliance jobs. Expand a job entry to view detailed information about waiting time and installation progress. Viewing License Key and Features All appliances must have a valid license installed. In most cases, the same license will be used for all of the deployment. Enter your unique license key in the License Key field if it is not already present. A message will appear if the key validates correctly or if there is an issue with the key. License keys can be restricted to allow only specific product updates and should not be distributed or shared outside your organization. Customers must explicitly \"opt-in\" to use new features that are added to the system updates. Features will not take effect until after the administrator saves and publishes the change. Only the features that have been purchased (and whether or not they are currently active) are displayed in the Licensed Features section as shown in the example below. " }, 
{ "title" : "Single Sign-On Guides (SAML) ", 
"url" : "41874-single-sign-on-guides--saml-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Active Directory Federation Services (ADFS) 4.0 ", 
"url" : "41874-single-sign-on-guides--saml-/41942-active-directory-federation-services--adfs--4-0.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Active Directory Federation Services (ADFS) 4.0 ", 
"snippet" : "About This Guide This document provides an overview of installation, configuration, and usage of the Menlo Security service with single sign-on using Active Directory credentials. The following topics are covered: ??? Installation Prerequisites Windows Server 2008 R2 SP2 or newer Server must be memb...", 
"body" : "About This Guide This document provides an overview of installation, configuration, and usage of the Menlo Security service with single sign-on using Active Directory credentials. The following topics are covered: ??? Installation Prerequisites Windows Server 2008 R2 SP2 or newer Server must be member of the Windows domain Administrator privileges are required to install software Active Directory Federation Services (ADFS) 4.0 License included with Windows Server DNS Hostname for authentication server Name is be used for ADFS WWW server performing user authentication Server Certificate for ADFS WWW Server (IIS) Certificate Common Name (CN) must match chosen DNS hostname A certificate from a public CA, such as DigiCert, is preferred An internal certificate from AD Certificate Services can be used if authentication is needed only from AD managed devices Verify there are no firewalls or other filtering mechanisms blocking the ports (TCP 3130, TCP 3131). Configure\/Verify IIS Certificates and Settings ADFS provides a web-based authentication mechanism. To protect the security of users credentials, it is important to have a web server certificate to protect the HTTPS authentication connections. A certificate from a public CA is recommended. This ensures that authentication requests do not generate SSL warnings, even for devices not managed within the AD domain. If a public certificate is not available, a domain certificate can be used. This works well for AD managed devices, but may generate encryption warnings for unmanaged devices. To manage web server certificates, open the Internet Information Services (IIS) Manager snap-in and select the Server Certificates option. In the Server Certificates manager, choose the type of certificate to be used. To create a certificate from the AD Certificate Services, choose Create Domain Certificate . Configure the certificate attributes next. It is important that the Common name match the hostname the authentication uses. A mismatched name causes SSL warnings. To install the certificate from a public CA, use the IIS snap-in and select Server Certificates . Import the certificate file from here. Once the certificate is installed, it can be validated by accessing the HTTPS URL of the server. For example: https:\/\/auth.company.com\/ The connection should complete with no browser warnings or alerts. The IIS welcome page should be shown. To enable authentication from non-IE browsers, a settings change is needed. Select the Authentication option. Select the Advanced Settings for Windows Authentication. Select Off for the Extended Protection Option. Install Active Directory Federation Services (ADFS) This section describes the process for doing a new install of ADFS. This section can be skipped in environments with an existing ADFS deployment. Follow the instructions on the Microsoft Install the AD FS Role Service page to install the server role via a wizard or Windows PowerShell. After successful installation, follow the steps to Configure a Stand-Alone Federation Server . Add a Token-Signing Certificate . Add a Token-Decrypting Certificate . Set a Service Communications Certificate . The SSL certificate created for IIS should be available, and the service name should be automatically determined from that certificate. If a certificate is not selected, choose the appropriate certificate from the list. Choose Add a trusted relying party to begin the configuration of the Menlo Security service relationship configuration. Configure Menlo Security as a Service Provider The following steps configure ADFS to accept authentication requests from Menlo Security's service. Select Enter data about relying party manually . Choose a name to identify Menlo Security as the service this configuration is for. This is only a label and does not affect functionality. Choose ADFS 4.0 profile. Click Next to pass this step. Do not enter any setting on the Configure URL page. Click Next to proceed. In the Relying party Identifier form, add the following URLs: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml\/metadata Select Permit all users to access the relying party , and click Next to proceed. Click Close to finish this part of the setup wizard. Leave the option Open the Edit Claim Rules... selected to proceed to the next step. Select Add Rule to configure what information is sent as part of the authentication process. Choose Send LDAP Attributes as claims . Choose a name for this rule. Select Active Directory as the attribute store and set the following mappings. These are important to match up and publish correctly: Name ID: UserPrincipalName Email Address: UserPrincipalName Role: Token-Groups -- Qualified by Domain Verify that the claim rule is created and select OK to proceed. Right-click the newly created claim rule and select Properties . Verify that the relying party identifiers include: User (Cloud): https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata and https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml\/metadata Admin (Cloud): https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml\/metadata User (Appliance): https:\/\/<your appliance login name>\/safeview-auth-server\/saml\/ metadata Admin (Appliance): https:\/\/<your appliance name>:8443\/api\/v1\/saml\/metadata Select the Endpoints tab. Add an endpoint: Type : SAML Assertion Consumer Binding : POST URLs : User (Cloud): https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml and https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml Admin (Cloud): https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml User (Appliance): https:\/\/<your appliance login name>\/safeview-auth-server\/saml Admin (Appliance): https:\/\/<your appliance name>:8443\/api\/v1\/saml Select OK , and set the endpoint as the Default. Export SAML Attributes Required in Menlo Security Settings The SAML assertion is cryptographically signed by ADFS, which is used to validate the authenticity of the user's login. To do this, we must export the public key from ADFS, which we'll add to the Menlo Security configuration. Select Certificates in the left-hand tree. Right-click the Token-signing certificate and select View Certificate . Select the Details tab and click Copy to File . Choose the option for Base-64 encoded X.509 and select a file name. Open the exported certificate in a text editor. This value is copied into the Menlo Security settings. Right-click ADFS in the left-hand tree and select Edit Federation Service Properties . Copy the Federation Service Identifier URL. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Select the ADFS SSO SAML provider. ADFS SSO will generate a SAML request which will use transparent Windows domain when available. The legacy \"ADFS\" provider will use a manual \"forms\" login where available. Input the SAML 2.0 Endpoint identifier from above. For example: https:\/\/<adfs-hostname>\/adfs\/ls Input the Service Identifier (Issuer URL) from above. For example: http:\/\/<adfs-hostname>\/adfs\/services\/trust This field is case-sensitive. Please use the value copied directly from the Federation Service Identifier above. Paste the ADFS Certificate which was exported earlier. Important: The first URL is https and the second is http. These should match the values exactly from Windows server configuration. Legacy Admin Portal Updated Admin Portal Make sure you include the domain for the ADFS service in the PAC bypass configuration. Failure to do this will result in a circular depependency where you are trying to get to the auth server and that is not allowed through the proxy because you are not authenticated. For OVA (private cloud) deployments, SAML authentication will need to be set up for the OVA admin user (in addition to your standard user endpoints). The endpoint and entityID for admin authentication should be: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "Azure Active Directory ", 
"url" : "41874-single-sign-on-guides--saml-/41943-azure-active-directory.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Azure Active Directory ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with single sign-on using Azure Active Directory credentials. The following topics are covered: ??? Installation Prerequisites Azure AD account Azure Configuration Perform the following ...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with single sign-on using Azure Active Directory credentials. The following topics are covered: ??? Installation Prerequisites Azure AD account Azure Configuration Perform the following steps to configure Azure Active Directory to accept Menlo Security Authentication requests. Sign into the Azure portal as an admin. Go to Enterprise Applications, and select + New application . In the Add an application screen, enter 'Menlo' in the gallery search field. Select the Menlo Security Isolation Platform application. A property screen opens on the right. Click Add to add the application. On the Menlo Security Isolation Platform | Overview page, select 2. Set up single sign on . The Menlo Security Isolation Platform | SAML-based Sign-on page opens. Sections 1, 2, 3, and 4 will be used for configuration. Click the Edit (Pencil) icon in Section 1 (Basic SAML Configuration) and enter the following URLs: Identifier (Entity ID) : https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata This is the valid issuer of SAML requests. Reply URL (Assertion Consumer Service URL) : https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml This tells Azure where to redirect users with SAML responses. Sign-on URL : https:\/\/safe.menlosecurity.com\/account\/login Click the Edit (Pencil) icon in Section 2 (User Attributes & Claims) and confirm the following: emailaddress : user.mail Click the Edit (Pencil) icon in Section 3 (SAML Signing Certificate) and click the following link to save the file: Certificate (Base64) . This file is used to configure Azure in the Menlo Admin UI. If necessary, the file can be sent via encrypted email. Go to Section 4 (Set up Menlo Security Isolation Platform) and copy the following values into a text file. These are used to configure Azure in the Menlo Admin UI. Login URL Azure AD Identifier Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Input the following: SAML 2.0 Endpoint : Enter Azure Login URL from above. Service Identifier (Issuer) : Enter Azure Azure AD Identifier from above. Certificate : Edit the certificate using the Azure Signing Certificate downloaded earlier. Add a Reply URL (ACS) to the Azure Application (Web and Email Isolation only) If you are using both web isolation and email isolation, you must add an extra Reply URL (ACS) to the Azure application. Under App Registrations , add the following Reply URL in Settings: https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml Configure PAC Files to Bypass Hosts For web isolation , create a PAC bypass for the following domains to avoid looping when using Azure AD authentication. Be sure to identify the correct domain\/host you are using, as these may vary by region: login.microsoftonline.com sts.windows.net microsoftonline-p.com msauth.net msftauth.net Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "Centrify ", 
"url" : "41874-single-sign-on-guides--saml-/41944-centrify.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Centrify ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Centrify SAML service. The following topics are covered: Centrify Configuration Log in to the Centrify Admin Portal. Select Apps and then Add Web Apps . ...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Centrify SAML service. The following topics are covered: Centrify Configuration Log in to the Centrify Admin Portal. Select Apps and then Add Web Apps . Input Menlo Security in the search field, and then select Add and Yes to approve the Menlo Security application. Review the SAML settings in the Menlo Security Application Settings section. Copy the Service Identifier and SAML 2.0 Endpoint strings. These will be input in your Menlo Security Admin Portal. Save the Security Certificate to disk. Open the file with a text editor and copy the contents of the file. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Paste the Centrify SAML 2.0 Endpoint string into the MSIP SAML 2.0 Endpoint HTML field. This is the redirect login URL. Paste the Centrify Service Identifier string into the MSIP Service Identifier (Issuer URL) field. This is the external key value. Open the Centrify Certificate in a text editor, and paste the contents into the form, including the BEGIN CERTIFICATE and END CERTIFICATE lines. Make sure the Centrify domain is included in your Proxy Auto Config Domain Exceptions to allow the requests to pass prior to successful authentication. Insert the following domain into the PAC exception editor: centrify.com For OVA (private cloud) deployments, SAML authentication will need to be set up for the OVA admin user (in addition to your standard user endpoints). The endpoint and entityID for admin authentication should be: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "Okta ", 
"url" : "41874-single-sign-on-guides--saml-/41945-okta.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Okta ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Okta SAML service. The following topics are covered: ???See for more information about configuring Single Sign-On (SSO). Okta Configuration Log in to the...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Okta SAML service. The following topics are covered: ???See for more information about configuring Single Sign-On (SSO). Okta Configuration Log in to the Okta administrative dashboard. Select Add an application , search for Menlo Security , and select the Menlo Security application. This displays the application setup wizard where you can configure the application settings and user associations. Once the application setup is completed, you can find the settings needed for the Menlo Security configuration in the Sign On section. Click the View Setup Instructions button. Scroll down to the Configuration Data section. You need to copy SAML 2.0 Endpoint settings into the Menlo Security settings. You will need to copy the following three elements: Copy the IDP Issure\/Entity ID . You will later paste this value into the Menlo Security Service Identifier field. Copy the text within the x.509 Certificate box, including the BEGIN and END CERTIFICATE lines. You will later paste this into the Menlo Security Settings. Copy the Login URL\/SignOn URL . You will later paste this value in the Menlo Security SAML 2.0 Endpoint field. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Input the Okta Login URL\/SignOn URL value into the MSIP SAML 2.0 Endpoint HTML field. This is the redirect login URL. Input the Okta IDP Issuer\/Entity ID value into the MSIP Service Identifier (Issuer URL) field. This is the Okta external key value. Input the Okta Certificate data, including the BEGIN CERTIFICATE and END CERTIFICATE lines. Paste it into the Menlo Security Settings. Make sure the Okta domains are exempted from your PAC file so authentication doesn't get forced through Menlo Security. Insert the following domains into PAC exception editor (if they don't already appear). okta.com oktacdn.com ssl.gstatic.com oktapreview.com For OVA (private cloud) deployments, SAML authentication will need to be set up for the OVA admin user (in addition to your standard user endpoints). The endpoint and entityID for admin authentication should be: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Enable SAML Authentication for an Admin in the Menlo Admin Portal To enable SAML authentication for adminstrators to the Menlo Admin console, a new \"MenloAdmin\" application must be defined within your Okta portal. From the Okta portal, navigate to the Applications tab and click Add Applicaton . Click Create New App . In the Create a New Application Integration pane, use the following settings and then click Create : Platform : Web Sign on method : SAML 2.0 Use the Create SAML Integration pane to define and configure the new application. In the first tab, General Settings , we will use the follwoing settings: App name : MenloAdmin App visibility : Check the checkboxes for \"Do not display application icon to users\" and \"Do not display application icon in the Okta Mobile app\" In the Configure SAML tab, use the following parameters, leaving all other default values unchanged (in the example below, no attributes are defined): Single Sign On URL : https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml Audience Restriction : https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml\/metadata Name ID Format : EmailAddress Application Username : Okta username In the Feedback tab, select the following and then click Finish : Are you a customer or partner? : I'm an Okta customer adding an internal app App type : Check the \"This is an internal app that we have created\" box The details for the newly defined application are displayed. Click on View Setup Instructions . Copy the information on the How to Configure SAML 2.0 for MenloAdmin Application page to configure the Menlo Security admin console Single Sign-On pane. The new application will need to be attributed to a group to allow users to authenticate. Open the Menlo Security admin console Single Sign-On pane ( Settings -> Authentication ). Copy details from the Okta website to fill in the fields for the Admin user. Click the Edit Certificate icon next to X.509 Certificate and paste in the certificate from the Okta website and then click Save Changes . If a PAC file is being used for redirection, some additional settings will need to be modified in the PAC file ( Settings -> Proxy Auto Config -> PAC file -> Actions -> Edit ). Typically, these will already be configured if you use SAML for user authentication. Verify that the following entries are in place: Default Exceptions : Ensure the \"Menlo Security\" exception and \"Cloud Authentication\" are active (checked). Domain Exceptions : Alternatively, manually add the following domain exceptions: okta.com oktacdn.com oktapreview.com ssl.gstatic.com Once all changes have been made, click Save and then Save Changes . " }, 
{ "title" : "OneLogin ", 
"url" : "41874-single-sign-on-guides--saml-/41946-onelogin.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ OneLogin ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via OneLogin SAML service. The following topics are covered: OneLogin Configuration Log in to the OneLogin administrative dashboard. Select Add and Add Apps ...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via OneLogin SAML service. The following topics are covered: OneLogin Configuration Log in to the OneLogin administrative dashboard. Select Add and Add Apps and search for Menlo Security . Select the Menlo Security App, then proceed to the application configuration. Select the SSO tab in the application to display the authentication URLs. Copy the Issuer URL and SAML 2.0 Endpoint settings into the Menlo Security settings. Select View Details to display the X.509 Certificate which is needed to validate the authenticity of SAML user authentications. Select the text within the X.509 Certificate box, including the BEGIN and END CERTIFICATE lines, and paste that into the Menlo Security Settings. Make sure the user is configured with access to the application in Onelogin. Select Users and then All Users find the relevant user; then select Applications and make sure Menlo Security is attached to the user. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Input the OneLogin SAML 2.0 Endpoint value from the OneLogin SSO tab. For example: https:\/\/menlosecurity.onelogin.com\/trust\/saml2\/http-post\/xxxxxx Input the OneLogin Issuer URL value (AKA service identifier). For example: https:\/\/app.onelogin.com\/saml\/metadata\/453409 Input the OneLogin Certificate data, including the BEGIN CERTIFICATE and END CERTIFICATE lines. Paste it into the Menlo Security Settings. You can download the certificate where it says Download in the OneLogin application view, and then use a text editor to cut and paste the information. Make sure the OneLogin domains are exempted from your PAC file so authentication doesn't get forced through Menlo Security. Insert the following domains into PAC exception editor (if they don't already appear). onelogin.com For OVA (private cloud) deployments, the Menlo app is selected by admins. This app has the following Menlo SAML endpoints pre-configured: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "Ping Identity ", 
"url" : "41874-single-sign-on-guides--saml-/41947-ping-identity.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Ping Identity ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Ping Identity and the PingOne SAML service. The following topics are covered: PingOne Configuration Login to the PingOne administrative dashboard. Select...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via Ping Identity and the PingOne SAML service. The following topics are covered: PingOne Configuration Login to the PingOne administrative dashboard. Select Applications and Application Catalog and search for Menlo Security . Select the Menlo Security App, then proceed through the application configuration using the defaults. Make sure the uid is configured to Email . PingOne: Add an application PingOne: SSO Tab Make sure the user is active and configured with access to the application. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Input a PingOne SAML 2.0 Endpoint value. It should look similar to the following (fill in the portion idpid= with your idpid from the Initiate Single Sign-On (SSO) URL from PingOne application view): https:\/\/sso.connect.pingidentity.com\/sso\/idp\/SSO.saml2?idpid=xxxxxx For Example, for a company called \"surfcrew\" using the above graphic, the value would be: https:\/\/sso.connect.pingidentity.com\/sso\/idp\/SSO.saml2?idpid=d3b555b6-c710-4b54-bb69-af155d424b0e Input the PingOne Service Identifier value (it's called \"Issuer\" in the above PingOne application view). For example, for the \"surfcrew\" company, the value would be: https:\/\/pingone.com\/idp\/surfcrew Input the PingOne Certificate data, including the BEGIN CERTIFICATE and END CERTIFICATE lines. Paste it into the Menlo Security Settings. You can download the certificate where it says Download in the PingOne application view, and then use a text editor to cut and paste the information. Settings: Single Sign-On Make sure the Ping domains are exempted from your PAC file so authentication doesn't get forced through Menlo Security. Insert the following domains into PAC exception editor (if they don't already appear). pingone.com pingidentity.com For OVA (private cloud) deployments, SAML authentication will need to be set up for the OVA admin user (in addition to your standard user endpoints). The endpoint and entityID for admin authentication should be: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "SAML Group Support ", 
"url" : "41874-single-sign-on-guides--saml-/41948-saml-group-support.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ SAML Group Support ", 
"snippet" : "Identity Providers with Group Support The Menlo Security Isolation Platform (MSIP) supports usage of groups within exception policy when you are authenticating with a SAML provider that supports group metadata. Group format is not defined as part of the SAML standard. Each SAML Identity Provider cho...", 
"body" : "Identity Providers with Group Support The Menlo Security Isolation Platform (MSIP) supports usage of groups within exception policy when you are authenticating with a SAML provider that supports group metadata. Group format is not defined as part of the SAML standard. Each SAML Identity Provider chooses their own custom attribute format to use for passing groups. The expected group attribute is defined in the table below: SAML Type Groups Support Group Attribute ADFS Yes http:\/\/schemas.microsoft.com\/ws\/2008\/06\/identity\/claims\/role Azure ADFS Yes http:\/\/schemas.microsoft.com\/ws\/2008\/06\/identity\/claims\/groups CA SiteMinder Yes GROUPMEMBERSHIP Okta Yes groups Other No NA MSIP supports groups with the Okta SAML profile; within Okta a custom SAML application configuration is required to choose which groups are included and attach them to the 'groups' attribute). Since groups are not standardized within the SAML specification the 'Other SAML' profile does not recognize any group attribute. If a SAML Identity Provider supports groups but is not listed in the table above, please contact Menlo Security to support additional group support. Note that most SAML Identity Providers allow configuration of the metadata used within the SAML assertion. This can be used to match the expected group attribute from an existing provider. We recommend that you use Okta or CA SiteMinder profiles for groups from other providers, as the SAML behavior for these are identical to the Other SAML profile. Updating Group Associations Groups are updated when the user performs a SAML authentication. To force updating of users' group data, a SAML reauthentication timeout must be set. Common values for this setting are 24 hours, 7 days, and 30 days. Please contact Menlo Support to request this setting be enabled so you can perform the group updates. Validating Group Input and Syntax To validate group input and syntax, log into the Admin Portal and navigate to Settings -> Authentication . Press the SAML Verbose Debugging button to temporarily enable debugging. When this is enabled, additional details about the data is included in the SAML assertion. This can be viewed in the browser's javascript console when performing a SAML authentication. The output will confirm that groups are enabled and list the group strings received in the authentication. Using SAML with Pre-pend Isolation When using proxy mode, the proxy port being used signals the preferred authentication method. When using pre-pend mode, no such signal is available. Instead, a service setting is used to choose the perferred authentication. To enable SAML login for pre-pend sessions, contact Menlo Support to enable the SAML for all logins. Note that this setting forces SAML as the authentication type for all sessions , including proxy and pre-pend requests. Ensure that the SAML authentication has been fully validated before enabling this setting. " }, 
{ "title" : "SiteMinder ", 
"url" : "41874-single-sign-on-guides--saml-/41949-siteminder.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ SiteMinder ", 
"snippet" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via the SiteMinder SAML service. The following topics are covered: ??? ??? Configure SiteMinder for the MSIP Create an entity in SiteMinder with MSIP acting ...", 
"body" : "About This Guide This document describes the installation, configuration, and usage of the Menlo Security service with user account management via the SiteMinder SAML service. The following topics are covered: ??? ??? Configure SiteMinder for the MSIP Create an entity in SiteMinder with MSIP acting as the Service Provider (SP) and then create and activate a partnership. Under the Tasks pane, navigate to Tasks -> Federation -> Partnership Federation -> Entities . Click the Create Entity button. Configure the entity: Set Entity Location to Remote and Entity Type to SAML2 SP . Enter the following identifying information for the entity: Entity ID : Identifier, e.g., \"MSIP\" Entity Name : Full entity name, e.g., \"MenloSecurity\" URL : Enter the URL for the \"Remote Assertion Consumer Service\" in this field, e.g., \" https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml \" Review the entity properties and click Finish to create the entity. Return to the Entity Page by clicking the Return to View Federation Entities link. Under the Tasks pane, navigate to Tasks -> Federation -> Partnership Federation -> Partnerships . Click the Create Partnership button. Set the Partnership Type to SAML2 SP -> IDP . Enter the following identifying information for the partnership: Partnership Name : Full partnership name, e.g., \"SM-MSIP\" Local IDP : Select the local IDP to use, e.g., \"Local-SSO-IDP\" Remote SP : Select the remote Service Provider to use, e.g. \"MSIP\" Set up the Authentication URL and Authentication Request Binding: Authentication URL : Enter the FQDN and URL of the SiteMinder host. This is unique for each organization and will have the following form: https:\/\/sso.sidewaysinc.net\/empl-login Authentication Request Binding : Set to HTTP-Redirect . Activate the partnership by clicking the Action drop-down menu and selecting Activate . Export the SiteMinder X509 Certificate Go to the Certificate and Private Key List ( Infrastructure -> X509 Cert Mgmt -> Trusted Certs ). Click the Action button next to the X509 certificate that will be used, and select Export from the drop-down menu. Configure Menlo Security Settings Log into the Menlo Security Admin Portal: https:\/\/admin.menlosecurity.com Go to Settings -> Authentication . Enter the corporate gateway IP address(es) where user traffic originates. This automatically uses SAML authentication for users coming from this IP address. Select Enable user authentication using SAML and choose whether External Access is allowed, or whether SAML authentication is limited to requests from the Gateway IP address. This controls if users outside the corporate network will be authenticated or if they will receive an error message. Select the Other SAML provider. Input the SAML 2.0 Endpoint identifier (Remote Assertion Consumer Service URL). Input the Service Identifier (Authentication URL) from above. Click the Edit Certificate link and paste the X509 Certificate which was exported earlier. Important: The first URL is https and the second is http. These should match the values exactly from Windows server configuration. For OVA (private cloud) deployments, SAML authentication will need to be set up for the OVA admin user (in addition to your standard user endpoints). The endpoint and entityID for admin authentication should be: https:\/\/applianceName:8443\/api\/v1\/saml https:\/\/applianceName:8443\/api\/v1\/saml\/metadata Single Sign-On Overview Review for information about configuring Single Sign-On (SSO). " }, 
{ "title" : "Manual SAML Configuration for Users and Admins ", 
"url" : "41874-single-sign-on-guides--saml-/41950-manual-saml-configuration-for-users-and-admins.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Single Sign-On Guides (SAML) \/ Manual SAML Configuration for Users and Admins ", 
"snippet" : "Introduction When using SAML identity providers (on-premise and cloud) a manual SAML configuration is required to create the application on the SAML provider. This document provides the parameters required to complete configuration for the SAML provider to support both user and admin SAML authentica...", 
"body" : "Introduction When using SAML identity providers (on-premise and cloud) a manual SAML configuration is required to create the application on the SAML provider. This document provides the parameters required to complete configuration for the SAML provider to support both user and admin SAML authentication. SAML \"Metadata\" Information Cloud SAML Parameters Protocol Version : SAML 2.0 SAML Authentication Mode : Service Provider Initiated Binding : HTTP POST NameID Format : urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified The NameID attribute allows any string value. Using an email address is recommended. The Entity\/Issuer strings (how MSIP is identified) and login URLs differ per use case: MSIP Cloud SAML User Authentication - Web Isolation Entity ID: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata Login URL: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml MSIP Cloud SAML User Authentication - Email Isolation Entity ID: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata Login URL: https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml MSIP Cloud SAML User Authentication - Web Isolation + Email Isolation When both email and web isolation is used, both login URLs must be configured. Entity ID: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml\/metadata Login URL (email): https:\/\/isolate.menlosecurity.com\/safeview-auth-server\/saml Login URL (web): https:\/\/safe.menlosecurity.com\/safeview-auth-server\/saml MSIP Cloud SAML Admin Portal Authentication When admin SAML login is enabled, login via Menlo user database account can be accessed at the following URL: https:\/\/admin.menlosecurity.com\/#\/login?force_udb Entity ID: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml\/metadata Login URL: https:\/\/safe.menlosecurity.com\/safeview-auth-server\/adminsaml On-Premise SAML Parameters In on-premise deployments, the SAML authentication is identical to cloud SAML authentication, however the appliance parameters must be customized for the appliance login name. Protocol Version : SAML 2.0 SAML Authentication Mode : Service Provider Initiated Binding : HTTP POST NameID Format : urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified The NameID attribute allows any string value. Using an email address is recommended. The Entity\/Issuer strings (how MSIP is identified) and login URLs differ per use case: MSIP On-Premise SAML User Authentication The login Name is defined in Settings -> Service : Entity ID: https:\/\/<appliance login name>\/safeview-auth-server\/saml\/metadata Login URL: https:\/\/<appliance login name>\/safeview-auth-server\/saml MSIP On-Premise SAML Admin Authentication The appliance hostname is defined in Settings -> Network : Entity ID: https:\/\/<appliance hostname>:8443\/api\/v1\/saml\/metadata Login URL: https:\/\/<appliance hostname>:8443\/api\/v1\/saml " }, 
{ "title" : "Proxy Chaining Guides ", 
"url" : "41876-proxy-chaining-guides.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Blue Coat ", 
"url" : "41876-proxy-chaining-guides/41951-blue-coat.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Blue Coat ", 
"snippet" : "About This Guide This document describes the configuration of Menlo Security in coordination with Blue Coat. Integration Overview There are two different methods which can be used to deploy Blue Coat with the Menlo Security Isolation Platform (MSIP): Proxy Chain : All requests are invisibly forwarde...", 
"body" : "About This Guide This document describes the configuration of Menlo Security in coordination with Blue Coat. Integration Overview There are two different methods which can be used to deploy Blue Coat with the Menlo Security Isolation Platform (MSIP): Proxy Chain : All requests are invisibly forwarded through Menlo Security. See Blue Coat Proxy Chain Setup Procedure below for details. Redirect URL : The user is notified about all redirects, and requests are routed through Menlo Security by using a pre-pended URL. See Blue Coat Redirect URL Mode Setup Procedure below for details. In either mode the gateway's security policy controls how Menlo Security processes requests, users, and categories. Refer to before proceeding to view more information about setting up chained deployments. The sections below describe how to configure Menlo Security with either method and Blue Coat. The Proxy Chain configuration was tested with SGOS 6.5 (older versions don't have the necessary forwarding configuration options). Blue Coat Proxy Chain Setup Procedure Chained proxy mode uses Blue Coat's \"Forwarding Layer\" configuration to forward requests selectively through Menlo Security. The forwarding policy defines a \"Menlo Security\" action to send only certain chosen connections to Menlo Security. Use the Source and Destination columns to define the criteria for forwarding certain connections, such as risky categories or high risk users. Prerequisites You will need the following information to configure Blue Coat's \"Forwarding Layer\": Menlo Proxy Hosts : One or more hostnames in the following form: proxyN-nnnnnn.menlosecurity.com . These hostnames are provided by Menlo Security and are specific to each Menlo Security Cloud customer. Proxy Port : The following table describes the ports used to access the Menlo Security proxy. Traffic to Send to Menlo Security Port(s) HTTP Only 80, 443, or 3128 HTTP\/HTTPS with SSL Inspection 3129 HTTP Only for SSO\/SAML-Enabled Configurations 3130 HTTP\/HTTPS with SSL Inspection for SSO\/SAML-Enabled Configurations 3131 Step 1: Add a Forwarding Host Object . The final configuration of the forwarding host will look similar to the following figure. In the Blue Coat Admin web UI, go to the Configuration tab. Select Forwarding , and then click Forwarding Hosts . Click the New button to create a new host object. Enter the following: Alias : Name for the object (e.g., MenloProxy0 ) Host : First hostname (e.g., proxy0-nnnnnn.menlosecurity.com ) Type : Proxy HTTP Port : Select the appropriate port specified above (e.g., 3129 ) nnnnn is found in your PAC file and is unique for your organization. To obtain this value, login to admin.menlosecurity.com and go to Settings -> Proxy Auto Config -> Preview . An example value is proxy0-5495966dtf2e436199999.menlosecurity.com . When Type = Proxy is chosen, the HTTPS port setting is disabled. The port setting is only required for HTTP, which defines the proxy connection port to use for all requests, including both HTTP and HTTPS. Repeat the process above for each proxy hostname you have been provided (e.g., proxy1-nnnnnn.menlosecurity.com , proxy2-nnnnnn.menlosecurity.com , proxy3-nnnnnn.menlosecurity.com , proxy4-nnnnnn.menlosecurity.com , ...). After all proxies have been entered as forwarding hosts, apply your changes. The final list should look similar to the figure below. Please note that the number of assigned proxies may vary. Step 2: Create a Forwarding Group . Select the Forwarding Groups tab. Click the New button to create a new forwarding group. Enter the following: Alias : Name for the forwarding group (e.g., MenloProxyGroup ) Add all Menlo Security forwarding hosts created in . Load Balancing Method : Round Robin Host Affinity Methods : Client IP Address Click OK to save the forwarding group when finished. Click the Apply button. The final list should look similar to the following picture. Step 3: Launch the Visual Policy Manager UI. Select Policy in the Blue Coat Admin Web UI. Select Visual Policy Manager . Click Launch . Step 4: Add a Forwarding Layer if one does not exist. Click the Policy menu in the Visual Policy Manager. Select Add Forwarding Layer... . Enter a name for the forwarding layer (e.g., MenloForwardingLayer ). Click OK . Step 5: Add Forwarding Rules to the Forwarding Layer. Two rules are required to forward traffic. One rule forces menlosecurity.com traffic through the proxy. The second is a user traffic rule that points to Menlo Security (i.e., the traffic passes through Blue Coat and is then isolated by Menlo Security). Click the Add Rule button to add a new rule to forward traffic to Menlo Security. Right-click the Action cell and select Set . Click the New button, and then choose Select Forwarding . Enter the following: Name : Name for the forwarding action (e.g., MenloForwardingAction ). Add the previously created MenloProxyGroup Forwarding Group . Determine what happens if Menlo Security isn't reachable (i.e., the action If no forwarding host is available ). Click the OK button. Make sure that MenloForwardingAction is selected, and click OK again. Repeat the steps above to add a rule to send xx.menlosecurity.com to the Menlo proxy. The rule will use the forwarding action, but the Destination will be the Menlo Proxy. Refer to Rule No. 1 in the figure below: To determine which traffic will be forwarded to Menlo Security for isolation, reconfigure Rule No. 2 to match a specific set of categories. For example, to create a Category object: Right-click the Source and Destination columns and select Set . Choose New and click Server URL Category . Provide a name (e.g., RiskyCategories or Uncategorized\/None and click the checkboxes for the desired categories. Click OK to save the object. Step 6: Install the Policy. From the File menu, select Install Policy on SG Appliance . Click the OK button to acknowledge that the policy was successfully installed, and close the Visual Policy Manager. Step 7: Validate Health Checks. Navigate to Health Checks in the Blue Coat Admin Web UI. A health check is automatically created for each Menlo Security Forwarding Host and the Forwarding Group. Select each health check and click the Perform Health Check button. Confirm that the health check succeeded by clicking the OK button. Step 8: Make sure you have configured appropriate outbound internet access. Set the outbound Internet access to TCP 3128 . If you wish to set up SSL, follow the steps in Optional: Setting Up SSL to set access to TCP 3129 . Optional: Setting Up SSL The Blue Coat system can be configured to do SSL inspection. If the Menlo Security certificate is added, it can also be used to isolate SSL-based web sites. When the Forwarding Host was created, HTTP Port 3128 was used. This is a good starting point to get familiarity with the system for regular HTTP traffic. To do SSL, you can configure this to HTTP Port 3129 . Leave the selection on http (not https). Retrieve the Menlo Security Certificate. Go to the Certificate Page and save the latest certificate file (and note location). Import the Menlo Security Certificate into the Blue Coat system by navigating to Configuration -> SSL -> CA Certificates . Click Import and cut and paste the content of the Menlo Security Certificate. Edit the certificate in a text editor and just cut and paste the contents (including the BEGIN CERTIFICATE & END CERTIFICATE lines). Next make sure the newly imported certificate is in the browser-trusted group. Select the CA Certificates Lists tab, select browser-trusted and edit. Move the MenloSecurity certificate to the right by clicking the Add >> button. Make sure any firewalls upstream are configured to allow TCP 3129. The Blue Coat environment should be configured for SSL inspection and any Blue Coat certificates already distributed. Blue Coat Redirect URL Mode Setup Procedure Redirect mode uses Blue Coat's \"Web Access\" policy to redirect sessions through Menlo Security. This mode optionally displays a user notification page before sending the user to the requested site via a safe safe.menlosecurity.com pre-pended URL. You can set up the Blue Coat policy to redirect any www request that is not categorized as illustrated below. Here, the policy is configured for three source types to allow unlimited Internet access from exception addresses. All other addresses that match the Unknown Category get the Notify-and-deny action which redirects the page to Menlo Security. Step 1: Choose a Category to configure. Open the Category Selection window to choose the category whose action you want to configure. Step 2: Select the notify action which you want used. Open the Edit Combined Action Object window and select the notify action to use. Blue Coat displays a page to explain why a certain site is inaccessible. You can customize this page to display site information, to provide a safe link for the user to access the page, or to redirect the user automatically to the requested site via Menlo Security. An example exception screen is shown below. Step 3: Customize the exception.policy_denied . Edit the exception_current.html file and customize the exception.policy_denied section per your requirements. The following example shows a page which allows users to browse risky sites securely. An actual block page can include full formatting and automatic redirection via JavaScript. (exception.policy_denied (contact) (details \"Web Risk Encountered - please use Menlo Security.\") (format) (help) (summary \"Access Denied\") (http (code \"403\") (contact) (details \"Web Risk Encountered - please use Menlo Security.\") (format <<--23635bae.a0fa0-- <HTML><HEAD> <TITLE>$(exception.summary)<\/TITLE> <\/HEAD> <BODY> <FONT face=\"Helvetica\"> <big><strong>Web Risk Detected<\/strong><\/big><BR> <\/FONT> <blockquote> This site has been identified as risky. Please access this site safely via <a href=\"https:\/\/safe.menlosecurity.com\/$(url)\" id=\"link\">Menlo Security<\/a> <script type=\"text\/javascript\">\/\/document.getElementById(\"link\").href= \"https:\/\/safe.menlosecurity.com\/\" + window.location.href<\/script> <\/blockquote> <\/FONT> <\/BODY><\/HTML> --23635bae.a0fa0-- ) (help) (summary) ) ) " }, 
{ "title" : "Check Point ", 
"url" : "41876-proxy-chaining-guides/41952-check-point.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Check Point ", 
"snippet" : "About This Guide This document describes the configuration of Menlo Security in coordination with Check Point. Integration Overview There are two different methods which can be used to deploy Check Point with the Menlo Security Isolation Platform (MSIP): Proxy Chain : All requests are invisibly forw...", 
"body" : "About This Guide This document describes the configuration of Menlo Security in coordination with Check Point. Integration Overview There are two different methods which can be used to deploy Check Point with the Menlo Security Isolation Platform (MSIP): Proxy Chain : All requests are invisibly forwarded through Menlo Security. This option is useful if you want all users to go through Menlo Security. See Proxy Chain Setup Procedure below for details. Redirect URL : The user sees the redirects, and requests are routed through Menlo Security by using a pre-pended URL visible to the end user. The primary reason to select this option is if you want to push only a subset of your users through Menlo Security. See Re-Direct URL Setup Procedure below for details. In either mode the partner's gateway security policy controls how Menlo Security processes requests, users, and categories. Refer to before proceeding to view more information about setting up chained deployments. Installation Prerequisites The following is required to set up Check Point with Menlo Security: Check Point R75.40 or later The following optional components can also be installed with Menlo Security: Application and URL Filtering Software Blade External authentication via Active Directory or related service Proxy Chain Setup Procedure In addition to the traffic forwarded to Menlo Security for isolation sessions, *.menlosecurity.com should also be forwarded to the Menlo proxy for explicit proxy chaining (non transparent). This ensures consistent session routing during service upgrades. Step 1: Verify that the Check Point firewall is configured as a proxy. Double click the Gateway object in the left hand navigation (or right-click Edit... ). In the HTTP\/HTTPS Proxy section there are two options for the proxy: Transparent or Non Transparent . If you've already configured your endpoints to access Check Point before accessing the Internet (distributed PAC files pointing them to the Check Point firewall), Non Transparent will be configured. Otherwise, you'll likely want to use Transparent mode as displayed below. You can remove the 8080 (or leave it) in the Ports section, but you need to configure 80 as shown. In the Advanced section, make sure to check off the X-Forward-For-Header (original client source IP address) option. Step 2: Configure Check Point Proxy to chain to Menlo Security. Now go to the Topology -> Proxy setting on the Check Point firewall and select the Use Custom proxy settings for this network object: radio button. Enter proxy0-nnnnn.menlosecurity.com* and configure the port to be 3128 . nnnnn is found in your PAC file and is unique for your organization. To obtain this value, login to admin.menlosecurity.com and go to Settings -> Proxy Auto Config -> Preview . An example value is proxy0-5495966dtf2e436199999.menlosecurity.com . Step 3: Configure a rule to allow HTTP\/HTTPS traffic. In most cases a rule already exists allowing HTTP\/HTTPS traffic. If not, you can simply add a regular rule to the rule base as done in the example below. It's also important to make sure that your firewall can access the Internet in the outbound direction (so that it can communicate upstream with proxy0-nnnnn.menlosecurity.com ). Step 4: Verify that sites are being isolated. You should push the policy above and then validate that URL requests from your endpoints behind the Check Point firewall are being re-directed appropriately. Open a browser and access an Internet-based URL (for example, eonline.com ). You should receive the Menlo Security authentication. Authenticate using your credentials, which should have been pre-registered in Menlo Security. Refer to and for details. Generally the credentials are of the form user.email@usercompany.com . After authentication, you should receive the page isolated with Menlo Security (based on your policy). You won't have to re-authenticate, because a cookie is set to retain this information. You can also configure SSO via Active Directory or other SAML 2.0 services. Step 5: Optionally, block categories on Check Point before sending to Isolation. If you have the Application & URL Filtering Module in Check Point you can filter traffic before it enters the Menlo Security Isolation Platform. In Menlo Security there are Category filters for gambling, pornography, etc. You could use these filters to prevent sites you know should be blocked from hitting the system. Likewise, you can use Check Point's categories to pre-filter out known bad sites before passing them into the Isolation layer. It doesn't make sense to isolate sites you know for sure users shouldn't be accessing (gambling, pornography, etc.). To configure this on Check Point, access the Application & URL Filtering tab and add in the the appropriate policy to reject sites. You can also create custom messages. Then apply filters by the Application & URL Filtering module (for example, set to reject all gambling sites). If the URL doesn't match any of the filtered categories, accept it. The accept request passes the URL to Menlo Security via the Proxy Configuration setting, Menlo Security retrieves the site in our Disposable Virtual Container, and the safe rendering-only information is then pushed down to the user. Re-Direct URL Setup Procedure Instead of using the Proxy setup native in Check Point, you can use the UserCheck Interaction feature with a Redirect to External Portal . This feature is useful if you want to send only a subset of users to Menlo Security. Currently, Check Point doesn't support having varied forwarding options on their proxy. You can't have an accept rule for one group of users to go to the Internet without Menlo Security and a different rule for another group to go to the Internet with Menlo Security. When Check Point is configured with an upstream proxy, any allowed web site (determined by the rule base) is sent to the upstream proxy. You can't control whether it gets forwarded directly or to the upstream proxy. Step 1: Create Check Point group with Menlo Users Create a group of users whose web traffic is directed to Menlo Security for isolation. These users won't be subjected to malware from websites because they access the web via Menlo Security's Disposable Virtual Containers (DVCs). Create a normal Check Point user group with your selected users. These are simply users in Check Point, either connected to Active Directory or not. In the following figure it is called Menlo-User-Access . Step 2: Create an Isolate UserCheck In the UserCheck menu of the Application and URL Filtering section in Check Point, create a new Interaction option which redirects to https:\/\/safe.menlosecurity.com\/ . Step 3: Modify the PHP Check Point's portal PHP code can be modified by logging into the firewall via ssh . For a reference, a Check Point KB entry describing their recommended PHP modifications for other use cases is here: https:\/\/supportcenter.checkpoint.com\/supportcenter\/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk83700 By modifying the PHP, the original URL the user requested is pre-pended onto the redirect URL for Menlo Security. For example, modify the following file: \/opt\/CPUserCheckPortal\/phpincs\/web\/interceptors\/UCCookieInterceptor.php as follows. (The original line is commented out.): if($data->AutoRedirect == false && $data->ExternalSystemURL != \"\") { \/\/Set a cookie for later. setcookie(\"UserCheck_UserID\", $data->UserID, time() + 31556926); \/\/Redirect to the external systen portal. \/\/header('Location: ' . $data->ExternalSystemURL . ($data->ForwardParams == true ? \"?IncidentID=\" . $IncidentID . \"&UserID=\" . $data->UserID : \"\")); header('Location: ' . $data->ExternalSystemURL . ($data->ForwardParams == true ? $UTILS::base64url_decode($REQUEST->getRequestParam(\"origUrl\", $REQUEST->GET_REQ_PARAMS)) : \"\")); } Step 4: Create an Application & URL Filtering Rule with an Isolate Action The following rule base can be created to invoke the Isolate action on a specific user group. The first rule blocks suspect sites for all users. The second rule allows authentication. Once authenticated, the Isolate UserCheck redirects the user to the MSIP. Step 5: Verify that sites are being isolated and blocked appropriately. You should push the policy above and then validate that URL requests from your endpoints behind the Check Point firewall are being re-directed and isolated accordingly. " }, 
{ "title" : "Forcepoint (Previously Websense) ", 
"url" : "41876-proxy-chaining-guides/41953-forcepoint--previously-websense-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Forcepoint (Previously Websense) ", 
"snippet" : "About This Guide This document describes how to configure Menlo Security with Forcepoint (previously Websense). This procedure was tested using Forcepoint Triton Web Version 8.2 (other older versions are also likely to work in a similar manner as long as they support the Parenting Configuration feat...", 
"body" : "About This Guide This document describes how to configure Menlo Security with Forcepoint (previously Websense). This procedure was tested using Forcepoint Triton Web Version 8.2 (other older versions are also likely to work in a similar manner as long as they support the Parenting Configuration feature). Integration Overview Forcepoint supports connecting to Menlo Security as a full Proxy Chain . This mode is documented below. It's possible to chain from Forcepoint to Menlo Security as an on-prem appliance (ova or hardware appliance) or to chain to Menlo Security in the Cloud (SaaS). Both options are noted below. Forcepoint Proxy Chain Setup Procedure Chained proxy mode uses Forcepoint's Parenting Configuration to forward requests through Menlo Security. Forcepoint will forward all traffic which is allowed by policy to Menlo Security where a determination can be made to allow, block or isolate the traffic. In most use cases, the Menlo Security system will be configured to simply isolate the requests. In addition to the traffic forwarded to Menlo Security for isolation sessions, *.menlosecurity.com should also be forwarded to the Menlo proxy. This ensures consistent session routing during service upgrades. Step 1: Turn on the Parenting Configuration feature. The final configuration of the Parenting Configuration will look similar to the following. Forepoint ParentConfig In the Forcepoint web UI, go to the Configure tab. Select Content Routing , and then click Hierarchies . Click the Enabled button for Parent Proxy and No DNS and Just Forward to Parent . The rest of the options can be Disabled . Step 2: Ensure there is a Parent Proxy Cache Rule in the Parent Configuration Select Edit File in the above location to add a Parent Proxy Cache Rule . For a very simple on-prem configuration you can enter the IP address of the Menlo Security Web Isolation device (appliance or VM\/OVA) and port 3128 and 3129. In Primary Destination Type , select dest_domain and enter . as the Primary Destination Value to match all domains. In Parent Proxies , input the Menlo proxy hostnames followed by the Menlo Isolation Port (3128 or 3130, depending on authentication method being used) and Menlo Isolation Port+SSL port (3129 or 3131, again depending on authentication method). You should use both 3128\/3130 and 3129\/3131 and the secondary specifier of 80 (for 3128\/3130) and 443 (for 3129\/3131). In an on-prem environment this would be the IP address of the web isolation system upstream from the Forcepoint system. You can also enter multiple hostnames of different web isolation systems separated by ; which allow for failover in the event the primary goes down. For a cloud deployment of Menlo Security you would enter proxy0-nnnnnn.menlosecurity.com:3129; proxy1-nnnnnn.menlosecurity.com:3129 where nnnn is found in your PAC file and is unique for your organization (login to admin.menlosecurity.com and go to Settings -> Proxy Auto Config -> Preview ). An example value is proxy0-5495966dtf2e43617f98fe80e4c0492.menlosecurity.com . In Round Robin , select True to load balance requests across the parent proxies specified above. In Go Direct select False . In Secondary Specifiers select 80 for the 3128\/3130 entry and 443 for the 3129\/3131 entry. If you don't split the Forcepoint traffic for 80 and 443 into different Menlo Security port destinations you can end up with randomly failing sessions because Forcepoint doesn't support transition from http to https on a single port. Doing this config ensures there is no re-use of the port and all http traffic goes to 3128\/3130 and all https requests go to 3129\/3131. It is possible to also add Secondary Specifiers to control which systems (i.e., source IP's) are passed through (this is helpful for controlled testing). The following figure shows a Forcepoint to Menlo Security in the Cloud config using a secondary specifier. Step 3: SSL Certificate Import (isolating https traffic) Forcepoint is most likely already set up to do SSL inspection, so it is best to import the Menlo Security CA certificate into the Forcepoint gateway (for cloud configuration) or import a subordinate certificate into the Menlo Security Web Isolation system(s). Doing this keeps you from having to make any new certificate changes on the user endpoints. For Cloud Configurations: Download the Menlo Security CA certificate via the Certificate Page . In the Forcepoint interface, select Configure -> Certificates -> Add Root CA . Select Choose File and then select the Add Certificate Authority option. Forcepoint Certificate Step 4: Make sure appropriate network access is allowed You will need to make sure you have configured appropriate access to the required TCP ports: 3128-3131 (i.e., any firewalls are open between Forcepoint and Menlo Security). " }, 
{ "title" : "Fortinet ", 
"url" : "41876-proxy-chaining-guides/41954-fortinet.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Fortinet ", 
"snippet" : "About This Guide This document describes proxy chaining of web requests from a Fortinet FortiGate to Menlo Security. In this guide, the FortiGate is operating as an explicit proxy which forwards requests to the Menlo Security cloud proxy. Integration Overview Fortinet can be configured to send traff...", 
"body" : "About This Guide This document describes proxy chaining of web requests from a Fortinet FortiGate to Menlo Security. In this guide, the FortiGate is operating as an explicit proxy which forwards requests to the Menlo Security cloud proxy. Integration Overview Fortinet can be configured to send traffic to Menlo Security via the creation of a Fortinet firewall rule. Setup Procedure Overview This section outlines the setup procedure. For a detailed example of setting up Menlo Security with Fortinet, refer to Detailed CLI. Step 1: Set a custom firewall service 'webproxy'. Step 2: Edit 'squid' to TCP 3129. Step 3: Configure forwarding server to proxy0-nnnnn.menlosecurity.com* Configure the forwarding server to proxy to proxy0-nnnnn.menlosecurity.com where nnnnn is found in your PAC file and is unique for your organization. Login to admin.menlosecurity.com Navigate to Settings -> Proxy Auto Config -> Preview . Identify the proxy value. An example value is proxy0-5495966dtf2e436199999.menlosecurity.com . Step 4: Enable the firewall rule with proxy. Step 5: Verify setup by opening a web browser from a device protected by Fortinet. You should be prompted for your Menlo Security login credentials. Isolation of any site should occur according to your MSIP policy settings. Detailed CLI The following Fortinet configuration shows each of the changes. \/\/Set the custom service config firewall service custom edit \"webproxy\" set explicit-proxy enable set category \"Web Proxy\" set protocol ALL set tcp-portrange 0-65535:0-65535 next end config firewall service custom edit \"SQUID\" set category \"Tunneling\" set tcp-portrange 3129 end \/\/Configure FWD Server to proxy0-nnnnn.menlosecurity.com Isolation Platform config web-proxy forward-server edit \"proxy0-nnnnnnnn.menlosecurity.com\" set fqdn \"proxy0-nnnnn.menlosecurity.com\" set addr-type fqdn set healthcheck enable next end \/\/Enable web-proxy config web-proxy explicit set status enable end \/\/Enable Interface explicit-web-proxy enable config system interface edit \"internal1\" set ip 172.31.1.129 255.255.255.128 set allowaccess ping https ssh http fgfm capwap set type physical set explicit-web-proxy enable next end \/\/Create Firewall Rule config firewall explicit-proxy-policy edit 1 set proxy web set dstintf \"wan1\" set srcaddr \"all\" set dstaddr \"all\" set service \"webproxy\" set action accept set schedule \"always\" set logtraffic all set webproxy-forward-server \"proxy0-nnnnn.menlosecurity.com\" set utm-status enable set webfilter-profile \"default\" set profile-protocol-options \"default\" set ssl-ssh-profile \"certificate-inspection\" next end The traffic sent to the Menlo proxy is selected by the firewall rule shown above. The example shows a rule routing \"all\" traffic, but in actual usage the policy may select a subset of internet requests or exempt some traffic from isolation. If a subset of traffic is selected, please configure *.menlosecurity.com to be forwarded to the Menlo proxy to ensure correct forwarding through service upgrades. " }, 
{ "title" : "McAfee Web Gateway ", 
"url" : "41876-proxy-chaining-guides/41955-mcafee-web-gateway.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ McAfee Web Gateway ", 
"snippet" : "About This Guide This document describes how to configure Menlo Security with an on-premise McAfee Web Gateway. In addition to the traffic forwarded to Menlo Security for isolation sessions, *.menlosecurity.com should also be forwarded to the Menlo proxy. This ensures consistent session routing duri...", 
"body" : "About This Guide This document describes how to configure Menlo Security with an on-premise McAfee Web Gateway. In addition to the traffic forwarded to Menlo Security for isolation sessions, *.menlosecurity.com should also be forwarded to the Menlo proxy. This ensures consistent session routing during service upgrades. Setup Procedure This section describes how to use the controls within the McAfee Web Gateway policy to route requests into the isolation platform based on any policy match criteria (e.g., risky categorization, user ID, or group membership). Open the McAfee Admin interface and go to Policy -> Rule Sets . Select Add Rule to create a new rule for Menlo isolation. Enter a name and description for the isolation function. Press Next > to continue. Select the Rule Criteria to use when deciding which users, groups, or sites should be isolated. Any of the McAfee Web Gateway match critera can be used. To validate the integration, select a category with predictable domains, like \"Education\". Press OK to confirm the selection and then Next > to continue. Next, select the Action field and set it to Continue . This allows the connection to proceed into Menlo Security isolation. Press Next > to continue. Click the Add button to add a Enable Next Hop Proxy event that will take place immediately. This allows the session via the Menlo Security proxy. Click the Add Settings button (or Edit if \"Chain_Menlo\" already exists) and add the Menlo proxy hostnames and port number. Proxy port numbers are determined by authentication and SSL inspection settings. The most common proxy port numbers are: 3131: SAML SSO 3129: Not using SAML authentication The proxy hostnames are in a format similar to proxy0-nnnnnnnnnn.menlosecurity.com . Add both proxy hostnames to enable proxy high availability. You can retrieve these via admin.menlosecurity.com in the Preview of the PAC file ( Settings -> Proxy Auto Config -> PAC File Actions -> Preview ). If HTTPS Scanning is in use in the McAfee Web Gateway, the Menlo Security CA certification must be installed in the Certificate Chain Filters area for SSL inspection trust. Download the Menlo CA Security evaluation certificate . Contact Menlo Security support for the production certificate after testing. Set the Next Hop Proxy Server as Sticky . This ties each client to a next-hop proxy. Multiple clients are load balanced across all the proxies in the proxy list. Click OK to apply changes and then test the isolation. Load a URL that matches the rule created earlier (e.g., \"Education\" category web page) and confirm that the request is directed into isolation. " }, 
{ "title" : "Palo Alto Networks ", 
"url" : "41876-proxy-chaining-guides/41956-palo-alto-networks.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Palo Alto Networks ", 
"snippet" : "About This Guide This document describes the configuration of Menlo Security in coordination with Palo Alto Networks. Integration Overview You can deploy Palo Alto Networks with the Menlo Security Isolation Platform (MSIP) using Redirect URL mode. In this mode the user is notified about all redirect...", 
"body" : "About This Guide This document describes the configuration of Menlo Security in coordination with Palo Alto Networks. Integration Overview You can deploy Palo Alto Networks with the Menlo Security Isolation Platform (MSIP) using Redirect URL mode. In this mode the user is notified about all redirects, and requests are routed through Menlo Security by using a pre-pended URL. Menlo Security uses the URL Override capability in Palo Alto Networks' URL Filtering feature. Refer to before proceeding to view more information about setting up chained deployments. Redirect URL Setup Procedure Step 1: Set the URL Filtering Category Override In your Palo Alto Networks admin UI, navigate to Objects -> Security Profiles -> URL Filtering . For the categories that you would like to send to Menlo Security, set the action to override . Step 2: Set the Server Address In your Palo Alto Networks admin UI, navigate to Device -> Setup -> Content-ID . In the URL Admin Override pane, click Add . In the URL Admin Override window, fill in the form fields with the following values: Password and Confirm Password: Any password This is the password that you share with your users who are allowed the override privilege. This is not used in the Menlo Security integration. Server Certificate: None Mode: Redirect Address: support.menlosecurity.com Step 3: Create Rule In your Palo Alto Networks admin UI, navigate to Policies -> Security . Create a rule in your policy with: Service: service-http Action: Allow In the Profile column, choose the Menlo Security Web Isolation profile under URL Filtering . Step 4: Verify The last step is to verify that the integration is working as configured. On a device behind the Palo Alto Networks firewall, open a web browser. Type a URL in the address bar which should trigger the Menlo Security rule. In our example, we navigate to https:\/\/www.helloworld.com which is an unknown category. The first time a website is redirected to Menlo Security, you are prompted for your Menlo Security login credentials. On successful login, you can reach the target website via Menlo Security Web Isolation. The URL has safe.menlosecurity.com prepended to the target URL. " }, 
{ "title" : "Squid ", 
"url" : "41876-proxy-chaining-guides/41957-squid.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Proxy Chaining Guides \/ Squid ", 
"snippet" : "About This Guide This document describes the configuration of Menlo Security in coordination with Squid. Integration Overview Before proceeding with proxy setup, refer to ....", 
"body" : "About This Guide This document describes the configuration of Menlo Security in coordination with Squid. Integration Overview Before proceeding with proxy setup, refer to . " }, 
{ "title" : "Transparent Proxy ", 
"url" : "41878-transparent-proxy.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Transparent Proxy ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Integrating Menlo Security Isolation Platform with Palo Alto Firewall ", 
"url" : "41878-transparent-proxy/41958-integrating-menlo-security-isolation-platform-with-palo-alto-firewall.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Transparent Proxy \/ Integrating Menlo Security Isolation Platform with Palo Alto Firewall ", 
"snippet" : "Introduction Please contact your Menlo Security account team to request support for this feature. This document describes the IPSec VPN and policy-based forwarding configuration to transparently steer traffic for isolation. Integration Architecture Diagram Prerequisites Palo Alto Firewall with PAN-O...", 
"body" : "Introduction Please contact your Menlo Security account team to request support for this feature. This document describes the IPSec VPN and policy-based forwarding configuration to transparently steer traffic for isolation. Integration Architecture Diagram Prerequisites Palo Alto Firewall with PAN-OS v8.1 or newer Provide Palo Alto firewall external IP address to Menlo Security Support for IPSec configuration Receive IPSec parameters from Menlo Security Support for Primary and Secondary tunnels: Menlo Security VPN Gateway IP Addresses Menlo Security VPN Pre-shared Key Strings IPSec Peer Identifiers Palo Alto Firewall Configuration Add VPN Zone for Firewall Policy Optionally, a new VPN zone can be defined for use in firewall policy if a distinct policy will be used for the VPN zone. Zones can be managed in Network -> Zones and should be created as a Layer 3 Zone . Otherwise, a standard Untrust zone can be used. Add Tunnel Interfaces Network -> Interfaces: Tunnel Interface Configure tunnel interfaces to be used for the VPN, on the preferred VR and zone. Add two interfaces, one for each Menlo VPN tunnel. The Palo Alto firewall requires an IP address to be assigned to the tunnel interface to enable routing. The address can be configured in the IPv4 tab. Any IP available address can be used, and it is not dependent on the IPSec parameters. Configure IPSec\/IKE Parameters Network -> IKE Crypto Supported values: DH Group : group19 Authentication : sha1, sha256 Encryption : aes-128-cbc, aes-256-cbc Network -> IPSec Crypto Supported values: Encryption : aes-128-cbc, aes-256-cbc Authentication : sha1, sha256 DH Group : group19 Lifetime : 1 Hour Network -> IKE Gateways Details of the Menlo Security VPN: IKEv2 only mode Peer IP Address Type : IP Peer IP Address : <See Menlo Security Configuration Data> Authentication : Pre-Shared Key Pre-shared Key value : <See Menlo Security Configuration Data> Local Identifier: FQDN : Customer identifier FQDN: <See Menlo Security Configuration Data> Peer Identifier: FQDN : <See Menlo Security Configuration Data> Advanced Options: Network -> IPSec Tunnels The tunnel configuration combines the previously defined objects into the VPN tunnel configurations. Configure two tunnels, one for each Menlo Security VPN node. Tunnel Monitoring: Tunnel monitoring passes ICMP requests through the tunnel to verify the tunnel is operational and brings the tunnel up once it is fully configured, allowing simple validation of tunnel status. Tunnel Monitor Destination IP : 169.254.10.1 Note that any address in the 169.254.0.0\/16 range can be used for tunnel monitoring. Firewall Policy The existing firewall policy must be updated to allow IPSec setup and HTTP\/HTTPS connections to the VPN Policy to allow Web access to VPN Zone Policy to allow Encapsulated IPSec and IKE requests Ipsec-esp-udp : UDP\/4500 Ike : UDP\/500 Policy-Based Forwarding (PBF) Policy-Based Forwarding (PBF) allows us to choose which traffic is forwarded to Menlo Security. The session routing decision is made when the initial packet of this session is seen. Routing decisions can be made on any IP header (source IP, Dest IP, Service) or user-name (if available). When initially configuring the integration, it is recommended to define a single source IP to be routed to the VPN tunnel for validation. Once validated, expand the matched source IP addresses to expand the group of isolated users. Source : User Names or IP Address range of users to be isolated Services : HTTP + HTTPS Egress I\/F : VPN Tunnel Previous integrations required routing Menlo Security requests outside the VPN tunnel. This is no longer required and it is recommended to route menlosecurity.com requests via the tunnel to better manage service upgrades. If using SAML authentication, the SAML destinations should either be configured to bypass the IPSec tunnel, or be added as an SSL Exemption in the Menlo policy. This prevents an â€˜authentication loopâ€™ where authentication is required to connect to the authentication server. High Availability and PBF Monitoring For high availability, it is recommended to use two IPSec tunnels and a PBF monitor configuration to disable the PBF rule when the tunnel is unavailable. In this case, the connections use the second PBF rule and route traffic to the standby tunnel. In Network -> Monitor , add a Monitor Profile to control the polling configuration used in PBF monitoring. In the Policy-Based Forwarding rule , enable the Monitor and select the profile defined above. Load Distribution To distribute sessions across both Menlo Security VPN nodes, the policy-based forwarding rules can be structured to send a subset of traffic to each VPN tunnel. If a load balancing configuration is used, the monitoring configuration must also be structured to use the secondary tunnel if the primary is unavailable. In the illustration above, two user subnets are forwarded separately, each using a different tunnel as its primary. Menlo Security Address Objects To minimize TLS decryption overhead, the Menlo ACR isolation HTTPS traffic can be configured to bypass decryption using the Menlo Security service addresses. The addresses are available in this knowledge base entry in CLI syntax which can be pasted into the device configuration CLI to simplify object and group definition. The current list of Menlo Security address ranges is also available in the section of the product documentation. The address group is used in the policy based forwarding rules as â€˜no-decryptâ€™ so it is not decrypted. Please Note: This policy bypasses decryption of only the Menlo ACR rendering operations, which do not contain any data which an inspection device can understand. Any â€˜inspectableâ€™ events, such as file uploads or downloads, are processed via different IP ranges and are not bypassed from decryption. " }, 
{ "title" : "AD Automation ", 
"url" : "41880-ad-automation.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ AD Automation ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Active Directory (AD) Automation Guide ", 
"url" : "41880-ad-automation/41959-active-directory--ad--automation-guide.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ AD Automation \/ Active Directory (AD) Automation Guide ", 
"snippet" : "Introduction Proxy configuration is centrally managed via Active Directory (AD), enabling a simple deployment process for user groups of any size. Using Group Policy Objects, you apply the configuration to an entire organization or stage the configuration by applying the policy to groups of users. A...", 
"body" : "Introduction Proxy configuration is centrally managed via Active Directory (AD), enabling a simple deployment process for user groups of any size. Using Group Policy Objects, you apply the configuration to an entire organization or stage the configuration by applying the policy to groups of users. AD also allows you to choose whether a user is permitted to change these settings. Other important functions you can control with AD are: Distributing a PAC file Distributing key Internet Explorer (IE) settings (for example, disabling the blocking of 3rd party cookies or disabling Enable Enhanced Protected Mode) Distributing a certificate for HTTPS integration This guide outlines the steps for performing Proxy Auto Config (PAC) and Certification distribution via Group Policy Objects (GPOs). Mobile and MAC will be covered in a future release. Proxy Configuration GPO To configure a Group Policy, open the Active Directory Users & Computers management application. This requires Domain Administrator privileges within Active Directory. Active Directory Group Policy management options may differ between versions. It's also possible to use other tools (registry keys, admin templates, custom packages, etc.). Below are only a few examples. For Windows Server 2012 (New Group Policy) Select the Domain or Organizational Unit to apply the policy to, then right-click that selection. Select the option to Create a new Group Policy , and assign a name like Menlo Security Settings . Select the new Group Policy Object and click Edit . You can edit the PAC setting policy at: User Configuration -> Preferences -> Control Panel -> Internet Settings Right click Internet Settings and select New -> Internet Explorer 10 . Internet Explorer 11 is not available because IE 10 covers versions 10-99. Edit the Address: selection with the PAC file for your organization. It starts with https:\/\/pac.menlosecrity.com\/ . Disable blocking of 3rd Party Cookies, etc. by modifying the Group Policy Settings in the Windows registry. Refer to the Microsoft Support Page for IE Secruity Zones Registry Entries for details. Go to HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Zones The Privacy tab slider uses 1A10 for Privacy Settings. Use the following DWORD values: Block All Cookies: 00000003 High: 00000001 Medium High: 00000001 Medium: 00000001 Low: 00000001 Accept all Cookies: 00000000 For Windows Server 2003, 2008 There was previously an Internet Explorer Maintenance option (IEM). This was disabled with later browsers, starting with IE 10. For IE 10-based environments you can use the replacement Group Policy Preferences, Administrative Templates, or Internet Explorer Administration Kit (IEAK). Refer to the Replacements for Internet Explorer Maintenance article for more information. If you aren't able to update to Windows 2012 (which is preferred for managing IE 10 and IE 11), then follow the example configuration provided below for a Windows Server 2008 managing IE 10 and 11. It requires both Administrative Templates as well as Registry Edits, because the PAC setting isn't available in the Administrative Templates, and you may not see the Internet Explorer 10 option noted above. Import the latest Administrative Templates for Internet Explorer from Microsoft. Make sure that you copy the files into the locations Microsoft defines, and if you have multiple system volumes copy them to the shared location for the domain controllers. You may see an insufficient privileges warning if you try to copy to the local disk, which would be the wrong location. Open the Group Policy Management Console and create a new GPO. You can create a new Menlo Security Settings object or base it on another GPO. See Create a New GPO from a Starter GPO for more information. Open the new Menlo Security Settings GPO and edit the Policies section. There is a Policies and a Preferences section. It's important that the next setting be in the Policies section so that users can't override it. Edit User ConfigurationAdministrative TemplatesWindows ComponentsInternet ExplorerDisable changing Automatic Configuration settings and set it to Enabled . This keeps users from unselecting the use of the PAC file. To configure the pointer to the actual PAC file use a registry setting to create AutoConfigURL . This registry edit may not exist, so you can create it with the following parameters: HIVE: HKEY_CURRENT_USER Key Path: Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings Value Name: AutoConfigURL Value Type: REG_SZ Value Data: https:\/\/pac.menlosecurity.com\/... (users are unique to your environment) You need to make sure that the GPO setting and registry entry propagates through the domain and that it's assigned to a user. Log in as that user and check the IE Internet Options . Connections -> LAN Settings should have Use automatic configuration script selected with the pointer to the relevant PAC. If you do this as a policy, it won't be changeable by the user. You can also issue gpudate\/force on the system if the setting hasn't propagated. For certificates, go to the Group Policy Management Editor, select Computer Configuration -> Windows Settings -> Security Settings -> Public Key Policies -> Trusted Root Certification Authorities and add the Menlo Security Prod Root CA. " }, 
{ "title" : "Logging ", 
"url" : "41882-logging.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Logging ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Logging API ", 
"url" : "41882-logging/41960-logging-api.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Logging \/ Logging API ", 
"snippet" : "Introduction This document describes the Logging API available for the Menlo Security Isolation Platform (MSIP). This API allows customers to leverage the Menlo Security Cloud Isolation Platform (SaaS) to extract their tenant logs locally. The API is updated as new parameters are added. Please conta...", 
"body" : "Introduction This document describes the Logging API available for the Menlo Security Isolation Platform (MSIP). This API allows customers to leverage the Menlo Security Cloud Isolation Platform (SaaS) to extract their tenant logs locally. The API is updated as new parameters are added. Please contact Menlo Security Support at https:\/\/csportal.menlosecurity.com\/hc\/en-us for any questions or requests for updates to the documentation. Logging API Details Root URL: https:\/\/logs.menlosecurity.com\/api Title: Fetch Logs URL: \/rep\/v1\/fetch\/client_select Method: POST Authentication and Security Authenticate all requests with HTTPS, Auth Token, and IP Whitelisting Resource Information Data Parameters: The data parameter is in the format: {token: [alphanumeric], log_type: [web|audit|email|attachment|smtp|isoc], pagingIdentifiers: { [pagingIdentifiers1], [pagingIdentifiers2],...[pagingIdentifiersN]}} . Example: {token: \"[alphanumeric]\", log_type: \"web\", pagingIdentifiers: { \"next_time\": \"2020-08-26T11:38:25.894Z\", \"last_iteration\": true, \"hashes\": { \"65653099c7e214052fd8530b6fbdb5d8\": 0 } } The token parameter is a 32 byte hash that acts as a shared secret to work with the API. The log_type parameter defines which type of MSIP log is being exported: web : Web access logs. This is the default log type returned if log_type is not specified. audit : Admin portal administrator audit logs. email : Email URL rewriter logs. attachment : Email attachment logs. smtp : Logs of SMTP messages processed by the SMTP transform and restore nodes. isoc : Alerts generated by the Menlo Threat Intelligence platform to help SoC analysts. The pagingIdentifiers parameter is an internal parameter used for log pagination as needed if the request returns more than the maximum number of records (up to 10,000). It should not be used for interpretation and the value and format of the parameter may change between releases without any prior communication. There is a rate limit of 2000 API requests per 120 seconds. Response Details: Each request returns a maximum of 10,000 records (default limit is 1000). Each response includes a paging dictionary (specified by the pagingIdentifiers key). Note that the pagingIdentifiers key is empty on the first page, but if the query generates more results than the set limit, the client must update their local paging directory with the pagingIdentifiers key from the response and post it as a parameter with the next request. Continue requesting pages until you receive no data for the time period specified. The pagingIdentifiers response now has different keys to prevent downloads of duplicate data. Please refer to the previous and new output examples below: Previous Output \"pagingIdentifiers\": { \"pnr_page_request_2019-04-10T21:00:00.000Z_2019-04-10T21:01:03.456Z_2019-04-10T21:00:00.000Z\": 1 } New Output \"pagingIdentifiers\": { \"next_time\": \"2020-10-21T09:15:21.031Z\", \"hashes\": { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, Operational logs are output in KVF, CEF and LEEF formats (for details, see ). For Menlo Security Cloud Isolation Platform (SaaS) users, the following URL parameters are provided (Private Cloud users redirect logs to their log server and do not use the API). The logging API may occasionally return an empty 200 response when a JSON object is expected. This can occur if there is no log data for the log request (e.g., an audit log for offpeak hours like 22:00 to 22:30). The query will return Content-Length: 0 . Please see the API Python Script CS Portal page for the latest Python scripts and examples. URL Parameters URL Parameter Description Example start UTC start time in seconds since epoch (1 January 1970). This is set to 5 minutes prior to the current time by default. 1454964247 format The format used for log output (JSON, KVF, CEF or LEEF). Note that CEF and KVP are wrapped in JSON and you must put single quotes around your URL to avoid bash interpretation of question marks or ampersands if these formats are used. format=CEF end UTC end time in seconds since epoch (1 January 1970). This is set to the current time by default end=1455569047 limit Results limit as an integer. The default is 1000 (maximum allowed value). limit=100 Testing the API To test the API, use curl and a token. Obtain your token to work with the API. Enter a command using curl to fetch data. The following example fetches the last 5 minutes of data and outputs it in the JSON format (default): curl --header 'Content-Type: application\/json' --data '{\"token\": \"[alphanumeric]\"}' https:\/\/logs.menlosecurity.com\/api\/rep\/v1\/fetch\/client_select If there is an error in your key, an Unauthorized response is sent: <html><title>401: Unauthorized<\/title><body>401:Unauthorized<\/body><\/html> If there is no data, the following blank output is returned: { \"timestamp\": \"2020-08-04T02:57:46.902Z\", \"result\": { \"pagingIdentifiers\": {}, \"events\": [] } } The parameters and examples are provided in the sections below. KVP Output Format Updates The KVP output formatting has been updated as follows: Fields that contain an equal sign or blank spaces now use quotes around the response. If the field uses an escape character for the equal sign (e.g., URL), the escape is removed from the response. Fields that might contain special characters are now always quoted. The following provides examples of old vs. new output format examples. top_url Previously: top_url=https:\/\/www.google.com\/?gws_rd\/=ssl Now: top_url=\"https:\/\/www.google.com\/?gws_rd=ssl\" xHeaders Previously: xHeaders=\"[u'guest', u'corp']\" Now: xHeaders=[u'guest', u'corp'] user-agent Previously: special-char-[] Now: \"special-char-[]\" Previously: user-agent=special-char-\\\\ Now: user-agent=\"special-char-\\\\\" Previously: user-agent=special-char-\\tnext-text Now: user-agent=\"special-char- next-text Web Logs Sample Response Details (JSON) { \"timestamp\": \"2019-04-10T21:00:02.599Z\", \"result\": { \"metrics\": [ \"last_access\", \"rows\" ], \"events\": [ { \"event\": { \"top_url\": \"http:\/\/example.com\", \"egress_country\": \"US\", \"domain\": \"example.com\", \"protocol\": \"http\", \"risk_tally\": \"-1\", \"origin_ip\": \"130.65.255.101\", \"has_password\": \"NA\", \"file_size\": \"NA\", \"origin_country\": \"FR\", \"x-client-country\": \"US\", \"browser_and_version\": \"Chrome_72\", \"user-agent\": \"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_14_0) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/72.0.3325.181 Safari\/537.36\", \"egress_ip\": \"54.111.221.123\", \"threats\": \"cats_Phishing & Fraud\", \"severity\": \"5\", \"event_time\": \"2019-04-10T21:00:40.548000\", \"dst\": \"130.65.255.101\", \"filename\": \"NA\", \"risk_score\": \"low\", \"version\": \"2.0\", \"sha256\": \"fd1aee671d92aba0f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a\", \"soph_dlp_ref\": \"NA\" \"tab_id\": \"1\", \"xff_ip\": \"NA\", \"product\": \"MSIP\", \"vendor\": \"Menlo Security\", \"request_type\": \"GET\", \"pe_reason\": \"6c6ea27d-5350\", \"categories\": \"Education\", \"x-client-ip\": \"12.206.221.226\", \"name\": \"page_request\", \"url\": \"http:\/\/example.com\", \"response_code\": \"200\", \"userid\": \"admin@menlosecurity.com\", \"full_session_id\": \"KbJQIDPS-1\" \"pe_action\": \"isolate\", \"threat_types\": \"Phishing\", \"ua_type\": \"supported_browser\", \"content-type\": \"text\/html; charset=iso-8859-1\", \"is_iframe\": \"true\", \"region\": \"us-west-1b\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2019-04-10T21:00:02.599Z top_url Top level URL (in case of iframe) https:\/\/example.com egress_country Egress IP country (isolation instance) US domain Domain part of the URL example.com protocol The protocol used for the session (http or https) http risk_tally Count of risks encountered 4 origin_ip Actual IP address of the destination server 130.65.255.101 has_password Presence of password in form POST request false file_size The size (in bytes) of a file in a file upload\/download event NA origin_country Country of actual IP address of the destination server (origin_ip) FR x-client-country Country for IP request from user US browser_and_version The client browser and its version. Non-browser returns a response of undefined_undefined. Chrome_65 user-agent The software (software agent) acting on behalf of a user (commonly a web browser). Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_11_6) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/65.0.3325.181 Safari\/537.36 egress_ip IP address for outbound flow (typically from a private network to the Internet) 54.111.221.123 threats Threat type identified by Menlo Security internal data (what the Risks field is set to) cats_Phishing & Fraud severity The severity level for the session. This is currently fixed at 5. 5 event_time The access initiate date and time 2018-04-10T21:00:40.548000 dst Destination IP that proxy DNS lookup resolved to (may sometimes be a list of IP addresses) 130.65.255.101 filename The filename of the file being uploaded or downloaded. NA risk_score Risk calculated for URL low version The Menlo Security product version (currently fixed at 2.0) 2.0 tab_id Tab creation number within a surrogate (used to track how an individual tab is navigated by a user) 1 xff_ip X-Forwarded-For HTP header field originating client IP address NA product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP vendor The product vendor name (Menlo Security) Menlo Security request_type The method type for the request (GET, PUT, POST, etc.) GET pe_reason Web policy rule ID responsible for Menlo Security action. This can be empty for some cases. 6c6ea27d-5350 categories Category Rules Category type classification (e.g., General, Education, Download Sites, etc.) Education x-client-ip Source IP 12.206.221.226 name Request type page_request url The Destination URL https:\/\/example.com response_code HTTP response status code 200 userid The User ID for the log (in Anonymous mode, this is anon-xxx ). admin@menlosecurity.com full_session_id Unique ID for a page load (used as a correlation ID for other events: uploads\/downloads\/etc.) KbJQIDPS-1 pe_action The Menlo Security action taken for the session ( Isolate , Allow , Block , or Direct ). Direct actions are external application links that a user may click to launch through their web browser (e.g., anchor links, javascript navigations and mailto links) isolate threat_types Top level risk Phishing ua_type The type of user agent (supported\/unsupported\/non browser) supported_browser content-type Page type text\/html; charset=iso-8859-1 is_iframe Is inline frame (iframe) element (true\/false) true cached Indicates whether the resource was obtained from the isolated browser's cache (True) or by downloading from the origin server (False) True sha256 SHA256 hash of this file or document or text. This provides a cryptographically unique identifier. fd1aee67... soph_dlp_ref DLP log link NA referer Page request referer address https:\/\/www.adobe.com region AWS region and availability zone us-west-1b pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls casb_app_name Cloud application name (for CASB events) DropBox casb_org_name Application organization name Dropbox Inc. casb_cat_name Application category ID Cloud File Sharing casb_fun_name Application function name upload casb_risk_score Menlo risk score for application (0-10) 3 casb_profile_name Menlo CASB profile name attached to application or exception rule upload block casb_profile_type Menlo CASB profile type (sanctioned\/unsanctioned\/unclassified) unclassified casb_profile_id Menlo CASB profile ID e47cecae-721f... DLP Logs Sample Response Details (JSON) { \"timestamp\": \"2020-03-09T17:16:22.227Z\", \"result\": { \"metrics\": [ \"last_access\", \"rows\" ], \"events\": [ { \"event\": { \"dst_url\": \"http:\/\/tinyupload.com\/\", \"user_input\": \"false\", \"protocol\": \"http\", \"file_type\": \"CSV\", \"domain\": \"tinyupload.com\", \"alerted\": \"false\", \"ccl_ids\": \"CreditordebitcardnumbersGlobal\", \"severity\": \"5\", \"event_time\": \"2020-03-09T17:16:22.227000\", \"event_id\": \"a4c2161b3f81a287ec46d3c993a33f3b97ded5fd854fa184e7f50679303111ce\", \"filename\": \"credit_cards.csv\", \"version\": \"2.0\", \"sha256\": \"fd1aee671d92aba0f9f0a8a6d5c6b843e09c8295ced9bb85e16d97360b4d7b3a\", \"status\": \"dirty\", \"product\": \"MSIP\", \"ccl_match_counts\": \"1\", \"vendor\": \"Menlo Security\", \"ccl_scores\": \"1\", \"rule_name\": \"Credit card block rule\", \"request_type\": \"GET\", \"src_url\": \"http:\/\/tinyupload.com\/\", \"categories\": \"Download Sites\", \"stream_name\": \"\/safefile-input\/working_file\", \"name\": \"file_upload\", \"userid\": \"admin@menlosecurity.com\", \"action\": \"block\", \"rule_id\": \"1f3ef32c-ec62-42fb-8cad-e1fee3375099\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2020-03-09T17:16:22.227Z dst_url Destination URL http:\/\/tinyupload.com user_input Whether or not this event was generated as a result of user form input false protocol The protocol used for the session (http or https) http file_type Type of file that triggered the DLP violation CSV domain Domain part of the URL tinyupload.com alerted Whether or not an email alert was sent to a DLP Auditor profile false ccl_ids Name of DLP dictionary that was violated. If there are multiple violations, this will be an array of strings CreditordebitcardnumbersGlobal severity The severity level for the session. This is currently fixed at 5. 5 event_time The access initiate date and time 2020-03-09T17:16:22.227000 event_id Unique identifier for the DLP request (corresponds to the file_id in web log if this is a file upload) a4c216... filename The name of the file that triggered the DLP violation (for file uploads) credit_cards.csv version The Menlo Security product version (currently fixed at 2.0) 2.0 sha256 SHA256 hash of this file or document or text. This provides a cryptographically unique identifier. fd1aee67... status Result from the DLP engine (currently fixed at dirty ) dirty product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP ccl_match_counts Number of matches of the string that caused the violation. If there are multiple violations, this will be an array of match counts in the same order as the list of dictionaries from ccl_ids field. 1 vendor The product vendor name (Menlo Security) Menlo Security ccl_scores DLP score from the dictionary that caused the violation. If there are multiple violations, this will be an array of DLP scores in the same order as the list of dictionaries from ccl_ids field. 1 rule_name Name of the DLP policy rule that was violated Credit card block rule request_type The method type for the request (GET, PUT, POST, etc.) POST src_url Source URL http:\/\/tinyupload.com\/ categories Category Rules Category type classification (e.g., General, Education, Download Sites, etc.) Download Sites stream_name Internal name used for the file (usually working_file ) or text stream (uid) 1a856c756fea name Request type file_upload userid User ID for the log (in Anonymous mode, this is anon-xxx ) admin@menlosecurity.com action Menlo Security action taken for session (block or log) block rule_id DLP policy rule identifier responsible for the action taken 1f3ef32... pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls Audit Logs Sample Response Details (JSON) { \"timestamp\": \"2019-04-10T20:51:10.488Z\", \"result\": { \"metrics\": [ \"last_access\", \"rows\" ], \"events\": [ { \"event\": { \"product\": \"MSIP\", \"sub_event_type\": \"logout\", \"uid\": \"admin@menlosecurity.com\", \"event_time\": \"2019-04-10T20:55:26.347000\", \"name\": \"authentication\", \"version\": \"2.0\", \"audit_actions\": \"logout\", \"vendor\": \"Menlo Security\", \"rev_id\": \"NA\", \"severity\": \"5\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2019-04-10T20:51:10.488Z product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP sub_event_type Sub request type logout uid The User ID for the log (in Anonymous mode, this is anon-xxx ). admin@menlosecurity.com event_time The access initiate date and time 2019-04-10T20:55.26347000 name Request type authentication version The Menlo Security product version (currently fixed at 2.0) 2.0 audit_actions Type of action taken logout vendor The product vendor name (Menlo Security) Menlo Security rev_id Revision ID of the policy saved\/published. NA severity The severity level for the session. This is currently fixed at 5. 5 pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls Email URL Rewriter Logs Sample Response Details (JSON) { \"timestamp\": \"2019-04-10T21:16:09.060Z\", \"result\": { \"metrics\": [ \"last_access\", \"rows\" ], \"events\": [ { \"event\": { \"delivered_to\": \"bsmith@company.com\", \"domain\": \"cnn.com\", \"vendor\": \"Menlo Security\", \"rewritten\": \"transform\", \"event_time\": \"2019-04-10T21:19:47\", \"from\": \"jdoe@company.com\", \"message_tid\": \"e52a2c70-3d04-11e8-8a0b-918c2380e1d4\", \"charset\": \"UTF-8\", \"product\": \"MSIP\", \"name\": \"url-rewrite\", \"url\": \"cnn.com\", \"reason\": \"default\", \"version\": \"2.0\", \"email_date\": \"2019-04-10T14:19:41-07:00\", \"message_id\": \"CACiMZ7P4LGPwwqbp+dKQ@mail.gmail.com\", \"subject\": \"Check This Out\", \"to\": \"bsmith@gmail.com\" \"severity\": \"5\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2019-04-10T21:16:09.060Z domain Domain part of the URL cnn.com vendor The product vendor name (Menlo Security) Menlo Security rewritten Action performed on the URL present in the email transform event_time The access initiate date and time 2019-04-10T21:19:47 message_tid Message transaction ID provided within all log messages pertaining to a given message e52a2c70-3d04-11e8-8a0b-918c2380e1d4 charset Charset used to encode text containing identified URL UTF-8 product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP name Request type url-rewrite url Destination URL cnn.com reason Rationale behind action performed default version The Menlo Security product version (currently fixed at 2.0) 2.0 email_date Email date 2019-04-10T14:19:41-07:00 message_id Email identifier CACiMZ7P4LGPwwqbp+dKQ@mail.gmail.com severity The severity level for the session. This is currently fixed at 5. 5 delivered_to Recipient email address bsmith@gmail.com from Email address in email From: line jdoe@company.com subject Text in email Subject: line Check This Out to Email address in email To: line bsmith@gmail.com pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls Email Attachment Logs Sample Response Details (JSON) { \"timestamp\": \"2019-04-10T21:16:09.060Z\", \"result\": { \"metrics\": [ \"last_access\", \"rows\" ], \"events\": [ { \"event\": { \"product\": \"MSIP\", \"rvlabs_factor\": \"0\", \"vendor\": \"Menlo Security\", \"rewritten\": \"replaced\", \"event_time\": \"2019-04-18T11:52:33.459Z\", \"file_type\": \"PDF\", \"filename\": \"invite.ics\", \"from\": \"jdoe@company.com\", \"reply_to\": \"jdoe@company.com\", \"bytes\": \"17036\", \"delivered_to\": \"bsmith@company.com\", \"to\": \"bsmith@company.com\", \"name\": \"attachment-rewrite\", \"message_tid\": \"30d7a0b0-a2dd-11e8-b2b5-916b58752559\", \"reason\": \"test\", \"version\": \"2.0\", \"email_date\": \"2019-04-18T11:38:02+00:00\", \"sha256\": \"6f5aacaf01daecd95c04d0d43f20649bb7212ecbf304a71cdd6c32cdbd4bfb73\", \"subject\": \"Meeting Invite\", \"message_id\": \"4MB00601840C057.namprd94.prod.outlook.com\", \"mime_type\": \"application\/pdf\", \"severity\": \"5\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2019-04-10T21:16:09.060Z product Product (Menlo Security Isolation Platform (MSIP)) MSIP rvlabs_factor Malware risk factor 0 vendor The product vendor name (Menlo Security) Menlo Security rewritten Action performed on the URL present in the email replaced event_time The access initiate date and time 2019-04-18T11:52:33.459Z file_type Attachment file type PDF bytes Size of identified attachment (in bytes) 17036 name Request type attachment-rewrite message_tid Message transaction ID provided within all log messages pertaining to a given message 30d7a0b0-a2dd-11e8-b2b5-916b58752559 reason Rationale behind the action performed test version The Menlo Security product version (currently fixed at 2.0) 2.0 email_date Email date 2019-04-18T11:38:02+00:00 sha256 The SHA256 hash of this file or document. This provides a cryptographically unique identifier. c2a995de626356f701b6c7f549a3f4 message_id Email identifier 4MB00601840C057.namprd94.prod.outlook.com mime_type Attachment MIME type application\/pdf severity The severity level for the session. This is currently fixed at 5. 5 delivered_to Recipient email address bsmith@gmail.com filename Attachment filename invite.ics from Email address in email From: line jdoe@company.com reply_to Sender email address jdoe@company.com subject Text in email Subject: line Meeting Invite to Email address in email To: line bsmith@gmail.com pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls SMTP Logs Sample Response Details (JSON) { \"timestamp\": \"2018-04-10T21:16:09.060Z\", \"result\": { \"metrics\": [ \"last_access\", \"total_links\", \"time_handoff_up\", \"original_bytes\", \"time_handoff_down\", \"rewritten_links\", \"rewrite_time_taken\", \"rows\", \"time_taken\" ], \"events\": [ { \"event\": { \"severity\": \"5\" \"smtp_reply\": \"250\", \"time_handoff_down\": 1.5959999561309814, \"total_links\": 3, \"rows\": 1, \"from\": \"NA\", \"next_hop_reason\": \"250 2.6.0 <CACiMZ7P4LGPwwqbpYUiit9VW=HT30vhJorgmq_4g1Uw5b3+dKQ@mail.gmail.com> [InternalId=115680649151408, Hostname=BY1PR10MB0358.namprd10.prod.outlook.com] 22156 bytes in 0.309, 69.903 KB\/sec Queued mail for delivery\", \"event_time\": \"2018-04-10T21:19:49\", \"src_tls\": \"true\", \"hostname\": \"safemail.menlosecurity.com\", \"src_ip\": \"216.32.181.23\", \"to\": \"NA\", \"version\": \"2.0\", \"message_id\": \"CACiMZ7P4LGPwwqbp+dKQ@mail.gmail.com\", \"product\": \"MSIP\", \"vendor\": \"Menlo Security\", \"timestamp\": \"2018-04-10T21:19:49.000Z\", \"src_port\": \"16928\", \"reason\": \"NA\", \"dst_tls\": \"true\", \"rewritten_links\": 3, \"time_taken\": 2.6410000324249268, \"rewrite_success\": \"true\", \"time_handoff_up\": 0.2930000126361847, \"name\": \"upstream-accept\", \"message_tid\": \"e52a2c70-3d04-11e8-8a0b-918c2380e1d4\", \"region\": \"us-east-1a\", \"unix_time\": \"1523395189\", \"unix_time_iso\": \"2018-04-10T21:19:49\", \"mode\": \"transform\", \"dst_ip\": \"207.46.163.10\", \"dst_from_port\": \"58145\" } } ], \"pagingIdentifiers\": { \"next_time\": \"2019-04-10T21:00:00.000Z\", \"hashes\" : { \"f21fdde7b4e3baa896d2154184bd451f\": 0 }, \"last_iteration\": true }, } } } Response Parameters Response Parameter Description Example timestamp Start time of the requesting log. This is internal to the log database. 2018-04-10T21:16:09.060Z severity The severity level for the session. This is currently fixed at 5. 5 smtp_reply The SMTP reply code propagated to upstream; downstream code 250 time_handoff_down Time spent writing to downstream in seconds 1.5959999561309814 total_links Number of links in the email 3 rows Number of rows with the same values 1 from Envelope sender (MAIL FROM) NA next_hop_reason Downstream response reason (e.g., 550 foo bar* or NA if it never got to downstream) 250 2.6.0 < CACiMZ7P4LGPwwqbpYUiit9VW=HT30vhJorgmq_4g1Uw5b3+dKQ@mail.gmail.com > [InternalId=115680649151408, Hostname=BY1PR10MB0358.namprd10.prod.outlook.com] 22156 bytes in 0.309, 69.903 KB\/sec Queued mail for delivery event_time The access initiate date and time 2018-04-10T21:19:49 src_tls Whether transport layer security was used talking to the source MTA true hostname Email processor hostname safemail.menlosecurity.com src_ip Source IP address 216.32.181.23 to Envelope recipients NA version The Menlo Security product version (currently fixed at 2.0) 2.0 message_id Unique ID for this email CACiMZ7P4LGPwwqbp+dKQ@mail.gmail.com product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP vendor The product vendor name (Menlo Security) Menlo Security timestamp Start time of the event 2018-04-10T21:19:49.000Z src_port Source port 16928 reason Internal error reason; NA used if the reason is downstream NA dst_tls Whether transport layer security was used talking to the destination MTA true rewritten_links Number of links rewritten 3 time_taken Total time spent in seconds processing email 2.6410000324249268 rewrite_success Whether rewriting was successful or not, or blank if not applicable true time_handoff_up Time spent reading from upstream in seconds, e.g. 1.234, or null if not applicable 0.2930000126361847 name Result of processing upstream-accept message_tid A unique transaction id for this attempt to process the email, the same message id may occur with multiple transaction ids if it is retried e52a2c70-3d04-11e8-8a0b-918c2380e1d4 region AWS region and availability zone us-east-1a unix_time Unix time epoch 1523395189 unix_time_iso Unix time stamp 2018-04-10T21:19:49 mode Whether the processing was to transform or restore the email transform dst_ip Destination IP address 207.46.163.10 dst_from_port When connection is established with downstream MTA, MTA's port is fixed, but local port requires indicating - useful for diagnosing issues based on connection, which is identified by tuple (local IP, local port, remote IP, remote port). 58145 pagingIdentifiers Identifier used for log pagination if needed to download all log entries (i.e., the request returned more than 1000 records). next_time Log pagination uses this field as the start time for query. If no time is present, the original start and end time is used hashes pagingIdentifier object hashes used to find and delete duplicate data from duplicate log fetch api calls iSOC Logs Sample Response Details (JSON) { \"event\": { \"alert_type\": \"isoc\", \"browser_and_version\": \"Chrome_83\", \"policy_applied\": \"allow\", \"recommended_action\": \"investigate\", \"click_time_verdict\": \"Malware Sites\", \"target_domain\": \"ianfette.org\", \"click_time_timestamp\": \"2020-06-02T01:20:56.446Z\", \"origin_ip\": \"173.201.140.128\", \"file_size\": \"NA\", \"browser_type\": \"supported_browser\", \"severity\": \"high\", \"event_time\": \"2020-06-02T01:21:09.097762\", \"user-agent\": \"Mozilla\/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/83.0.4103.61 Safari\/537.36\", \"version\": \"2.0\", \"product\": \"MSIP\", \"vendor\": \"Menlo Security\", \"alert_sub_type\": \"isoc_access_malicious_site\", \"dest_ips\": \"173.201.140.128\", \"url\": \"http:\/\/ianfette.org\/\", \"alert_name\": \"Malicious Site Access\", \"document_download_type\": \"false\", \"http_method\": \"GET\", \"resource_category\": \"page_request\", \"alert_source\": \"web\", \"browser\": \"Chrome\" } } Response Parameters Response Parameter Description Example alert_type Type of alert (iSOC) isoc browser_and_version Browser and major version IE_11 policy_applied Policy applied to the request block recommended_action Recommended action that the customer needs to take for this alert ( none : alert was either blocked or isolated and no action is required by SoC admin; investigate : alert requires SoC to investigate to ensure no improper actions taken by user; immediate : alert requires immediate attention by SoC admin) none click_time_verdict Click time categorization Phishing and Other Frauds target_domain Domain as logged dangeroussite.com click_time_timestamp Timestamp recorded at time of click 2020-01-03T13:16:50.214Z origin_ip Actual IP address of the destination server 130.65.255.101 file_size Size of the file in bytes when a malicious file is downloaded 1024 browser_type Whether the browser request was made from a supported browser supported_browser severity Defines how critical the alert is high event_time The access initiate date and time 2020-06-02T01:21:09.097762 user-agent User agent string from the http header Mozilla\/5.0 (Windows NT 10.0; WOW64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/79.0.3945.88 Safari\/537.36 version The Menlo Security product version (currently fixed at 2.0) 2.0 product The Menlo Security Product (MSIP or Menlo Security Isolation Platform) MSIP vendor The product vendor name (Menlo Security) Menlo Security alert_sub_type Specific subtype of the alert isoc_submission_phishing_content dest_ips Destination IPs of the malicious request 4.4.4.4 url Request URL https:\/\/dangeroussite.com alert_name Name of the alert Phishing Site Content Submission document_download_type Defines the kind of document that was downloaded (safe\/original) original http_method HTTP method POST resource_category Indicates the type of request (i.e. page request\/download\/etc.) form_post alert_source Email\/Web web browser Browser making the web request Chrome file_type Libmagic result of the file type that was downloaded PDF filename Filename of the downloaded file LmsCertificate.pdf password_input If a web request had a password submitted false file_hash SHA256 of the file download 3c4e2ea86477064daf1c4d3d66bf1289774fe3c76681502cb8c4a9e6e4f15a64 email_risk_score Email risk score low http_response HTTP response status 200 malware_family_name Malware family name from the hash lookup result or manual labelling Win32.Trojan.Browsefox isoc_verdict Menlo Security's verdict of the web request Phising and Other Frauds av_scan Hash lookup\/av scan result Infected Example Logging Script Log into the Menlo Security Support Portal and access the following article: API Python Script The API Perl script is no longer supported or maintained. " }, 
{ "title" : "Menlo Security Log Field Name Mapping ", 
"url" : "41882-logging/41961-menlo-security-log-field-name-mapping.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Logging \/ Menlo Security Log Field Name Mapping ", 
"snippet" : "Introduction The following tables provide the field names used on the Admin Portal in the Log and Insights panes and the corresponding names provided in exported JSON, CEF, KVP, and LEEF files. These tables will be updated as new fields are added. All Logs UI Name UI Values JSON CEF KVP LEEF Insight...", 
"body" : "Introduction The following tables provide the field names used on the Admin Portal in the Log and Insights panes and the corresponding names provided in exported JSON, CEF, KVP, and LEEF files. These tables will be updated as new fields are added. All Logs UI Name UI Values JSON CEF KVP LEEF Insights NA NA vendor vendor vendor vendor NA NA NA product product product product NA NA NA version version version version NA NA NA signature signature signature signature NA NA NA severity severity severity sev NA Web Logs UI Name UI Values JSON CEF KVP LEEF Insights Request Type Page Request, File Upload, File Request, Mail Attachment, Flash, Isolated Document, Original Download, Safe Download, Application Request, SSL Inspection, Resource Request, Form POST, N\/A, External Application Link name name name name resource Action Allow, Isolate, Isolate + Read-Only, Block, Email-Entry Read-Write, Email-Entry Connect-Direct, Email-Entry Read-Only, Email-Entry Block, Mobile-Block Low, Mobile-Block Medium, Mobile-Block High, Email-Exit Read-Write, Email-Exit Connect-Direct, Bypass, SSL Exception, Isolation Exit pe_action act pe_action pe_action action Protocol http, https protocol app protocol protocol protocol User ID <user ID\/email address> userid suid userid usrName user Request Method GET, POST, PUT, DELETE, PATCH, HEAD request_type requestMethod request_type request_type method Date <Date and Time> e.g., OCT-17-2021 12:30:10 PM event_time start event_time devTime interval Browser Type <Browser name and version> e.g., Chrome 77 browser_and_version browserAndVersion browser_and_version browser_and_version browser Source IP <Source IP address> x-client-ip src x-client-ip src src_ip URL <URL> url request url url domain Egress IP <IP address> origin_ip originIp origin_ip originIP egress_ip User Agent <user agent> e.g., Mozilla\/5.0 (Macintosh, Intel Mac OS X 10_12_16) user-agent requestClientApplication user-agent user-agent user_agent\" Referer <referer address> referer referer referer referer referer Response Code <http response code> 200 response_code responseCode response_code responseCode status Content Type <content type> e.g., text\/html content-type contentType content-type contentType N\/A File Name <file name> e.g., test.pdf filename fileName filename fileName filename Hash of the File <SHA-256 hash value> sha256 sha256 sha256 sha256 hash N\/A N\/A has_password hasPassword has_password hasPassword has_password N\/A N\/A top_url topUrl top_url topUrl top_url N\/A N\/A domain domain domain domain domain N\/A N\/A email_isolation_state emailIsolationState email_isolation_state emailIsolationState N\/A N\/A N\/A full_session_id fullSessionId full_session_id fullSessionId N\/A N\/A N\/A tab_id tabId tab_id tabId N\/A N\/A N\/A cached cached cached cached N\/A URL <URL of the doc accessed> document_url documentUrl document_url documentUrl url Web Risk Score Low, Medium, High risk_score riskScore risk_score riskScore risk_score N\/A N\/A <risk range from -1 to 100 where 100 is trustworthy> risk_tally riskTally risk_tally riskTally reputation Rule Matched <hash of rule matching for event> pe_reason ruleName rule_name ruleName rule_id N\/A N\/A <rule name> N\/A N\/A N\/A N\/A rule_name File Size <file size in bytes> file_size fileSize file_size fileSize file_size Source Country <source country name> x-client-country srcCountry x-client-country srcCountry src_country Egress Country <egress country name> egress_country egressCountry egress_country egressCountry egress_country Destination Country <destination country name> origin_country originCountry origin_country originCountry dst_country Destination IP <destination IP address> dst dst dst dst dst_ip iframe True, False, N\/A is_iframe isIframe is_iframe isIframe is_iframe N\/A N\/A threats threats threats threats N\/A Categories Advertisements & Pop-ups, Anonymizers, Business, Computers & Technology, Download Sites, Education, Entertainment, Fashion & Beauty, Finance, General, Government, Hate & Intolerance, Health & Medicine, Image Sharing, Information Security, Instant Messaging, Job Search, News, Non-profits & NGOs, Parked Domains, Personal Sites, Politics, Religion, Restaurants & Dining, Search Engines & Portals, Shopping, Skipped Menlo Categories, Social Networking, Streaming Media & Downloads, Transportation, Travel, Unknown, Web-based Email categories categories categories categories categories category Threat Type Flash, Vulnerable Service, Risky File, Uncategorized Site, Parked Domains, Phishing threat_types threat_types threat_types threat_types threat Access Mode Proxy, Prepend N\/A N\/A N\/A N\/A access Risk G-Green, R-Red, Y-Yellow N\/A N\/A N\/A N\/A Code File Information <file download details if applicable> N\/A N\/A N\/A N\/A 'download' and 'hash of the file' X-Headers <x-headers> policy_headers xHeaders policy_headers xHeaders x_header X-Headers Matched <if x-headers match> policy_headers_matched xHeadersMatched policy_headers_matched xHeadersMatched x_headers_matched Application Name <cloud application name> casb_app_name casbAppName casb_app_name casbAppName N\/A Organization Name <application organization name> casb_org_name casbOrgName casb_org_name casbOrgName N\/A Application Category <application category name> casb_cat_name casbCatName casb_cat_name casbCatName N\/A Application Action <application function name> casb_fun_name casbFunName casb_fun_name casbFunName N\/A Application Risk Score <risk score for an application from 0 to 10> casb_risk_score casbRiskScore casb_risk_score casbRiskScore N\/A CASB Profile <CASB profile name> casb_profile_name casbProfileName casb_profile_name casbProfileName N\/A N\/A <archive path> N\/A N\/A N\/A N\/A archive_path N\/A <depth of nested archives> N\/A N\/A N\/A N\/A archive_depth N\/A <parent file id> N\/A N\/A N\/A N\/A parent_file_id N\/A <parent filename> N\/A N\/A N\/A N\/A parent_filename N\/A <parent hash> N\/A N\/A N\/A N\/A parent_hash N\/A <root file ID> N\/A N\/A N\/A N\/A root_file_id N\/A <root filename> N\/A N\/A N\/A N\/A root_filename N\/A <root hash> N\/A N\/A N\/A N\/A root_hash Safemail Logs UI Name UI Values JSON CEF KVP LEEF Insights Rewrite Logs N\/A event event event event N\/A Action Not Transformed, Transformed, Restored, Whitelisted rewritten rewritten rewritten rewritten N\/A Reason Attachment Isolation, Default Transform, Private Name, Private IP, Popular Sites, File Import, Malformed URL, Whitelist Undefined, Undo, Unsupported Charset, Unsupported Transfer Encoding reason reason reason reason reason Transaction ID <uuid> message_tid message_tid message_tid message_tid N\/A Receiver <email recipient> to to to to to Sender <email sender> from from from from from Subject <subject line> subject subject subject subject subject N\/A N\/A reply_to reply_to reply_to reply_to reply_to Date <date and time> email_date email_date email_date email_date N\/A Message ID <identifier for message> message_id message_id message_id message_id message_id N\/A N\/A delivered_to delivered_to delivered_to delivered_to delivered_to Message Charset <character set> e.g., UTF-8 charset charset charset charset charset N\/A N\/A domain domain domain domain domain URL <URL> url url url url url N\/A N\/A filename file_name filename file_name N\/A N\/A N\/A mime_type mime_type mime_type mime_type mime_type Date <date and time> event_time event_time event_time devTime N\/A Email Attachment Logs UI Name UI Values JSON CEF KVP LEEF Insights Event Type Rewritten event event event event event Action Allow, Isolate, Block, Unwrapped rewritten rewritten rewritten rewritten rewritten Reason <reason for action> reason reason reason reason reason Transaction ID uuid message_tid message_tid message_tid message_tid N\/A Receiver <email recipient> to to to to to Sender <email sender> from from from from from Subject <subject line> subject subject subject subject subject N\/A N\/A reply_to reply_to reply_to reply_to reply_to Date <Date and time in local time format> e.g., Dec-03-2020 02:10:10 PM email_date email_date email_date email_date N\/A Message ID <Message ID field in email header> message_id message_id message_id message_id message_id N\/A N\/A delivered_to delivered_to delivered_to delivered_to delivered_to N\/A N\/A charset charset charset charset charset N\/A N\/A domain domain domain domain domain Filename <original file name of attachment> filename file_name filename file_name filename File Type <supported file or document type> mime_type mime_type mime_type mime_type file_type N\/A N\/A bytes bytes bytes bytes file_size sha256 SHA-256 hash of attachment sha257 sha258 sha259 sha260 hash File Type <supported file or document type> file_type file_type file_type file_type N\/A N\/A rvlabs_risk rvlabs_risk rvlabs_risk rvlabs_risk N\/A N\/A rvlabs_classification rvlabs_classification rvlabs_classification rvlabs_classification rvlabs_classification N\/A N\/A rvlabs_factor rvlabs_factor rvlabs_factor rvlabs_factor rvlabs_factor N\/A N\/A rvlabs_result rvlabs_result rvlabs_result rvlabs_result av_scan_result N\/A N\/A rvlabs_malicious_indicators rvlabs_malicious_indicators rvlabs_malicious_indicators rvlabs_malicious_indicators N\/A N\/A event_time event_time event_time devTime Event Timestamp <date and time in Unix format> e.g., 2019-12-03T22:10:10.408Z N\/A N\/A N\/A N\/A N\/A SMTP Logs UI Name UI Values JSON CEF KVP LEEF Insights Action Accepted, Rejected, Aborted, Sent, Unmodified event event event event event SMTP Reply Code Standard smtp reply codes per protocol (e.g., 2** 4** or 5**) smtp_reply smtp_reply smtp_reply smtp_reply N\/A Time Source MTA Handoff (s): Double (in sec) e.g., 0.709 time_handoff_down time_handoff_down time_handoff_down time_handoff_down N\/A Links <Total Number of links in email (int)> total_links total_links total_links total_links N\/A N\/A N\/A rows rows rows rows N\/A Hostname <hostname> hostname hostname hostname hostname hostname Sender <email sender> from from from from from Source TLS True, False src_tls src_tls src_tls src_tls src_tls Source IP Address <source IP address> src_ip src_ip src_ip src src_ip Receiver <email recipient> to to to to to Source Port <port> e.g., 23072 src_port src_port src_port srcPort N\/A Message ID <message ID in email header> message_id message_id message_id message_id message_id Next Hop Reason <reason for success\/failure in form SMTP code <string from next hop> e.g, 250 2.6.0 < BYAPR10MB3336BCB477A7195E492E7B6CD8420@BYAPR10MB3336.namprd10.prod.outlook.com > [InternalId=16342350563020, Hostname=MN2PR10MB4223.namprd10.prod.outlook.com] 29126 bytes in 0.308, 92.238 KB\/sec Queued mail for delivery next_hop_reason next_hop_reason next_hop_reason next_hop_reason N\/A Event Timestamp <timestamp of log event in ISO8601 format> timestamp timestamp timestamp timestamp N\/A Reason All Reasons, Attachment Isolation, Default Transform, Private Name, Private IP, Popular Sites, Manual, File Import, Malformed URL, Whitelist Undefined, Undo, Unsupported Charset, Unsupported Transform reason reason reason reason reason Destination IP Address <destination IP address> dst_ip dst_ip dst_ip dst dst_ip Destination TLS True, False dst_tls dst_tls dst_tls dst_tls dst_tls Links Rewritten <number of rewritten links> rewritten_links rewritten_links rewritten_links rewritten_links N\/A N\/A N\/A time_processing time_processing time_processing time_processing N\/A Time Total(s) <total time taken from accepting email to handing email off to downstream, including wait for upstream\/downstream hand-off, processing, and misc communications time> e.g., 3.690 time_taken time_taken time_taken time_taken N\/A Time Source MTA Handoff (s) <time taken to receive mail from upstream mail server so processing can begin> e.g., 0.709 time_handoff_up time_handoff_up time_handoff_up time_handoff_up N\/A Transaction ID <uuid> message_tid message_tid message_tid message_tid N\/A N\/A N\/A region region region region region N\/A N\/A unix_time unix_time unix_time unix_time N\/A Size (bytes) <size in bytes> e.g., 31554 bytes bytes bytes bytes N\/A Date <local date and time> e.g., Dec-03-2019 02:10:11 PM unix_time_iso unix_time_iso unix_time_iso unix_time_iso N\/A Destination Port <destination port> e.g., 55716 dst_from_port dst_from_port dst_from_port dst_from_port N\/A Direction Transform, Restore, Both Directions mode mode mode mode mode Rewrite Success True, False, Null (if not relevant) rewrite_success rewrite_success rewrite_success rewrite_success rewrite_success Date <date and time> event_time event_time event_time devTime event_time Audit Logs UI Name UI Values JSON CEF KVP LEEF Insights Event Type Policy, Settings, Authentication event_type event_type event_type event_type event_type Admin ID <admin user ID> uid suid uid usrName uid Sub Event Type Exceptions, Login, None, Documents and Files sub_event_type sub_event sub_event_type sub_event sub_event_type Action Added, Modified, Deleted, Published, Login Success, Login Denied, Logout, Success, Rule Order Changed, Code Reset (through Email), Disabled, Initialized audit_actions audit_actions audit_actions audit_actions audit_actions N\/A <rev ID> rev_id policy_rev_id rev_id policy_rev_id rev_id Date <date and time> event_time event_time event_time devTime event_time N\/A N\/A additional_info additional_info additional_info additional_info additional_info Bandwidth Logs UI Name UI Values JSON CEF KVP LEEF Insights Browser Type <browser name and version> e.g., Chrome 77 browser_and_version browserAndVersion browser_and_version browser_and_version browser Categories Advertisements & Pop-ups, Anonymizers, Business, Computers & Technology, Download Sites, Education, Entertainment, Fashion & Beauty, Finance, General, Government, Hate & Intolerance, Health & Medicine, Image Sharing, Information Security, Instant Messaging, Job Search, News, Non-profits & NGOs, Parked Domains, Personal Sites, Politics, Religion, Restaurants & Dining, Search Engines & Portals, Shopping, Skipped Menlo Categories, Social Networking, Streaming Media & Downloads, Transportation, Travel, Unknown, Web-based Email categories categories categories categories category N\/A <frame domain> N\/A N\/A N\/A N\/A frame_domain N\/A <is an iframe> N\/A N\/A N\/A N\/A is_iframe N\/A <is on mobile> N\/A N\/A N\/A N\/A is_mobile N\/A <is a quota action> N\/A N\/A N\/A N\/A quota_action N\/A <is a quota event> N\/A N\/A N\/A N\/A quota_event N\/A <region> N\/A N\/A N\/A N\/A region N\/A <res domain> N\/A N\/A N\/A N\/A res_domain Source IP <source IP address> src_ip src_ip src_ip src src_ip N\/A <top domain> N\/A N\/A N\/A N\/A top_domain N\/A <user agent type> N\/A N\/A N\/A N\/A ua_type N\/A <user> N\/A N\/A N\/A N\/A user N\/A <user agent> N\/A N\/A N\/A N\/A user_agent N\/A <rule id> N\/A N\/A N\/A N\/A rule_id N\/A <rule name> N\/A N\/A N\/A N\/A rule_name " }, 
{ "title" : "Browsing Recorder ", 
"url" : "41882-logging/41962-browsing-recorder.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Logging \/ Browsing Recorder ", 
"snippet" : "Introduction The MSIP now captures browsing data that is accessible via the Dashboard and Reporting panes. The following data is captured for each page visited by the user (full navigation): HTML, JavaScript, CSS and XHR requests. This includes the URL, request and response headers, loading iframe U...", 
"body" : "Introduction The MSIP now captures browsing data that is accessible via the Dashboard and Reporting panes. The following data is captured for each page visited by the user (full navigation): HTML, JavaScript, CSS and XHR requests. This includes the URL, request and response headers, loading iframe URL and XHR request payload Keyboard\/Paste input on the page. This logs all keys pressed or other input methods up to 10k characters per page. The content of the input field after a key press (40 byte window around the cursor) is also captured. Input field contents during navigation. This takes up to 100 snapshots per page. Screenshots after each key press. Five (5) screenshots maximum are saved per minute. If there is a recent screenshot (within the past 1 second), the older screen is thrown out. Data is captured in the following formats: Network data: HAR format Screenshots: JPEG encryption. Files are named with the following convention: screenshot_timestamp_keycounter.jpg Input data: JSON list. Each entry includes the following: text, timestamp, type (keydown, paste, input), xpath, field_text (input trimmed to window of 40 bytes), offset, iframe_url, and input_counter. Final field input state: JSON dictionary. This is a nested dictionary; the first level is a unique ID + frame URL, and the second level key is the xpath. Setup Requirements To enable Browser Recorder functionality in MSIP, an S3 bucket must be provisioned to allow storage of user activity data. You must also create a user for accessing the bucket, and attach a policy to the user. Please note the following: After performing the steps to Create the Bucket and Create the User and Policy, the customer must provide Menlo Security with the Bucket Name , Bucket Path (folder name), and Access Key ID of the user so the feature can be provisioned. The S3 bucket must be provisioned and owned by the customer, as its data will be highly sensitive. When the user's access key is created, the customer must save the secret. This cannot be accessed later; if the original one is lost, another access kay may be created. The user should only be granted programmatic access to the bucket. Refer to the sections below for more details. Provisioning Example In the example below, we will create the following: An S3 bucket called \"menlodev-browsing-records-2\" A folder called \"records\" under which all browser recording folders and files will be stored Create the Bucket Sign into your AWS account. Go to S3. Click + Create Bucket at the top right. Name the bucket menlodev-browsing-records-2 and click Next . On the Properties page, use the default values and click Next . On the Public Access page, make sure everything is blocked (default value). If not, block and restrict all access settings by checking the checkboxes and setting the Manage system permissions to not grant group write access as shown below. Click Next to continue. Review your choices and click Create Bucket . Click on the new bucket that was just created. Click the + Create Folder button. Name the folder records and click Save . Create the User and Policy The following snippet shows an example of the policy that will be created next and attached to the user. This policy is very narrow and only allows writing to a specific path within the bucket. These are the only permissions needed, and the customer should not grant Menlo Security more permissions than shown below. { \"Version\": \"2012-10-17\", \"Statement\": [ { \"Sid\": \"\", \"Effect\": \"Allow\", \"Action\": [ \"s3:PutObject\", \"s3:PutObjectAcl\" ], \"Resource\": [ \"arn:aws:s3:::menlodev-browsing-records-2\/records\/*\" ] } ] } To create the policy: Click the Policies tab and create a new policy. Copy the json policy above Bucket Policy Editor JSON tab. Note that menldev-browsing-records-2 should match your bucket name and records should match your folder name . Click the Users tab and create a new user. Enter a unique user name ( br_upload_user in the example below) and set the AWS access type to Programmatic access only. Review the user settings and attach the upload-browsing-records policy to the user. On the Security Credentials tab, create the access key and record the Access Key ID so it can be provided to Menlo Security. File Storage Within the S3 path, files are stored in folders named with the user-id . Each capture has the following encoded within the filename, separated by underscores: Timestamp : Session timestamp Browser ID : Unique identifier for an isolated browser instance. Browser ID is consistent through the browsing session. A new browser ID is created for each new browser instantiation. Session ID : Unique identifier for the tab\/session Tab ID : Tab number within the current browser ID which data is being captured for Navigation Counter : Incrementing counter of page navigations within a tab URL : The address bar URL for the current page load The effective file structure is: $Bucket\/$Path\/user1@example.org\/ts_bid_sessionid_tab_counter_url.zip " }, 
{ "title" : "Operational Logs and Metrics ", 
"url" : "41882-logging/41963-operational-logs-and-metrics.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Logging \/ Operational Logs and Metrics ", 
"snippet" : "Operational Logs and Metrics Operational Monitoring takes the form of: SNMP traps for critical system events Operational Logs output via syslog in KVF (Key-Value), ArcSight CEF or LEEF format Metrics output in graphite plaintext format SNMP and REST Health monitoring APIs Operational Logs are output...", 
"body" : "Operational Logs and Metrics Operational Monitoring takes the form of: SNMP traps for critical system events Operational Logs output via syslog in KVF (Key-Value), ArcSight CEF or LEEF format Metrics output in graphite plaintext format SNMP and REST Health monitoring APIs Operational Logs are output to a remote syslog from the menlo components and several third party components. The log events are documented in an Events Guide. In addition to the operational logs, three broad groups of metrics are collected (application, process and machine). These metrics are processed by collectd and output using the graphite plaintext format over UDP via a separate operational metrics channel. This format can be easily parsed or input into a variety of analysis tools. The SNMP Traps are used for critical issues such as the system in a failed state. The operational log messages generally indicate errors and warnings for issues that can be resolved by the operations team. The logs will also contain some informational messages which can be used for data\/usage analysis. The metrics are designed to be useful for monitoring the overall state of the system and for trend analysis. An example set of use cases and best practices for monitoring the Menlo Security Isolation Platform is available at . SNMP Traps The following critical events will generate SNMP Traps: Safeview server is in failed state LDAP or auth server is not accessible Upstream proxy server is not accessible Safeview server booted up LDAP or auth server is available after an outage Upstream proxy server is available again after an outage Disk almost full FireEye appliance (if configured) is not accessible Central Manager is not accessible Number of Control Groups for container creation has exceeded a critical limit Destinations for SNMP Traps can be configured in the CMR Dashboard, along with the syslog output channels for the session logs, system logs and the operational logs, and the operational metrics channel. More information can be found about each of the SNMP Trap messages here: In addition to the sending of SNMP Traps, each machine in the deployment also provides the ability to be polled by an SNMP Management Station using UDP Port 161 to provide the standard machine-wide SNMP metrics for Memory, CPU and Disk utilization. Operational Logs Operational logs are output via an syslog channel specified in the CMR Dashboard (Logging\/Alerts tab) which can optionally be the same as the System and\/or Session syslog channel. The log output format matches the format produced by the System and Session syslog output and can be KVF, CEF or LEEF format. For Private Cloud users, logs are redirected to their log server. Cloud users will use the Logging API to export logs. An example of the key-value attributes being output in syslog format is below: level=\"info\" event_type=\"isolate-document\" service=\"safedocs.http\" device=\"msip\" time=\"2016-08-26T10:36:30.189Z\" user_id=\"anon_4luq2yaE\" tenant_id=\"4\" file_type=\"PDF\" doc_id=\"docc15xkI5K5d17827d-7f31-4387-85ca-b19538e25add\" target_url=\"https:\/\/www.example.com\/MyExampleFile.pdf\" Menlo Services will be producing operational logging messages. Each message will have a unique event identifier which will be documented in an Events Guide along with a \"reason\" behind why the event was produced, the cause of the event and an action that can be taken to further diagnose or fix the issue (if required). The action may be to \"Restart the instance\" or to \"Export diagnostics and contact Menlo Support\". Not all warnings and errors require action to be taken by the operations team. Informational messages will not include a cause or action. In addition, log file for various third party services that are useful for diagnosing issues and monitoring requests are pushed into the same operational logging channel. Logging levels are: Level Meaning CRITICAL Indicates that there is impact to multiple users of the system due to a failure in the system which needs to be resolved by the operations team. ERROR Indicates a failure to complete the current request due to a problem with the system which may need to be resolved by the operations team. WARNING Indicates that a userâ€™s request was able to be completed but some condition arose that has identified an issue with the system INFO Indicates some normal status that can later be used for data analysis In addition to the menlo platform events, some third party logs are redirected via the ops log output: Attribute Example Meaning time Timestamp Date and Time that the event occurred level ERROR Event level (CRITICAL, ERROR, WARN, or INFO) device msip Used to identify Menlo Security Platform messages hostname safeview1404 The machine hostname node_id c15xkI5K The Menlo node identifier service safeview.thin-client The Service producing the event event_type redis-error The event identifier user_id name@example.com The user identifier (if relevant) tenant_id 4 The tenant identifier (if relevant) browser_id 4CH-giWU The unique client browser identifier (if relevant) client_ip 1.2.3.4 The client browser machine's IP address Further attributes will be included in the message as appropriate for the particular event (examples include the user_agent, target_url, doc_id, etc.) Events are documented for each service as follows: Guide Description User session related events (e.g., page requests) output via the session syslog channel System audit events (e.g., administrative actions) output via the system syslog channel Document isolation service events Icap service events Policy server events Safeview director events Antivirus file server events Safeview common library events Live updates agent service events State store service events Surrogate manager service events Surrogate router service events System statistics service events Thin client service events Third party service logs that can be used for analysis of proxy (non-isolated) requests Third party logs from the process monitoring service that provide information about scheduled and unscheduled process restarts An example set of use cases for monitoring the Menlo Security Isolation Platform is available at . Sample log output can be found at . Note that during a service restart or reboot, many services will log and alert as they go down. These logs and alerts during a service restart should be ignored. Operational Metrics The Menlo Security Isolation Platform is able to produce a range of metrics in the form of counters\/rates, gauges and times in Milliseconds. Application, Process and Machine level metrics will be output via the graphite plaintext protocol over UDP (default and recommended) or TCP from collectd and statsd servers to the metrics output host and port (and optional metrics prefix string) configured in the Dashboard of each appliance. The safeview appliance template should include the metrics output host and port so that this configuration is pushed out to each appliance. The graphite plaintext protocol is three space-separated values per line of the form: <metric path> <metric value> <metric timestamp> Metrics are gathered and output once per minute. In a multi-tenant environment, tenant-specific metrics will also be available. The metric name will include the tenant identifer when the metric is related to a user's request. The tenant-specific metric will be output in addition to the global metric. There are three types of metrics being output: Application metrics. These are specific to the application (for example, Surrogate Browser Utilization). Process metrics. These are specific to the processes (for example, the CPU Utilization of the HAProxy process). Machine metrics. These are specific to the machine (for example the Memory or Disk Utilization). See for more information about setting up a Metrics Monitoring system (Graphite and Grafana). Application Metrics Application level metrics are metrics produced by the Menlo Security Isolation Platform itself (for example, Document Isolation queue size, Surrogate Browser utilization, Download File Types passing through the platform, etc.). These metrics are output in graphite plaintext format: <metric path> <metric value> <metric timestamp> Where \"metric path\" is of the form: <machine>.statsd.<type>-<metric name> For example: safeview1404.statsd.derive-safedocs_http_document_PDF safeview1404.statsd.derive-safedocs_http_resp_code_GET_500 A sample Grafana graph for Document Isolation Service is shown below highlighting document isolation service response codes, request latency, queue size, downloads and document request types using the metrics provided by the document isolation service: Graph showing document isolation service response codes, request latency, queue size, downloads and document request types Process Metrics Collectd is used to monitor processes at a process level reporting on process\/thread count, user and system cpu time, page faults, resident segment size, stacksize and io data. Process metrics are output in graphite plaintext format along with the application and machine metrics. The format of the metric path for process metrics is as follows: <machine>.processes-<name>.<metric> For example: safeview1404.processes-auth-server.ps_cputime.user safeview1404.processes-safeview.ps_count.threads The following menlo and third party processes are monitored, with others monitored at an aggregate level: processes-auth-server processes-client-logger processes-cookie-server processes-dashboard processes-director processes-doc_converter processes-druid processes-event-consumer processes-file-server processes-haproxy processes-kafka processes-mysql processes-nginx processes-node-agent processes-pnr-enforcement processes-pnr-icap processes-pnr-icap-auth processes-pnr-uce processes-rds processes-redis-server processes-rewriter processes-safedocs processes-safeview processes-squid processes-surrogate-manager processes-surrogate-router processes-td-agent processes-vt-service processes-zookeeper A sample Grafana graph is shown below which was generated using the above metrics to show the breakdown of SafeView, SafeDoc and PnR processes CPU time and a count of the safeview surrogate processes and threads. Graph showing safeview, safedocs and PnR processes CPU time along with ta process and thread count of surrogates Machine Metrics Collectd is used to collect machine level metrics which are output in graphite plaintext format using the metric path format: <hostname>.<metric-class>.<metric> For example: safeview1404.aggregation-cpu-average.percent-user safeview1404.load.load.shortterm Category Metric Class Description CPU aggregation-cpu-average aggregation-cpu-sum Idle, interrupt, nice, softirq, steam, system, user and wait metrics for each machines CPU as percentages Disk Space df-dev, df-menlo-boot, df-menlo_data, df-menlo-download... Free, reserved and used disk space for each disk partition Disk I\/O disk-sda, disk-sda1, disk-sda2, disk-sda3, disk-sda4... Disk I\/O merged, octects, ops and time for each physical disk DNS dns DNS queries, query types and error metrics Interface interface-eth0 Errors, Octets and Packets for each of the network interfaces System Load load Short, midterm and longterm system load metrics Memory Usage memory Buffered, cached, free and used memory metrics Summary Processes processes Summary process metrics for the machine, fork rate, blocked, paging, running, sleeping, stopped, zombies Swap I\/O swap Cached, Free, I\/O in, I\/O out, Used Swap metrics Uptime uptime Machine up time Zookeeper zookeeper (CMR only) Information about the zookeeper processes The following sample Grafana graphs plot system wide metrics showing disk, process, load, memory and network utilization: Server Load Disk Processes Network Utilization Sample Grafana dashboards to monitor the machine, process and application metrics are available below. These can be imported into a grafana+graphite+carbon deployment to render the metrics being produced by the Menlo Security Isolation Platform onto several dashboards: These sample monitoring dashbaords assume metrics are being sent to grafana with the prefix: \"msip.\" They cover the majority of the metrics being produced by the Menlo Security Isolation Platform and can be used to identify issues and problems, monitor the current state of the system and obtain statistics about how the platform is being used and how it is performing. These are examples and can be used as a starting point to develop more details dashboards to suit an individual deployment's monitoring requirements. SNMP and REST Health Monitoring APIs In addition to the logging and metrics output, the Menlo Security Isolation Platform provides SNMP Polling and some REST Health Monitoring APIs. Each machine in the deployment acts as a standard SNMP source and can be polled by an SNMP Management Station via UDP Port 161. This SNMP Agent provides machine level information using the standard SNMP MIBs for: System MIB (.1.3.6.1.2.1.1) Host Resources MIB (.1.3.6.1.2.1.25) UC Davis MIB (.1.3.6.1.4.1.2021) These MIBs allow monitoring of the Menlo Security Isolation Platform via standard SNMP Management Station polling. They provide system-wide information about Memory, CPU and Disk usage. In addition to the SNMP polling, the following REST Health Monitor APIs are available which can be periodically polled using http in order to monitor the overall health of the system. System Ping Check GET https:\/\/<host>:8443\/api\/v1\/ping\/ Basic ping check that does not require authentication Determines if the Dashboard UI is accessible Responds with HTTP 200 status Applicable to all hosts SSL Certificates must be installed when making the request (or the check skipped on the client) Example: wget -S -q --delete-after https:\/\/<host>:8443\/api\/v1\/ping --no-check-certificate 2>&1 | awk '\/^ HTTP\/{print $2}' This will return 200 if the machine is available and the dashboard is accessible, otherwise if there is no response or the status code returned is not 200, there is a problem with the machine. System Health Check GET https:\/\/<host>:8443\/api\/v1\/status?limit=1 Used to get an overall status check and determine why a particular node is reporting \"Red\" status in the dashboard Should return a HTTP 200 status and a JSON document giving the overall system state No response or any HTTP status other than 200 indicates a service failure (which may be temporary, such as a service restart in progress) In the JSON response, along with statistics on the disk, memory, cpu, swap, utilization and list of failing services, check the following: diagnostics_failed: true or false - if true, a service is down. Check the services section in the JSON or for more details examine the operations log to find out more details if required. In particular, look for repeated messages from service=\"monit\" with the reason=\"process is not running\" indicating that the system is attempting to restart the given service in the event_type attribute, but is unable to do so. These can happen during normal operation from time to time for example during service restarts, upgrades and configuration changes, but if the status API is reporting an issue and a message indicating that a process is not running is repeated in the operations log, this indicates that the system is in a failed state and should be restarted. maintenance_mode: true or false - whether the service is in maintenance mode reboot_time: time since last reboot version: current full version of the isolation platform Applicable to all host(s) SSL Certificates must be installed when making the request (or the check skipped on the client) Requires authentication to access the API. Login via a POST to \/api\/v1\/login and retrieve the cookies to pass in the request. Example: wget -q --save-cookies cookies.txt --post-data '{\"username\": \"admin\", \"password\": \"<password>\"}' --header \"Accept: application\/json\" --header=\"Content-type: application\/json\" --keep-session-cookies --delete-after https:\/\/<host>:8443\/api\/v1\/login --no-check-certificate wget -qO- --load-cookies cookies.txt https:\/\/<host>:8443\/api\/v1\/status?limit=1 --no-check-certificate The above will log in to the dashboard using an administrator username and password, obtain the cookies and use them to request the current machines' status returning a JSON document to stdout. An example of the response is below: \"disk_stats\": { \"disk_menlo_data\": { \"usage\": 68.0, \"total\": 73848360960, \"used\": 50187235328, \"free\": 19886256128 }, \"disk_menlo_boot\": { \"usage\": 2.3, \"total\": 296231936, \"used\": 6766592, \"free\": 269543424 }, \"disk_var_log\": { \"usage\": 0.3, \"total\": 10434695168, \"used\": 29782016, \"free\": 9851269120 }, \"disk_menlo_download\": { \"usage\": 0.2, \"total\": 10434695168, \"used\": 23580672, \"free\": 9857470464 }, \"disk_mnt_coredump\": { \"usage\": 0.1, \"total\": 991092736, \"used\": 1273856, \"free\": 921841664 }, \"disk_root\": { \"usage\": 10.1, \"total\": 79132893184, \"used\": 7988596736, \"free\": 67713138688 } }, \"reset_time\": 930.8538100719452, \"maintenance_mode\": false, \"reboot_time\": 1474.17, \"num_urls_visited\": 0, \"threshold\": 80, \"services\": [{ \"diagnostics_failed\": true, \"name\": \"LdapServer\" }], \"disk\": 10.1, \"diagnostics_failed\": true, \"utilization\": 0, \"version\": \"2.44.0-1.2874.0\", \"swap\": 0.0, \"memory\": 22.9, \"cpu\": 2.8 Isolation Platform Accessible GET https:\/\/<safeview host>\/ Determines if the isolation platform service is accessible Responds with HTTP 200 status Applicable to all safeview (isolation) master hosts only (not available on the CMR or worker nodes) SSL Certificates must be installed when making the request (or skipped on the client) Proxy Port Accessible GET https:\/\/<proxy host>:3129\/ Determines if the Proxy responding to proxy requests A plain GET over http to port 3129 will return HTTP status 400 - this is normal. Applicable to the proxy server host(s) only PAC requests from CMR https:\/\/<CMR host>\/\\<customer pac url\\> Determines if PACs are being served to client browsers Applicable to the CMR host(s) only Document Isolation Service Health GET https:\/\/<safeview host>\/docview\/health Determines if the Document Isolation Service is accessible Responds with HTTP 200 status if document isolation is working fine, 500 if there is a problem Applicable to all safeview (isolation) hosts The JSON response includes additional information and can be used to highlight issues if there is a problem: docConv - true if document converter is working, false if disabled or broken queue - true if the queue of documents to be processed is \"normal\", false if this is very high or blocked (suggesting very heavy system load or a failure to read documents from the queue) disk - true if the disk space on the document isolation machine is within normal limits, false otherwise. memory - true if the memory available on the machine is within normal limits, false otherwise. currentDiskAvail - percentage free disk space on document isolation machine at current time minDiskAvail - minimum percentage free disk space seen since last process restart minDiskAvailTime - time in milliseconds since the minimum percentage free disk space was seen currentMemoryAvail - percentage free memory on document isolation machine at current time minMemoryAvail - minimum percentage free memory seen since last process restart minMemoryAvailTime - time in milliseconds since the minimum percentage free memory was seen currentQueueSize - the size of the queue of documents waiting to be converted at the current time (this should be close to zero) maxQueueSize - maximum size of the queue that has been seen since last process restart maxQueueSizeTime - time in milliseconds since the maximum queue size was seen currentConversions - the number of document conversions happening at the current time maxConversions - the peak number of document conversions happening at the same time maxConversionsTime - the time in milliseconds since the peak number of document conversions was seen lastRedisErrorTime - time in milliseconds since redis last reported an error currentTime - the current timestamp in milliseconds since unix epoch " }, 
{ "title" : "Release Notes ", 
"url" : "41884-release-notes.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Release Notes ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Web Isolation Release Notes ", 
"url" : "41884-release-notes/41964-web-isolation-release-notes.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Release Notes \/ Web Isolation Release Notes ", 
"snippet" : "Public Cloud (SaaS) Web Isolation IMPORTANT: Menlo Security continues to deploy new proxies across all regions. As proxies are added, additional IP addresses for accessing the Menlo Security platform are published. Please ensure outbound traffic can access the complete list of IP Addresses provided ...", 
"body" : "Public Cloud (SaaS) Web Isolation IMPORTANT: Menlo Security continues to deploy new proxies across all regions. As proxies are added, additional IP addresses for accessing the Menlo Security platform are published. Please ensure outbound traffic can access the complete list of IP Addresses provided in . Release Date: November 17, 2021 (Web Isolation: 2.82.0) Announcement An Admin Portal alert window will be presented to administrators using Internet Explorer that states we will discontinue support for IE with release 2.83. After version 2.83, we will continue to encourage users to move to supported browsers such as Chrome, FireFox, Safari and Edge. We will allow users to access the Admin Portal at their own risk. New Features SaaS Tenant Restriction Headers - (New Admin Portal) Added the ability to create header restriction exceptions that can be used to manage access to SaaS applications like Office 365 and G Suite. See for more information. Improvements Improvements to features will be switched on or enabled by default, unless otherwise specified. Web Isolation By default all new tenants have the feature to not use the proxy exception list enabled. This feature is now supported by all proxy modes. The user-defined rule name for File Upload exceptions is now displayed in the web logs. Web applications policy can now use the same policy defined in the web policy for categories, threats and exceptions. User group information is now logged for policy matches. Modal dialogs for browser alerts, prompts, and confirmations will now only show the page hostname. Document and File Isolation Added support for .docx file downloads in IE11. Inline CASB Applications Added to show the supported features for some commonly used applications. Refer to for previous release details. * To request to have this feature enabled, log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . † This is a licensed feature â€“ contact the Menlo Security Sales Team to find out more. Private Cloud (On-Prem virtual appliance) Web Isolation Release Date: November 2021 (Web Isolation: 2.81.1) New Features All the new features will be switched on by default, unless otherwise specified. X-Header Policy Tags - X-Msip-Policy headers can be ingested from an upstream proxy and used within Menlo policy. Improvements to Existing Features All the improved features will be switched on by default, unless otherwise specified. Latest updates to the Chromium browser engine and security updates Web Isolation Improved description of failure reasons when resetting MFA on admin logins. Added support for the WebGL (Web Graphics Library) used by some web pages for interactive graphics (e.g., embedded maps). Added audit logging for commands executed from the CLI and settings changes made through the UI on the Settings , Management , Authentication , Customization , and System Update panes. Added a configurable option to display an isolation banner on pages. The DSA SSH key is now disabled since the short bit length (1024) is considered vulnerable. Added the ability to filter web logs in the UI by appliance hostname. Document\/File Isolation Added the ability to configure upload file size limits in the Web Settings pane. An error message is now displayed if a user enters an incorrect password in password-protected isolated documents or files. Known Issues Central upgrade supports appliance version 2.56.4 and newer. Older appliances can be upgraded via \"System Update\" in the appliance dashboard UI. Refer to for previous release details. * To request to have this feature enabled, log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . † This is a licensed feature â€“ contact the Menlo Security Sales Team to find out more. " }, 
{ "title" : "Email Isolation Release Notes ", 
"url" : "41884-release-notes/41965-email-isolation-release-notes.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Release Notes \/ Email Isolation Release Notes ", 
"snippet" : "Public Cloud (SaaS) Email Isolation Release Date: November 17, 2021 (Web Isolation: 2.82.0) Improvements to Existing Features All the improved features will be switched on by default, unless otherwise specified. Latest updates to the Chromium browser engine and security updates Refer to for previous...", 
"body" : "Public Cloud (SaaS) Email Isolation Release Date: November 17, 2021 (Web Isolation: 2.82.0) Improvements to Existing Features All the improved features will be switched on by default, unless otherwise specified. Latest updates to the Chromium browser engine and security updates Refer to for previous release details. * To request to have this feature enabled, log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . † This is a licensable feature; please contact the Menlo Security Sales Team to find out more. Private Cloud (On-Prem virtual appliance) Email Isolation Release Date: November 2021 (2.81.1) Improvements to Existing Features Latest updates to the Chromium browser engine and security updates Performance and other quality improvements Added on-prem support for mobile email isolation. This will be on by default for new installations; upgrades will maintain the previous behavior (mobile email off). Refer to for previous release details. * To request to have this feature enabled, log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . † This is a licensable feature; please contact the Menlo Security Sales Team to find out more. " }, 
{ "title" : "Client Certificates ", 
"url" : "41886-client-certificates.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Client Certificates ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "SSL Termination Setup: Load CA Certificate ", 
"url" : "41886-client-certificates/41966-ssl-termination-setup--load-ca-certificate.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Client Certificates \/ SSL Termination Setup: Load CA Certificate ", 
"snippet" : "SSL Termination Setup: Load CA Certificate This page describes how to add a CA certificate to a single Windows client for testing purposes. For production deployments, adding the certificates via Active Directory is recommended. Click the Certificate icon or link to download. Go to the Certificate P...", 
"body" : "SSL Termination Setup: Load CA Certificate This page describes how to add a CA certificate to a single Windows client for testing purposes. For production deployments, adding the certificates via Active Directory is recommended. Click the Certificate icon or link to download. Go to the Certificate Page and save the latest certificate file (and note location). In Internet Explorer, click the gear icon at the top right corner and navigate to Internet Options . Click the Content tab. Click the Certificates button. Internet Options - Content Click the Trusted Root Certificate Authorities tab. Click the Import... button. Trusted Root Certificate Authorities Click the Browse... button and select the Menlo CA file to import. Click Next to proceed. File to Import Select the default certificate destination Trusted Root Certification Authorities . Click Next to proceed. Certificate Store Verify the certificate information. This should match the values on the page for the certificate you downloaded previously from the Certificate Page . Click Yes to install the certificate. " }, 
{ "title" : "SSL Termination Setup: Load CA Certificate macOS ", 
"url" : "41886-client-certificates/41967-ssl-termination-setup--load-ca-certificate-macos.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Client Certificates \/ SSL Termination Setup: Load CA Certificate macOS ", 
"snippet" : "SSL Termination Setup: Load CA Certificate macOS This page describes how to add a CA certificate to a single macOS client. Click the Certificate icon or link to download the file. Go to the Certificate Page and save the latest certificate file (and note location). Open the Keychain Access applicatio...", 
"body" : "SSL Termination Setup: Load CA Certificate macOS This page describes how to add a CA certificate to a single macOS client. Click the Certificate icon or link to download the file. Go to the Certificate Page and save the latest certificate file (and note location). Open the Keychain Access application ( Finder -> Go menu -> Utilities ). Keychain Access In the menu bar for the Keychain Access application, select File -> Import Items . Navigate to the location where the file was downloaded, and select it. Make sure to select System in the Destination Keychain setting, and then click Open . Certificate Import An authenticated administrator must approve the change. In the search box, enter menlo to search for the certificate that was just installed. Double click the Menlo Security Root certificate to display the detailed view. Keychain Properties Expand the Trust section, and select Always Trust for Secure Sockets Layer (SSL) and for X.509 Basic Policy . Certificate Trust Verify the certificate information. This should match the values on the page for the certificate downloaded previously from the Certificate Page . Click the red button to close the detailed view of the certificate. An authenticated administrator must approve the change. " }, 
{ "title" : "Menlo Connect Client ", 
"url" : "41888-menlo-connect-client.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Menlo Connect Client for Windows ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows ", 
"snippet" : "This guide is divided into the following sections:...", 
"body" : "This guide is divided into the following sections: " }, 
{ "title" : "How Menlo Connect Works ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41969-how-menlo-connect-works.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ How Menlo Connect Works ", 
"snippet" : "How Menlo Connect Works Menlo Connect runs as a service on a user's laptop or other endpoint machine to manage their system proxy settings and address situations with connectivity limits, such as guest Wi-Fi captive portals. Unauthorized users are prevented from stopping or disabling Menlo Connect. ...", 
"body" : "How Menlo Connect Works Menlo Connect runs as a service on a user's laptop or other endpoint machine to manage their system proxy settings and address situations with connectivity limits, such as guest Wi-Fi captive portals. Unauthorized users are prevented from stopping or disabling Menlo Connect. Menlo Connect can detect when users try to connect to networks where a captive portal requires them to pay or accept a use policy before accessing the internet (for example, Wi-Fi networks at airports or hotels). When it detects a captive portal, it will temporarily remove the configured Menlo PAC file settings, allowing users to complete the steps necessary to access the network, before automatically re-enabling itself. Menlo Connect enforces the use of the Menlo PAC file, ensuring that your organization's security and access policies are applied wherever they might be accessing the internet. Menlo Connect also has built-in location awareness for customers who require a hybrid configuration. In environments where devices on the corporate network connect to a secure web gateway\/proxy when accessing the internet but go directly to the Menlo Security Isolation Platform when roaming outside the corporate network, the on-net feature will determine the location of the user's device, which can be either \"on-network\" or \"off-network\"; it then enforces the appropriate proxy settings based on location. Menlo Connect now has uninstall protection that prevents unauthorized users from removing the agent by requiring a password to be entered first. " }, 
{ "title" : "Menlo Connect for Windows Release Notes ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41979-menlo-connect-for-windows-release-notes.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Menlo Connect for Windows Release Notes ", 
"snippet" : "Release Date: March 2021 (2.2) Changes: Menlo Connect Tamper-Proof Enhancement â€“ Tamper-proof protection for the Windows endpoint added. The Menlo Connect agent now runs as a service preventing unauthorized users from stopping or disabling the agent. This also adds uninstall protection that preven...", 
"body" : "Release Date: March 2021 (2.2) Changes: Menlo Connect Tamper-Proof Enhancement â€“ Tamper-proof protection for the Windows endpoint added. The Menlo Connect agent now runs as a service preventing unauthorized users from stopping or disabling the agent. This also adds uninstall protection that prevents unauthorized users from removing the Menlo Connect agent by requiring a password. Download new versions of the installer at the Customer Success Knowledge Portal article: Menlo Connect . Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. Release Date: March 2021 (2.2)Release Date: November 2020 (2.1.1.3) Changes: Support added for Proxy type value 3: Static proxy Server with ProxyBypass (requires ProxyServer and optionally ProxyBypass settings including IE11) (3). This change adds support for accessing sites on the proxy bypass list when using IE11. Update the registry file with the new value, and restart the Menlo Connect Client to enable this change. See for details. Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. Release Date: September 2020 (2.1.1.3) Changes: Fresh installations of the Menlo Connect Client (manual install using the msi and not via a group policy or command line) will now have the \"Suspend\" and \"Deactive\" options enabled by default. After installation is complete, these options are available from the MCC icon right-click menu. See and for details. Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. Release Date: August 2020 (2.1.1) Changes: If a user attempts to change\/disable the system proxy settings it will revert to the configured on-net proxy (settings can no longer be changed if on-net mode is enabled and they are connected to the corporate network). Menlo Connect automatically starts upon successful completion of silent install (previously if the \/PASSIVE or \/QUIET switches were used on MSIEXEC there was no automatic restart). Menlo Connect now always uses the configured system proxy as the 'On-Net' proxy setting (no longer maintaining a separate registry value) when connected to the corporate network. Menlo Connect now supports 'Local Machine' (all users) installation in addition to the previous 'Current User' install. See and for details. For 'Local Machine' installations, Menlo Connect reads Windows registry settings values from HKEY_LOCAL_MACHINESOFTWAREWOW6432NodeMenloMenlo ConnectSettings in addition to HKEY_CURRENT_USERSoftwareMenloMenlo-ConnectSettings. Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. Release Date: June 2020 (2.1.0.10) Changes: Static proxy and Automatic configuration using the PAC file can now be enabled from the registry Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. Release Date: February 2020 (2.1.0.9) Changes: Initial release of Menlo Connect Client for Windows 7, 8.1 and 10 Known Issues: Cannot use Bypass list for static proxy static mode (2) with the on-net feature when attempting to enter a non-valid character (e.g., \"\/\"). The recommended workaround is to use Auto configuration using PAC file mode (4) ; this allows domain and IP exceptions to be configured in the PAC file itself. " }, 
{ "title" : "Menlo Connect for Windows Prerequisites and Settings ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41971-menlo-connect-for-windows-prerequisites-and-settings.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Menlo Connect for Windows Prerequisites and Settings ", 
"snippet" : "Installation Prerequisites Each user must have a valid account on the Menlo Security Isolation Platform associated with your tenant and be able to authenticate with the service. Menlo Connect supports the following Operating Systems: Windows 7 (32 and 64-bit) Windows 8.1 (32 and 64-bit) Windows 10 (...", 
"body" : "Installation Prerequisites Each user must have a valid account on the Menlo Security Isolation Platform associated with your tenant and be able to authenticate with the service. Menlo Connect supports the following Operating Systems: Windows 7 (32 and 64-bit) Windows 8.1 (32 and 64-bit) Windows 10 (32 and 64-bit) There are no specific hardware requirements for Menlo Connect. Menlo Connect is distributed as an MSI install package. Download the latest version of the Menlo Connect installer for Windows from the CS portal Menlo Connect page . Ways to install Menlo Connect: Manual Install : On the Windows endpoint double-click on Menlo.Connect.Setup.<version>.msi (e.g., Menlo.Connect.Setup.2.2.0.4.msi ). See for details. Command Line : On the Windows endpoint open a command prompt and use the msiexec command to install Menlo Connect. As with the manual install option, if the PAC file URL is not supplied as an argument in the command line entry or is not present in the registry, the user will be prompted to enter it. It is recommended that you also install Menlo Connect with the tamper protection feature and supply your raw password as an argument in the command line entry. The Menlo Connect installer will generate a password hash and store this in the Windows Registry. See for details. Deploy through an Active Directory group policy : Menlo Connect can also be deployed across multiple Windows endpoints through an Active Directory group policy. Detailed instructions for deploying the agent via GPO are provided in . The PAC URL is saved in the following Windows Registry location: HKEY_LOCAL_MACHINE\\Software\\WOW6432\\Menlo\\Menlo Connect\\Settings\\PAC\\PacFileUrl Settings (All Users Installation) Menlo Connect reads settings values from the following sources, in order of precedence: Windows Registry : Located at HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings and HKEY_CURRENT_USER\\Software\\Menlo\\Menlo Connect\\Settings . Administrators can control Menlo Connect behavior remotely. Config.bin file : If any setting is missing from the Windows Registry, Menlo Connect falls back to this file. Default values : If the config.bin is missing any required setting, the default values are used. Required settings without a default value will cause a runtime exception and Menlo Connect exits with an error message. Settings are located in HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings so administrators can configure settings in a single location, and this also prevents non-admin users from modifying application settings. This table describes all available settings. Note that changing some of these settings will require the Menlo Connect process to be restarted. Group Parameter Description Example Default Value Registry Value Requires Restart Pac PacFileUrl URL for PAC file location https:\/\/pac.menlosecurity.com\/...\/wpad.dat None PacFileUrl=https:\/\/pac.menlosecurity.com\/....\/wpad.dat Yes Pac PacParserRegex Expression that parses the PAC file and retrieves the proxy list (dns:port) that must be enclosed in capturing group PacParserRegex=PROXYs+([a-zA-Z0-9-]+.menlosecurity.com:[0-9]+) See example; this does not need to be modified PacParserRegex=PROXYs+([a-zA-Z0-9-]+.menlosecurity.com:[0-9]+) Yes Pac PollingInterval Polling interval in seconds used to check for connectivity to Menlo Proxy servers 10 60 PollingInterval=dword:0000000a Yes DisableMode PasswordHash SHA256 hash of password that allows user to deactivate Menlo Connect 7208f7.... None PasswordHash=hex:72,08 No DisableMode Enabled Is Disable mode enabled? Yes No Enabled=dword:00000000 No DisableMode NeedPwd Is Password required to disable Menlo Connect? No No NeedPwd=dword:00000000 No DisableMode Duration Allowed disable limit in hours 18 24 Duration=dword:00000018 No SuspendMode PasswordHash SHA256 hash of password that allows user to suspend Menlo Connect 7208f7.... None PasswordHash=hex:72,08 No SuspendMode Duration Allowed suspension limit in minutes 15 15 Duration=dword:0000000f No SuspendMode Enabled Is Suspend mode enabled? Yes No Enabled=dword:00000001 No SuspendMode NeedPwd Is Password required to suspend Menlo Connect? No No NeedPwd=dword:00000000 No Logs RetentionHours Logs of this age in hours are deleted from the logs folder 24 24 RetentionHours=dword:00000018 Yes Logs Encrypt Encrypt log files? No No Enabled=dword:00000000 Yes Diagnostics PrivateIpEndpoint Private IP endpoint returned for diagnostics safe.menlosecurity.com safe.menlosecurity.com PrivateIpEndpoint=safe.menlosecurity.com No Diagnostics PublicIpEndpoint Public IP endpoint returned in plain text for diagnostics api.ipify.org api.ipify.org PublicIpEndpoint=api.ipify.org No General MuteNotification Allowed to mute all notifications? Yes No MuteNotification=dword:00000000 Yes OnNet Enabled Enables on\/off net feature. Capture of existing system proxy settings (learning mode) works regardless of this setting. Yes No Enabled=dword:00000001 Yes OnNet EnforceProxy Should proxy settings be applied immediately when switching network modes (if disabled, current state of Menlo Connect is preserved). Yes No EnforceProxy=dword:00000001 Yes OnNet Rules Defines rules to identify the corporate network (currently only DNS lookup). Rule format is the following with no white spaces: DNS{<domain>=<IPv4>} where domain is the known domain address inside the corporate network and IPv4 is the address to which the domain resolves DNS{menlo.corp.net=127.0.0.1} None Rules=DNS{menlo.corp.net=127.0.0.1} Yes OnNet AutodiscoveryFlags Retrieves automatic discovery settings dword:00000000 OnNet AutoconfigSecondaryUrl Chained autoconfig URL (used when primary URL points to a file that sets a second autoconfig URL for proxy information) OnNet AutoconfigReloadDelay Number of minutes until automatic refresh of autoconfig URL by autodiscovery dword:00000000 Proxy ProxyMode Proxy type. Allowed values: 1 - Direct Connection (no proxy). 2 - Static proxy server (requires ProxyServer and optionally ProxyBypass settings). 3 - Static proxy server with ProxyBypass (requires ProxyServer and optionally ProxyBypass settings including IE11). 4 - Auto configuration using PAC file (assumes AutoconfigUrl setting is provided). 1 None ProxyMode=dword:00000001 Yes Proxy ProxyServer Static proxy server address in format: <proxy>:<port> some.static.proxy:1234 None ProxyServer=some.static.proxy:1234 Yes Proxy ProxyBypass Bypass list for static proxy mode (2). Addresses are separated with comma\/semicolon. This works with the ProxyServer setting. localhost; some.other.host None ProxyBypass=localhost;some.other.host Yes Proxy AutoconfigUrl URL to PAC file. Used in Auto configuration using PAC file mode (4). https:\/\/pac.menlosecurity.com\/...\/wpad.dat None AutoconfigUrl=https:\/\/pac.menlosecurity.com\/....\/wpad.dat Yes MenloConnect TamperProtection PasswordHash Uninstall Password Hash; generated during installation 4a ea 72 10... None PasswordHash=hex:4a,ea No Example Registry File (All Users Installation) The following is an example of a Windows Registry file from Windows Registry Editor version 5.00 where the agent is installed for all users with on-net ProxyMode=4. You can copy the following example and modify it as needed to save a .reg file. This file can be used to automatically add the corresponding registry subkeys and values on the Windows endpoint that you are installing the Menlo Connect agent on. [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings] [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\Diagnostics] [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\DisableMode] [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\Logs] [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\OnNet] \"Enabled\"=dword:00000001 \"EnforceProxy\"=dword:00000001 \"Rules\"=\"DNS{localhost=127.0.0.1}\" \"ProxyMode\"=dword:00000004 \"ProxyServer\"=\"10.10.10.10:80\" \"ProxyBypass\"=\"<local>\" \"AutoconfigUrl\"=\"https:\/\/pac.menlosecurity.com\/menlosecurity-af324847e6\/wpad.dat\" \"AutodiscoveryFlags\"=dword:00000000 \"AutoconfigSecondaryUrl\"=\"\" \"AutoconfigReloadDelay\"=dword:00000000 [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\PAC] \"PacFileUrl\"=\"https:\/\/pac.menlosecurity.com\/menlosecurity-af324847e6\/wpad.dat\" [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\SuspendMode] Example Registry File to Remove Suspend\/Disable Menlo Connect Option To completely remove the option for users to suspend or disable Menlo Connect by right-clicking the Menlo Connect icon in the system tray, administrators can update the .reg file using the following example. Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Menlo\\Menlo Connect] Â [HKEY_LOCAL_MACHINESOFTWAREWOW6432NodeMenloMenlo ConnectSettingsSuspendMode] \"Enabled\"=dword:00000000 [HKEY_LOCAL_MACHINESOFTWAREWOW6432NodeMenloMenlo ConnectSettingsDisableMode] \"Enabled\"=dword:00000000 " }, 
{ "title" : "Set Up Menlo Connect Client Using Group Policy Objects (GPOs) ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41980-set-up-menlo-connect-client-using-group-policy-objects--gpos-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Set Up Menlo Connect Client Using Group Policy Objects (GPOs) ", 
"snippet" : "Introduction This section describes how to install Menlo Connect using a Group Policy. This is the most common installation type. If you wish to manually run the Menlo Connect installer on a single computer, see the section . Prerequisites Windows Server 2016 with Active Directory Domain and Service...", 
"body" : "Introduction This section describes how to install Menlo Connect using a Group Policy. This is the most common installation type. If you wish to manually run the Menlo Connect installer on a single computer, see the section . Prerequisites Windows Server 2016 with Active Directory Domain and Services role Windows 7 (32 or 64 bit), Windows 8.1 (64 bit), or Windows 10 (32 or 64 bit) You may be able to install the client using earlier versions of Windows Server, but they are not officially supported. Deploy Menlo Connect Open the Group Policy Management console using Server Manager. Expand the Domain object ( menlo.net in the example). Right-click the Default Domain Policy and select Edit... to deploy Menlo Connect. Select New -> Package... to add the Menlo Connect .msi: Select the Menlo.Connect.Setup.<version>.msi file and press Open . Select the Deployment Method: Assigned and press OK . Right-click the Menlo Connect software installation and select Properties . In the Deployment tab under Deployment Options select Install this application at logon and press OK . You can push Menlo Connect registry settings to Windows endpoints by either using a remote registry browser integrated into the Group Policy Preferences (GPP) console or manually by specifying a path to the registry key, parameter name and value. You can configure (create\/edit\/delete) any registry parameter or key using the group policy extension Group Policy Preferences (GPP). Then deploy this setting to all domain computers. Go to Windows Settings -> Registry and set the PAC URL using the following values: Name : PacFileUrl Order : 1 Action : Create Hive : HKEY_LOCAL_MACHINE Key : Software\\WOW6432Node\\Menlo\\Menlo Connect\\Settings\\PAC Value Name : PacFileUrl Type : REG_SZ Value data : <Your PAC URL here, e.g. https:\/\/pac.menlosecurity.com\/example101\/wpad.dat > Test the group policy: Log in to a Windows machine that is joined to the Active Directory domain that the GPO policy is applied to ( menlo.net in the example). Confirm the Menlo Connect application is installed, the correct PAC URL is configured in the browser settings, and the application is working as configured. Menlo Connect appears as in icon in the task bar as shown below. " }, 
{ "title" : "Set Up Menlo Connect Client for Windows Using Installer (Single Machine) ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41985-set-up-menlo-connect-client-for-windows-using-installer--single-machine-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Set Up Menlo Connect Client for Windows Using Installer (Single Machine) ", 
"snippet" : "Set Up Menlo Connect Client Using Installer (Single Machine) This section describes how to install Menlo Connect on a single machine using the .msi installer package. If you wish to install Menlo Connect via a group policy, see the section . Obtain your PAC URL. If there is no entry in the Windows R...", 
"body" : "Set Up Menlo Connect Client Using Installer (Single Machine) This section describes how to install Menlo Connect on a single machine using the .msi installer package. If you wish to install Menlo Connect via a group policy, see the section . Obtain your PAC URL. If there is no entry in the Windows Registry, you will have to enter the URL during installation. This may already be present in the Windows Registry at the following location: Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\Connections\\DefaultConnectionSettings Double-click Menlo.Connect.Setup.<version>.msi to start the Menlo Connect installer. Follow the steps and advance through the screens. The application and registry values are stored in the following locations: MCC: C:\\Program Files (x86)\\Menlo\\Menlo Connect Service Log files: C:\\Program Files (x86)\\Menlo\\Menlo Connect\\Logs UI Log per User: C:\\Users\\{user}\\AppData\\Local\\Menlo\\Menlo Connect\\Logs Registry (1 of 2): Computer\\HKEY_CURRENT_USER\\Software\\Menlo\\Menlo Connect\\Logs Registry (2 of 2): Computer\\HKEY_LOCAL_MACHINE\\Software\\WOW6432Node\\Menlo\\Menlo Connect Select\/deselect option to hide Menlo Connect in Windows Add\/Remove programs to prevent users from easily uninstalling the application and it must be removed using the Menlo Connect installer or from the command line. Enter the PAC URL in the Proxy Automatic Configuration screen. Select\/deselect option to require the tamper-proofing password for uninstallation. The user must enter the password before Menlo Connect is removed from the machine. Click Install to begin installation. Click the Finish button to exit the installer and start Menlo Connect. The Menlo Connect icon appears in the computer's taskbar once it has started running. While Menlo Connect is running Click the Menlo Connect icon to view information about the connection. Turning off the proxy While Menlo Connect is running, a user cannot manually turn off the Automatic proxy setup script through Windows Settings. Any attempt to do so automatically resets back to On once the window is closed. Turning off Menlo Connect To suspend or disable Menlo Connect, perform the steps in . Verify Menlo Connect is running Menlo Connect can be viewed in the Windows Task Manager as a background process and service. " }, 
{ "title" : "Set Up Menlo Connect Client for Windows via Command Line (Single Machine) ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41986-set-up-menlo-connect-client-for-windows-via-command-line--single-machine-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Set Up Menlo Connect Client for Windows via Command Line (Single Machine) ", 
"snippet" : "This section describes how to install Menlo Connect on a single machine using the command line. Launch the Command Prompt. Enter the following to install Menlo Connect with the desired parameter values for your installation: msiexec \/i \"{path-to-menlo-connect-msi-file.msi}\" PAC_URL=\"{type-your-PAC-U...", 
"body" : "This section describes how to install Menlo Connect on a single machine using the command line. Launch the Command Prompt. Enter the following to install Menlo Connect with the desired parameter values for your installation: msiexec \/i \"{path-to-menlo-connect-msi-file.msi}\" PAC_URL=\"{type-your-PAC-URL}\" \/q \/L*V {path-to-log-file} Use \/L!*v for troubleshooting, which generates a more verbose log file. This option is available for any command that supports \/L*V . Enable tamper protection by entering the command with the tamper protection password following the PAC URL: msiexec \/i \"{path-to-menlo-connect-msi-file.msi}\" PAC_URL=\"{type-your-PAC-URL}\" TAMPER_PROTECTION_PWD=\"{raw-password}\" \/q \/L*V {path-to-log-file} Example: install Menlo Connect for all users (the install file and the log file path are in the same folder as the batch script file): msiexec \/i \"Menlo.Connect.Setup.msi\" PAC_URL=\"https:\/\/pac.menlosecurity.com\/test-1234\/wpad.dat\" \/q \/L*V log.txt Example: install Menlo Connect for all users with the tamper protection password \"12345678@?\": msiexec \/i \"Menlo.Connect.Setup.msi\" PAC_URL=\"https:\/\/pac.menlosecurity.com\/test-1234\/wpad.dat\" TAMPER_PROTECTION_PWD=\"12345678@?\" \/q \/L*V log.txt " }, 
{ "title" : "Upgrading the Menlo Connect Agent ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41987-upgrading-the-menlo-connect-agent.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Upgrading the Menlo Connect Agent ", 
"snippet" : "The Menlo Connect installer detects existing Menlo Connect installations in use (current user only or all users). For per-user installations If your existing installation is per-user, you will need to re-install Menlo Connect, instead of upgrading. To upgrade to the latest version you should: Backup...", 
"body" : "The Menlo Connect installer detects existing Menlo Connect installations in use (current user only or all users). For per-user installations If your existing installation is per-user, you will need to re-install Menlo Connect, instead of upgrading. To upgrade to the latest version you should: Backup your registry configuration. Uninstall Menlo Connect. Install the latest Menlo Connect version. Restore the registry entries. Refer to Microsoft's instructions for backing up and restoring Windows Registry files: [Microsoft documentation] How to back up and restore the registry in Windows . For all-user installations The same Registry values are kept, so the PAC URL will not be requested. To upgrade: Double-click Menlo.Connect.Setup.<version>.msi to start the Menlo Connect installer. Follow the steps and advance through the screens. Click Install to begin upgrade installation. The User Account Control confirmation dialog appears to confirm installation. Once complete, click the Finish button to exit the installer. " }, 
{ "title" : "Pause or Remove the Menlo Connect Client Application for Windows ", 
"url" : "41888-menlo-connect-client/41968-menlo-connect-client-for-windows/41988-pause-or-remove-the-menlo-connect-client-application-for-windows.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for Windows \/ Pause or Remove the Menlo Connect Client Application for Windows ", 
"snippet" : "Introduction This section provides instructions for pausing (for a short period or indefinitely) and\/or uninstalling Menlo Connect from a single computer. The suspend period and the disable service option is configured in the Windows Registry. Your permissions may not allow you to either change the ...", 
"body" : "Introduction This section provides instructions for pausing (for a short period or indefinitely) and\/or uninstalling Menlo Connect from a single computer. The suspend period and the disable service option is configured in the Windows Registry. Your permissions may not allow you to either change the suspension length and\/or disable the Menlo Connect service. Contact your administrator if you have issues. Pausing the Menlo Connect Application (Suspend or Disable Service) If enabled in your Windows Registry, you can temporarily suspend or completely disable Menlo Connect on your computer. To disable this option, see . Suspend Menlo Connect To pause Menlo Connect for a short period (default is 15 minutes): Right-click the Menlo Connect application icon in the task bar and select Suspend . If suspend is password-protected, a pop-up window appears where the user must enter the correct password before the service is temporarily disabled. The task bar icon indicates that Menlo Connect is disabled (red X). Click on the application icon to view the time left in the suspension period. Menlo Connect will automatically restart at the end of this period. Deactivate Menlo Connect Deactivating Menlo Connect disables it indefinitely, but leaves the application installed on your computer. To deactivate Menlo Connect: Right-click the Menlo Connect icon in the task bar and select Deactivate . The task bar icon indicates that Menlo Connect is disabled (red X). To restart Menlo Connect, right-click the icon and select Resume . The task bar icon shows that Menlo Connect is enabled again. Uninstall Menlo Connect Uninstalling Menlo Connect removes the application from your computer entirely. You can use the Menlo Connect installer to uninstall the application, or uninstall it from the command line. Remove Menlo Connect using the installer Double-click on the Menlo Connect installer. There is an option to hide Menlo Connect from Windows Add\/Remove programs during installation; if it is visible it can also be uninstalled from here. Select the Remove option. Enter the tamper-proofing protection password. The installer removes the application cleans the Windows Registry. Remove Menlo Connect using the command line Launch the Command Prompt as a user with administrative privileges . Enter the following to remove Menlo Connect: msiexec \/x \"{path-to-menlo-connect-msi-file.msi}\" \/q \/L*V {path-to-log-file} Use \/L!*v for troubleshooting, which generates a more verbose log file. This option is available for any command that supports \/L*V . If tamper protection is enabled, enter the command with the tamper protection password hash: msiexec \/x \"{path-to-menlo-connect-msi-file.msi}\" TAMPER_PROTECTION_PWD=\"{password-hash}\" \/q \/L*V {path-to-log-file} Example: The following command removes Menlo Connect installed with tamper protection: msiexec \/x \"menlo-connect_v2.2.0.3.msi\" TAMPER_PROTECTION_PWD=\"54,41,54,06,f9,ed,48,f7,fc,5e,e5,69,ff,bd,84,be,c1,18,17,2b,33,a9,bb,63,e3,fe,43,47,9a,01,6f,80,f5,e6,a4,4a,b3,cd,5f,45,eb,3c,2b,07,cd,39,29,9a,f5,e6,a4,4a,b3,cd,5f,45,eb,3c,2b,07,cd,39,29,9a\" \/q \/L*V \"mcc_installer.log\" " }, 
{ "title" : "Menlo Connect Client for macOS ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS ", 
"snippet" : "This guide is divided into the following sections:...", 
"body" : "This guide is divided into the following sections: " }, 
{ "title" : "Introduction to Menlo Connect Client for macOS ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41989-introduction-to-menlo-connect-client-for-macos.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Introduction to Menlo Connect Client for macOS ", 
"snippet" : "Description The Menlo Connect agent for macOS is a software application that runs on a user's laptop or other endpoint machine to manage their system proxy settings and address situations with connectivity limits, such as guest Wi-Fi captive portals. The agent can detect when users try to connect to...", 
"body" : "Description The Menlo Connect agent for macOS is a software application that runs on a user's laptop or other endpoint machine to manage their system proxy settings and address situations with connectivity limits, such as guest Wi-Fi captive portals. The agent can detect when users try to connect to networks where a captive portal requires them to pay, authenticate, or agree to an acceptable use policy before accessing the internet (for example, Wi-Fi networks at airports or hotels). When it detects a captive portal, it will temporarily remove the configured Menlo PAC file settings, allowing users to complete the steps necessary to access the network, before automatically re-enabling itself. The agent seamlessly enforces the use of the Menlo PAC file, ensuring that your organization's security and access policies are applied wherever they might be accessing the internet. The agent also has built-in location awareness for customers who require a hybrid configuration. In environments where devices on the corporate network connect to an on-premise Web gateway and the Menlo Security Cloud Platform when roaming outside the corporate network, the on-net feature will determine the location of the user's device, which can be either \"on-network\" or \"off-network\"; it then enforces the appropriate proxy settings based on location. " }, 
{ "title" : "Menlo Connect Client for macOS Release Notes ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41990-menlo-connect-client-for-macos-release-notes.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Menlo Connect Client for macOS Release Notes ", 
"snippet" : "Release Date: November 2021 (2.2.0.2) Changes: The log retention key name used in the default.sh file and Windows Registry has been renamed Logs_RetentionHours (was Logs_DecreaseTime). The installer now blocks installation of Menlo Connect version 2.2 if a previous installation of Menlo Connect exis...", 
"body" : "Release Date: November 2021 (2.2.0.2) Changes: The log retention key name used in the default.sh file and Windows Registry has been renamed Logs_RetentionHours (was Logs_DecreaseTime). The installer now blocks installation of Menlo Connect version 2.2 if a previous installation of Menlo Connect exists. The current version must be uninstalled before version 2.2 is installed. Release Date: July 2021 (2.2.0.1) Changes: Added new default configuration parameters: Net_ProxyByPass (hosts and domains that should bypass the proxy) and Net_ExcludeSimpleHost (used with Net_ProxyByPass to enable\/disable proxy bypass) Added option to display password during entry. Added logging for network troubleshooting. Fixed bug that displayed double icon for Menlo Connect following restart. Fixed bug that caused a DNS resolution error when installing on macOS Big Sur. Known Issues: Menlo Connect is not supported by Palo Alto Networks GlobalProtect app. Release Date: September 2020 (2.1.0.11) Changes: Fresh installations of the Menlo Connect Client (manual install using the pkg and not via a group policy) will now have the \"Suspend\" and \"Deactive\" options enabled by default. After installation is complete, these options are available from the MCC icon right-click menu. Known Issues: None Release Date: June 17, 2020 (2.1.0.10) Changes: Initial release of Menlo Connect Client for macOS Known Issues: None " }, 
{ "title" : "Menlo Connect for macOS Prerequisites and Settings ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41972-menlo-connect-for-macos-prerequisites-and-settings.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Menlo Connect for macOS Prerequisites and Settings ", 
"snippet" : "Installation Prerequisites Each user must have a valid account on the Menlo Security Cloud Platform associated with your tenant and be able to authenticate with the service. Operating Systems Menlo Connect supports the following Operating Systems: macOS 10.12 and above Configuration Script Before in...", 
"body" : "Installation Prerequisites Each user must have a valid account on the Menlo Security Cloud Platform associated with your tenant and be able to authenticate with the service. Operating Systems Menlo Connect supports the following Operating Systems: macOS 10.12 and above Configuration Script Before installing Menlo Connect, you must run the defaults.sh file on the endpoint(s): For a Group of endpoints, be sure to add the configuration script as described in . For a Single endpoint, open a terminal window and enter the following command: sh {PATH-TO-FILE\/}defaults.sh Deployment Options The Menlo Connect agent is distributed as a pkg install package, and can be deployed in the following ways: Multiple Endpoints Deploy to one or more Mac endpoints using Jamf or another MDM solution Detailed instructions for deploying the agent through Jamf Pro are provided in . Single Endpoint Manual Install : On the Mac endpoint double-click on the MenloConnect.pkg file (unzip the MenloConnect-<version>.zip file to obtain all required files. Detailed instructions are provided in . Command Line : On the Mac endpoint open a terminal window and enter the following: sudo installer -pkg {PATH-TO-FILE\/}MenloConnect.pkg -target \/ Installer Download the current version of the Menlo Connect installer for Mac from the CS portal Menlo Connect page . Defaults.sh File Settings Menlo Connect reads settings values from the defaults.sh file. This file can be updated during installation of the agent for your requirements. If any required settings are missing a default value, a runtime exception is generated and Menlo Connect exits with an error message. The following table describes all available settings. If you modify any of the following settings, you must run the following command in a terminal window before they will take effect: sh {PATH-TO-FILE\/}defaults.sh Group Parameter Description Example Default Value Pac PacFileUrl URL for PAC file location https:\/\/pac.menlosecurity.com\/<tenant-specific-relative-path> None Pac PacParserRegex Expression that parses the PAC file and retrieves the proxy list (dns:port) that must be enclosed in capturing group PacParserRegex=PROXYs+([a-zA-Z0-9-]+.menlosecurity.com:[0-9]+) See example; this does not need to be modified Pac PollingInterval Polling interval in seconds used to check for connectivity to Menlo Proxy servers 10 10 DisableMode DisableMode_PasswordHash SHA256 hash of password that allows user to deactivate Menlo Connect <password-hash> None DisableMode DisableMode_Duration Allowed disable mode limit in hours 24 24 DisableMode DisableMode_Enabled Is Disable mode enabled? false false DisableMode DisableMode_NeedPwd Is Password required to disable Menlo Connect? false false SuspendMode SuspendMode_PasswordHash SHA256 hash of password that allows user to suspend Menlo Connect <password-hash> None SuspendMode SuspendMode_Duration Allowed suspension limit in minutes 15 15 SuspendMode SuspendMode_Enabled Is Suspend mode enabled? false false SuspendMode SuspendMode_NeedPwd Is Password required to suspend Menlo Connect? false false SuspendMode PwdRetryInterval Retry interval for password in minutes 30 30 Logs RetentionHours Logs of this age in hours are deleted from the logs folder 24 24 Diagnostics PrivateIpEndpoint Private IP endpoint returned for diagnostics safe.menlosecurity.com safe.menlosecurity.com Diagnostics PublicIpEndpoint Public IP endpoint returned in plain text for diagnostics api.ipify.org api.ipify.org OnNet Net_Enabled Enables on\/off net feature. Capture of existing system proxy settings (learning mode) works regardless of this setting. false false OnNet Net_CheckDomain Known domain inside the corporate network <domain> <domain> OnNet Net_CheckIP Address to which the known domain inside the corporate network resolves <ip-address> <ip-address> OnNet Net_Direct Direct connection mode when on-net (no proxy) false false OnNet Net_PacFileEnabled On-net PAC file enabled false false OnNet Net_PacFileUrl On-net URL to PAC file https:\/\/pac.menlosecurity.com\/<tenant-specific-relative-path> https:\/\/pac.menlosecurity.com\/<tenant-specific-relative-path> OnNet Net_ProxyHTTPEnabled Proxy mode enabled false false OnNet Net_ProxyHTTPAddress IP address for proxy mode <proxy-ip-address> <proxy-ip-address> OnNet Net_ProxyHTTPPort Proxy port for proxy mode <proxy-port> <proxy-port> OnNet Net_EnforceProxy Should proxy settings be applied immediately when switching network modes (if disabled, current state of Menlo Connect is preserved). false false OnNet Net_ProxyByPass Allow hosts\/domains to bypass proxy. Use a semicolon (;) to separate hosts and domains that will bypass proxy. <host> <host> OnNet Net_ExcludeSimpleHost If Net_ProxyByPass has a value this changes to TRUE to enable proxy bypass by the hosts\/domains in that parameter false false defaults.sh file The following is an example of the defaults.sh file. You can copy the example and modify it as needed, saving it as an .sh file. #!\/usr\/bin\/env bash #Clear previous defaults (If applied - will remove current client state [suspend\/disable]) #sudo defaults delete com.menlo.service #Pac section sudo defaults write com.menlo.service Pac_FileUrl -string \"https:\/\/pac.menlosecurity.com\/<tenant-specific-relative-path>\" sudo defaults write com.menlo.service Pac_ParserRegex -string \"PROXY\\s+([a-zA-Z0-9-]+.menlosecurity.com:[0-9]+)\" sudo defaults write com.menlo.service Pac_PollingInterval -int 10 #DisableMode section sudo defaults write com.menlo.service DisableMode_PasswordHash -string \"<password-hash>\" #SHA256 sudo defaults write com.menlo.service DisableMode_Duration -int 24 sudo defaults write com.menlo.service DisableMode_Enabled -bool false sudo defaults write com.menlo.service DisableMode_NeedPwd -bool false #SuspendMode section sudo defaults write com.menlo.service SuspendMode_PasswordHash -string \"<password-hash>\" #SHA256 sudo defaults write com.menlo.service SuspendMode_Duration -int 15 sudo defaults write com.menlo.service SuspendMode_Enabled -bool false sudo defaults write com.menlo.service SuspendMode_NeedPwd -bool false sudo defaults write com.menlo.service PwdRetryInterval -int 30 #Logs section sudo defaults write com.menlo.service Logs_RetentionHours -int 24 #Diagnostics section sudo defaults write com.menlo.service Diagnostics_PrivateIpEndpoint -string \"safe.menlosecurity.com\" sudo defaults write com.menlo.service Diagnostics_PublicIpEndpoint -string \"https:\/\/api.ipify.org\" #OnNet section sudo defaults write com.menlo.service Net_Enabled -bool false sudo defaults write com.menlo.service Net_CheckDomain -string \"<domain>\" sudo defaults write com.menlo.service Net_CheckIP -string \"<ip-address>\" sudo defaults write com.menlo.service Net_Direct -bool false sudo defaults write com.menlo.service Net_PacFileEnabled -bool false sudo defaults write com.menlo.service Net_PacFileUrl -string \"https:\/\/pac.menlosecurity.com\/<tenant-specific-relative-path>\" sudo defaults write com.menlo.service Net_ProxyHTTPEnabled -bool false sudo defaults write com.menlo.service Net_ProxyHTTPAddress -string \"<proxy-ip-address>\" sudo defaults write com.menlo.service Net_ProxyHTTPPort -int <proxy-port> sudo defaults write com.menlo.service Net_EnforceProxy -bool false " }, 
{ "title" : "Deploying the Menlo Connect Agent via Jamf Pro ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41991-deploying-the-menlo-connect-agent-via-jamf-pro.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Deploying the Menlo Connect Agent via Jamf Pro ", 
"snippet" : "Introduction This section describes how to install the Menlo Connect Agent using Jamf Pro, which is the recommended installation method for a group of users\/computers. If you are installing Menlo Connect Client on a single computer, see for information about using the MenloConnect.pkg installer. Dep...", 
"body" : "Introduction This section describes how to install the Menlo Connect Agent using Jamf Pro, which is the recommended installation method for a group of users\/computers. If you are installing Menlo Connect Client on a single computer, see for information about using the MenloConnect.pkg installer. Deployment requires the following: ??? (MenloConnect.pkg) to JAMF Pro ??? (defaults.sh) as needed that sets the desired configuration parameters (e.g. suspend time period, password requirements, etc.) ??? of the computers that will receive the Menlo Connect Agent ??? that defines when the computers are checked for Menlo Connect Agent installation\/upgrade status Upload the Menlo Connect Package In Jamf Pro, select Settings -> Computer Management -> Packages . Click New . Use the General pane to configure the display name (e.g., Menlo Connect) and category (e.g., Security). Click Upload Package and select the MenloConnect.pkg file (located in the distr folder). Once the package is uploaded, click Save . Add the Config Script In Jamf Pro, select Settings -> Computer Management -> Scripts . Click New . Use the General pane to configure the display name (defaults.sh) and category (e.g., Security). Click the Script tab and enter the contents from the defaults.sh file in the script editor. See :ref: menlo-connect-mac-settings for details. If desired, generate SHA-256 password hashes for Disable Mode and\/or Suspend Mode . If the OnNet feature will be used (hybrid configuration with location awareness), be sure to enable that service and enter the appropriate Net Check Domain and IP and Proxy HTTP IP Address and Port. Click Save . Create a Smart Group In Jamf Pro, select Computers -> Smart Computer Groups . Click New . Configure basic settings for the group that will use the Menlo Connect Agent. Click Save and then click View to view the computers in the Smart Group. Operations in the group take place in the order they are listed (from top to bottom). Create a Policy In Jamf Pro, select Computers -> Policies . Click New . Enter the basic settings for the policy. We recommend the following General pane options. Display Name : Enter the desired name for the Menlo Connect policy. Enabled : Check to enable the policy. A Smart Computer Group will be used to determine which computers have Menlo Connect enabled. Category : Select the policy category type (e.g., Security ). Trigger : Select the event trigger that initiates the policy (e.g., Recurring Check-in to have the computers in the smart group check at the JAMF configured frequency whether Menlo Connect is installed and\/or up to date. Execution Frequency : Select the policy frequency (e.g., Once every week ). Select the Scripts pane and find the Menlo Connect defaults shell file ( Menlo_defaults.sh ). Press Add to add this script to the policy, and press Save when ready. You can use the Logs pane for the new policy to view installation details. Select the desired Smart Computer group and attach the policy to the group. " }, 
{ "title" : "Set Up Menlo Connect Client for macOS Using Installer (Single User) ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41973-set-up-menlo-connect-client-for-macos-using-installer--single-user-.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Set Up Menlo Connect Client for macOS Using Installer (Single User) ", 
"snippet" : "Procedure This section describes how to install Menlo Connect on a single computer using the installer package. If you wish to install Menlo Connect via a group policy, see the section. Be sure that the defaults.sh file has been run as described in (Installation Prerequisites) before you install Men...", 
"body" : "Procedure This section describes how to install Menlo Connect on a single computer using the installer package. If you wish to install Menlo Connect via a group policy, see the section. Be sure that the defaults.sh file has been run as described in (Installation Prerequisites) before you install Menlo Connect Client. Double-click the MenloConnect.pkg to start the Setup Wizard. Follow the on-screen steps and click Continue to advance through the wizard. Confirm your installation location and click Install to proceed with installation or Change Install Location... to select another disk. The installer displays a Success message once installation is complete. Click the Close button to exit the wizard. The Menlo Connect application starts running immediately and is indicated by a menu bar icon. Click the icon to view information about the connection. While Menlo Connect is running, a user cannot manually turn off the Automatic proxy setup script through System Preferences -> Network -> Proxies . If they attempt to do so, it is automatically reset back to On as soon as the window is closed\/refreshed. To suspend or disable Menlo Connect, perform the steps in . These actions are now enabled by default following installation using the installer for a single user. Menlo Connect Log File By default, Menlo Connect logs all system events to the following location: var\/log\/menlo.log " }, 
{ "title" : "Pause or Remove the Menlo Connect Client Application for macOS ", 
"url" : "41888-menlo-connect-client/41970-menlo-connect-client-for-macos/41992-pause-or-remove-the-menlo-connect-client-application-for-macos.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Connect Client \/ Menlo Connect Client for macOS \/ Pause or Remove the Menlo Connect Client Application for macOS ", 
"snippet" : "Introduction This section provides instructions for pausing (for a short period or indefinitely) and\/or uninstalling the Menlo Connect application from a single computer. The suspend period and the disable service option is configured in the defaults.sh file. Your permissions may not allow you to ei...", 
"body" : "Introduction This section provides instructions for pausing (for a short period or indefinitely) and\/or uninstalling the Menlo Connect application from a single computer. The suspend period and the disable service option is configured in the defaults.sh file. Your permissions may not allow you to either change the suspension length and\/or disable the Menlo Connect service. Contact your administrator if you have issues. Pausing the Menlo Connect Application (Suspend or Disable Service) If enabled in the defaults.sh file, you can temporarily suspend or completely disable Menlo Connect on your computer. To pause Menlo Connect for a short period (default is 15 minutes), Right-click the Menlo Connect icon in the menu bar and select Suspend . If suspend is password-protected, a pop-up window appears where the user must enter the correct password before the service is temporarily disabled. The menu bar icon indicates that Menlo Connect is disabled (red X). Menlo Connect will automatically restart at the end of the suspend period. To deactivate Menlo Connect for a user-defined period (default is 24 hours), Right-click the Menlo Connect icon in the menu bar and select Deactivate . The menu bar icon indicates that Menlo Connect is disabled (red X). When you are ready to restart Menlo Connect, right-click the icon and select Resume . The menu bar icon shows that Menlo Connect is enabled again. Uninstall Menlo Connect If you wish to remove Menlo Connect from your computer, Open the terminal and enter the following: sh {PATH-TO-FILE\/}uninstall.sh The application is uninstalled. " }, 
{ "title" : "Troubleshooting ", 
"url" : "41890-troubleshooting.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Troubleshooting ", 
"snippet" : "...", 
"body" : "" }, 
{ "title" : "Basic Troubleshooting ", 
"url" : "41890-troubleshooting/41993-basic-troubleshooting.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Troubleshooting \/ Basic Troubleshooting ", 
"snippet" : "Introduction This page provides some basic checks you can use for troubleshooting. For more detailed troubleshooting procedures, refer to the Menlo Security Support Knowledge Base. The following topics are covered below: Determining if a Site is Isolated Using Incognito or Private Browsing Pre-Pend ...", 
"body" : "Introduction This page provides some basic checks you can use for troubleshooting. For more detailed troubleshooting procedures, refer to the Menlo Security Support Knowledge Base. The following topics are covered below: Determining if a Site is Isolated Using Incognito or Private Browsing Pre-Pend Mode Site Testing Error: The requested URL could not be retrieved Collecting Developer Mode Information from a Browser Uploading a file to Menlo Security Support SSL inspection exceptions are not working MSIP authorization fails using Internet Explorer (On-prem\/Private Cloud only) Office 365 mail is not being restored Troubleshooting printing and PDF conversion issues Management Appliance low disk space warning SNMP traps (On-prem\/Private Cloud only) Determining if a Site is Isolated The easiest way to determine if a site is being isolated is to do a View Page Source of the web page. This can normally be viewed by right clicking the webpage and selecting View Page Source . If the site is isolated, there should only be about 20 lines, with the last ending in a pointer to the MSIP. Non-Isolated Page: Example Allowed Page Without Isolation Isolated Page: Example Isolated Page Using Incognito or Private Browsing Occasionally you may want to test the authentication of a page without using any previously set cookies. Cookies are used by Menlo Security to help streamline the authentication process for users. Both in the use of Menlo Security Authentication and single sign-on, a local cookie is set to notify the browser that it should not continually query the user with an authentication dialog box. To force an authentication instead of using previously created information in the cookie (e.g., when working on the authentication setup), delete the cookies in the browser or start an Incognito or Private Browser session. To start the browser in this mode do one of the following: In Chrome, select Omni icon -> New Incognito Window or press Ctrl-Shift-N . In Firefox, select File\/Omni icon -> New Private Window or press Ctrl-Shift-P . In Internet Explorer, from the Menu Bar select Tools -> InPrivate Browsing or press Ctrl-Shift-P . In Safari, select File -> New Private Window or press Ctrl-Shift-P . Once the private browsing window is open, it doesn't have access to any previously set cookies, and it can't set cookies after the browser window session is closed. Pre-Pend Mode Site Testing A special trial and testing option called Pre-Pend Mode is available for testing the impact of Menlo Security on web sites. This is useful to see any change in the appearance of a site from a working setup which isolates the page but does not require any proxy or local re-configuration. In Pre-pend Mode the string https:\/\/safe.menlosecurity.com is pre-pended to each URL or earch term. For example, https:\/\/safe.menlosecurity.com\/http:\/\/www.slate.com or https:\/\/safe.menlosecurity.com\/apple This mode still requires authentication into a valid Menlo Security account. HTTPS can be used in Pre-Pend Mode without additional certificate configuration. Error: The requested URL could not be retrieved If a URL cannot be retrieved when using MSIP but it loads without problems when not using MSIP, first confirm that there is no category, threat, or exception block in the policy configuration. If the URL should not be blocked, but it is not loading in MSIP, the destination web server may be blocking access from the Amazon servers MSIP uses. This happens on rare occasions and can easily be fixed by sending the URL request to Menlo Security Customer Success. We will route traffic for that destination web server through non-Amazon systems. Please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . Collecting Developer Mode Information from a Browser It may be necessary to collect detailed information about a page load. For example, while troubleshooting SAML, certificate issues, speed problems or even rendering issues. Browsers have \"Developer Tools\" which show exactly what and when a page loads. To access this information for Menlo support, perform the following steps: Open an Incognito\/Private Window. Open the Developer Tools: Press F12 or navigate to Tools -> (Web Developer) -> Developer Tools . In the Developer Tools, select the Network tab, and validate the following settings: Recording is enabled (red icon should be displayed). Preserve log is checked. Disable cache is checked. Reproduce the issue. Select All in the Developer Tools Name\/Path output section, and then right click and select Save as HAR with Content . Send Menlo Security the HAR file for review. Uploading a file to Menlo Security Support If you can't attach a large file to a help desk ticket or email it, you can use the following website to upload a file for the Menlo Security support team: https:\/\/support-upload.menlosecurity.com SSL inspection exceptions are not working If you find that SSL inspection exceptions are not being honored (i.e., SSL inspection and then isolation based on your web policy is done), confirm that you have configured your corporate gateway IPs. This is done in the Settings -> Authentication -> Corporate Gateway IPs section. See . The policy relies on the source IP to identify the tenant, because the browser does not send any cookies until SSL negotiations are complete. When browsing traffic comes from an IP address that is not in the Gateway IP list, any SSL inspection exceptions will not work. MSIP authorization fails using Internet Explorer (On-prem\/Private Cloud only) If your MSIP sessions are not being authorized when using Internet Explorer (IE), confirm that you have set up an IE Authorization Hostname in your DNS. This is required for all prepend mode IE users (and not required if you always use proxy mode in IE). This is configured in the Isolation appliance under the Settings -> Service -> IE Zone Authorization section. See . This configuration allows MSIP authorization across IE integrity levels. If the site being accessed is in a different integrity level than the MSIP authorization cookie, the request cannot be authorized. This setting passes the MSIP cookie into another integrity level, allowing MSIP sessions to be authorized. IE keeps separate cookie stores per integrity level, and an additional flag automatically puts any site that bypasses the proxy into the Internet zone. By default, sites in your Intranet are in the medium integrity level. Integrity level will be either low or medium for a zone, depending on whether protected mode is enabled for that zone. Office 365 mail is not being restored If mail sent from Exchange\/Office 365 is not being restored, please confirm if the mail uses the TNEF (application\/ms-tnef) format. If the email uses this format and you want TNEF email to be restored, it is possible that TNEF processing is not enabled on your tenant. Also you should consider whether it is more appropriate to configure Exchange\/Office 365 so that emails are sent using standard email formats as TNEF is a proprietary format that is not as widely supported. For further assistance, please log a ticket with Menlo Security Customer Success at https:\/\/csportal.menlosecurity.com\/hc\/en-us or support@menlosecurity.com . Troubleshooting printing and PDF conversion issues Print troubleshooting messages have been added to the latest MSIP release. If a user has tried to print from the browser's print menu, a window appears that recommends that they use the Ctrl+P shortcut to print the page. Note that \"printing\" generates a PDF first. A Print Options window can be used to scale and choose the paper size and layout for the output. The Print Preview window shows the PDF output prepared for the web page. If no output is shown, confirm that a PDF viewer is installed on your system. A loading icon appears in the window while the PDF is being prepared. Management Appliance low disk space warning If your Management Appliance sends a low disk space warning for the second (logging) disk, you can resize the local storage as follows: In your server virtualization software (e.g. VMware), manually increase the disk size. During the next appliance boot up, the file system is automatically resized to take advantage of available space. SNMP traps (On-prem\/Private Cloud only) Isolation appliances will send various alert messages if online\/network resources are unavailable. A complete list of alert messages and any resolution steps that are required are located here: ??? for details. " }, 
{ "title" : "Central Manager Dashboard Service Checks ", 
"url" : "41890-troubleshooting/41994-central-manager-dashboard-service-checks.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Troubleshooting \/ Central Manager Dashboard Service Checks ", 
"snippet" : "Introduction This document provides a complete list of all Dashboard service checks that may appear (i.e., fail) on the Dashboard. Where applicable, a resolution for the issue is provided below the description. Index AD Authorization An external FireEye AX profile Approaching Disposable Virtual Cont...", 
"body" : "Introduction This document provides a complete list of all Dashboard service checks that may appear (i.e., fail) on the Dashboard. Where applicable, a resolution for the issue is provided below the description. Index AD Authorization An external FireEye AX profile Approaching Disposable Virtual Container control group resource limits. Please schedule an appliance reboot. Approaching isolated browser resource limits Auth Server Central Management System not available Certificate vault is not healthy Client Logger Cookie Server DVC Manager DVC Router Dashboard Dashboard(g) Dashboard(ng) Dashboard(u) Director Document Isolation Due to configuration, external FireEye AX Event Consumer External FireEye AX WSAPI File Extraction REST API CA certificate expires in less than 30 days File Extraction REST API endpoint is not available or cannot be contacted File Extraction REST API endpoint is rejecting requests due to SSL validation errors File Processing File Server File Server Container Service FireEye AX CA certificate expires in less than 30 days. FireEye AX appliance is rejecting requests due to SSL validation errors ICAP ICAP-Auth Kafka Link Transform Live Updater Live Updates Agent Log Agent Log Agent connection Log Agent is buffering log messages due to issues with the upstream log receiver. Logging sub-system (b) Logging sub-system (c) Logging sub-system (h) Logging sub-system (l) Logging sub-system (r) Logging sub-system is using more memory than expected (b) Logging sub-system is using more memory than expected (c) Logging sub-system is using more memory than expected (h) Logging sub-system is using more memory than expected (r) Mail Proxy Menlo Intelligence Center Server Menlo License \/ Updates Server is not available or cannot be contacted MySQL NGINX Node Agent Not reachable from CMR Policy Policy(port) Proxy Proxy(port) Proxy(smp) RDS Redis ReversingLabs endpoint is not available or cannot be contacted ReversingLabs endpoint is rejecting requests due to SSL validation errors Service Surrogate Downscaler System version is out of date The dynamic Live-Updates are out of date and unable to update. The dynamic Live-Updates system is not available UCE Worker Pool URL Classifier (Live Webroot Query) URL Classifier (Native Checks) Update Server Upstream Proxy Webroot API Status Zookeeper rsyslogd CMR Dashboard Status Messages AD Authorization Active Directory is used for authorization. This message indicates a problem with the service (outage or heavy load). Part of LDAP. An external FireEye AX profile When content inspection is integrated with the FireEye AX, this check ensures the configuration provided to the MSIP defining the analysis profiles are reported as available from the API. Part of FireEye, non-critical (will not fail health-check). Approaching Disposable Virtual Container control group resource limits. Please schedule an appliance reboot. MSIP uses Disposable Virtual Containers. This message warns about approaching the associated control group limits imposed by the appliance. Rebooting the appliance resolves the problem by releasing unduly tied-up resources. Part of OS. Approaching isolated browser resource limits CMR monitors the number of Safeview surrogate browsers. This warning appears when approaching resource limits. Part of safeview, non-critical (will not fail health-check). Auth Server Check for the Safeview auth service. Part of auth-server. Central Management System not available Health-check for the CMR itself is failing. Part of dashboard, non-critical (will not fail health-check). Certificate vault is not healthy There is a problem with the encrypted vault storing the appliance certificates. It might be possible to resolve by resetting the certificates from the CLI. For additional help, please contact support. Part of OS, non-critical (will not fail health-check). Client Logger Check for Safeview logging service. Part of safeview. Cookie Server Check for service used by Safeview to store user cookies. Part of safeview. DVC Manager Contact Menlo Security Support. Part of safeview. DVC Router Contact Menlo Security Support. Part of safeview. Dashboard CMR Dashboard service. Part of dashboard. Dashboard(g) Contact Menlo Security support. Part of dashboard. Dashboard(ng) Auxiliary services for CRM Dashboard. Part of dashboard. Dashboard(u) Contact Menlo Security support. Part of dashboard. Director Contact Menlo Security support. Part of safeview. Document Isolation Contact Menlo Security support. Part of safeview. Due to configuration, external FireEye AX When content inspection is integrated with the FireEye AX, this check ensures the configuration provided to the MSIP is valid, such as the server address and password. It also checks that the API is responding. Part of FireEye, non-critical (will not fail health-check). Event Consumer Contact Menlo Security support. Part of safeview. External FireEye AX WSAPI When content inspection is integrated with the FireEye AX, this check ensures the FireEye AX's WSAPI is enabled at the API. Part of FireEye, non-critical (will not fail health-check). File Extraction REST API CA certificate expires in less than 30 days When content inspection is integrated with the Menlo File Extraction REST API, this check ensures the server's SSL certificate has at least 30 days of validity remaining. Part of file-server. File Extraction REST API endpoint is not available or cannot be contacted When content inspection is integrated with the Menlo File Extraction REST API, this check ensures the configuration provided to the MSIP is valid, such as the server address and password. It also checks that the API is responding. Part of file-server. File Extraction REST API endpoint is rejecting requests due to SSL validation errors When content inspection is integrated with the Menlo File Extraction REST API, this check ensures the server's SSL certificate is valid for the hostname, signed by a trusted CA or signed by the provided CA certificate, and that the certificate has not expired. File Processing The File Processing service is responsible for handling the content inspection of file downloads and uploads. Part of file-server. File Server The file-server service is responsible for handling the content inspection of file downloads and uploads. Part of safeview. File Server Container Service Contact Menlo Security support. Part of file-server. FireEye AX CA certificate expires in less than 30 days. When content inspection is integrated with the FireEye AX, this check ensures the FireEye AX's SSL certificate has at least 30 days of validity remaining. Part of FireEye, non-critical (will not fail health-check). FireEye AX appliance is rejecting requests due to SSL validation errors When content inspection is integrated with the FireEye AX, this check ensures the FireEye AX's SSL certificate is valid for the hostname, signed by a trusted CA or signed by the provided CA certificate, and that the certificate has not expired. Part of FireEye, non-critical (will not fail health-check). ICAP Checks ICAP service health. Part of icap. ICAP-Auth Checks that the icap-auth service is running in a healthy state. Part of icap-auth. Kafka Checks the health of the platform for handling real-time log feeds. Part of logging sub-system. Link Transform Check for the Safemail link rewriter service. Part of safemail. Live Updater Check for Live Updater Service that delivers live updates to various services. Part of safeview. Live Updates Agent Check for Live Updates Agent that ensures receiving live updates of Menlo Intelligence, Anti-Virus data and other live updates files. Part of safeview. Log Agent Log Agent that collects and forwards logs for aggregation. Part of logging sub-system. Log Agent connection Log Agent secure handshake check. Part of logging sub-system. Log Agent is buffering log messages due to issues with the upstream log receiver. Log Agent is a service that forwards log messages to an upstream log receiver\/aggregator. If there's a problem with the upstream log receiver, Log Agent buffers log messages that it's unable to forward. Once the upstream receiver problem is resolved, buffered messages are automatically forwarded. If the receiver outage is so prolonged that the local buffer overflows, some logs may be lost. Part of logging sub-system. Logging sub-system (b) This check ensures the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system (c) This check ensures the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system (h) This check ensures the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system (l) This check ensures the health of the logging sub-system responsible for ingesting realtime log data. When this check fails, it indicates that the system is lagging behind the realtime feed. Part of logging sub-system. Logging sub-system (r) This check ensures the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system is using more memory than expected (b) This warning alerts about high memory use detected when checking the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system is using more memory than expected (c) This warning alerts about high memory use detected when checking the health of the service responsible for managing log data. Part of logging sub-system. Logging sub-system is using more memory than expected (h) This warning alerts about high memory use detected when checking the health of the service responsible for querying log data. Part of logging sub-system. Logging sub-system is using more memory than expected (r) This warning alerts about high memory use detected when checking the health of the service responsible for querying log data. Part of logging sub-system. Mail Proxy Check for the Safemail mailproxy service. Part of safemail. Menlo Intelligence Center Server Check for MIC service that provides threat intelligence updates. Part of safeview. Menlo License \/ Updates Server is not available or cannot be contacted MSIP periodically checks Menlo service to verify its license and version are up to date, and if new updates are available. This message appears if this service could not be contacted. This is usually due to a temporary outage and resolves quickly on its own. If the problem persists, contact support. Part of dashboard, non-critical (will not fail health-check). MySQL Checks MySQL service health. MySQL is used by other services to provide RDBMS. NGINX NGINX web server. Part of safeview. Node Agent Part of safeview. Not reachable from CMR Services maintain a heartbeat signal with the CMR. This error indicates a problem with the return heartbeat, and monitored service is not reachable from the CMR. Policy Checks that the policy-enforcement service is running in a healthy state. Part of policy-enforcement. Policy(port) Checks that the policy-enforcement service is running on its designated port. Part of policy-enforcement. Proxy Checks that Squid proxy service is running. Part of proxy. Proxy(port) Checks that Squid proxy is listening to its service port. Part of proxy. Proxy(smp) Checks the health of the Squid proxy service, including the number of its helper processes. Part of proxy. RDS Contact Menlo Security support. Part of safeview. Redis Redis is used by Safeview and several other MSIP services for an in-memory database. Part of safeview. ReversingLabs endpoint is not available or cannot be contacted ReversingLabs is used to analyze safemail attachments. This message indicates a problem connecting to the ReversingLabs service endpoint. ReversingLabs service might be temporarily down or unreachable. Part of safemail, non-critical (will not fail health-check). ReversingLabs endpoint is rejecting requests due to SSL validation errors ReversingLabs is used to analyze safemail attachments. This message indicates a problem connecting securely to the ReversingLabs service endpoint due to an SSL validation error. It may be a temporary service disruption that resolves on its own. If prolonged, contact support. Part of safemail, non-critical (will not fail health-check). Service Checks the general appliance health. Part of dashboard. Surrogate Downscaler Contact Menlo Security support. Part of safeview. System version is out of date The version of a managed system is checked periodically. This message indicates that the version is out of date. Part of dashboard. The dynamic Live-Updates are out of date and unable to update. MSIP receives Menlo Intelligence, AntiVirus and other updates through Live Updates service. This message appears if the service is not able to obtain the latest updates from the Menlo servers. This is usually a temporary problem that resolves quickly on its own. If the problem persists, contact support. Part of safeview, non-critical (will not fail health-check). The dynamic Live-Updates system is not available MSIP receives Menlo Intelligence, AntiVirus and other updates through Live Updates service. This message appears if the service was unavailable. This is usually a temporary problem that resolves quickly on its own. If the problem persists, contact support. Part of safeview, non-critical (will not fail health-check). UCE Worker Pool Checks that the UCE service is running and responsive. If this check is failing, the system is usually automatically attempting to start a new UCE instance to clear the error condition. This check ensures that the UCE worker pool is listening\/accepting incoming connections on its service port, and responds to this health-check query. The check fails if UCE is not listening on its port, or is in a stalled state that prevents it from accepting requests or responding to health-checks. Part of uce (URL Classification Engine). URL Classifier (Live Webroot Query) Forces UCE to make a live test query to Webroot service API to ensure the Webroot API is up, reachable, and the Webroot categorization service is working. UCE queries the Webroot API if it doesn't have classification data for a URL in its local db (URLDB or cache). Since the Webroot API is an external service, this is a non-critical service check. This means that even if it fails (e.g. Webroot API is down), it does not cause the UCE service to be considered to be down, or to be restarted. UCE continues to run as usual, and provide URL classifications based on local data in its regularly updated URLDBs and cache. Unless the failure is due to a permanent misconfiguration, such as a bad network setup that blocks connections to the Webroot API, errors are usually transient and typically resolve quickly on their own. UCE will automatically start using the Webroot API as soon as it becomes available again. No administrator action is required. Further troubleshooting is warranted if the outage is prolonged (hours). Part of uce (URL Classification Engine), non-critical (will not fail health-check). URL Classifier (Native Checks) Performs internal UCE health-checks for Redis and Postgres databases. If this test fails, UCE service is impacted. It may be responsive, but might not be able to provide all the components normally present in URL classification responses. Further troubleshooting is necessary if restarting UCE and\/or the other affected services (Redis, Postgres) does not clear the error condition. Part of uce (URL Classification Engine). Update Server Safeview update service check. Part of safeview. Upstream Proxy This check alerts if there is a problem with connectivity to the configured upstream proxy. Part of proxy. Webroot API Status Checks if there is a Webroot service API outage. This check is based on tracking done by UCE itself if Webroot API calls fail. Repeated errors result in Webroot API being considered to be \"down\". Unlike another check, uce-service that makes a live Webroot API call as part of the check, this check does not initiate a Webroot API call. It only reports the current status as it is known to UCE based on its recent interactions with Webroot. Since the Webroot API is an external service, this is a non-critical service check. UCE continues to classify URLs based on its local databases and cache while Webroot API is down. Once Webroot API comes back online, UCE seamlessly starts to use it normally. Part of uce (URL Classification Engine), non-critical (will not fail health-check). Zookeeper Service to ingest and aggregate logs from various services. Part of logging sub-system. rsyslogd Contact Menlo Security support. Part of logging sub-system. " }, 
{ "title" : "Menlo Security APIs ", 
"url" : "41996-menlo-security-apis.html", 
"breadcrumbs" : "Menlo Security Documentation v0 \/ Menlo Security APIs ", 
"snippet" : "This is just an example and not actual Menlo APIs....", 
"body" : "This is just an example and not actual Menlo APIs. " }
]
$(document).trigger('search.ready');
});